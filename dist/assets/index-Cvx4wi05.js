var Gu=Object.defineProperty;var Hu=(e,i,s)=>i in e?Gu(e,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[i]=s;var yn=(e,i,s)=>Hu(e,typeof i!="symbol"?i+"":i,s);function _mergeNamespaces(e,i){for(var s=0;s<i.length;s++){const o=i[s];if(typeof o!="string"&&!Array.isArray(o)){for(const a in o)if(a!=="default"&&!(a in e)){const h=Object.getOwnPropertyDescriptor(o,a);h&&Object.defineProperty(e,a,h.get?h:{enumerable:!0,get:()=>o[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const h of a)if(h.type==="childList")for(const _ of h.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&o(_)}).observe(document,{childList:!0,subtree:!0});function s(a){const h={};return a.integrity&&(h.integrity=a.integrity),a.referrerPolicy&&(h.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?h.credentials="include":a.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function o(a){if(a.ep)return;a.ep=!0;const h=s(a);fetch(a.href,h)}})();var define_global_default={},commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof define_global_default<"u"?define_global_default:typeof self<"u"?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$1=Symbol.for("react.element"),n$1=Symbol.for("react.portal"),p$2=Symbol.for("react.fragment"),q$1=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),t=Symbol.for("react.provider"),u=Symbol.for("react.context"),v$1=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),z$1=Symbol.iterator;function A$1(e){return e===null||typeof e!="object"?null:(e=z$1&&e[z$1]||e["@@iterator"],typeof e=="function"?e:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$1={};function E$1(e,i,s){this.props=e,this.context=i,this.refs=D$1,this.updater=s||B$1}E$1.prototype.isReactComponent={};E$1.prototype.setState=function(e,i){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,i,"setState")};E$1.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function F(){}F.prototype=E$1.prototype;function G$1(e,i,s){this.props=e,this.context=i,this.refs=D$1,this.updater=s||B$1}var H$1=G$1.prototype=new F;H$1.constructor=G$1;C$1(H$1,E$1.prototype);H$1.isPureReactComponent=!0;var I$1=Array.isArray,J=Object.prototype.hasOwnProperty,K$1={current:null},L$1={key:!0,ref:!0,__self:!0,__source:!0};function M$1(e,i,s){var o,a={},h=null,_=null;if(i!=null)for(o in i.ref!==void 0&&(_=i.ref),i.key!==void 0&&(h=""+i.key),i)J.call(i,o)&&!L$1.hasOwnProperty(o)&&(a[o]=i[o]);var g=arguments.length-2;if(g===1)a.children=s;else if(1<g){for(var _e=Array(g),st=0;st<g;st++)_e[st]=arguments[st+2];a.children=_e}if(e&&e.defaultProps)for(o in g=e.defaultProps,g)a[o]===void 0&&(a[o]=g[o]);return{$$typeof:l$1,type:e,key:h,ref:_,props:a,_owner:K$1.current}}function N$1(e,i){return{$$typeof:l$1,type:e.type,key:i,ref:e.ref,props:e.props,_owner:e._owner}}function O$1(e){return typeof e=="object"&&e!==null&&e.$$typeof===l$1}function escape(e){var i={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(s){return i[s]})}var P$1=/\/+/g;function Q$1(e,i){return typeof e=="object"&&e!==null&&e.key!=null?escape(""+e.key):i.toString(36)}function R$1(e,i,s,o,a){var h=typeof e;(h==="undefined"||h==="boolean")&&(e=null);var _=!1;if(e===null)_=!0;else switch(h){case"string":case"number":_=!0;break;case"object":switch(e.$$typeof){case l$1:case n$1:_=!0}}if(_)return _=e,a=a(_),e=o===""?"."+Q$1(_,0):o,I$1(a)?(s="",e!=null&&(s=e.replace(P$1,"$&/")+"/"),R$1(a,i,s,"",function(st){return st})):a!=null&&(O$1(a)&&(a=N$1(a,s+(!a.key||_&&_.key===a.key?"":(""+a.key).replace(P$1,"$&/")+"/")+e)),i.push(a)),1;if(_=0,o=o===""?".":o+":",I$1(e))for(var g=0;g<e.length;g++){h=e[g];var _e=o+Q$1(h,g);_+=R$1(h,i,s,_e,a)}else if(_e=A$1(e),typeof _e=="function")for(e=_e.call(e),g=0;!(h=e.next()).done;)h=h.value,_e=o+Q$1(h,g++),_+=R$1(h,i,s,_e,a);else if(h==="object")throw i=String(e),Error("Objects are not valid as a React child (found: "+(i==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":i)+"). If you meant to render a collection of children, use an array instead.");return _}function S$1(e,i,s){if(e==null)return e;var o=[],a=0;return R$1(e,o,"","",function(h){return i.call(s,h,a++)}),o}function T$1(e){if(e._status===-1){var i=e._result;i=i(),i.then(function(s){(e._status===0||e._status===-1)&&(e._status=1,e._result=s)},function(s){(e._status===0||e._status===-1)&&(e._status=2,e._result=s)}),e._status===-1&&(e._status=0,e._result=i)}if(e._status===1)return e._result.default;throw e._result}var U$1={current:null},V$1={transition:null},W$1={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$1};function X$1(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$1,forEach:function(e,i,s){S$1(e,function(){i.apply(this,arguments)},s)},count:function(e){var i=0;return S$1(e,function(){i++}),i},toArray:function(e){return S$1(e,function(i){return i})||[]},only:function(e){if(!O$1(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};react_production_min.Component=E$1;react_production_min.Fragment=p$2;react_production_min.Profiler=r;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$1;react_production_min.Suspense=w;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.act=X$1;react_production_min.cloneElement=function(e,i,s){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var o=C$1({},e.props),a=e.key,h=e.ref,_=e._owner;if(i!=null){if(i.ref!==void 0&&(h=i.ref,_=K$1.current),i.key!==void 0&&(a=""+i.key),e.type&&e.type.defaultProps)var g=e.type.defaultProps;for(_e in i)J.call(i,_e)&&!L$1.hasOwnProperty(_e)&&(o[_e]=i[_e]===void 0&&g!==void 0?g[_e]:i[_e])}var _e=arguments.length-2;if(_e===1)o.children=s;else if(1<_e){g=Array(_e);for(var st=0;st<_e;st++)g[st]=arguments[st+2];o.children=g}return{$$typeof:l$1,type:e.type,key:a,ref:h,props:o,_owner:_}};react_production_min.createContext=function(e){return e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:t,_context:e},e.Consumer=e};react_production_min.createElement=M$1;react_production_min.createFactory=function(e){var i=M$1.bind(null,e);return i.type=e,i};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(e){return{$$typeof:v$1,render:e}};react_production_min.isValidElement=O$1;react_production_min.lazy=function(e){return{$$typeof:y,_payload:{_status:-1,_result:e},_init:T$1}};react_production_min.memo=function(e,i){return{$$typeof:x,type:e,compare:i===void 0?null:i}};react_production_min.startTransition=function(e){var i=V$1.transition;V$1.transition={};try{e()}finally{V$1.transition=i}};react_production_min.unstable_act=X$1;react_production_min.useCallback=function(e,i){return U$1.current.useCallback(e,i)};react_production_min.useContext=function(e){return U$1.current.useContext(e)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(e){return U$1.current.useDeferredValue(e)};react_production_min.useEffect=function(e,i){return U$1.current.useEffect(e,i)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function(e,i,s){return U$1.current.useImperativeHandle(e,i,s)};react_production_min.useInsertionEffect=function(e,i){return U$1.current.useInsertionEffect(e,i)};react_production_min.useLayoutEffect=function(e,i){return U$1.current.useLayoutEffect(e,i)};react_production_min.useMemo=function(e,i){return U$1.current.useMemo(e,i)};react_production_min.useReducer=function(e,i,s){return U$1.current.useReducer(e,i,s)};react_production_min.useRef=function(e){return U$1.current.useRef(e)};react_production_min.useState=function(e){return U$1.current.useState(e)};react_production_min.useSyncExternalStore=function(e,i,s){return U$1.current.useSyncExternalStore(e,i,s)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs(reactExports);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f=reactExports,k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m$1=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$1={key:!0,ref:!0,__self:!0,__source:!0};function q(e,i,s){var o,a={},h=null,_=null;s!==void 0&&(h=""+s),i.key!==void 0&&(h=""+i.key),i.ref!==void 0&&(_=i.ref);for(o in i)m$1.call(i,o)&&!p$1.hasOwnProperty(o)&&(a[o]=i[o]);if(e&&e.defaultProps)for(o in i=e.defaultProps,i)a[o]===void 0&&(a[o]=i[o]);return{$$typeof:k,type:e,key:h,ref:_,props:a,_owner:n.current}}reactJsxRuntime_production_min.Fragment=l;reactJsxRuntime_production_min.jsx=q;reactJsxRuntime_production_min.jsxs=q;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function i(Et,At){var St=Et.length;Et.push(At);e:for(;0<St;){var bt=St-1>>>1,Ct=Et[bt];if(0<a(Ct,At))Et[bt]=At,Et[St]=Ct,St=bt;else break e}}function s(Et){return Et.length===0?null:Et[0]}function o(Et){if(Et.length===0)return null;var At=Et[0],St=Et.pop();if(St!==At){Et[0]=St;e:for(var bt=0,Ct=Et.length,Nt=Ct>>>1;bt<Nt;){var kt=2*(bt+1)-1,Ht=Et[kt],jt=kt+1,Zt=Et[jt];if(0>a(Ht,St))jt<Ct&&0>a(Zt,Ht)?(Et[bt]=Zt,Et[jt]=St,bt=jt):(Et[bt]=Ht,Et[kt]=St,bt=kt);else if(jt<Ct&&0>a(Zt,St))Et[bt]=Zt,Et[jt]=St,bt=jt;else break e}}return At}function a(Et,At){var St=Et.sortIndex-At.sortIndex;return St!==0?St:Et.id-At.id}if(typeof performance=="object"&&typeof performance.now=="function"){var h=performance;e.unstable_now=function(){return h.now()}}else{var _=Date,g=_.now();e.unstable_now=function(){return _.now()-g}}var _e=[],st=[],tt=1,at=null,ot=3,lt=!1,ct=!1,$=!1,c=typeof setTimeout=="function"?setTimeout:null,d=typeof clearTimeout=="function"?clearTimeout:null,j=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function et(Et){for(var At=s(st);At!==null;){if(At.callback===null)o(st);else if(At.startTime<=Et)o(st),At.sortIndex=At.expirationTime,i(_e,At);else break;At=s(st)}}function nt(Et){if($=!1,et(Et),!ct)if(s(_e)!==null)ct=!0,Mt(ut);else{var At=s(st);At!==null&&wt(nt,At.startTime-Et)}}function ut(Et,At){ct=!1,$&&($=!1,d(rt),rt=-1),lt=!0;var St=ot;try{for(et(At),at=s(_e);at!==null&&(!(at.expirationTime>At)||Et&&!mt());){var bt=at.callback;if(typeof bt=="function"){at.callback=null,ot=at.priorityLevel;var Ct=bt(at.expirationTime<=At);At=e.unstable_now(),typeof Ct=="function"?at.callback=Ct:at===s(_e)&&o(_e),et(At)}else o(_e);at=s(_e)}if(at!==null)var Nt=!0;else{var kt=s(st);kt!==null&&wt(nt,kt.startTime-At),Nt=!1}return Nt}finally{at=null,ot=St,lt=!1}}var b=!1,it=null,rt=-1,dt=5,ft=-1;function mt(){return!(e.unstable_now()-ft<dt)}function yt(){if(it!==null){var Et=e.unstable_now();ft=Et;var At=!0;try{At=it(!0,Et)}finally{At?gt():(b=!1,it=null)}}else b=!1}var gt;if(typeof j=="function")gt=function(){j(yt)};else if(typeof MessageChannel<"u"){var _t=new MessageChannel,xt=_t.port2;_t.port1.onmessage=yt,gt=function(){xt.postMessage(null)}}else gt=function(){c(yt,0)};function Mt(Et){it=Et,b||(b=!0,gt())}function wt(Et,At){rt=c(function(){Et(e.unstable_now())},At)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Et){Et.callback=null},e.unstable_continueExecution=function(){ct||lt||(ct=!0,Mt(ut))},e.unstable_forceFrameRate=function(Et){0>Et||125<Et?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):dt=0<Et?Math.floor(1e3/Et):5},e.unstable_getCurrentPriorityLevel=function(){return ot},e.unstable_getFirstCallbackNode=function(){return s(_e)},e.unstable_next=function(Et){switch(ot){case 1:case 2:case 3:var At=3;break;default:At=ot}var St=ot;ot=At;try{return Et()}finally{ot=St}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Et,At){switch(Et){case 1:case 2:case 3:case 4:case 5:break;default:Et=3}var St=ot;ot=Et;try{return At()}finally{ot=St}},e.unstable_scheduleCallback=function(Et,At,St){var bt=e.unstable_now();switch(typeof St=="object"&&St!==null?(St=St.delay,St=typeof St=="number"&&0<St?bt+St:bt):St=bt,Et){case 1:var Ct=-1;break;case 2:Ct=250;break;case 5:Ct=1073741823;break;case 4:Ct=1e4;break;default:Ct=5e3}return Ct=St+Ct,Et={id:tt++,callback:At,priorityLevel:Et,startTime:St,expirationTime:Ct,sortIndex:-1},St>bt?(Et.sortIndex=St,i(st,Et),s(_e)===null&&Et===s(st)&&($?(d(rt),rt=-1):$=!0,wt(nt,St-bt))):(Et.sortIndex=Ct,i(_e,Et),ct||lt||(ct=!0,Mt(ut))),Et},e.unstable_shouldYield=mt,e.unstable_wrapCallback=function(Et){var At=ot;return function(){var St=ot;ot=At;try{return Et.apply(this,arguments)}finally{ot=St}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p(e){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)i+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(e,i){ha(e,i),ha(e+"Capture",i)}function ha(e,i){for(ea[e]=i,e=0;e<i.length;e++)da.add(i[e])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(e){return ja.call(ma,e)?!0:ja.call(la,e)?!1:ka.test(e)?ma[e]=!0:(la[e]=!0,!1)}function pa(e,i,s,o){if(s!==null&&s.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return o?!1:s!==null?!s.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function qa(e,i,s,o){if(i===null||typeof i>"u"||pa(e,i,s,o))return!0;if(o)return!1;if(s!==null)switch(s.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function v(e,i,s,o,a,h,_){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=o,this.attributeNamespace=a,this.mustUseProperty=s,this.propertyName=e,this.type=i,this.sanitizeURL=h,this.removeEmptyString=_}var z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){z[e]=new v(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var i=e[0];z[i]=new v(i,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){z[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){z[e]=new v(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){z[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){z[e]=new v(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){z[e]=new v(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){z[e]=new v(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){z[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var i=e.replace(ra,sa);z[i]=new v(i,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var i=e.replace(ra,sa);z[i]=new v(i,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var i=e.replace(ra,sa);z[i]=new v(i,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){z[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)});z.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){z[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)});function ta(e,i,s,o){var a=z.hasOwnProperty(i)?z[i]:null;(a!==null?a.type!==0:o||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(qa(i,s,a,o)&&(s=null),o||a===null?oa(i)&&(s===null?e.removeAttribute(i):e.setAttribute(i,""+s)):a.mustUseProperty?e[a.propertyName]=s===null?a.type===3?!1:"":s:(i=a.attributeName,o=a.attributeNamespace,s===null?e.removeAttribute(i):(a=a.type,s=a===3||a===4&&s===!0?"":""+s,o?e.setAttributeNS(o,i,s):e.setAttribute(i,s))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(e){return e===null||typeof e!="object"?null:(e=Ja&&e[Ja]||e["@@iterator"],typeof e=="function"?e:null)}var A=Object.assign,La;function Ma(e){if(La===void 0)try{throw Error()}catch(s){var i=s.stack.trim().match(/\n( *(at )?)/);La=i&&i[1]||""}return`
`+La+e}var Na=!1;function Oa(e,i){if(!e||Na)return"";Na=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(st){var o=st}Reflect.construct(e,[],i)}else{try{i.call()}catch(st){o=st}e.call(i.prototype)}else{try{throw Error()}catch(st){o=st}e()}}catch(st){if(st&&o&&typeof st.stack=="string"){for(var a=st.stack.split(`
`),h=o.stack.split(`
`),_=a.length-1,g=h.length-1;1<=_&&0<=g&&a[_]!==h[g];)g--;for(;1<=_&&0<=g;_--,g--)if(a[_]!==h[g]){if(_!==1||g!==1)do if(_--,g--,0>g||a[_]!==h[g]){var _e=`
`+a[_].replace(" at new "," at ");return e.displayName&&_e.includes("<anonymous>")&&(_e=_e.replace("<anonymous>",e.displayName)),_e}while(1<=_&&0<=g);break}}}finally{Na=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?Ma(e):""}function Pa(e){switch(e.tag){case 5:return Ma(e.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return e=Oa(e.type,!1),e;case 11:return e=Oa(e.type.render,!1),e;case 1:return e=Oa(e.type,!0),e;default:return""}}function Qa(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ca:return(e.displayName||"Context")+".Consumer";case Ba:return(e._context.displayName||"Context")+".Provider";case Da:var i=e.render;return e=e.displayName,e||(e=i.displayName||i.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ga:return i=e.displayName||null,i!==null?i:Qa(e.type)||"Memo";case Ha:i=e._payload,e=e._init;try{return Qa(e(i))}catch{}}return null}function Ra(e){var i=e.type;switch(e.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=i.render,e=e.displayName||e.name||"",i.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(i);case 8:return i===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Sa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ta(e){var i=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function Ua(e){var i=Ta(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,i),o=""+e[i];if(!e.hasOwnProperty(i)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var a=s.get,h=s.set;return Object.defineProperty(e,i,{configurable:!0,get:function(){return a.call(this)},set:function(_){o=""+_,h.call(this,_)}}),Object.defineProperty(e,i,{enumerable:s.enumerable}),{getValue:function(){return o},setValue:function(_){o=""+_},stopTracking:function(){e._valueTracker=null,delete e[i]}}}}function Va(e){e._valueTracker||(e._valueTracker=Ua(e))}function Wa(e){if(!e)return!1;var i=e._valueTracker;if(!i)return!0;var s=i.getValue(),o="";return e&&(o=Ta(e)?e.checked?"true":"false":e.value),e=o,e!==s?(i.setValue(e),!0):!1}function Xa(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ya(e,i){var s=i.checked;return A({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??e._wrapperState.initialChecked})}function Za(e,i){var s=i.defaultValue==null?"":i.defaultValue,o=i.checked!=null?i.checked:i.defaultChecked;s=Sa(i.value!=null?i.value:s),e._wrapperState={initialChecked:o,initialValue:s,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function ab(e,i){i=i.checked,i!=null&&ta(e,"checked",i,!1)}function bb(e,i){ab(e,i);var s=Sa(i.value),o=i.type;if(s!=null)o==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if(o==="submit"||o==="reset"){e.removeAttribute("value");return}i.hasOwnProperty("value")?cb(e,i.type,s):i.hasOwnProperty("defaultValue")&&cb(e,i.type,Sa(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(e.defaultChecked=!!i.defaultChecked)}function db(e,i,s){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var o=i.type;if(!(o!=="submit"&&o!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+e._wrapperState.initialValue,s||i===e.value||(e.value=i),e.defaultValue=i}s=e.name,s!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,s!==""&&(e.name=s)}function cb(e,i,s){(i!=="number"||Xa(e.ownerDocument)!==e)&&(s==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var eb=Array.isArray;function fb(e,i,s,o){if(e=e.options,i){i={};for(var a=0;a<s.length;a++)i["$"+s[a]]=!0;for(s=0;s<e.length;s++)a=i.hasOwnProperty("$"+e[s].value),e[s].selected!==a&&(e[s].selected=a),a&&o&&(e[s].defaultSelected=!0)}else{for(s=""+Sa(s),i=null,a=0;a<e.length;a++){if(e[a].value===s){e[a].selected=!0,o&&(e[a].defaultSelected=!0);return}i!==null||e[a].disabled||(i=e[a])}i!==null&&(i.selected=!0)}}function gb(e,i){if(i.dangerouslySetInnerHTML!=null)throw Error(p(91));return A({},i,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function hb(e,i){var s=i.value;if(s==null){if(s=i.children,i=i.defaultValue,s!=null){if(i!=null)throw Error(p(92));if(eb(s)){if(1<s.length)throw Error(p(93));s=s[0]}i=s}i==null&&(i=""),s=i}e._wrapperState={initialValue:Sa(s)}}function ib(e,i){var s=Sa(i.value),o=Sa(i.defaultValue);s!=null&&(s=""+s,s!==e.value&&(e.value=s),i.defaultValue==null&&e.defaultValue!==s&&(e.defaultValue=s)),o!=null&&(e.defaultValue=""+o)}function jb(e){var i=e.textContent;i===e._wrapperState.initialValue&&i!==""&&i!==null&&(e.value=i)}function kb(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(e,i){return e==null||e==="http://www.w3.org/1999/xhtml"?kb(i):e==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var mb,nb=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,s,o,a){MSApp.execUnsafeLocalFunction(function(){return e(i,s,o,a)})}:e}(function(e,i){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=i;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=mb.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;i.firstChild;)e.appendChild(i.firstChild)}});function ob(e,i){if(i){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=i;return}}e.textContent=i}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(e){qb.forEach(function(i){i=i+e.charAt(0).toUpperCase()+e.substring(1),pb[i]=pb[e]})});function rb(e,i,s){return i==null||typeof i=="boolean"||i===""?"":s||typeof i!="number"||i===0||pb.hasOwnProperty(e)&&pb[e]?(""+i).trim():i+"px"}function sb(e,i){e=e.style;for(var s in i)if(i.hasOwnProperty(s)){var o=s.indexOf("--")===0,a=rb(s,i[s],o);s==="float"&&(s="cssFloat"),o?e.setProperty(s,a):e[s]=a}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(e,i){if(i){if(tb[e]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(p(137,e));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(p(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(p(61))}if(i.style!=null&&typeof i.style!="object")throw Error(p(62))}}function vb(e,i){if(e.indexOf("-")===-1)return typeof i.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var yb=null,zb=null,Ab=null;function Bb(e){if(e=Cb(e)){if(typeof yb!="function")throw Error(p(280));var i=e.stateNode;i&&(i=Db(i),yb(e.stateNode,e.type,i))}}function Eb(e){zb?Ab?Ab.push(e):Ab=[e]:zb=e}function Fb(){if(zb){var e=zb,i=Ab;if(Ab=zb=null,Bb(e),i)for(e=0;e<i.length;e++)Bb(i[e])}}function Gb(e,i){return e(i)}function Hb(){}var Ib=!1;function Jb(e,i,s){if(Ib)return e(i,s);Ib=!0;try{return Gb(e,i,s)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(e,i){var s=e.stateNode;if(s===null)return null;var o=Db(s);if(o===null)return null;s=o[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(e=e.type,o=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!o;break e;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(p(231,i,typeof s));return s}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(e,i,s,o,a,h,_,g,_e){var st=Array.prototype.slice.call(arguments,3);try{i.apply(s,st)}catch(tt){this.onError(tt)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(e){Ob=!0,Pb=e}};function Tb(e,i,s,o,a,h,_,g,_e){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(e,i,s,o,a,h,_,g,_e){if(Tb.apply(this,arguments),Ob){if(Ob){var st=Pb;Ob=!1,Pb=null}else throw Error(p(198));Qb||(Qb=!0,Rb=st)}}function Vb(e){var i=e,s=e;if(e.alternate)for(;i.return;)i=i.return;else{e=i;do i=e,i.flags&4098&&(s=i.return),e=i.return;while(e)}return i.tag===3?s:null}function Wb(e){if(e.tag===13){var i=e.memoizedState;if(i===null&&(e=e.alternate,e!==null&&(i=e.memoizedState)),i!==null)return i.dehydrated}return null}function Xb(e){if(Vb(e)!==e)throw Error(p(188))}function Yb(e){var i=e.alternate;if(!i){if(i=Vb(e),i===null)throw Error(p(188));return i!==e?null:e}for(var s=e,o=i;;){var a=s.return;if(a===null)break;var h=a.alternate;if(h===null){if(o=a.return,o!==null){s=o;continue}break}if(a.child===h.child){for(h=a.child;h;){if(h===s)return Xb(a),e;if(h===o)return Xb(a),i;h=h.sibling}throw Error(p(188))}if(s.return!==o.return)s=a,o=h;else{for(var _=!1,g=a.child;g;){if(g===s){_=!0,s=a,o=h;break}if(g===o){_=!0,o=a,s=h;break}g=g.sibling}if(!_){for(g=h.child;g;){if(g===s){_=!0,s=h,o=a;break}if(g===o){_=!0,o=h,s=a;break}g=g.sibling}if(!_)throw Error(p(189))}}if(s.alternate!==o)throw Error(p(190))}if(s.tag!==3)throw Error(p(188));return s.stateNode.current===s?e:i}function Zb(e){return e=Yb(e),e!==null?$b(e):null}function $b(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var i=$b(e);if(i!==null)return i;e=e.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(e){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,e,void 0,(e.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(e){return e>>>=0,e===0?32:31-(pc(e)/qc|0)|0}var rc=64,sc=4194304;function tc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function uc(e,i){var s=e.pendingLanes;if(s===0)return 0;var o=0,a=e.suspendedLanes,h=e.pingedLanes,_=s&268435455;if(_!==0){var g=_&~a;g!==0?o=tc(g):(h&=_,h!==0&&(o=tc(h)))}else _=s&~a,_!==0?o=tc(_):h!==0&&(o=tc(h));if(o===0)return 0;if(i!==0&&i!==o&&!(i&a)&&(a=o&-o,h=i&-i,a>=h||a===16&&(h&4194240)!==0))return i;if(o&4&&(o|=s&16),i=e.entangledLanes,i!==0)for(e=e.entanglements,i&=o;0<i;)s=31-oc(i),a=1<<s,o|=e[s],i&=~a;return o}function vc(e,i){switch(e){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(e,i){for(var s=e.suspendedLanes,o=e.pingedLanes,a=e.expirationTimes,h=e.pendingLanes;0<h;){var _=31-oc(h),g=1<<_,_e=a[_];_e===-1?(!(g&s)||g&o)&&(a[_]=vc(g,i)):_e<=i&&(e.expiredLanes|=g),h&=~g}}function xc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function yc(){var e=rc;return rc<<=1,!(rc&4194240)&&(rc=64),e}function zc(e){for(var i=[],s=0;31>s;s++)i.push(e);return i}function Ac(e,i,s){e.pendingLanes|=i,i!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,i=31-oc(i),e[i]=s}function Bc(e,i){var s=e.pendingLanes&~i;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=i,e.mutableReadLanes&=i,e.entangledLanes&=i,i=e.entanglements;var o=e.eventTimes;for(e=e.expirationTimes;0<s;){var a=31-oc(s),h=1<<a;i[a]=0,o[a]=-1,e[a]=-1,s&=~h}}function Cc(e,i){var s=e.entangledLanes|=i;for(e=e.entanglements;s;){var o=31-oc(s),a=1<<o;a&i|e[o]&i&&(e[o]|=i),s&=~a}}var C=0;function Dc(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(e,i){switch(e){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(i.pointerId)}}function Tc(e,i,s,o,a,h){return e===null||e.nativeEvent!==h?(e={blockedOn:i,domEventName:s,eventSystemFlags:o,nativeEvent:h,targetContainers:[a]},i!==null&&(i=Cb(i),i!==null&&Fc(i)),e):(e.eventSystemFlags|=o,i=e.targetContainers,a!==null&&i.indexOf(a)===-1&&i.push(a),e)}function Uc(e,i,s,o,a){switch(i){case"focusin":return Lc=Tc(Lc,e,i,s,o,a),!0;case"dragenter":return Mc=Tc(Mc,e,i,s,o,a),!0;case"mouseover":return Nc=Tc(Nc,e,i,s,o,a),!0;case"pointerover":var h=a.pointerId;return Oc.set(h,Tc(Oc.get(h)||null,e,i,s,o,a)),!0;case"gotpointercapture":return h=a.pointerId,Pc.set(h,Tc(Pc.get(h)||null,e,i,s,o,a)),!0}return!1}function Vc(e){var i=Wc(e.target);if(i!==null){var s=Vb(i);if(s!==null){if(i=s.tag,i===13){if(i=Wb(s),i!==null){e.blockedOn=i,Ic(e.priority,function(){Gc(s)});return}}else if(i===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Xc(e){if(e.blockedOn!==null)return!1;for(var i=e.targetContainers;0<i.length;){var s=Yc(e.domEventName,e.eventSystemFlags,i[0],e.nativeEvent);if(s===null){s=e.nativeEvent;var o=new s.constructor(s.type,s);wb=o,s.target.dispatchEvent(o),wb=null}else return i=Cb(s),i!==null&&Fc(i),e.blockedOn=s,!1;i.shift()}return!0}function Zc(e,i,s){Xc(e)&&s.delete(i)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(e,i){e.blockedOn===i&&(e.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(e){function i(a){return ad(a,e)}if(0<Kc.length){ad(Kc[0],e);for(var s=1;s<Kc.length;s++){var o=Kc[s];o.blockedOn===e&&(o.blockedOn=null)}}for(Lc!==null&&ad(Lc,e),Mc!==null&&ad(Mc,e),Nc!==null&&ad(Nc,e),Oc.forEach(i),Pc.forEach(i),s=0;s<Qc.length;s++)o=Qc[s],o.blockedOn===e&&(o.blockedOn=null);for(;0<Qc.length&&(s=Qc[0],s.blockedOn===null);)Vc(s),s.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(e,i,s,o){var a=C,h=cd.transition;cd.transition=null;try{C=1,fd(e,i,s,o)}finally{C=a,cd.transition=h}}function gd(e,i,s,o){var a=C,h=cd.transition;cd.transition=null;try{C=4,fd(e,i,s,o)}finally{C=a,cd.transition=h}}function fd(e,i,s,o){if(dd){var a=Yc(e,i,s,o);if(a===null)hd(e,i,o,id$2,s),Sc(e,o);else if(Uc(a,e,i,s,o))o.stopPropagation();else if(Sc(e,o),i&4&&-1<Rc.indexOf(e)){for(;a!==null;){var h=Cb(a);if(h!==null&&Ec(h),h=Yc(e,i,s,o),h===null&&hd(e,i,o,id$2,s),h===a)break;a=h}a!==null&&o.stopPropagation()}else hd(e,i,o,null,s)}}var id$2=null;function Yc(e,i,s,o){if(id$2=null,e=xb(o),e=Wc(e),e!==null)if(i=Vb(e),i===null)e=null;else if(s=i.tag,s===13){if(e=Wb(i),e!==null)return e;e=null}else if(s===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;e=null}else i!==e&&(e=null);return id$2=e,null}function jd(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var e,i=ld,s=i.length,o,a="value"in kd?kd.value:kd.textContent,h=a.length;for(e=0;e<s&&i[e]===a[e];e++);var _=s-e;for(o=1;o<=_&&i[s-o]===a[h-o];o++);return md=a.slice(e,1<o?1-o:void 0)}function od(e){var i=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&i===13&&(e=13)):e=i,e===10&&(e=13),32<=e||e===13?e:0}function pd(){return!0}function qd(){return!1}function rd(e){function i(s,o,a,h,_){this._reactName=s,this._targetInst=a,this.type=o,this.nativeEvent=h,this.target=_,this.currentTarget=null;for(var g in e)e.hasOwnProperty(g)&&(s=e[g],this[g]=s?s(h):h[g]);return this.isDefaultPrevented=(h.defaultPrevented!=null?h.defaultPrevented:h.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),i}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==yd&&(yd&&e.type==="mousemove"?(wd=e.screenX-yd.screenX,xd=e.screenY-yd.screenY):xd=wd=0,yd=e),wd)},movementY:function(e){return"movementY"in e?e.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(e){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(e):(e=Od[e])?!!i[e]:!1}function zd(){return Pd}var Qd=A({},ud,{key:function(e){if(e.key){var i=Md[e.key]||e.key;if(i!=="Unidentified")return i}return e.type==="keypress"?(e=od(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Nd[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(e){return e.type==="keypress"?od(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?od(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=" ",fe=!1;function ge(e,i){switch(e){case"keyup":return $d.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ie=!1;function je(e,i){switch(e){case"compositionend":return he(i);case"keypress":return i.which!==32?null:(fe=!0,ee);case"textInput":return e=i.data,e===ee&&fe?null:e;default:return null}}function ke(e,i){if(ie)return e==="compositionend"||!ae&&ge(e,i)?(e=nd(),md=ld=kd=null,ie=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return de&&i.locale!=="ko"?null:i.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(e){var i=e&&e.nodeName&&e.nodeName.toLowerCase();return i==="input"?!!le[e.type]:i==="textarea"}function ne(e,i,s,o){Eb(o),i=oe(i,"onChange"),0<i.length&&(s=new td("onChange","change",null,s,o),e.push({event:s,listeners:i}))}var pe=null,qe=null;function re(e){se(e,0)}function te(e){var i=ue(e);if(Wa(i))return e}function ve(e,i){if(e==="change")return i}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(e){if(e.propertyName==="value"&&te(qe)){var i=[];ne(i,qe,e,xb(e)),Jb(re,i)}}function Ce(e,i,s){e==="focusin"?(Ae(),pe=i,qe=s,pe.attachEvent("onpropertychange",Be)):e==="focusout"&&Ae()}function De(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return te(qe)}function Ee(e,i){if(e==="click")return te(i)}function Fe(e,i){if(e==="input"||e==="change")return te(i)}function Ge(e,i){return e===i&&(e!==0||1/e===1/i)||e!==e&&i!==i}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(e,i){if(He(e,i))return!0;if(typeof e!="object"||e===null||typeof i!="object"||i===null)return!1;var s=Object.keys(e),o=Object.keys(i);if(s.length!==o.length)return!1;for(o=0;o<s.length;o++){var a=s[o];if(!ja.call(i,a)||!He(e[a],i[a]))return!1}return!0}function Je(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ke(e,i){var s=Je(e);e=0;for(var o;s;){if(s.nodeType===3){if(o=e+s.textContent.length,e<=i&&o>=i)return{node:s,offset:i-e};e=o}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=Je(s)}}function Le(e,i){return e&&i?e===i?!0:e&&e.nodeType===3?!1:i&&i.nodeType===3?Le(e,i.parentNode):"contains"in e?e.contains(i):e.compareDocumentPosition?!!(e.compareDocumentPosition(i)&16):!1:!1}function Me(){for(var e=window,i=Xa();i instanceof e.HTMLIFrameElement;){try{var s=typeof i.contentWindow.location.href=="string"}catch{s=!1}if(s)e=i.contentWindow;else break;i=Xa(e.document)}return i}function Ne(e){var i=e&&e.nodeName&&e.nodeName.toLowerCase();return i&&(i==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||i==="textarea"||e.contentEditable==="true")}function Oe(e){var i=Me(),s=e.focusedElem,o=e.selectionRange;if(i!==s&&s&&s.ownerDocument&&Le(s.ownerDocument.documentElement,s)){if(o!==null&&Ne(s)){if(i=o.start,e=o.end,e===void 0&&(e=i),"selectionStart"in s)s.selectionStart=i,s.selectionEnd=Math.min(e,s.value.length);else if(e=(i=s.ownerDocument||document)&&i.defaultView||window,e.getSelection){e=e.getSelection();var a=s.textContent.length,h=Math.min(o.start,a);o=o.end===void 0?h:Math.min(o.end,a),!e.extend&&h>o&&(a=o,o=h,h=a),a=Ke(s,h);var _=Ke(s,o);a&&_&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==_.node||e.focusOffset!==_.offset)&&(i=i.createRange(),i.setStart(a.node,a.offset),e.removeAllRanges(),h>o?(e.addRange(i),e.extend(_.node,_.offset)):(i.setEnd(_.node,_.offset),e.addRange(i)))}}for(i=[],e=s;e=e.parentNode;)e.nodeType===1&&i.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<i.length;s++)e=i[s],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(e,i,s){var o=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Te||Qe==null||Qe!==Xa(o)||(o=Qe,"selectionStart"in o&&Ne(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Se&&Ie(Se,o)||(Se=o,o=oe(Re,"onSelect"),0<o.length&&(i=new td("onSelect","select",null,i,s),e.push({event:i,listeners:o}),i.target=Qe)))}function Ve(e,i){var s={};return s[e.toLowerCase()]=i.toLowerCase(),s["Webkit"+e]="webkit"+i,s["Moz"+e]="moz"+i,s}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(e){if(Xe[e])return Xe[e];if(!We[e])return e;var i=We[e],s;for(s in i)if(i.hasOwnProperty(s)&&s in Ye)return Xe[e]=i[s];return e}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(e,i){df.set(e,i),fa(i,[e])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(e,i,s){var o=e.type||"unknown-event";e.currentTarget=s,Ub(o,i,void 0,e),e.currentTarget=null}function se(e,i){i=(i&4)!==0;for(var s=0;s<e.length;s++){var o=e[s],a=o.event;o=o.listeners;e:{var h=void 0;if(i)for(var _=o.length-1;0<=_;_--){var g=o[_],_e=g.instance,st=g.currentTarget;if(g=g.listener,_e!==h&&a.isPropagationStopped())break e;nf(a,g,st),h=_e}else for(_=0;_<o.length;_++){if(g=o[_],_e=g.instance,st=g.currentTarget,g=g.listener,_e!==h&&a.isPropagationStopped())break e;nf(a,g,st),h=_e}}}if(Qb)throw e=Rb,Qb=!1,Rb=null,e}function D(e,i){var s=i[of];s===void 0&&(s=i[of]=new Set);var o=e+"__bubble";s.has(o)||(pf(i,e,2,!1),s.add(o))}function qf(e,i,s){var o=0;i&&(o|=4),pf(s,e,o,i)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(e){if(!e[rf]){e[rf]=!0,da.forEach(function(s){s!=="selectionchange"&&(mf.has(s)||qf(s,!1,e),qf(s,!0,e))});var i=e.nodeType===9?e:e.ownerDocument;i===null||i[rf]||(i[rf]=!0,qf("selectionchange",!1,i))}}function pf(e,i,s,o){switch(jd(i)){case 1:var a=ed;break;case 4:a=gd;break;default:a=fd}s=a.bind(null,i,s,e),a=void 0,!Lb||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(a=!0),o?a!==void 0?e.addEventListener(i,s,{capture:!0,passive:a}):e.addEventListener(i,s,!0):a!==void 0?e.addEventListener(i,s,{passive:a}):e.addEventListener(i,s,!1)}function hd(e,i,s,o,a){var h=o;if(!(i&1)&&!(i&2)&&o!==null)e:for(;;){if(o===null)return;var _=o.tag;if(_===3||_===4){var g=o.stateNode.containerInfo;if(g===a||g.nodeType===8&&g.parentNode===a)break;if(_===4)for(_=o.return;_!==null;){var _e=_.tag;if((_e===3||_e===4)&&(_e=_.stateNode.containerInfo,_e===a||_e.nodeType===8&&_e.parentNode===a))return;_=_.return}for(;g!==null;){if(_=Wc(g),_===null)return;if(_e=_.tag,_e===5||_e===6){o=h=_;continue e}g=g.parentNode}}o=o.return}Jb(function(){var st=h,tt=xb(s),at=[];e:{var ot=df.get(e);if(ot!==void 0){var lt=td,ct=e;switch(e){case"keypress":if(od(s)===0)break e;case"keydown":case"keyup":lt=Rd;break;case"focusin":ct="focus",lt=Fd;break;case"focusout":ct="blur",lt=Fd;break;case"beforeblur":case"afterblur":lt=Fd;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":lt=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":lt=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":lt=Vd;break;case $e:case af:case bf:lt=Hd;break;case cf:lt=Xd;break;case"scroll":lt=vd;break;case"wheel":lt=Zd;break;case"copy":case"cut":case"paste":lt=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":lt=Td}var $=(i&4)!==0,c=!$&&e==="scroll",d=$?ot!==null?ot+"Capture":null:ot;$=[];for(var j=st,et;j!==null;){et=j;var nt=et.stateNode;if(et.tag===5&&nt!==null&&(et=nt,d!==null&&(nt=Kb(j,d),nt!=null&&$.push(tf(j,nt,et)))),c)break;j=j.return}0<$.length&&(ot=new lt(ot,ct,null,s,tt),at.push({event:ot,listeners:$}))}}if(!(i&7)){e:{if(ot=e==="mouseover"||e==="pointerover",lt=e==="mouseout"||e==="pointerout",ot&&s!==wb&&(ct=s.relatedTarget||s.fromElement)&&(Wc(ct)||ct[uf]))break e;if((lt||ot)&&(ot=tt.window===tt?tt:(ot=tt.ownerDocument)?ot.defaultView||ot.parentWindow:window,lt?(ct=s.relatedTarget||s.toElement,lt=st,ct=ct?Wc(ct):null,ct!==null&&(c=Vb(ct),ct!==c||ct.tag!==5&&ct.tag!==6)&&(ct=null)):(lt=null,ct=st),lt!==ct)){if($=Bd,nt="onMouseLeave",d="onMouseEnter",j="mouse",(e==="pointerout"||e==="pointerover")&&($=Td,nt="onPointerLeave",d="onPointerEnter",j="pointer"),c=lt==null?ot:ue(lt),et=ct==null?ot:ue(ct),ot=new $(nt,j+"leave",lt,s,tt),ot.target=c,ot.relatedTarget=et,nt=null,Wc(tt)===st&&($=new $(d,j+"enter",ct,s,tt),$.target=et,$.relatedTarget=c,nt=$),c=nt,lt&&ct)t:{for($=lt,d=ct,j=0,et=$;et;et=vf(et))j++;for(et=0,nt=d;nt;nt=vf(nt))et++;for(;0<j-et;)$=vf($),j--;for(;0<et-j;)d=vf(d),et--;for(;j--;){if($===d||d!==null&&$===d.alternate)break t;$=vf($),d=vf(d)}$=null}else $=null;lt!==null&&wf(at,ot,lt,$,!1),ct!==null&&c!==null&&wf(at,c,ct,$,!0)}}e:{if(ot=st?ue(st):window,lt=ot.nodeName&&ot.nodeName.toLowerCase(),lt==="select"||lt==="input"&&ot.type==="file")var ut=ve;else if(me(ot))if(we)ut=Fe;else{ut=De;var b=Ce}else(lt=ot.nodeName)&&lt.toLowerCase()==="input"&&(ot.type==="checkbox"||ot.type==="radio")&&(ut=Ee);if(ut&&(ut=ut(e,st))){ne(at,ut,s,tt);break e}b&&b(e,ot,st),e==="focusout"&&(b=ot._wrapperState)&&b.controlled&&ot.type==="number"&&cb(ot,"number",ot.value)}switch(b=st?ue(st):window,e){case"focusin":(me(b)||b.contentEditable==="true")&&(Qe=b,Re=st,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(at,s,tt);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(at,s,tt)}var it;if(ae)e:{switch(e){case"compositionstart":var rt="onCompositionStart";break e;case"compositionend":rt="onCompositionEnd";break e;case"compositionupdate":rt="onCompositionUpdate";break e}rt=void 0}else ie?ge(e,s)&&(rt="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(rt="onCompositionStart");rt&&(de&&s.locale!=="ko"&&(ie||rt!=="onCompositionStart"?rt==="onCompositionEnd"&&ie&&(it=nd()):(kd=tt,ld="value"in kd?kd.value:kd.textContent,ie=!0)),b=oe(st,rt),0<b.length&&(rt=new Ld(rt,e,null,s,tt),at.push({event:rt,listeners:b}),it?rt.data=it:(it=he(s),it!==null&&(rt.data=it)))),(it=ce?je(e,s):ke(e,s))&&(st=oe(st,"onBeforeInput"),0<st.length&&(tt=new Ld("onBeforeInput","beforeinput",null,s,tt),at.push({event:tt,listeners:st}),tt.data=it))}se(at,i)})}function tf(e,i,s){return{instance:e,listener:i,currentTarget:s}}function oe(e,i){for(var s=i+"Capture",o=[];e!==null;){var a=e,h=a.stateNode;a.tag===5&&h!==null&&(a=h,h=Kb(e,s),h!=null&&o.unshift(tf(e,h,a)),h=Kb(e,i),h!=null&&o.push(tf(e,h,a))),e=e.return}return o}function vf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function wf(e,i,s,o,a){for(var h=i._reactName,_=[];s!==null&&s!==o;){var g=s,_e=g.alternate,st=g.stateNode;if(_e!==null&&_e===o)break;g.tag===5&&st!==null&&(g=st,a?(_e=Kb(s,h),_e!=null&&_.unshift(tf(s,_e,g))):a||(_e=Kb(s,h),_e!=null&&_.push(tf(s,_e,g)))),s=s.return}_.length!==0&&e.push({event:i,listeners:_})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(e){return(typeof e=="string"?e:""+e).replace(xf,`
`).replace(yf,"")}function Af(e,i,s){if(i=zf(i),zf(e)!==i&&s)throw Error(p(425))}function Bf(){}var Cf=null,Df=null;function Ef(e,i){return e==="textarea"||e==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(e){return Hf.resolve(null).then(e).catch(If)}:Ff;function If(e){setTimeout(function(){throw e})}function Kf(e,i){var s=i,o=0;do{var a=s.nextSibling;if(e.removeChild(s),a&&a.nodeType===8)if(s=a.data,s==="/$"){if(o===0){e.removeChild(a),bd(i);return}o--}else s!=="$"&&s!=="$?"&&s!=="$!"||o++;s=a}while(s);bd(i)}function Lf(e){for(;e!=null;e=e.nextSibling){var i=e.nodeType;if(i===1||i===3)break;if(i===8){if(i=e.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return e}function Mf(e){e=e.previousSibling;for(var i=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(i===0)return e;i--}else s==="/$"&&i++}e=e.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(e){var i=e[Of];if(i)return i;for(var s=e.parentNode;s;){if(i=s[uf]||s[Of]){if(s=i.alternate,i.child!==null||s!==null&&s.child!==null)for(e=Mf(e);e!==null;){if(s=e[Of])return s;e=Mf(e)}return i}e=s,s=e.parentNode}return null}function Cb(e){return e=e[Of]||e[uf],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ue(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(p(33))}function Db(e){return e[Pf]||null}var Sf=[],Tf=-1;function Uf(e){return{current:e}}function E(e){0>Tf||(e.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(e,i){Tf++,Sf[Tf]=e.current,e.current=i}var Vf={},H=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(e,i){var s=e.type.contextTypes;if(!s)return Vf;var o=e.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===i)return o.__reactInternalMemoizedMaskedChildContext;var a={},h;for(h in s)a[h]=i[h];return o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),a}function Zf(e){return e=e.childContextTypes,e!=null}function $f(){E(Wf),E(H)}function ag(e,i,s){if(H.current!==Vf)throw Error(p(168));G(H,i),G(Wf,s)}function bg(e,i,s){var o=e.stateNode;if(i=i.childContextTypes,typeof o.getChildContext!="function")return s;o=o.getChildContext();for(var a in o)if(!(a in i))throw Error(p(108,Ra(e)||"Unknown",a));return A({},s,o)}function cg(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Vf,Xf=H.current,G(H,e),G(Wf,Wf.current),!0}function dg(e,i,s){var o=e.stateNode;if(!o)throw Error(p(169));s?(e=bg(e,i,Xf),o.__reactInternalMemoizedMergedChildContext=e,E(Wf),E(H),G(H,e)):E(Wf),G(Wf,s)}var eg=null,fg=!1,gg=!1;function hg(e){eg===null?eg=[e]:eg.push(e)}function ig(e){fg=!0,hg(e)}function jg(){if(!gg&&eg!==null){gg=!0;var e=0,i=C;try{var s=eg;for(C=1;e<s.length;e++){var o=s[e];do o=o(!0);while(o!==null)}eg=null,fg=!1}catch(a){throw eg!==null&&(eg=eg.slice(e+1)),ac(fc,jg),a}finally{C=i,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(e,i){kg[lg++]=ng,kg[lg++]=mg,mg=e,ng=i}function ug(e,i,s){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=e;var o=rg;e=sg;var a=32-oc(o)-1;o&=~(1<<a),s+=1;var h=32-oc(i)+a;if(30<h){var _=a-a%5;h=(o&(1<<_)-1).toString(32),o>>=_,a-=_,rg=1<<32-oc(i)+a|s<<a|o,sg=h+e}else rg=1<<h|s<<a|o,sg=e}function vg(e){e.return!==null&&(tg(e,1),ug(e,1,0))}function wg(e){for(;e===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;e===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;function Ag(e,i){var s=Bg(5,null,null,0);s.elementType="DELETED",s.stateNode=i,s.return=e,i=e.deletions,i===null?(e.deletions=[s],e.flags|=16):i.push(s)}function Cg(e,i){switch(e.tag){case 5:var s=e.type;return i=i.nodeType!==1||s.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(e.stateNode=i,xg=e,yg=Lf(i.firstChild),!0):!1;case 6:return i=e.pendingProps===""||i.nodeType!==3?null:i,i!==null?(e.stateNode=i,xg=e,yg=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(s=qg!==null?{id:rg,overflow:sg}:null,e.memoizedState={dehydrated:i,treeContext:s,retryLane:1073741824},s=Bg(18,null,null,0),s.stateNode=i,s.return=e,e.child=s,xg=e,yg=null,!0):!1;default:return!1}}function Dg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Eg(e){if(I){var i=yg;if(i){var s=i;if(!Cg(e,i)){if(Dg(e))throw Error(p(418));i=Lf(s.nextSibling);var o=xg;i&&Cg(e,i)?Ag(o,s):(e.flags=e.flags&-4097|2,I=!1,xg=e)}}else{if(Dg(e))throw Error(p(418));e.flags=e.flags&-4097|2,I=!1,xg=e}}}function Fg(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;xg=e}function Gg(e){if(e!==xg)return!1;if(!I)return Fg(e),I=!0,!1;var i;if((i=e.tag!==3)&&!(i=e.tag!==5)&&(i=e.type,i=i!=="head"&&i!=="body"&&!Ef(e.type,e.memoizedProps)),i&&(i=yg)){if(Dg(e))throw Hg(),Error(p(418));for(;i;)Ag(e,i),i=Lf(i.nextSibling)}if(Fg(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(p(317));e:{for(e=e.nextSibling,i=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"){if(i===0){yg=Lf(e.nextSibling);break e}i--}else s!=="$"&&s!=="$!"&&s!=="$?"||i++}e=e.nextSibling}yg=null}}else yg=xg?Lf(e.stateNode.nextSibling):null;return!0}function Hg(){for(var e=yg;e;)e=Lf(e.nextSibling)}function Ig(){yg=xg=null,I=!1}function Jg(e){zg===null?zg=[e]:zg.push(e)}var Kg=ua.ReactCurrentBatchConfig;function Lg(e,i,s){if(e=s.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(p(309));var o=s.stateNode}if(!o)throw Error(p(147,e));var a=o,h=""+e;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===h?i.ref:(i=function(_){var g=a.refs;_===null?delete g[h]:g[h]=_},i._stringRef=h,i)}if(typeof e!="string")throw Error(p(284));if(!s._owner)throw Error(p(290,e))}return e}function Mg(e,i){throw e=Object.prototype.toString.call(i),Error(p(31,e==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":e))}function Ng(e){var i=e._init;return i(e._payload)}function Og(e){function i(d,j){if(e){var et=d.deletions;et===null?(d.deletions=[j],d.flags|=16):et.push(j)}}function s(d,j){if(!e)return null;for(;j!==null;)i(d,j),j=j.sibling;return null}function o(d,j){for(d=new Map;j!==null;)j.key!==null?d.set(j.key,j):d.set(j.index,j),j=j.sibling;return d}function a(d,j){return d=Pg(d,j),d.index=0,d.sibling=null,d}function h(d,j,et){return d.index=et,e?(et=d.alternate,et!==null?(et=et.index,et<j?(d.flags|=2,j):et):(d.flags|=2,j)):(d.flags|=1048576,j)}function _(d){return e&&d.alternate===null&&(d.flags|=2),d}function g(d,j,et,nt){return j===null||j.tag!==6?(j=Qg(et,d.mode,nt),j.return=d,j):(j=a(j,et),j.return=d,j)}function _e(d,j,et,nt){var ut=et.type;return ut===ya?tt(d,j,et.props.children,nt,et.key):j!==null&&(j.elementType===ut||typeof ut=="object"&&ut!==null&&ut.$$typeof===Ha&&Ng(ut)===j.type)?(nt=a(j,et.props),nt.ref=Lg(d,j,et),nt.return=d,nt):(nt=Rg(et.type,et.key,et.props,null,d.mode,nt),nt.ref=Lg(d,j,et),nt.return=d,nt)}function st(d,j,et,nt){return j===null||j.tag!==4||j.stateNode.containerInfo!==et.containerInfo||j.stateNode.implementation!==et.implementation?(j=Sg(et,d.mode,nt),j.return=d,j):(j=a(j,et.children||[]),j.return=d,j)}function tt(d,j,et,nt,ut){return j===null||j.tag!==7?(j=Tg(et,d.mode,nt,ut),j.return=d,j):(j=a(j,et),j.return=d,j)}function at(d,j,et){if(typeof j=="string"&&j!==""||typeof j=="number")return j=Qg(""+j,d.mode,et),j.return=d,j;if(typeof j=="object"&&j!==null){switch(j.$$typeof){case va:return et=Rg(j.type,j.key,j.props,null,d.mode,et),et.ref=Lg(d,null,j),et.return=d,et;case wa:return j=Sg(j,d.mode,et),j.return=d,j;case Ha:var nt=j._init;return at(d,nt(j._payload),et)}if(eb(j)||Ka(j))return j=Tg(j,d.mode,et,null),j.return=d,j;Mg(d,j)}return null}function ot(d,j,et,nt){var ut=j!==null?j.key:null;if(typeof et=="string"&&et!==""||typeof et=="number")return ut!==null?null:g(d,j,""+et,nt);if(typeof et=="object"&&et!==null){switch(et.$$typeof){case va:return et.key===ut?_e(d,j,et,nt):null;case wa:return et.key===ut?st(d,j,et,nt):null;case Ha:return ut=et._init,ot(d,j,ut(et._payload),nt)}if(eb(et)||Ka(et))return ut!==null?null:tt(d,j,et,nt,null);Mg(d,et)}return null}function lt(d,j,et,nt,ut){if(typeof nt=="string"&&nt!==""||typeof nt=="number")return d=d.get(et)||null,g(j,d,""+nt,ut);if(typeof nt=="object"&&nt!==null){switch(nt.$$typeof){case va:return d=d.get(nt.key===null?et:nt.key)||null,_e(j,d,nt,ut);case wa:return d=d.get(nt.key===null?et:nt.key)||null,st(j,d,nt,ut);case Ha:var b=nt._init;return lt(d,j,et,b(nt._payload),ut)}if(eb(nt)||Ka(nt))return d=d.get(et)||null,tt(j,d,nt,ut,null);Mg(j,nt)}return null}function ct(d,j,et,nt){for(var ut=null,b=null,it=j,rt=j=0,dt=null;it!==null&&rt<et.length;rt++){it.index>rt?(dt=it,it=null):dt=it.sibling;var ft=ot(d,it,et[rt],nt);if(ft===null){it===null&&(it=dt);break}e&&it&&ft.alternate===null&&i(d,it),j=h(ft,j,rt),b===null?ut=ft:b.sibling=ft,b=ft,it=dt}if(rt===et.length)return s(d,it),I&&tg(d,rt),ut;if(it===null){for(;rt<et.length;rt++)it=at(d,et[rt],nt),it!==null&&(j=h(it,j,rt),b===null?ut=it:b.sibling=it,b=it);return I&&tg(d,rt),ut}for(it=o(d,it);rt<et.length;rt++)dt=lt(it,d,rt,et[rt],nt),dt!==null&&(e&&dt.alternate!==null&&it.delete(dt.key===null?rt:dt.key),j=h(dt,j,rt),b===null?ut=dt:b.sibling=dt,b=dt);return e&&it.forEach(function(mt){return i(d,mt)}),I&&tg(d,rt),ut}function $(d,j,et,nt){var ut=Ka(et);if(typeof ut!="function")throw Error(p(150));if(et=ut.call(et),et==null)throw Error(p(151));for(var b=ut=null,it=j,rt=j=0,dt=null,ft=et.next();it!==null&&!ft.done;rt++,ft=et.next()){it.index>rt?(dt=it,it=null):dt=it.sibling;var mt=ot(d,it,ft.value,nt);if(mt===null){it===null&&(it=dt);break}e&&it&&mt.alternate===null&&i(d,it),j=h(mt,j,rt),b===null?ut=mt:b.sibling=mt,b=mt,it=dt}if(ft.done)return s(d,it),I&&tg(d,rt),ut;if(it===null){for(;!ft.done;rt++,ft=et.next())ft=at(d,ft.value,nt),ft!==null&&(j=h(ft,j,rt),b===null?ut=ft:b.sibling=ft,b=ft);return I&&tg(d,rt),ut}for(it=o(d,it);!ft.done;rt++,ft=et.next())ft=lt(it,d,rt,ft.value,nt),ft!==null&&(e&&ft.alternate!==null&&it.delete(ft.key===null?rt:ft.key),j=h(ft,j,rt),b===null?ut=ft:b.sibling=ft,b=ft);return e&&it.forEach(function(yt){return i(d,yt)}),I&&tg(d,rt),ut}function c(d,j,et,nt){if(typeof et=="object"&&et!==null&&et.type===ya&&et.key===null&&(et=et.props.children),typeof et=="object"&&et!==null){switch(et.$$typeof){case va:e:{for(var ut=et.key,b=j;b!==null;){if(b.key===ut){if(ut=et.type,ut===ya){if(b.tag===7){s(d,b.sibling),j=a(b,et.props.children),j.return=d,d=j;break e}}else if(b.elementType===ut||typeof ut=="object"&&ut!==null&&ut.$$typeof===Ha&&Ng(ut)===b.type){s(d,b.sibling),j=a(b,et.props),j.ref=Lg(d,b,et),j.return=d,d=j;break e}s(d,b);break}else i(d,b);b=b.sibling}et.type===ya?(j=Tg(et.props.children,d.mode,nt,et.key),j.return=d,d=j):(nt=Rg(et.type,et.key,et.props,null,d.mode,nt),nt.ref=Lg(d,j,et),nt.return=d,d=nt)}return _(d);case wa:e:{for(b=et.key;j!==null;){if(j.key===b)if(j.tag===4&&j.stateNode.containerInfo===et.containerInfo&&j.stateNode.implementation===et.implementation){s(d,j.sibling),j=a(j,et.children||[]),j.return=d,d=j;break e}else{s(d,j);break}else i(d,j);j=j.sibling}j=Sg(et,d.mode,nt),j.return=d,d=j}return _(d);case Ha:return b=et._init,c(d,j,b(et._payload),nt)}if(eb(et))return ct(d,j,et,nt);if(Ka(et))return $(d,j,et,nt);Mg(d,et)}return typeof et=="string"&&et!==""||typeof et=="number"?(et=""+et,j!==null&&j.tag===6?(s(d,j.sibling),j=a(j,et),j.return=d,d=j):(s(d,j),j=Qg(et,d.mode,nt),j.return=d,d=j),_(d)):s(d,j)}return c}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(e){var i=Wg.current;E(Wg),e._currentValue=i}function bh(e,i,s){for(;e!==null;){var o=e.alternate;if((e.childLanes&i)!==i?(e.childLanes|=i,o!==null&&(o.childLanes|=i)):o!==null&&(o.childLanes&i)!==i&&(o.childLanes|=i),e===s)break;e=e.return}}function ch(e,i){Xg=e,Zg=Yg=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&i&&(dh=!0),e.firstContext=null)}function eh(e){var i=e._currentValue;if(Zg!==e)if(e={context:e,memoizedValue:i,next:null},Yg===null){if(Xg===null)throw Error(p(308));Yg=e,Xg.dependencies={lanes:0,firstContext:e}}else Yg=Yg.next=e;return i}var fh=null;function gh(e){fh===null?fh=[e]:fh.push(e)}function hh(e,i,s,o){var a=i.interleaved;return a===null?(s.next=s,gh(i)):(s.next=a.next,a.next=s),i.interleaved=s,ih(e,o)}function ih(e,i){e.lanes|=i;var s=e.alternate;for(s!==null&&(s.lanes|=i),s=e,e=e.return;e!==null;)e.childLanes|=i,s=e.alternate,s!==null&&(s.childLanes|=i),s=e,e=e.return;return s.tag===3?s.stateNode:null}var jh=!1;function kh(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh(e,i){e=e.updateQueue,i.updateQueue===e&&(i.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function mh(e,i){return{eventTime:e,lane:i,tag:0,payload:null,callback:null,next:null}}function nh(e,i,s){var o=e.updateQueue;if(o===null)return null;if(o=o.shared,K&2){var a=o.pending;return a===null?i.next=i:(i.next=a.next,a.next=i),o.pending=i,ih(e,s)}return a=o.interleaved,a===null?(i.next=i,gh(o)):(i.next=a.next,a.next=i),o.interleaved=i,ih(e,s)}function oh(e,i,s){if(i=i.updateQueue,i!==null&&(i=i.shared,(s&4194240)!==0)){var o=i.lanes;o&=e.pendingLanes,s|=o,i.lanes=s,Cc(e,s)}}function ph(e,i){var s=e.updateQueue,o=e.alternate;if(o!==null&&(o=o.updateQueue,s===o)){var a=null,h=null;if(s=s.firstBaseUpdate,s!==null){do{var _={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};h===null?a=h=_:h=h.next=_,s=s.next}while(s!==null);h===null?a=h=i:h=h.next=i}else a=h=i;s={baseState:o.baseState,firstBaseUpdate:a,lastBaseUpdate:h,shared:o.shared,effects:o.effects},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=i:e.next=i,s.lastBaseUpdate=i}function qh(e,i,s,o){var a=e.updateQueue;jh=!1;var h=a.firstBaseUpdate,_=a.lastBaseUpdate,g=a.shared.pending;if(g!==null){a.shared.pending=null;var _e=g,st=_e.next;_e.next=null,_===null?h=st:_.next=st,_=_e;var tt=e.alternate;tt!==null&&(tt=tt.updateQueue,g=tt.lastBaseUpdate,g!==_&&(g===null?tt.firstBaseUpdate=st:g.next=st,tt.lastBaseUpdate=_e))}if(h!==null){var at=a.baseState;_=0,tt=st=_e=null,g=h;do{var ot=g.lane,lt=g.eventTime;if((o&ot)===ot){tt!==null&&(tt=tt.next={eventTime:lt,lane:0,tag:g.tag,payload:g.payload,callback:g.callback,next:null});e:{var ct=e,$=g;switch(ot=i,lt=s,$.tag){case 1:if(ct=$.payload,typeof ct=="function"){at=ct.call(lt,at,ot);break e}at=ct;break e;case 3:ct.flags=ct.flags&-65537|128;case 0:if(ct=$.payload,ot=typeof ct=="function"?ct.call(lt,at,ot):ct,ot==null)break e;at=A({},at,ot);break e;case 2:jh=!0}}g.callback!==null&&g.lane!==0&&(e.flags|=64,ot=a.effects,ot===null?a.effects=[g]:ot.push(g))}else lt={eventTime:lt,lane:ot,tag:g.tag,payload:g.payload,callback:g.callback,next:null},tt===null?(st=tt=lt,_e=at):tt=tt.next=lt,_|=ot;if(g=g.next,g===null){if(g=a.shared.pending,g===null)break;ot=g,g=ot.next,ot.next=null,a.lastBaseUpdate=ot,a.shared.pending=null}}while(!0);if(tt===null&&(_e=at),a.baseState=_e,a.firstBaseUpdate=st,a.lastBaseUpdate=tt,i=a.shared.interleaved,i!==null){a=i;do _|=a.lane,a=a.next;while(a!==i)}else h===null&&(a.shared.lanes=0);rh|=_,e.lanes=_,e.memoizedState=at}}function sh(e,i,s){if(e=i.effects,i.effects=null,e!==null)for(i=0;i<e.length;i++){var o=e[i],a=o.callback;if(a!==null){if(o.callback=null,o=s,typeof a!="function")throw Error(p(191,a));a.call(o)}}}var th={},uh=Uf(th),vh$1=Uf(th),wh=Uf(th);function xh(e){if(e===th)throw Error(p(174));return e}function yh(e,i){switch(G(wh,i),G(vh$1,e),G(uh,th),e=i.nodeType,e){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:lb(null,"");break;default:e=e===8?i.parentNode:i,i=e.namespaceURI||null,e=e.tagName,i=lb(i,e)}E(uh),G(uh,i)}function zh(){E(uh),E(vh$1),E(wh)}function Ah(e){xh(wh.current);var i=xh(uh.current),s=lb(i,e.type);i!==s&&(G(vh$1,e),G(uh,s))}function Bh(e){vh$1.current===e&&(E(uh),E(vh$1))}var L=Uf(0);function Ch(e){for(var i=e;i!==null;){if(i.tag===13){var s=i.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if(i.flags&128)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Dh=[];function Eh(){for(var e=0;e<Dh.length;e++)Dh[e]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M=null,N=null,O=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P(){throw Error(p(321))}function Mh(e,i){if(i===null)return!1;for(var s=0;s<i.length&&s<e.length;s++)if(!He(e[s],i[s]))return!1;return!0}function Nh(e,i,s,o,a,h){if(Hh=h,M=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Fh.current=e===null||e.memoizedState===null?Oh:Ph,e=s(o,a),Jh){h=0;do{if(Jh=!1,Kh=0,25<=h)throw Error(p(301));h+=1,O=N=null,i.updateQueue=null,Fh.current=Qh,e=s(o,a)}while(Jh)}if(Fh.current=Rh,i=N!==null&&N.next!==null,Hh=0,O=N=M=null,Ih=!1,i)throw Error(p(300));return e}function Sh(){var e=Kh!==0;return Kh=0,e}function Th(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O===null?M.memoizedState=O=e:O=O.next=e,O}function Uh(){if(N===null){var e=M.alternate;e=e!==null?e.memoizedState:null}else e=N.next;var i=O===null?M.memoizedState:O.next;if(i!==null)O=i,N=e;else{if(e===null)throw Error(p(310));N=e,e={memoizedState:N.memoizedState,baseState:N.baseState,baseQueue:N.baseQueue,queue:N.queue,next:null},O===null?M.memoizedState=O=e:O=O.next=e}return O}function Vh(e,i){return typeof i=="function"?i(e):i}function Wh(e){var i=Uh(),s=i.queue;if(s===null)throw Error(p(311));s.lastRenderedReducer=e;var o=N,a=o.baseQueue,h=s.pending;if(h!==null){if(a!==null){var _=a.next;a.next=h.next,h.next=_}o.baseQueue=a=h,s.pending=null}if(a!==null){h=a.next,o=o.baseState;var g=_=null,_e=null,st=h;do{var tt=st.lane;if((Hh&tt)===tt)_e!==null&&(_e=_e.next={lane:0,action:st.action,hasEagerState:st.hasEagerState,eagerState:st.eagerState,next:null}),o=st.hasEagerState?st.eagerState:e(o,st.action);else{var at={lane:tt,action:st.action,hasEagerState:st.hasEagerState,eagerState:st.eagerState,next:null};_e===null?(g=_e=at,_=o):_e=_e.next=at,M.lanes|=tt,rh|=tt}st=st.next}while(st!==null&&st!==h);_e===null?_=o:_e.next=g,He(o,i.memoizedState)||(dh=!0),i.memoizedState=o,i.baseState=_,i.baseQueue=_e,s.lastRenderedState=o}if(e=s.interleaved,e!==null){a=e;do h=a.lane,M.lanes|=h,rh|=h,a=a.next;while(a!==e)}else a===null&&(s.lanes=0);return[i.memoizedState,s.dispatch]}function Xh(e){var i=Uh(),s=i.queue;if(s===null)throw Error(p(311));s.lastRenderedReducer=e;var o=s.dispatch,a=s.pending,h=i.memoizedState;if(a!==null){s.pending=null;var _=a=a.next;do h=e(h,_.action),_=_.next;while(_!==a);He(h,i.memoizedState)||(dh=!0),i.memoizedState=h,i.baseQueue===null&&(i.baseState=h),s.lastRenderedState=h}return[h,o]}function Yh(){}function Zh(e,i){var s=M,o=Uh(),a=i(),h=!He(o.memoizedState,a);if(h&&(o.memoizedState=a,dh=!0),o=o.queue,$h(ai.bind(null,s,o,e),[e]),o.getSnapshot!==i||h||O!==null&&O.memoizedState.tag&1){if(s.flags|=2048,bi(9,ci.bind(null,s,o,a,i),void 0,null),Q===null)throw Error(p(349));Hh&30||di(s,i,a)}return a}function di(e,i,s){e.flags|=16384,e={getSnapshot:i,value:s},i=M.updateQueue,i===null?(i={lastEffect:null,stores:null},M.updateQueue=i,i.stores=[e]):(s=i.stores,s===null?i.stores=[e]:s.push(e))}function ci(e,i,s,o){i.value=s,i.getSnapshot=o,ei(i)&&fi(e)}function ai(e,i,s){return s(function(){ei(i)&&fi(e)})}function ei(e){var i=e.getSnapshot;e=e.value;try{var s=i();return!He(e,s)}catch{return!0}}function fi(e){var i=ih(e,1);i!==null&&gi(i,e,1,-1)}function hi(e){var i=Th();return typeof e=="function"&&(e=e()),i.memoizedState=i.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:e},i.queue=e,e=e.dispatch=ii.bind(null,M,e),[i.memoizedState,e]}function bi(e,i,s,o){return e={tag:e,create:i,destroy:s,deps:o,next:null},i=M.updateQueue,i===null?(i={lastEffect:null,stores:null},M.updateQueue=i,i.lastEffect=e.next=e):(s=i.lastEffect,s===null?i.lastEffect=e.next=e:(o=s.next,s.next=e,e.next=o,i.lastEffect=e)),e}function ji(){return Uh().memoizedState}function ki(e,i,s,o){var a=Th();M.flags|=e,a.memoizedState=bi(1|i,s,void 0,o===void 0?null:o)}function li(e,i,s,o){var a=Uh();o=o===void 0?null:o;var h=void 0;if(N!==null){var _=N.memoizedState;if(h=_.destroy,o!==null&&Mh(o,_.deps)){a.memoizedState=bi(i,s,h,o);return}}M.flags|=e,a.memoizedState=bi(1|i,s,h,o)}function mi(e,i){return ki(8390656,8,e,i)}function $h(e,i){return li(2048,8,e,i)}function ni(e,i){return li(4,2,e,i)}function oi(e,i){return li(4,4,e,i)}function pi(e,i){if(typeof i=="function")return e=e(),i(e),function(){i(null)};if(i!=null)return e=e(),i.current=e,function(){i.current=null}}function qi(e,i,s){return s=s!=null?s.concat([e]):null,li(4,4,pi.bind(null,i,e),s)}function ri(){}function si(e,i){var s=Uh();i=i===void 0?null:i;var o=s.memoizedState;return o!==null&&i!==null&&Mh(i,o[1])?o[0]:(s.memoizedState=[e,i],e)}function ti(e,i){var s=Uh();i=i===void 0?null:i;var o=s.memoizedState;return o!==null&&i!==null&&Mh(i,o[1])?o[0]:(e=e(),s.memoizedState=[e,i],e)}function ui(e,i,s){return Hh&21?(He(s,i)||(s=yc(),M.lanes|=s,rh|=s,e.baseState=!0),i):(e.baseState&&(e.baseState=!1,dh=!0),e.memoizedState=s)}function vi(e,i){var s=C;C=s!==0&&4>s?s:4,e(!0);var o=Gh.transition;Gh.transition={};try{e(!1),i()}finally{C=s,Gh.transition=o}}function wi(){return Uh().memoizedState}function xi(e,i,s){var o=yi(e);if(s={lane:o,action:s,hasEagerState:!1,eagerState:null,next:null},zi(e))Ai(i,s);else if(s=hh(e,i,s,o),s!==null){var a=R();gi(s,e,o,a),Bi(s,i,o)}}function ii(e,i,s){var o=yi(e),a={lane:o,action:s,hasEagerState:!1,eagerState:null,next:null};if(zi(e))Ai(i,a);else{var h=e.alternate;if(e.lanes===0&&(h===null||h.lanes===0)&&(h=i.lastRenderedReducer,h!==null))try{var _=i.lastRenderedState,g=h(_,s);if(a.hasEagerState=!0,a.eagerState=g,He(g,_)){var _e=i.interleaved;_e===null?(a.next=a,gh(i)):(a.next=_e.next,_e.next=a),i.interleaved=a;return}}catch{}finally{}s=hh(e,i,a,o),s!==null&&(a=R(),gi(s,e,o,a),Bi(s,i,o))}}function zi(e){var i=e.alternate;return e===M||i!==null&&i===M}function Ai(e,i){Jh=Ih=!0;var s=e.pending;s===null?i.next=i:(i.next=s.next,s.next=i),e.pending=i}function Bi(e,i,s){if(s&4194240){var o=i.lanes;o&=e.pendingLanes,s|=o,i.lanes=s,Cc(e,s)}}var Rh={readContext:eh,useCallback:P,useContext:P,useEffect:P,useImperativeHandle:P,useInsertionEffect:P,useLayoutEffect:P,useMemo:P,useReducer:P,useRef:P,useState:P,useDebugValue:P,useDeferredValue:P,useTransition:P,useMutableSource:P,useSyncExternalStore:P,useId:P,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(e,i){return Th().memoizedState=[e,i===void 0?null:i],e},useContext:eh,useEffect:mi,useImperativeHandle:function(e,i,s){return s=s!=null?s.concat([e]):null,ki(4194308,4,pi.bind(null,i,e),s)},useLayoutEffect:function(e,i){return ki(4194308,4,e,i)},useInsertionEffect:function(e,i){return ki(4,2,e,i)},useMemo:function(e,i){var s=Th();return i=i===void 0?null:i,e=e(),s.memoizedState=[e,i],e},useReducer:function(e,i,s){var o=Th();return i=s!==void 0?s(i):i,o.memoizedState=o.baseState=i,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},o.queue=e,e=e.dispatch=xi.bind(null,M,e),[o.memoizedState,e]},useRef:function(e){var i=Th();return e={current:e},i.memoizedState=e},useState:hi,useDebugValue:ri,useDeferredValue:function(e){return Th().memoizedState=e},useTransition:function(){var e=hi(!1),i=e[0];return e=vi.bind(null,e[1]),Th().memoizedState=e,[i,e]},useMutableSource:function(){},useSyncExternalStore:function(e,i,s){var o=M,a=Th();if(I){if(s===void 0)throw Error(p(407));s=s()}else{if(s=i(),Q===null)throw Error(p(349));Hh&30||di(o,i,s)}a.memoizedState=s;var h={value:s,getSnapshot:i};return a.queue=h,mi(ai.bind(null,o,h,e),[e]),o.flags|=2048,bi(9,ci.bind(null,o,h,s,i),void 0,null),s},useId:function(){var e=Th(),i=Q.identifierPrefix;if(I){var s=sg,o=rg;s=(o&~(1<<32-oc(o)-1)).toString(32)+s,i=":"+i+"R"+s,s=Kh++,0<s&&(i+="H"+s.toString(32)),i+=":"}else s=Lh++,i=":"+i+"r"+s.toString(32)+":";return e.memoizedState=i},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},useDebugValue:ri,useDeferredValue:function(e){var i=Uh();return ui(i,N.memoizedState,e)},useTransition:function(){var e=Wh(Vh)[0],i=Uh().memoizedState;return[e,i]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(e){var i=Uh();return N===null?i.memoizedState=e:ui(i,N.memoizedState,e)},useTransition:function(){var e=Xh(Vh)[0],i=Uh().memoizedState;return[e,i]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(e,i){if(e&&e.defaultProps){i=A({},i),e=e.defaultProps;for(var s in e)i[s]===void 0&&(i[s]=e[s]);return i}return i}function Di(e,i,s,o){i=e.memoizedState,s=s(o,i),s=s==null?i:A({},i,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var Ei={isMounted:function(e){return(e=e._reactInternals)?Vb(e)===e:!1},enqueueSetState:function(e,i,s){e=e._reactInternals;var o=R(),a=yi(e),h=mh(o,a);h.payload=i,s!=null&&(h.callback=s),i=nh(e,h,a),i!==null&&(gi(i,e,a,o),oh(i,e,a))},enqueueReplaceState:function(e,i,s){e=e._reactInternals;var o=R(),a=yi(e),h=mh(o,a);h.tag=1,h.payload=i,s!=null&&(h.callback=s),i=nh(e,h,a),i!==null&&(gi(i,e,a,o),oh(i,e,a))},enqueueForceUpdate:function(e,i){e=e._reactInternals;var s=R(),o=yi(e),a=mh(s,o);a.tag=2,i!=null&&(a.callback=i),i=nh(e,a,o),i!==null&&(gi(i,e,o,s),oh(i,e,o))}};function Fi(e,i,s,o,a,h,_){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(o,h,_):i.prototype&&i.prototype.isPureReactComponent?!Ie(s,o)||!Ie(a,h):!0}function Gi(e,i,s){var o=!1,a=Vf,h=i.contextType;return typeof h=="object"&&h!==null?h=eh(h):(a=Zf(i)?Xf:H.current,o=i.contextTypes,h=(o=o!=null)?Yf(e,a):Vf),i=new i(s,h),e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=Ei,e.stateNode=i,i._reactInternals=e,o&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=h),i}function Hi(e,i,s,o){e=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(s,o),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(s,o),i.state!==e&&Ei.enqueueReplaceState(i,i.state,null)}function Ii(e,i,s,o){var a=e.stateNode;a.props=s,a.state=e.memoizedState,a.refs={},kh(e);var h=i.contextType;typeof h=="object"&&h!==null?a.context=eh(h):(h=Zf(i)?Xf:H.current,a.context=Yf(e,h)),a.state=e.memoizedState,h=i.getDerivedStateFromProps,typeof h=="function"&&(Di(e,i,h,s),a.state=e.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(i=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),i!==a.state&&Ei.enqueueReplaceState(a,a.state,null),qh(e,s,a,o),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Ji(e,i){try{var s="",o=i;do s+=Pa(o),o=o.return;while(o);var a=s}catch(h){a=`
Error generating stack: `+h.message+`
`+h.stack}return{value:e,source:i,stack:a,digest:null}}function Ki(e,i,s){return{value:e,source:null,stack:s??null,digest:i??null}}function Li(e,i){try{console.error(i.value)}catch(s){setTimeout(function(){throw s})}}var Mi=typeof WeakMap=="function"?WeakMap:Map;function Ni(e,i,s){s=mh(-1,s),s.tag=3,s.payload={element:null};var o=i.value;return s.callback=function(){Oi||(Oi=!0,Pi=o),Li(e,i)},s}function Qi(e,i,s){s=mh(-1,s),s.tag=3;var o=e.type.getDerivedStateFromError;if(typeof o=="function"){var a=i.value;s.payload=function(){return o(a)},s.callback=function(){Li(e,i)}}var h=e.stateNode;return h!==null&&typeof h.componentDidCatch=="function"&&(s.callback=function(){Li(e,i),typeof o!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var _=i.stack;this.componentDidCatch(i.value,{componentStack:_!==null?_:""})}),s}function Si(e,i,s){var o=e.pingCache;if(o===null){o=e.pingCache=new Mi;var a=new Set;o.set(i,a)}else a=o.get(i),a===void 0&&(a=new Set,o.set(i,a));a.has(s)||(a.add(s),e=Ti.bind(null,e,i,s),i.then(e,e))}function Ui(e){do{var i;if((i=e.tag===13)&&(i=e.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return e;e=e.return}while(e!==null);return null}function Vi(e,i,s,o,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===i?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(i=mh(-1,1),i.tag=2,nh(s,i,1))),s.lanes|=1),e)}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(e,i,s,o){i.child=e===null?Vg(i,null,s,o):Ug(i,e.child,s,o)}function Yi(e,i,s,o,a){s=s.render;var h=i.ref;return ch(i,a),o=Nh(e,i,s,o,h,a),s=Sh(),e!==null&&!dh?(i.updateQueue=e.updateQueue,i.flags&=-2053,e.lanes&=~a,Zi(e,i,a)):(I&&s&&vg(i),i.flags|=1,Xi(e,i,o,a),i.child)}function $i(e,i,s,o,a){if(e===null){var h=s.type;return typeof h=="function"&&!aj(h)&&h.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(i.tag=15,i.type=h,bj(e,i,h,o,a)):(e=Rg(s.type,null,o,i,i.mode,a),e.ref=i.ref,e.return=i,i.child=e)}if(h=e.child,!(e.lanes&a)){var _=h.memoizedProps;if(s=s.compare,s=s!==null?s:Ie,s(_,o)&&e.ref===i.ref)return Zi(e,i,a)}return i.flags|=1,e=Pg(h,o),e.ref=i.ref,e.return=i,i.child=e}function bj(e,i,s,o,a){if(e!==null){var h=e.memoizedProps;if(Ie(h,o)&&e.ref===i.ref)if(dh=!1,i.pendingProps=o=h,(e.lanes&a)!==0)e.flags&131072&&(dh=!0);else return i.lanes=e.lanes,Zi(e,i,a)}return cj(e,i,s,o,a)}function dj(e,i,s){var o=i.pendingProps,a=o.children,h=e!==null?e.memoizedState:null;if(o.mode==="hidden")if(!(i.mode&1))i.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(ej,fj),fj|=s;else{if(!(s&1073741824))return e=h!==null?h.baseLanes|s:s,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:e,cachePool:null,transitions:null},i.updateQueue=null,G(ej,fj),fj|=e,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=h!==null?h.baseLanes:s,G(ej,fj),fj|=o}else h!==null?(o=h.baseLanes|s,i.memoizedState=null):o=s,G(ej,fj),fj|=o;return Xi(e,i,a,s),i.child}function gj(e,i){var s=i.ref;(e===null&&s!==null||e!==null&&e.ref!==s)&&(i.flags|=512,i.flags|=2097152)}function cj(e,i,s,o,a){var h=Zf(s)?Xf:H.current;return h=Yf(i,h),ch(i,a),s=Nh(e,i,s,o,h,a),o=Sh(),e!==null&&!dh?(i.updateQueue=e.updateQueue,i.flags&=-2053,e.lanes&=~a,Zi(e,i,a)):(I&&o&&vg(i),i.flags|=1,Xi(e,i,s,a),i.child)}function hj(e,i,s,o,a){if(Zf(s)){var h=!0;cg(i)}else h=!1;if(ch(i,a),i.stateNode===null)ij(e,i),Gi(i,s,o),Ii(i,s,o,a),o=!0;else if(e===null){var _=i.stateNode,g=i.memoizedProps;_.props=g;var _e=_.context,st=s.contextType;typeof st=="object"&&st!==null?st=eh(st):(st=Zf(s)?Xf:H.current,st=Yf(i,st));var tt=s.getDerivedStateFromProps,at=typeof tt=="function"||typeof _.getSnapshotBeforeUpdate=="function";at||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(g!==o||_e!==st)&&Hi(i,_,o,st),jh=!1;var ot=i.memoizedState;_.state=ot,qh(i,o,_,a),_e=i.memoizedState,g!==o||ot!==_e||Wf.current||jh?(typeof tt=="function"&&(Di(i,s,tt,o),_e=i.memoizedState),(g=jh||Fi(i,s,g,o,ot,_e,st))?(at||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(i.flags|=4194308)):(typeof _.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=o,i.memoizedState=_e),_.props=o,_.state=_e,_.context=st,o=g):(typeof _.componentDidMount=="function"&&(i.flags|=4194308),o=!1)}else{_=i.stateNode,lh(e,i),g=i.memoizedProps,st=i.type===i.elementType?g:Ci(i.type,g),_.props=st,at=i.pendingProps,ot=_.context,_e=s.contextType,typeof _e=="object"&&_e!==null?_e=eh(_e):(_e=Zf(s)?Xf:H.current,_e=Yf(i,_e));var lt=s.getDerivedStateFromProps;(tt=typeof lt=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(g!==at||ot!==_e)&&Hi(i,_,o,_e),jh=!1,ot=i.memoizedState,_.state=ot,qh(i,o,_,a);var ct=i.memoizedState;g!==at||ot!==ct||Wf.current||jh?(typeof lt=="function"&&(Di(i,s,lt,o),ct=i.memoizedState),(st=jh||Fi(i,s,st,o,ot,ct,_e)||!1)?(tt||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(o,ct,_e),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(o,ct,_e)),typeof _.componentDidUpdate=="function"&&(i.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof _.componentDidUpdate!="function"||g===e.memoizedProps&&ot===e.memoizedState||(i.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||g===e.memoizedProps&&ot===e.memoizedState||(i.flags|=1024),i.memoizedProps=o,i.memoizedState=ct),_.props=o,_.state=ct,_.context=_e,o=st):(typeof _.componentDidUpdate!="function"||g===e.memoizedProps&&ot===e.memoizedState||(i.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||g===e.memoizedProps&&ot===e.memoizedState||(i.flags|=1024),o=!1)}return jj(e,i,s,o,h,a)}function jj(e,i,s,o,a,h){gj(e,i);var _=(i.flags&128)!==0;if(!o&&!_)return a&&dg(i,s,!1),Zi(e,i,h);o=i.stateNode,Wi.current=i;var g=_&&typeof s.getDerivedStateFromError!="function"?null:o.render();return i.flags|=1,e!==null&&_?(i.child=Ug(i,e.child,null,h),i.child=Ug(i,null,g,h)):Xi(e,i,g,h),i.memoizedState=o.state,a&&dg(i,s,!0),i.child}function kj(e){var i=e.stateNode;i.pendingContext?ag(e,i.pendingContext,i.pendingContext!==i.context):i.context&&ag(e,i.context,!1),yh(e,i.containerInfo)}function lj(e,i,s,o,a){return Ig(),Jg(a),i.flags|=256,Xi(e,i,s,o),i.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(e){return{baseLanes:e,cachePool:null,transitions:null}}function oj(e,i,s){var o=i.pendingProps,a=L.current,h=!1,_=(i.flags&128)!==0,g;if((g=_)||(g=e!==null&&e.memoizedState===null?!1:(a&2)!==0),g?(h=!0,i.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),G(L,a&1),e===null)return Eg(i),e=i.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(i.mode&1?e.data==="$!"?i.lanes=8:i.lanes=1073741824:i.lanes=1,null):(_=o.children,e=o.fallback,h?(o=i.mode,h=i.child,_={mode:"hidden",children:_},!(o&1)&&h!==null?(h.childLanes=0,h.pendingProps=_):h=pj(_,o,0,null),e=Tg(e,o,s,null),h.return=i,e.return=i,h.sibling=e,i.child=h,i.child.memoizedState=nj(s),i.memoizedState=mj,e):qj(i,_));if(a=e.memoizedState,a!==null&&(g=a.dehydrated,g!==null))return rj(e,i,_,o,g,a,s);if(h){h=o.fallback,_=i.mode,a=e.child,g=a.sibling;var _e={mode:"hidden",children:o.children};return!(_&1)&&i.child!==a?(o=i.child,o.childLanes=0,o.pendingProps=_e,i.deletions=null):(o=Pg(a,_e),o.subtreeFlags=a.subtreeFlags&14680064),g!==null?h=Pg(g,h):(h=Tg(h,_,s,null),h.flags|=2),h.return=i,o.return=i,o.sibling=h,i.child=o,o=h,h=i.child,_=e.child.memoizedState,_=_===null?nj(s):{baseLanes:_.baseLanes|s,cachePool:null,transitions:_.transitions},h.memoizedState=_,h.childLanes=e.childLanes&~s,i.memoizedState=mj,o}return h=e.child,e=h.sibling,o=Pg(h,{mode:"visible",children:o.children}),!(i.mode&1)&&(o.lanes=s),o.return=i,o.sibling=null,e!==null&&(s=i.deletions,s===null?(i.deletions=[e],i.flags|=16):s.push(e)),i.child=o,i.memoizedState=null,o}function qj(e,i){return i=pj({mode:"visible",children:i},e.mode,0,null),i.return=e,e.child=i}function sj(e,i,s,o){return o!==null&&Jg(o),Ug(i,e.child,null,s),e=qj(i,i.pendingProps.children),e.flags|=2,i.memoizedState=null,e}function rj(e,i,s,o,a,h,_){if(s)return i.flags&256?(i.flags&=-257,o=Ki(Error(p(422))),sj(e,i,_,o)):i.memoizedState!==null?(i.child=e.child,i.flags|=128,null):(h=o.fallback,a=i.mode,o=pj({mode:"visible",children:o.children},a,0,null),h=Tg(h,a,_,null),h.flags|=2,o.return=i,h.return=i,o.sibling=h,i.child=o,i.mode&1&&Ug(i,e.child,null,_),i.child.memoizedState=nj(_),i.memoizedState=mj,h);if(!(i.mode&1))return sj(e,i,_,null);if(a.data==="$!"){if(o=a.nextSibling&&a.nextSibling.dataset,o)var g=o.dgst;return o=g,h=Error(p(419)),o=Ki(h,o,void 0),sj(e,i,_,o)}if(g=(_&e.childLanes)!==0,dh||g){if(o=Q,o!==null){switch(_&-_){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(o.suspendedLanes|_)?0:a,a!==0&&a!==h.retryLane&&(h.retryLane=a,ih(e,a),gi(o,e,a,-1))}return tj(),o=Ki(Error(p(421))),sj(e,i,_,o)}return a.data==="$?"?(i.flags|=128,i.child=e.child,i=uj.bind(null,e),a._reactRetry=i,null):(e=h.treeContext,yg=Lf(a.nextSibling),xg=i,I=!0,zg=null,e!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=e.id,sg=e.overflow,qg=i),i=qj(i,o.children),i.flags|=4096,i)}function vj(e,i,s){e.lanes|=i;var o=e.alternate;o!==null&&(o.lanes|=i),bh(e.return,i,s)}function wj(e,i,s,o,a){var h=e.memoizedState;h===null?e.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:o,tail:s,tailMode:a}:(h.isBackwards=i,h.rendering=null,h.renderingStartTime=0,h.last=o,h.tail=s,h.tailMode=a)}function xj(e,i,s){var o=i.pendingProps,a=o.revealOrder,h=o.tail;if(Xi(e,i,o.children,s),o=L.current,o&2)o=o&1|2,i.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=i.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&vj(e,s,i);else if(e.tag===19)vj(e,s,i);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===i)break e;for(;e.sibling===null;){if(e.return===null||e.return===i)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}o&=1}if(G(L,o),!(i.mode&1))i.memoizedState=null;else switch(a){case"forwards":for(s=i.child,a=null;s!==null;)e=s.alternate,e!==null&&Ch(e)===null&&(a=s),s=s.sibling;s=a,s===null?(a=i.child,i.child=null):(a=s.sibling,s.sibling=null),wj(i,!1,a,s,h);break;case"backwards":for(s=null,a=i.child,i.child=null;a!==null;){if(e=a.alternate,e!==null&&Ch(e)===null){i.child=a;break}e=a.sibling,a.sibling=s,s=a,a=e}wj(i,!0,s,null,h);break;case"together":wj(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function ij(e,i){!(i.mode&1)&&e!==null&&(e.alternate=null,i.alternate=null,i.flags|=2)}function Zi(e,i,s){if(e!==null&&(i.dependencies=e.dependencies),rh|=i.lanes,!(s&i.childLanes))return null;if(e!==null&&i.child!==e.child)throw Error(p(153));if(i.child!==null){for(e=i.child,s=Pg(e,e.pendingProps),i.child=s,s.return=i;e.sibling!==null;)e=e.sibling,s=s.sibling=Pg(e,e.pendingProps),s.return=i;s.sibling=null}return i.child}function yj(e,i,s){switch(i.tag){case 3:kj(i),Ig();break;case 5:Ah(i);break;case 1:Zf(i.type)&&cg(i);break;case 4:yh(i,i.stateNode.containerInfo);break;case 10:var o=i.type._context,a=i.memoizedProps.value;G(Wg,o._currentValue),o._currentValue=a;break;case 13:if(o=i.memoizedState,o!==null)return o.dehydrated!==null?(G(L,L.current&1),i.flags|=128,null):s&i.child.childLanes?oj(e,i,s):(G(L,L.current&1),e=Zi(e,i,s),e!==null?e.sibling:null);G(L,L.current&1);break;case 19:if(o=(s&i.childLanes)!==0,e.flags&128){if(o)return xj(e,i,s);i.flags|=128}if(a=i.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),G(L,L.current),o)break;return null;case 22:case 23:return i.lanes=0,dj(e,i,s)}return Zi(e,i,s)}var zj,Aj,Bj,Cj;zj=function(e,i){for(var s=i.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};Aj=function(){};Bj=function(e,i,s,o){var a=e.memoizedProps;if(a!==o){e=i.stateNode,xh(uh.current);var h=null;switch(s){case"input":a=Ya(e,a),o=Ya(e,o),h=[];break;case"select":a=A({},a,{value:void 0}),o=A({},o,{value:void 0}),h=[];break;case"textarea":a=gb(e,a),o=gb(e,o),h=[];break;default:typeof a.onClick!="function"&&typeof o.onClick=="function"&&(e.onclick=Bf)}ub(s,o);var _;s=null;for(st in a)if(!o.hasOwnProperty(st)&&a.hasOwnProperty(st)&&a[st]!=null)if(st==="style"){var g=a[st];for(_ in g)g.hasOwnProperty(_)&&(s||(s={}),s[_]="")}else st!=="dangerouslySetInnerHTML"&&st!=="children"&&st!=="suppressContentEditableWarning"&&st!=="suppressHydrationWarning"&&st!=="autoFocus"&&(ea.hasOwnProperty(st)?h||(h=[]):(h=h||[]).push(st,null));for(st in o){var _e=o[st];if(g=a!=null?a[st]:void 0,o.hasOwnProperty(st)&&_e!==g&&(_e!=null||g!=null))if(st==="style")if(g){for(_ in g)!g.hasOwnProperty(_)||_e&&_e.hasOwnProperty(_)||(s||(s={}),s[_]="");for(_ in _e)_e.hasOwnProperty(_)&&g[_]!==_e[_]&&(s||(s={}),s[_]=_e[_])}else s||(h||(h=[]),h.push(st,s)),s=_e;else st==="dangerouslySetInnerHTML"?(_e=_e?_e.__html:void 0,g=g?g.__html:void 0,_e!=null&&g!==_e&&(h=h||[]).push(st,_e)):st==="children"?typeof _e!="string"&&typeof _e!="number"||(h=h||[]).push(st,""+_e):st!=="suppressContentEditableWarning"&&st!=="suppressHydrationWarning"&&(ea.hasOwnProperty(st)?(_e!=null&&st==="onScroll"&&D("scroll",e),h||g===_e||(h=[])):(h=h||[]).push(st,_e))}s&&(h=h||[]).push("style",s);var st=h;(i.updateQueue=st)&&(i.flags|=4)}};Cj=function(e,i,s,o){s!==o&&(i.flags|=4)};function Dj(e,i){if(!I)switch(e.tailMode){case"hidden":i=e.tail;for(var s=null;i!==null;)i.alternate!==null&&(s=i),i=i.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?i||e.tail===null?e.tail=null:e.tail.sibling=null:o.sibling=null}}function S(e){var i=e.alternate!==null&&e.alternate.child===e.child,s=0,o=0;if(i)for(var a=e.child;a!==null;)s|=a.lanes|a.childLanes,o|=a.subtreeFlags&14680064,o|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)s|=a.lanes|a.childLanes,o|=a.subtreeFlags,o|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=o,e.childLanes=s,i}function Ej(e,i,s){var o=i.pendingProps;switch(wg(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(i),null;case 1:return Zf(i.type)&&$f(),S(i),null;case 3:return o=i.stateNode,zh(),E(Wf),E(H),Eh(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(e===null||e.child===null)&&(Gg(i)?i.flags|=4:e===null||e.memoizedState.isDehydrated&&!(i.flags&256)||(i.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(e,i),S(i),null;case 5:Bh(i);var a=xh(wh.current);if(s=i.type,e!==null&&i.stateNode!=null)Bj(e,i,s,o,a),e.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!o){if(i.stateNode===null)throw Error(p(166));return S(i),null}if(e=xh(uh.current),Gg(i)){o=i.stateNode,s=i.type;var h=i.memoizedProps;switch(o[Of]=i,o[Pf]=h,e=(i.mode&1)!==0,s){case"dialog":D("cancel",o),D("close",o);break;case"iframe":case"object":case"embed":D("load",o);break;case"video":case"audio":for(a=0;a<lf.length;a++)D(lf[a],o);break;case"source":D("error",o);break;case"img":case"image":case"link":D("error",o),D("load",o);break;case"details":D("toggle",o);break;case"input":Za(o,h),D("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!h.multiple},D("invalid",o);break;case"textarea":hb(o,h),D("invalid",o)}ub(s,h),a=null;for(var _ in h)if(h.hasOwnProperty(_)){var g=h[_];_==="children"?typeof g=="string"?o.textContent!==g&&(h.suppressHydrationWarning!==!0&&Af(o.textContent,g,e),a=["children",g]):typeof g=="number"&&o.textContent!==""+g&&(h.suppressHydrationWarning!==!0&&Af(o.textContent,g,e),a=["children",""+g]):ea.hasOwnProperty(_)&&g!=null&&_==="onScroll"&&D("scroll",o)}switch(s){case"input":Va(o),db(o,h,!0);break;case"textarea":Va(o),jb(o);break;case"select":case"option":break;default:typeof h.onClick=="function"&&(o.onclick=Bf)}o=a,i.updateQueue=o,o!==null&&(i.flags|=4)}else{_=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=kb(s)),e==="http://www.w3.org/1999/xhtml"?s==="script"?(e=_.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof o.is=="string"?e=_.createElement(s,{is:o.is}):(e=_.createElement(s),s==="select"&&(_=e,o.multiple?_.multiple=!0:o.size&&(_.size=o.size))):e=_.createElementNS(e,s),e[Of]=i,e[Pf]=o,zj(e,i,!1,!1),i.stateNode=e;e:{switch(_=vb(s,o),s){case"dialog":D("cancel",e),D("close",e),a=o;break;case"iframe":case"object":case"embed":D("load",e),a=o;break;case"video":case"audio":for(a=0;a<lf.length;a++)D(lf[a],e);a=o;break;case"source":D("error",e),a=o;break;case"img":case"image":case"link":D("error",e),D("load",e),a=o;break;case"details":D("toggle",e),a=o;break;case"input":Za(e,o),a=Ya(e,o),D("invalid",e);break;case"option":a=o;break;case"select":e._wrapperState={wasMultiple:!!o.multiple},a=A({},o,{value:void 0}),D("invalid",e);break;case"textarea":hb(e,o),a=gb(e,o),D("invalid",e);break;default:a=o}ub(s,a),g=a;for(h in g)if(g.hasOwnProperty(h)){var _e=g[h];h==="style"?sb(e,_e):h==="dangerouslySetInnerHTML"?(_e=_e?_e.__html:void 0,_e!=null&&nb(e,_e)):h==="children"?typeof _e=="string"?(s!=="textarea"||_e!=="")&&ob(e,_e):typeof _e=="number"&&ob(e,""+_e):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(ea.hasOwnProperty(h)?_e!=null&&h==="onScroll"&&D("scroll",e):_e!=null&&ta(e,h,_e,_))}switch(s){case"input":Va(e),db(e,o,!1);break;case"textarea":Va(e),jb(e);break;case"option":o.value!=null&&e.setAttribute("value",""+Sa(o.value));break;case"select":e.multiple=!!o.multiple,h=o.value,h!=null?fb(e,!!o.multiple,h,!1):o.defaultValue!=null&&fb(e,!!o.multiple,o.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Bf)}switch(s){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return S(i),null;case 6:if(e&&i.stateNode!=null)Cj(e,i,e.memoizedProps,o);else{if(typeof o!="string"&&i.stateNode===null)throw Error(p(166));if(s=xh(wh.current),xh(uh.current),Gg(i)){if(o=i.stateNode,s=i.memoizedProps,o[Of]=i,(h=o.nodeValue!==s)&&(e=xg,e!==null))switch(e.tag){case 3:Af(o.nodeValue,s,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Af(o.nodeValue,s,(e.mode&1)!==0)}h&&(i.flags|=4)}else o=(s.nodeType===9?s:s.ownerDocument).createTextNode(o),o[Of]=i,i.stateNode=o}return S(i),null;case 13:if(E(L),o=i.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(I&&yg!==null&&i.mode&1&&!(i.flags&128))Hg(),Ig(),i.flags|=98560,h=!1;else if(h=Gg(i),o!==null&&o.dehydrated!==null){if(e===null){if(!h)throw Error(p(318));if(h=i.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(p(317));h[Of]=i}else Ig(),!(i.flags&128)&&(i.memoizedState=null),i.flags|=4;S(i),h=!1}else zg!==null&&(Fj(zg),zg=null),h=!0;if(!h)return i.flags&65536?i:null}return i.flags&128?(i.lanes=s,i):(o=o!==null,o!==(e!==null&&e.memoizedState!==null)&&o&&(i.child.flags|=8192,i.mode&1&&(e===null||L.current&1?T===0&&(T=3):tj())),i.updateQueue!==null&&(i.flags|=4),S(i),null);case 4:return zh(),Aj(e,i),e===null&&sf(i.stateNode.containerInfo),S(i),null;case 10:return ah(i.type._context),S(i),null;case 17:return Zf(i.type)&&$f(),S(i),null;case 19:if(E(L),h=i.memoizedState,h===null)return S(i),null;if(o=(i.flags&128)!==0,_=h.rendering,_===null)if(o)Dj(h,!1);else{if(T!==0||e!==null&&e.flags&128)for(e=i.child;e!==null;){if(_=Ch(e),_!==null){for(i.flags|=128,Dj(h,!1),o=_.updateQueue,o!==null&&(i.updateQueue=o,i.flags|=4),i.subtreeFlags=0,o=s,s=i.child;s!==null;)h=s,e=o,h.flags&=14680066,_=h.alternate,_===null?(h.childLanes=0,h.lanes=e,h.child=null,h.subtreeFlags=0,h.memoizedProps=null,h.memoizedState=null,h.updateQueue=null,h.dependencies=null,h.stateNode=null):(h.childLanes=_.childLanes,h.lanes=_.lanes,h.child=_.child,h.subtreeFlags=0,h.deletions=null,h.memoizedProps=_.memoizedProps,h.memoizedState=_.memoizedState,h.updateQueue=_.updateQueue,h.type=_.type,e=_.dependencies,h.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return G(L,L.current&1|2),i.child}e=e.sibling}h.tail!==null&&B()>Gj&&(i.flags|=128,o=!0,Dj(h,!1),i.lanes=4194304)}else{if(!o)if(e=Ch(_),e!==null){if(i.flags|=128,o=!0,s=e.updateQueue,s!==null&&(i.updateQueue=s,i.flags|=4),Dj(h,!0),h.tail===null&&h.tailMode==="hidden"&&!_.alternate&&!I)return S(i),null}else 2*B()-h.renderingStartTime>Gj&&s!==1073741824&&(i.flags|=128,o=!0,Dj(h,!1),i.lanes=4194304);h.isBackwards?(_.sibling=i.child,i.child=_):(s=h.last,s!==null?s.sibling=_:i.child=_,h.last=_)}return h.tail!==null?(i=h.tail,h.rendering=i,h.tail=i.sibling,h.renderingStartTime=B(),i.sibling=null,s=L.current,G(L,o?s&1|2:s&1),i):(S(i),null);case 22:case 23:return Hj(),o=i.memoizedState!==null,e!==null&&e.memoizedState!==null!==o&&(i.flags|=8192),o&&i.mode&1?fj&1073741824&&(S(i),i.subtreeFlags&6&&(i.flags|=8192)):S(i),null;case 24:return null;case 25:return null}throw Error(p(156,i.tag))}function Ij(e,i){switch(wg(i),i.tag){case 1:return Zf(i.type)&&$f(),e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 3:return zh(),E(Wf),E(H),Eh(),e=i.flags,e&65536&&!(e&128)?(i.flags=e&-65537|128,i):null;case 5:return Bh(i),null;case 13:if(E(L),e=i.memoizedState,e!==null&&e.dehydrated!==null){if(i.alternate===null)throw Error(p(340));Ig()}return e=i.flags,e&65536?(i.flags=e&-65537|128,i):null;case 19:return E(L),null;case 4:return zh(),null;case 10:return ah(i.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Lj(e,i){var s=e.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(o){W(e,i,o)}else s.current=null}function Mj(e,i,s){try{s()}catch(o){W(e,i,o)}}var Nj=!1;function Oj(e,i){if(Cf=dd,e=Me(),Ne(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{s=(s=e.ownerDocument)&&s.defaultView||window;var o=s.getSelection&&s.getSelection();if(o&&o.rangeCount!==0){s=o.anchorNode;var a=o.anchorOffset,h=o.focusNode;o=o.focusOffset;try{s.nodeType,h.nodeType}catch{s=null;break e}var _=0,g=-1,_e=-1,st=0,tt=0,at=e,ot=null;t:for(;;){for(var lt;at!==s||a!==0&&at.nodeType!==3||(g=_+a),at!==h||o!==0&&at.nodeType!==3||(_e=_+o),at.nodeType===3&&(_+=at.nodeValue.length),(lt=at.firstChild)!==null;)ot=at,at=lt;for(;;){if(at===e)break t;if(ot===s&&++st===a&&(g=_),ot===h&&++tt===o&&(_e=_),(lt=at.nextSibling)!==null)break;at=ot,ot=at.parentNode}at=lt}s=g===-1||_e===-1?null:{start:g,end:_e}}else s=null}s=s||{start:0,end:0}}else s=null;for(Df={focusedElem:e,selectionRange:s},dd=!1,V=i;V!==null;)if(i=V,e=i.child,(i.subtreeFlags&1028)!==0&&e!==null)e.return=i,V=e;else for(;V!==null;){i=V;try{var ct=i.alternate;if(i.flags&1024)switch(i.tag){case 0:case 11:case 15:break;case 1:if(ct!==null){var $=ct.memoizedProps,c=ct.memoizedState,d=i.stateNode,j=d.getSnapshotBeforeUpdate(i.elementType===i.type?$:Ci(i.type,$),c);d.__reactInternalSnapshotBeforeUpdate=j}break;case 3:var et=i.stateNode.containerInfo;et.nodeType===1?et.textContent="":et.nodeType===9&&et.documentElement&&et.removeChild(et.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p(163))}}catch(nt){W(i,i.return,nt)}if(e=i.sibling,e!==null){e.return=i.return,V=e;break}V=i.return}return ct=Nj,Nj=!1,ct}function Pj(e,i,s){var o=i.updateQueue;if(o=o!==null?o.lastEffect:null,o!==null){var a=o=o.next;do{if((a.tag&e)===e){var h=a.destroy;a.destroy=void 0,h!==void 0&&Mj(i,s,h)}a=a.next}while(a!==o)}}function Qj(e,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var s=i=i.next;do{if((s.tag&e)===e){var o=s.create;s.destroy=o()}s=s.next}while(s!==i)}}function Rj(e){var i=e.ref;if(i!==null){var s=e.stateNode;switch(e.tag){case 5:e=s;break;default:e=s}typeof i=="function"?i(e):i.current=e}}function Sj(e){var i=e.alternate;i!==null&&(e.alternate=null,Sj(i)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(i=e.stateNode,i!==null&&(delete i[Of],delete i[Pf],delete i[of],delete i[Qf],delete i[Rf])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Tj(e){return e.tag===5||e.tag===3||e.tag===4}function Uj(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Tj(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Vj(e,i,s){var o=e.tag;if(o===5||o===6)e=e.stateNode,i?s.nodeType===8?s.parentNode.insertBefore(e,i):s.insertBefore(e,i):(s.nodeType===8?(i=s.parentNode,i.insertBefore(e,s)):(i=s,i.appendChild(e)),s=s._reactRootContainer,s!=null||i.onclick!==null||(i.onclick=Bf));else if(o!==4&&(e=e.child,e!==null))for(Vj(e,i,s),e=e.sibling;e!==null;)Vj(e,i,s),e=e.sibling}function Wj(e,i,s){var o=e.tag;if(o===5||o===6)e=e.stateNode,i?s.insertBefore(e,i):s.appendChild(e);else if(o!==4&&(e=e.child,e!==null))for(Wj(e,i,s),e=e.sibling;e!==null;)Wj(e,i,s),e=e.sibling}var X=null,Xj=!1;function Yj(e,i,s){for(s=s.child;s!==null;)Zj(e,i,s),s=s.sibling}function Zj(e,i,s){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,s)}catch{}switch(s.tag){case 5:U||Lj(s,i);case 6:var o=X,a=Xj;X=null,Yj(e,i,s),X=o,Xj=a,X!==null&&(Xj?(e=X,s=s.stateNode,e.nodeType===8?e.parentNode.removeChild(s):e.removeChild(s)):X.removeChild(s.stateNode));break;case 18:X!==null&&(Xj?(e=X,s=s.stateNode,e.nodeType===8?Kf(e.parentNode,s):e.nodeType===1&&Kf(e,s),bd(e)):Kf(X,s.stateNode));break;case 4:o=X,a=Xj,X=s.stateNode.containerInfo,Xj=!0,Yj(e,i,s),X=o,Xj=a;break;case 0:case 11:case 14:case 15:if(!U&&(o=s.updateQueue,o!==null&&(o=o.lastEffect,o!==null))){a=o=o.next;do{var h=a,_=h.destroy;h=h.tag,_!==void 0&&(h&2||h&4)&&Mj(s,i,_),a=a.next}while(a!==o)}Yj(e,i,s);break;case 1:if(!U&&(Lj(s,i),o=s.stateNode,typeof o.componentWillUnmount=="function"))try{o.props=s.memoizedProps,o.state=s.memoizedState,o.componentWillUnmount()}catch(g){W(s,i,g)}Yj(e,i,s);break;case 21:Yj(e,i,s);break;case 22:s.mode&1?(U=(o=U)||s.memoizedState!==null,Yj(e,i,s),U=o):Yj(e,i,s);break;default:Yj(e,i,s)}}function ak(e){var i=e.updateQueue;if(i!==null){e.updateQueue=null;var s=e.stateNode;s===null&&(s=e.stateNode=new Kj),i.forEach(function(o){var a=bk.bind(null,e,o);s.has(o)||(s.add(o),o.then(a,a))})}}function ck(e,i){var s=i.deletions;if(s!==null)for(var o=0;o<s.length;o++){var a=s[o];try{var h=e,_=i,g=_;e:for(;g!==null;){switch(g.tag){case 5:X=g.stateNode,Xj=!1;break e;case 3:X=g.stateNode.containerInfo,Xj=!0;break e;case 4:X=g.stateNode.containerInfo,Xj=!0;break e}g=g.return}if(X===null)throw Error(p(160));Zj(h,_,a),X=null,Xj=!1;var _e=a.alternate;_e!==null&&(_e.return=null),a.return=null}catch(st){W(a,i,st)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)dk(i,e),i=i.sibling}function dk(e,i){var s=e.alternate,o=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ck(i,e),ek(e),o&4){try{Pj(3,e,e.return),Qj(3,e)}catch($){W(e,e.return,$)}try{Pj(5,e,e.return)}catch($){W(e,e.return,$)}}break;case 1:ck(i,e),ek(e),o&512&&s!==null&&Lj(s,s.return);break;case 5:if(ck(i,e),ek(e),o&512&&s!==null&&Lj(s,s.return),e.flags&32){var a=e.stateNode;try{ob(a,"")}catch($){W(e,e.return,$)}}if(o&4&&(a=e.stateNode,a!=null)){var h=e.memoizedProps,_=s!==null?s.memoizedProps:h,g=e.type,_e=e.updateQueue;if(e.updateQueue=null,_e!==null)try{g==="input"&&h.type==="radio"&&h.name!=null&&ab(a,h),vb(g,_);var st=vb(g,h);for(_=0;_<_e.length;_+=2){var tt=_e[_],at=_e[_+1];tt==="style"?sb(a,at):tt==="dangerouslySetInnerHTML"?nb(a,at):tt==="children"?ob(a,at):ta(a,tt,at,st)}switch(g){case"input":bb(a,h);break;case"textarea":ib(a,h);break;case"select":var ot=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!h.multiple;var lt=h.value;lt!=null?fb(a,!!h.multiple,lt,!1):ot!==!!h.multiple&&(h.defaultValue!=null?fb(a,!!h.multiple,h.defaultValue,!0):fb(a,!!h.multiple,h.multiple?[]:"",!1))}a[Pf]=h}catch($){W(e,e.return,$)}}break;case 6:if(ck(i,e),ek(e),o&4){if(e.stateNode===null)throw Error(p(162));a=e.stateNode,h=e.memoizedProps;try{a.nodeValue=h}catch($){W(e,e.return,$)}}break;case 3:if(ck(i,e),ek(e),o&4&&s!==null&&s.memoizedState.isDehydrated)try{bd(i.containerInfo)}catch($){W(e,e.return,$)}break;case 4:ck(i,e),ek(e);break;case 13:ck(i,e),ek(e),a=e.child,a.flags&8192&&(h=a.memoizedState!==null,a.stateNode.isHidden=h,!h||a.alternate!==null&&a.alternate.memoizedState!==null||(fk=B())),o&4&&ak(e);break;case 22:if(tt=s!==null&&s.memoizedState!==null,e.mode&1?(U=(st=U)||tt,ck(i,e),U=st):ck(i,e),ek(e),o&8192){if(st=e.memoizedState!==null,(e.stateNode.isHidden=st)&&!tt&&e.mode&1)for(V=e,tt=e.child;tt!==null;){for(at=V=tt;V!==null;){switch(ot=V,lt=ot.child,ot.tag){case 0:case 11:case 14:case 15:Pj(4,ot,ot.return);break;case 1:Lj(ot,ot.return);var ct=ot.stateNode;if(typeof ct.componentWillUnmount=="function"){o=ot,s=ot.return;try{i=o,ct.props=i.memoizedProps,ct.state=i.memoizedState,ct.componentWillUnmount()}catch($){W(o,s,$)}}break;case 5:Lj(ot,ot.return);break;case 22:if(ot.memoizedState!==null){gk(at);continue}}lt!==null?(lt.return=ot,V=lt):gk(at)}tt=tt.sibling}e:for(tt=null,at=e;;){if(at.tag===5){if(tt===null){tt=at;try{a=at.stateNode,st?(h=a.style,typeof h.setProperty=="function"?h.setProperty("display","none","important"):h.display="none"):(g=at.stateNode,_e=at.memoizedProps.style,_=_e!=null&&_e.hasOwnProperty("display")?_e.display:null,g.style.display=rb("display",_))}catch($){W(e,e.return,$)}}}else if(at.tag===6){if(tt===null)try{at.stateNode.nodeValue=st?"":at.memoizedProps}catch($){W(e,e.return,$)}}else if((at.tag!==22&&at.tag!==23||at.memoizedState===null||at===e)&&at.child!==null){at.child.return=at,at=at.child;continue}if(at===e)break e;for(;at.sibling===null;){if(at.return===null||at.return===e)break e;tt===at&&(tt=null),at=at.return}tt===at&&(tt=null),at.sibling.return=at.return,at=at.sibling}}break;case 19:ck(i,e),ek(e),o&4&&ak(e);break;case 21:break;default:ck(i,e),ek(e)}}function ek(e){var i=e.flags;if(i&2){try{e:{for(var s=e.return;s!==null;){if(Tj(s)){var o=s;break e}s=s.return}throw Error(p(160))}switch(o.tag){case 5:var a=o.stateNode;o.flags&32&&(ob(a,""),o.flags&=-33);var h=Uj(e);Wj(e,h,a);break;case 3:case 4:var _=o.stateNode.containerInfo,g=Uj(e);Vj(e,g,_);break;default:throw Error(p(161))}}catch(_e){W(e,e.return,_e)}e.flags&=-3}i&4096&&(e.flags&=-4097)}function hk(e,i,s){V=e,ik(e)}function ik(e,i,s){for(var o=(e.mode&1)!==0;V!==null;){var a=V,h=a.child;if(a.tag===22&&o){var _=a.memoizedState!==null||Jj;if(!_){var g=a.alternate,_e=g!==null&&g.memoizedState!==null||U;g=Jj;var st=U;if(Jj=_,(U=_e)&&!st)for(V=a;V!==null;)_=V,_e=_.child,_.tag===22&&_.memoizedState!==null?jk(a):_e!==null?(_e.return=_,V=_e):jk(a);for(;h!==null;)V=h,ik(h),h=h.sibling;V=a,Jj=g,U=st}kk(e)}else a.subtreeFlags&8772&&h!==null?(h.return=a,V=h):kk(e)}}function kk(e){for(;V!==null;){var i=V;if(i.flags&8772){var s=i.alternate;try{if(i.flags&8772)switch(i.tag){case 0:case 11:case 15:U||Qj(5,i);break;case 1:var o=i.stateNode;if(i.flags&4&&!U)if(s===null)o.componentDidMount();else{var a=i.elementType===i.type?s.memoizedProps:Ci(i.type,s.memoizedProps);o.componentDidUpdate(a,s.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var h=i.updateQueue;h!==null&&sh(i,h,o);break;case 3:var _=i.updateQueue;if(_!==null){if(s=null,i.child!==null)switch(i.child.tag){case 5:s=i.child.stateNode;break;case 1:s=i.child.stateNode}sh(i,_,s)}break;case 5:var g=i.stateNode;if(s===null&&i.flags&4){s=g;var _e=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":_e.autoFocus&&s.focus();break;case"img":_e.src&&(s.src=_e.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var st=i.alternate;if(st!==null){var tt=st.memoizedState;if(tt!==null){var at=tt.dehydrated;at!==null&&bd(at)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p(163))}U||i.flags&512&&Rj(i)}catch(ot){W(i,i.return,ot)}}if(i===e){V=null;break}if(s=i.sibling,s!==null){s.return=i.return,V=s;break}V=i.return}}function gk(e){for(;V!==null;){var i=V;if(i===e){V=null;break}var s=i.sibling;if(s!==null){s.return=i.return,V=s;break}V=i.return}}function jk(e){for(;V!==null;){var i=V;try{switch(i.tag){case 0:case 11:case 15:var s=i.return;try{Qj(4,i)}catch(_e){W(i,s,_e)}break;case 1:var o=i.stateNode;if(typeof o.componentDidMount=="function"){var a=i.return;try{o.componentDidMount()}catch(_e){W(i,a,_e)}}var h=i.return;try{Rj(i)}catch(_e){W(i,h,_e)}break;case 5:var _=i.return;try{Rj(i)}catch(_e){W(i,_,_e)}}}catch(_e){W(i,i.return,_e)}if(i===e){V=null;break}var g=i.sibling;if(g!==null){g.return=i.return,V=g;break}V=i.return}}var lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok=ua.ReactCurrentBatchConfig,K=0,Q=null,Y=null,Z=0,fj=0,ej=Uf(0),T=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R(){return K&6?B():Ak!==-1?Ak:Ak=B()}function yi(e){return e.mode&1?K&2&&Z!==0?Z&-Z:Kg.transition!==null?(Bk===0&&(Bk=yc()),Bk):(e=C,e!==0||(e=window.event,e=e===void 0?16:jd(e.type)),e):1}function gi(e,i,s,o){if(50<yk)throw yk=0,zk=null,Error(p(185));Ac(e,s,o),(!(K&2)||e!==Q)&&(e===Q&&(!(K&2)&&(qk|=s),T===4&&Ck(e,Z)),Dk(e,o),s===1&&K===0&&!(i.mode&1)&&(Gj=B()+500,fg&&jg()))}function Dk(e,i){var s=e.callbackNode;wc(e,i);var o=uc(e,e===Q?Z:0);if(o===0)s!==null&&bc(s),e.callbackNode=null,e.callbackPriority=0;else if(i=o&-o,e.callbackPriority!==i){if(s!=null&&bc(s),i===1)e.tag===0?ig(Ek.bind(null,e)):hg(Ek.bind(null,e)),Jf(function(){!(K&6)&&jg()}),s=null;else{switch(Dc(o)){case 1:s=fc;break;case 4:s=gc;break;case 16:s=hc;break;case 536870912:s=jc;break;default:s=hc}s=Fk(s,Gk.bind(null,e))}e.callbackPriority=i,e.callbackNode=s}}function Gk(e,i){if(Ak=-1,Bk=0,K&6)throw Error(p(327));var s=e.callbackNode;if(Hk()&&e.callbackNode!==s)return null;var o=uc(e,e===Q?Z:0);if(o===0)return null;if(o&30||o&e.expiredLanes||i)i=Ik(e,o);else{i=o;var a=K;K|=2;var h=Jk();(Q!==e||Z!==i)&&(uk=null,Gj=B()+500,Kk(e,i));do try{Lk();break}catch(g){Mk(e,g)}while(!0);$g(),mk.current=h,K=a,Y!==null?i=0:(Q=null,Z=0,i=T)}if(i!==0){if(i===2&&(a=xc(e),a!==0&&(o=a,i=Nk(e,a))),i===1)throw s=pk,Kk(e,0),Ck(e,o),Dk(e,B()),s;if(i===6)Ck(e,o);else{if(a=e.current.alternate,!(o&30)&&!Ok(a)&&(i=Ik(e,o),i===2&&(h=xc(e),h!==0&&(o=h,i=Nk(e,h))),i===1))throw s=pk,Kk(e,0),Ck(e,o),Dk(e,B()),s;switch(e.finishedWork=a,e.finishedLanes=o,i){case 0:case 1:throw Error(p(345));case 2:Pk(e,tk,uk);break;case 3:if(Ck(e,o),(o&130023424)===o&&(i=fk+500-B(),10<i)){if(uc(e,0)!==0)break;if(a=e.suspendedLanes,(a&o)!==o){R(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Ff(Pk.bind(null,e,tk,uk),i);break}Pk(e,tk,uk);break;case 4:if(Ck(e,o),(o&4194240)===o)break;for(i=e.eventTimes,a=-1;0<o;){var _=31-oc(o);h=1<<_,_=i[_],_>a&&(a=_),o&=~h}if(o=a,o=B()-o,o=(120>o?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*lk(o/1960))-o,10<o){e.timeoutHandle=Ff(Pk.bind(null,e,tk,uk),o);break}Pk(e,tk,uk);break;case 5:Pk(e,tk,uk);break;default:throw Error(p(329))}}}return Dk(e,B()),e.callbackNode===s?Gk.bind(null,e):null}function Nk(e,i){var s=sk;return e.current.memoizedState.isDehydrated&&(Kk(e,i).flags|=256),e=Ik(e,i),e!==2&&(i=tk,tk=s,i!==null&&Fj(i)),e}function Fj(e){tk===null?tk=e:tk.push.apply(tk,e)}function Ok(e){for(var i=e;;){if(i.flags&16384){var s=i.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var o=0;o<s.length;o++){var a=s[o],h=a.getSnapshot;a=a.value;try{if(!He(h(),a))return!1}catch{return!1}}}if(s=i.child,i.subtreeFlags&16384&&s!==null)s.return=i,i=s;else{if(i===e)break;for(;i.sibling===null;){if(i.return===null||i.return===e)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Ck(e,i){for(i&=~rk,i&=~qk,e.suspendedLanes|=i,e.pingedLanes&=~i,e=e.expirationTimes;0<i;){var s=31-oc(i),o=1<<s;e[s]=-1,i&=~o}}function Ek(e){if(K&6)throw Error(p(327));Hk();var i=uc(e,0);if(!(i&1))return Dk(e,B()),null;var s=Ik(e,i);if(e.tag!==0&&s===2){var o=xc(e);o!==0&&(i=o,s=Nk(e,o))}if(s===1)throw s=pk,Kk(e,0),Ck(e,i),Dk(e,B()),s;if(s===6)throw Error(p(345));return e.finishedWork=e.current.alternate,e.finishedLanes=i,Pk(e,tk,uk),Dk(e,B()),null}function Qk(e,i){var s=K;K|=1;try{return e(i)}finally{K=s,K===0&&(Gj=B()+500,fg&&jg())}}function Rk(e){wk!==null&&wk.tag===0&&!(K&6)&&Hk();var i=K;K|=1;var s=ok.transition,o=C;try{if(ok.transition=null,C=1,e)return e()}finally{C=o,ok.transition=s,K=i,!(K&6)&&jg()}}function Hj(){fj=ej.current,E(ej)}function Kk(e,i){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(s!==-1&&(e.timeoutHandle=-1,Gf(s)),Y!==null)for(s=Y.return;s!==null;){var o=s;switch(wg(o),o.tag){case 1:o=o.type.childContextTypes,o!=null&&$f();break;case 3:zh(),E(Wf),E(H),Eh();break;case 5:Bh(o);break;case 4:zh();break;case 13:E(L);break;case 19:E(L);break;case 10:ah(o.type._context);break;case 22:case 23:Hj()}s=s.return}if(Q=e,Y=e=Pg(e.current,null),Z=fj=i,T=0,pk=null,rk=qk=rh=0,tk=sk=null,fh!==null){for(i=0;i<fh.length;i++)if(s=fh[i],o=s.interleaved,o!==null){s.interleaved=null;var a=o.next,h=s.pending;if(h!==null){var _=h.next;h.next=a,o.next=_}s.pending=o}fh=null}return e}function Mk(e,i){do{var s=Y;try{if($g(),Fh.current=Rh,Ih){for(var o=M.memoizedState;o!==null;){var a=o.queue;a!==null&&(a.pending=null),o=o.next}Ih=!1}if(Hh=0,O=N=M=null,Jh=!1,Kh=0,nk.current=null,s===null||s.return===null){T=1,pk=i,Y=null;break}e:{var h=e,_=s.return,g=s,_e=i;if(i=Z,g.flags|=32768,_e!==null&&typeof _e=="object"&&typeof _e.then=="function"){var st=_e,tt=g,at=tt.tag;if(!(tt.mode&1)&&(at===0||at===11||at===15)){var ot=tt.alternate;ot?(tt.updateQueue=ot.updateQueue,tt.memoizedState=ot.memoizedState,tt.lanes=ot.lanes):(tt.updateQueue=null,tt.memoizedState=null)}var lt=Ui(_);if(lt!==null){lt.flags&=-257,Vi(lt,_,g,h,i),lt.mode&1&&Si(h,st,i),i=lt,_e=st;var ct=i.updateQueue;if(ct===null){var $=new Set;$.add(_e),i.updateQueue=$}else ct.add(_e);break e}else{if(!(i&1)){Si(h,st,i),tj();break e}_e=Error(p(426))}}else if(I&&g.mode&1){var c=Ui(_);if(c!==null){!(c.flags&65536)&&(c.flags|=256),Vi(c,_,g,h,i),Jg(Ji(_e,g));break e}}h=_e=Ji(_e,g),T!==4&&(T=2),sk===null?sk=[h]:sk.push(h),h=_;do{switch(h.tag){case 3:h.flags|=65536,i&=-i,h.lanes|=i;var d=Ni(h,_e,i);ph(h,d);break e;case 1:g=_e;var j=h.type,et=h.stateNode;if(!(h.flags&128)&&(typeof j.getDerivedStateFromError=="function"||et!==null&&typeof et.componentDidCatch=="function"&&(Ri===null||!Ri.has(et)))){h.flags|=65536,i&=-i,h.lanes|=i;var nt=Qi(h,g,i);ph(h,nt);break e}}h=h.return}while(h!==null)}Sk(s)}catch(ut){i=ut,Y===s&&s!==null&&(Y=s=s.return);continue}break}while(!0)}function Jk(){var e=mk.current;return mk.current=Rh,e===null?Rh:e}function tj(){(T===0||T===3||T===2)&&(T=4),Q===null||!(rh&268435455)&&!(qk&268435455)||Ck(Q,Z)}function Ik(e,i){var s=K;K|=2;var o=Jk();(Q!==e||Z!==i)&&(uk=null,Kk(e,i));do try{Tk();break}catch(a){Mk(e,a)}while(!0);if($g(),K=s,mk.current=o,Y!==null)throw Error(p(261));return Q=null,Z=0,T}function Tk(){for(;Y!==null;)Uk(Y)}function Lk(){for(;Y!==null&&!cc();)Uk(Y)}function Uk(e){var i=Vk(e.alternate,e,fj);e.memoizedProps=e.pendingProps,i===null?Sk(e):Y=i,nk.current=null}function Sk(e){var i=e;do{var s=i.alternate;if(e=i.return,i.flags&32768){if(s=Ij(s,i),s!==null){s.flags&=32767,Y=s;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{T=6,Y=null;return}}else if(s=Ej(s,i,fj),s!==null){Y=s;return}if(i=i.sibling,i!==null){Y=i;return}Y=i=e}while(i!==null);T===0&&(T=5)}function Pk(e,i,s){var o=C,a=ok.transition;try{ok.transition=null,C=1,Wk(e,i,s,o)}finally{ok.transition=a,C=o}return null}function Wk(e,i,s,o){do Hk();while(wk!==null);if(K&6)throw Error(p(327));s=e.finishedWork;var a=e.finishedLanes;if(s===null)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(p(177));e.callbackNode=null,e.callbackPriority=0;var h=s.lanes|s.childLanes;if(Bc(e,h),e===Q&&(Y=Q=null,Z=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||vk||(vk=!0,Fk(hc,function(){return Hk(),null})),h=(s.flags&15990)!==0,s.subtreeFlags&15990||h){h=ok.transition,ok.transition=null;var _=C;C=1;var g=K;K|=4,nk.current=null,Oj(e,s),dk(s,e),Oe(Df),dd=!!Cf,Df=Cf=null,e.current=s,hk(s),dc(),K=g,C=_,ok.transition=h}else e.current=s;if(vk&&(vk=!1,wk=e,xk=a),h=e.pendingLanes,h===0&&(Ri=null),mc(s.stateNode),Dk(e,B()),i!==null)for(o=e.onRecoverableError,s=0;s<i.length;s++)a=i[s],o(a.value,{componentStack:a.stack,digest:a.digest});if(Oi)throw Oi=!1,e=Pi,Pi=null,e;return xk&1&&e.tag!==0&&Hk(),h=e.pendingLanes,h&1?e===zk?yk++:(yk=0,zk=e):yk=0,jg(),null}function Hk(){if(wk!==null){var e=Dc(xk),i=ok.transition,s=C;try{if(ok.transition=null,C=16>e?16:e,wk===null)var o=!1;else{if(e=wk,wk=null,xk=0,K&6)throw Error(p(331));var a=K;for(K|=4,V=e.current;V!==null;){var h=V,_=h.child;if(V.flags&16){var g=h.deletions;if(g!==null){for(var _e=0;_e<g.length;_e++){var st=g[_e];for(V=st;V!==null;){var tt=V;switch(tt.tag){case 0:case 11:case 15:Pj(8,tt,h)}var at=tt.child;if(at!==null)at.return=tt,V=at;else for(;V!==null;){tt=V;var ot=tt.sibling,lt=tt.return;if(Sj(tt),tt===st){V=null;break}if(ot!==null){ot.return=lt,V=ot;break}V=lt}}}var ct=h.alternate;if(ct!==null){var $=ct.child;if($!==null){ct.child=null;do{var c=$.sibling;$.sibling=null,$=c}while($!==null)}}V=h}}if(h.subtreeFlags&2064&&_!==null)_.return=h,V=_;else e:for(;V!==null;){if(h=V,h.flags&2048)switch(h.tag){case 0:case 11:case 15:Pj(9,h,h.return)}var d=h.sibling;if(d!==null){d.return=h.return,V=d;break e}V=h.return}}var j=e.current;for(V=j;V!==null;){_=V;var et=_.child;if(_.subtreeFlags&2064&&et!==null)et.return=_,V=et;else e:for(_=j;V!==null;){if(g=V,g.flags&2048)try{switch(g.tag){case 0:case 11:case 15:Qj(9,g)}}catch(ut){W(g,g.return,ut)}if(g===_){V=null;break e}var nt=g.sibling;if(nt!==null){nt.return=g.return,V=nt;break e}V=g.return}}if(K=a,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,e)}catch{}o=!0}return o}finally{C=s,ok.transition=i}}return!1}function Xk(e,i,s){i=Ji(s,i),i=Ni(e,i,1),e=nh(e,i,1),i=R(),e!==null&&(Ac(e,1,i),Dk(e,i))}function W(e,i,s){if(e.tag===3)Xk(e,e,s);else for(;i!==null;){if(i.tag===3){Xk(i,e,s);break}else if(i.tag===1){var o=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(Ri===null||!Ri.has(o))){e=Ji(s,e),e=Qi(i,e,1),i=nh(i,e,1),e=R(),i!==null&&(Ac(i,1,e),Dk(i,e));break}}i=i.return}}function Ti(e,i,s){var o=e.pingCache;o!==null&&o.delete(i),i=R(),e.pingedLanes|=e.suspendedLanes&s,Q===e&&(Z&s)===s&&(T===4||T===3&&(Z&130023424)===Z&&500>B()-fk?Kk(e,0):rk|=s),Dk(e,i)}function Yk(e,i){i===0&&(e.mode&1?(i=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):i=1);var s=R();e=ih(e,i),e!==null&&(Ac(e,i,s),Dk(e,s))}function uj(e){var i=e.memoizedState,s=0;i!==null&&(s=i.retryLane),Yk(e,s)}function bk(e,i){var s=0;switch(e.tag){case 13:var o=e.stateNode,a=e.memoizedState;a!==null&&(s=a.retryLane);break;case 19:o=e.stateNode;break;default:throw Error(p(314))}o!==null&&o.delete(i),Yk(e,s)}var Vk;Vk=function(e,i,s){if(e!==null)if(e.memoizedProps!==i.pendingProps||Wf.current)dh=!0;else{if(!(e.lanes&s)&&!(i.flags&128))return dh=!1,yj(e,i,s);dh=!!(e.flags&131072)}else dh=!1,I&&i.flags&1048576&&ug(i,ng,i.index);switch(i.lanes=0,i.tag){case 2:var o=i.type;ij(e,i),e=i.pendingProps;var a=Yf(i,H.current);ch(i,s),a=Nh(null,i,o,e,a,s);var h=Sh();return i.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,Zf(o)?(h=!0,cg(i)):h=!1,i.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,kh(i),a.updater=Ei,i.stateNode=a,a._reactInternals=i,Ii(i,o,e,s),i=jj(null,i,o,!0,h,s)):(i.tag=0,I&&h&&vg(i),Xi(null,i,a,s),i=i.child),i;case 16:o=i.elementType;e:{switch(ij(e,i),e=i.pendingProps,a=o._init,o=a(o._payload),i.type=o,a=i.tag=Zk(o),e=Ci(o,e),a){case 0:i=cj(null,i,o,e,s);break e;case 1:i=hj(null,i,o,e,s);break e;case 11:i=Yi(null,i,o,e,s);break e;case 14:i=$i(null,i,o,Ci(o.type,e),s);break e}throw Error(p(306,o,""))}return i;case 0:return o=i.type,a=i.pendingProps,a=i.elementType===o?a:Ci(o,a),cj(e,i,o,a,s);case 1:return o=i.type,a=i.pendingProps,a=i.elementType===o?a:Ci(o,a),hj(e,i,o,a,s);case 3:e:{if(kj(i),e===null)throw Error(p(387));o=i.pendingProps,h=i.memoizedState,a=h.element,lh(e,i),qh(i,o,null,s);var _=i.memoizedState;if(o=_.element,h.isDehydrated)if(h={element:o,isDehydrated:!1,cache:_.cache,pendingSuspenseBoundaries:_.pendingSuspenseBoundaries,transitions:_.transitions},i.updateQueue.baseState=h,i.memoizedState=h,i.flags&256){a=Ji(Error(p(423)),i),i=lj(e,i,o,s,a);break e}else if(o!==a){a=Ji(Error(p(424)),i),i=lj(e,i,o,s,a);break e}else for(yg=Lf(i.stateNode.containerInfo.firstChild),xg=i,I=!0,zg=null,s=Vg(i,null,o,s),i.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Ig(),o===a){i=Zi(e,i,s);break e}Xi(e,i,o,s)}i=i.child}return i;case 5:return Ah(i),e===null&&Eg(i),o=i.type,a=i.pendingProps,h=e!==null?e.memoizedProps:null,_=a.children,Ef(o,a)?_=null:h!==null&&Ef(o,h)&&(i.flags|=32),gj(e,i),Xi(e,i,_,s),i.child;case 6:return e===null&&Eg(i),null;case 13:return oj(e,i,s);case 4:return yh(i,i.stateNode.containerInfo),o=i.pendingProps,e===null?i.child=Ug(i,null,o,s):Xi(e,i,o,s),i.child;case 11:return o=i.type,a=i.pendingProps,a=i.elementType===o?a:Ci(o,a),Yi(e,i,o,a,s);case 7:return Xi(e,i,i.pendingProps,s),i.child;case 8:return Xi(e,i,i.pendingProps.children,s),i.child;case 12:return Xi(e,i,i.pendingProps.children,s),i.child;case 10:e:{if(o=i.type._context,a=i.pendingProps,h=i.memoizedProps,_=a.value,G(Wg,o._currentValue),o._currentValue=_,h!==null)if(He(h.value,_)){if(h.children===a.children&&!Wf.current){i=Zi(e,i,s);break e}}else for(h=i.child,h!==null&&(h.return=i);h!==null;){var g=h.dependencies;if(g!==null){_=h.child;for(var _e=g.firstContext;_e!==null;){if(_e.context===o){if(h.tag===1){_e=mh(-1,s&-s),_e.tag=2;var st=h.updateQueue;if(st!==null){st=st.shared;var tt=st.pending;tt===null?_e.next=_e:(_e.next=tt.next,tt.next=_e),st.pending=_e}}h.lanes|=s,_e=h.alternate,_e!==null&&(_e.lanes|=s),bh(h.return,s,i),g.lanes|=s;break}_e=_e.next}}else if(h.tag===10)_=h.type===i.type?null:h.child;else if(h.tag===18){if(_=h.return,_===null)throw Error(p(341));_.lanes|=s,g=_.alternate,g!==null&&(g.lanes|=s),bh(_,s,i),_=h.sibling}else _=h.child;if(_!==null)_.return=h;else for(_=h;_!==null;){if(_===i){_=null;break}if(h=_.sibling,h!==null){h.return=_.return,_=h;break}_=_.return}h=_}Xi(e,i,a.children,s),i=i.child}return i;case 9:return a=i.type,o=i.pendingProps.children,ch(i,s),a=eh(a),o=o(a),i.flags|=1,Xi(e,i,o,s),i.child;case 14:return o=i.type,a=Ci(o,i.pendingProps),a=Ci(o.type,a),$i(e,i,o,a,s);case 15:return bj(e,i,i.type,i.pendingProps,s);case 17:return o=i.type,a=i.pendingProps,a=i.elementType===o?a:Ci(o,a),ij(e,i),i.tag=1,Zf(o)?(e=!0,cg(i)):e=!1,ch(i,s),Gi(i,o,a),Ii(i,o,a,s),jj(null,i,o,!0,e,s);case 19:return xj(e,i,s);case 22:return dj(e,i,s)}throw Error(p(156,i.tag))};function Fk(e,i){return ac(e,i)}function $k(e,i,s,o){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(e,i,s,o){return new $k(e,i,s,o)}function aj(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Zk(e){if(typeof e=="function")return aj(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Da)return 11;if(e===Ga)return 14}return 2}function Pg(e,i){var s=e.alternate;return s===null?(s=Bg(e.tag,i,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=i,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&14680064,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,i=e.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function Rg(e,i,s,o,a,h){var _=2;if(o=e,typeof e=="function")aj(e)&&(_=1);else if(typeof e=="string")_=5;else e:switch(e){case ya:return Tg(s.children,a,h,i);case za:_=8,a|=8;break;case Aa:return e=Bg(12,s,i,a|2),e.elementType=Aa,e.lanes=h,e;case Ea:return e=Bg(13,s,i,a),e.elementType=Ea,e.lanes=h,e;case Fa:return e=Bg(19,s,i,a),e.elementType=Fa,e.lanes=h,e;case Ia:return pj(s,a,h,i);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ba:_=10;break e;case Ca:_=9;break e;case Da:_=11;break e;case Ga:_=14;break e;case Ha:_=16,o=null;break e}throw Error(p(130,e==null?e:typeof e,""))}return i=Bg(_,s,i,a),i.elementType=e,i.type=o,i.lanes=h,i}function Tg(e,i,s,o){return e=Bg(7,e,o,i),e.lanes=s,e}function pj(e,i,s,o){return e=Bg(22,e,o,i),e.elementType=Ia,e.lanes=s,e.stateNode={isHidden:!1},e}function Qg(e,i,s){return e=Bg(6,e,null,i),e.lanes=s,e}function Sg(e,i,s){return i=Bg(4,e.children!==null?e.children:[],e.key,i),i.lanes=s,i.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},i}function al(e,i,s,o,a){this.tag=i,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=o,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function bl(e,i,s,o,a,h,_,g,_e){return e=new al(e,i,s,g,_e),i===1?(i=1,h===!0&&(i|=8)):i=0,h=Bg(3,null,null,i),e.current=h,h.stateNode=e,h.memoizedState={element:o,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh(h),e}function cl(e,i,s){var o=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:o==null?null:""+o,children:e,containerInfo:i,implementation:s}}function dl(e){if(!e)return Vf;e=e._reactInternals;e:{if(Vb(e)!==e||e.tag!==1)throw Error(p(170));var i=e;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(Zf(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(p(171))}if(e.tag===1){var s=e.type;if(Zf(s))return bg(e,s,i)}return i}function el(e,i,s,o,a,h,_,g,_e){return e=bl(s,o,!0,e,a,h,_,g,_e),e.context=dl(null),s=e.current,o=R(),a=yi(s),h=mh(o,a),h.callback=i??null,nh(s,h,a),e.current.lanes=a,Ac(e,a,o),Dk(e,o),e}function fl(e,i,s,o){var a=i.current,h=R(),_=yi(a);return s=dl(s),i.context===null?i.context=s:i.pendingContext=s,i=mh(h,_),i.payload={element:e},o=o===void 0?null:o,o!==null&&(i.callback=o),e=nh(a,i,_),e!==null&&(gi(e,a,_,h),oh(e,a,_)),_}function gl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function hl(e,i){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<i?s:i}}function il(e,i){hl(e,i),(e=e.alternate)&&hl(e,i)}function jl(){return null}var kl=typeof reportError=="function"?reportError:function(e){console.error(e)};function ll(e){this._internalRoot=e}ml.prototype.render=ll.prototype.render=function(e){var i=this._internalRoot;if(i===null)throw Error(p(409));fl(e,i,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var i=e.containerInfo;Rk(function(){fl(null,e,null,null)}),i[uf]=null}};function ml(e){this._internalRoot=e}ml.prototype.unstable_scheduleHydration=function(e){if(e){var i=Hc();e={blockedOn:null,target:e,priority:i};for(var s=0;s<Qc.length&&i!==0&&i<Qc[s].priority;s++);Qc.splice(s,0,e),s===0&&Vc(e)}};function nl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ol(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function pl(){}function ql(e,i,s,o,a){if(a){if(typeof o=="function"){var h=o;o=function(){var st=gl(_);h.call(st)}}var _=el(i,o,e,0,null,!1,!1,"",pl);return e._reactRootContainer=_,e[uf]=_.current,sf(e.nodeType===8?e.parentNode:e),Rk(),_}for(;a=e.lastChild;)e.removeChild(a);if(typeof o=="function"){var g=o;o=function(){var st=gl(_e);g.call(st)}}var _e=bl(e,0,!1,null,null,!1,!1,"",pl);return e._reactRootContainer=_e,e[uf]=_e.current,sf(e.nodeType===8?e.parentNode:e),Rk(function(){fl(i,_e,s,o)}),_e}function rl(e,i,s,o,a){var h=s._reactRootContainer;if(h){var _=h;if(typeof a=="function"){var g=a;a=function(){var _e=gl(_);g.call(_e)}}fl(i,_,e,a)}else _=ql(s,i,e,a,o);return gl(_)}Ec=function(e){switch(e.tag){case 3:var i=e.stateNode;if(i.current.memoizedState.isDehydrated){var s=tc(i.pendingLanes);s!==0&&(Cc(i,s|1),Dk(i,B()),!(K&6)&&(Gj=B()+500,jg()))}break;case 13:Rk(function(){var o=ih(e,1);if(o!==null){var a=R();gi(o,e,1,a)}}),il(e,1)}};Fc=function(e){if(e.tag===13){var i=ih(e,134217728);if(i!==null){var s=R();gi(i,e,134217728,s)}il(e,134217728)}};Gc=function(e){if(e.tag===13){var i=yi(e),s=ih(e,i);if(s!==null){var o=R();gi(s,e,i,o)}il(e,i)}};Hc=function(){return C};Ic=function(e,i){var s=C;try{return C=e,i()}finally{C=s}};yb=function(e,i,s){switch(i){case"input":if(bb(e,s),i=s.name,s.type==="radio"&&i!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<s.length;i++){var o=s[i];if(o!==e&&o.form===e.form){var a=Db(o);if(!a)throw Error(p(90));Wa(o),bb(o,a)}}}break;case"textarea":ib(e,s);break;case"select":i=s.value,i!=null&&fb(e,!!s.multiple,i,!1)}};Gb=Qk;Hb=Rk;var sl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Zb(e),e===null?null:e.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||jl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;reactDom_production_min.createPortal=function(e,i){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl(i))throw Error(p(200));return cl(e,i,null,s)};reactDom_production_min.createRoot=function(e,i){if(!nl(e))throw Error(p(299));var s=!1,o="",a=kl;return i!=null&&(i.unstable_strictMode===!0&&(s=!0),i.identifierPrefix!==void 0&&(o=i.identifierPrefix),i.onRecoverableError!==void 0&&(a=i.onRecoverableError)),i=bl(e,1,!1,null,null,s,!1,o,a),e[uf]=i.current,sf(e.nodeType===8?e.parentNode:e),new ll(i)};reactDom_production_min.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var i=e._reactInternals;if(i===void 0)throw typeof e.render=="function"?Error(p(188)):(e=Object.keys(e).join(","),Error(p(268,e)));return e=Zb(i),e=e===null?null:e.stateNode,e};reactDom_production_min.flushSync=function(e){return Rk(e)};reactDom_production_min.hydrate=function(e,i,s){if(!ol(i))throw Error(p(200));return rl(null,e,i,!0,s)};reactDom_production_min.hydrateRoot=function(e,i,s){if(!nl(e))throw Error(p(405));var o=s!=null&&s.hydratedSources||null,a=!1,h="",_=kl;if(s!=null&&(s.unstable_strictMode===!0&&(a=!0),s.identifierPrefix!==void 0&&(h=s.identifierPrefix),s.onRecoverableError!==void 0&&(_=s.onRecoverableError)),i=el(i,null,e,1,s??null,a,!1,h,_),e[uf]=i.current,sf(e),o)for(e=0;e<o.length;e++)s=o[e],a=s._getVersion,a=a(s._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[s,a]:i.mutableSourceEagerHydrationData.push(s,a);return new ml(i)};reactDom_production_min.render=function(e,i,s){if(!ol(i))throw Error(p(200));return rl(null,e,i,!1,s)};reactDom_production_min.unmountComponentAtNode=function(e){if(!ol(e))throw Error(p(40));return e._reactRootContainer?(Rk(function(){rl(null,null,e,!1,function(){e._reactRootContainer=null,e[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(e,i,s,o){if(!ol(s))throw Error(p(200));if(e==null||e._reactInternals===void 0)throw Error(p(38));return rl(e,i,s,!1,o)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(e){console.error(e)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports,m=reactDomExports;client.createRoot=m.createRoot,client.hydrateRoot=m.hydrateRoot;const Navbar=({currentSection:e,onNavigate:i})=>{const[s,o]=reactExports.useState(!1),a=[{id:"overview",label:"Overview"},{id:"interactive",label:"Interactive Demo"}];return jsxRuntimeExports.jsxs("nav",{className:"fixed top-0 left-0 right-0 z-50 glass-morphism border-b border-white/10",children:[jsxRuntimeExports.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between h-16",children:[jsxRuntimeExports.jsx("div",{className:"flex items-center",children:jsxRuntimeExports.jsxs("div",{className:"flex-shrink-0",children:[jsxRuntimeExports.jsx("h1",{className:"text-xl font-bold bg-gradient-to-r from-blue-400 to-purple-600 bg-clip-text text-transparent",children:"SILCS FragMaps Demo"}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-400",children:"P38 MAP Kinase"})]})}),jsxRuntimeExports.jsx("div",{className:"hidden md:block",children:jsxRuntimeExports.jsx("div",{className:"ml-10 flex items-baseline space-x-4",children:a.map(h=>jsxRuntimeExports.jsx("button",{onClick:()=>i(h.id),className:`px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 ${e===h.id?"bg-white/20 text-white border border-white/30":"text-gray-300 hover:bg-white/10 hover:text-white"}`,children:h.label},h.id))})}),jsxRuntimeExports.jsx("div",{className:"md:hidden",children:jsxRuntimeExports.jsx("button",{onClick:()=>o(!s),className:"inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-white hover:bg-white/10 focus:outline-none",children:jsxRuntimeExports.jsx("svg",{className:"h-6 w-6",stroke:"currentColor",fill:"none",viewBox:"0 0 24 24",children:s?jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})})]})}),s&&jsxRuntimeExports.jsx("div",{className:"md:hidden glass-morphism border-t border-white/10",children:jsxRuntimeExports.jsx("div",{className:"px-2 pt-2 pb-3 space-y-1 sm:px-3",children:a.map(h=>jsxRuntimeExports.jsx("button",{onClick:()=>{i(h.id),o(!1)},className:`block px-3 py-2 rounded-md text-base font-medium w-full text-left ${e===h.id?"bg-white/20 text-white border border-white/30":"text-gray-300 hover:bg-white/10 hover:text-white"}`,children:h.label},h.id))})})]})},LayoutGroupContext=reactExports.createContext({});function useConstant(e){const i=reactExports.useRef(null);return i.current===null&&(i.current=e()),i.current}const isBrowser$1=typeof window<"u",useIsomorphicLayoutEffect=isBrowser$1?reactExports.useLayoutEffect:reactExports.useEffect,PresenceContext=reactExports.createContext(null);function addUniqueItem(e,i){e.indexOf(i)===-1&&e.push(i)}function removeItem(e,i){const s=e.indexOf(i);s>-1&&e.splice(s,1)}const clamp=(e,i,s)=>s>i?i:s<e?e:s;let invariant=()=>{};const MotionGlobalConfig={},isNumericalString=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function isObject(e){return typeof e=="object"&&e!==null}const isZeroValueString=e=>/^0[^.\s]+$/u.test(e);function memo(e){let i;return()=>(i===void 0&&(i=e()),i)}const noop=e=>e,combineFunctions=(e,i)=>s=>i(e(s)),pipe=(...e)=>e.reduce(combineFunctions),progress=(e,i,s)=>{const o=i-e;return o===0?1:(s-e)/o};class SubscriptionManager{constructor(){this.subscriptions=[]}add(i){return addUniqueItem(this.subscriptions,i),()=>removeItem(this.subscriptions,i)}notify(i,s,o){const a=this.subscriptions.length;if(a)if(a===1)this.subscriptions[0](i,s,o);else for(let h=0;h<a;h++){const _=this.subscriptions[h];_&&_(i,s,o)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const secondsToMilliseconds=e=>e*1e3,millisecondsToSeconds=e=>e/1e3;function velocityPerSecond(e,i){return i?e*(1e3/i):0}const calcBezier=(e,i,s)=>(((1-3*s+3*i)*e+(3*s-6*i))*e+3*i)*e,subdivisionPrecision=1e-7,subdivisionMaxIterations=12;function binarySubdivide(e,i,s,o,a){let h,_,g=0;do _=i+(s-i)/2,h=calcBezier(_,o,a)-e,h>0?s=_:i=_;while(Math.abs(h)>subdivisionPrecision&&++g<subdivisionMaxIterations);return _}function cubicBezier(e,i,s,o){if(e===i&&s===o)return noop;const a=h=>binarySubdivide(h,0,1,e,s);return h=>h===0||h===1?h:calcBezier(a(h),i,o)}const mirrorEasing=e=>i=>i<=.5?e(2*i)/2:(2-e(2*(1-i)))/2,reverseEasing=e=>i=>1-e(1-i),backOut=cubicBezier(.33,1.53,.69,.99),backIn=reverseEasing(backOut),backInOut=mirrorEasing(backIn),anticipate=e=>(e*=2)<1?.5*backIn(e):.5*(2-Math.pow(2,-10*(e-1))),circIn=e=>1-Math.sin(Math.acos(e)),circOut=reverseEasing(circIn),circInOut=mirrorEasing(circIn),easeIn=cubicBezier(.42,0,1,1),easeOut=cubicBezier(0,0,.58,1),easeInOut=cubicBezier(.42,0,.58,1),isEasingArray=e=>Array.isArray(e)&&typeof e[0]!="number",isBezierDefinition=e=>Array.isArray(e)&&typeof e[0]=="number",easingLookup={linear:noop,easeIn,easeInOut,easeOut,circIn,circInOut,circOut,backIn,backInOut,backOut,anticipate},isValidEasing=e=>typeof e=="string",easingDefinitionToFunction=e=>{if(isBezierDefinition(e)){invariant(e.length===4);const[i,s,o,a]=e;return cubicBezier(i,s,o,a)}else if(isValidEasing(e))return easingLookup[e];return e},stepsOrder=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function createRenderStep(e,i){let s=new Set,o=new Set,a=!1,h=!1;const _=new WeakSet;let g={delta:0,timestamp:0,isProcessing:!1};function _e(tt){_.has(tt)&&(st.schedule(tt),e()),tt(g)}const st={schedule:(tt,at=!1,ot=!1)=>{const ct=ot&&a?s:o;return at&&_.add(tt),ct.has(tt)||ct.add(tt),tt},cancel:tt=>{o.delete(tt),_.delete(tt)},process:tt=>{if(g=tt,a){h=!0;return}a=!0,[s,o]=[o,s],s.forEach(_e),s.clear(),a=!1,h&&(h=!1,st.process(tt))}};return st}const maxElapsed=40;function createRenderBatcher(e,i){let s=!1,o=!0;const a={delta:0,timestamp:0,isProcessing:!1},h=()=>s=!0,_=stepsOrder.reduce((et,nt)=>(et[nt]=createRenderStep(h),et),{}),{setup:g,read:_e,resolveKeyframes:st,preUpdate:tt,update:at,preRender:ot,render:lt,postRender:ct}=_,$=()=>{const et=MotionGlobalConfig.useManualTiming?a.timestamp:performance.now();s=!1,MotionGlobalConfig.useManualTiming||(a.delta=o?1e3/60:Math.max(Math.min(et-a.timestamp,maxElapsed),1)),a.timestamp=et,a.isProcessing=!0,g.process(a),_e.process(a),st.process(a),tt.process(a),at.process(a),ot.process(a),lt.process(a),ct.process(a),a.isProcessing=!1,s&&i&&(o=!1,e($))},c=()=>{s=!0,o=!0,a.isProcessing||e($)};return{schedule:stepsOrder.reduce((et,nt)=>{const ut=_[nt];return et[nt]=(b,it=!1,rt=!1)=>(s||c(),ut.schedule(b,it,rt)),et},{}),cancel:et=>{for(let nt=0;nt<stepsOrder.length;nt++)_[stepsOrder[nt]].cancel(et)},state:a,steps:_}}const{schedule:frame,cancel:cancelFrame,state:frameData,steps:frameSteps}=createRenderBatcher(typeof requestAnimationFrame<"u"?requestAnimationFrame:noop,!0);let now;function clearTime(){now=void 0}const time={now:()=>(now===void 0&&time.set(frameData.isProcessing||MotionGlobalConfig.useManualTiming?frameData.timestamp:performance.now()),now),set:e=>{now=e,queueMicrotask(clearTime)}},checkStringStartsWith=e=>i=>typeof i=="string"&&i.startsWith(e),isCSSVariableName=checkStringStartsWith("--"),startsAsVariableToken=checkStringStartsWith("var(--"),isCSSVariableToken=e=>startsAsVariableToken(e)?singleCssVariableRegex.test(e.split("/*")[0].trim()):!1,singleCssVariableRegex=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function containsCSSVariable(e){return typeof e!="string"?!1:e.split("/*")[0].includes("var(--")}const number={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},alpha={...number,transform:e=>clamp(0,1,e)},scale={...number,default:1},sanitize=e=>Math.round(e*1e5)/1e5,floatRegex=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function isNullish(e){return e==null}const singleColorRegex=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,isColorString=(e,i)=>s=>!!(typeof s=="string"&&singleColorRegex.test(s)&&s.startsWith(e)||i&&!isNullish(s)&&Object.prototype.hasOwnProperty.call(s,i)),splitColor=(e,i,s)=>o=>{if(typeof o!="string")return o;const[a,h,_,g]=o.match(floatRegex);return{[e]:parseFloat(a),[i]:parseFloat(h),[s]:parseFloat(_),alpha:g!==void 0?parseFloat(g):1}},clampRgbUnit=e=>clamp(0,255,e),rgbUnit={...number,transform:e=>Math.round(clampRgbUnit(e))},rgba={test:isColorString("rgb","red"),parse:splitColor("red","green","blue"),transform:({red:e,green:i,blue:s,alpha:o=1})=>"rgba("+rgbUnit.transform(e)+", "+rgbUnit.transform(i)+", "+rgbUnit.transform(s)+", "+sanitize(alpha.transform(o))+")"};function parseHex(e){let i="",s="",o="",a="";return e.length>5?(i=e.substring(1,3),s=e.substring(3,5),o=e.substring(5,7),a=e.substring(7,9)):(i=e.substring(1,2),s=e.substring(2,3),o=e.substring(3,4),a=e.substring(4,5),i+=i,s+=s,o+=o,a+=a),{red:parseInt(i,16),green:parseInt(s,16),blue:parseInt(o,16),alpha:a?parseInt(a,16)/255:1}}const hex={test:isColorString("#"),parse:parseHex,transform:rgba.transform},createUnitType=e=>({test:i=>typeof i=="string"&&i.endsWith(e)&&i.split(" ").length===1,parse:parseFloat,transform:i=>`${i}${e}`}),degrees=createUnitType("deg"),percent=createUnitType("%"),px=createUnitType("px"),vh=createUnitType("vh"),vw=createUnitType("vw"),progressPercentage={...percent,parse:e=>percent.parse(e)/100,transform:e=>percent.transform(e*100)},hsla={test:isColorString("hsl","hue"),parse:splitColor("hue","saturation","lightness"),transform:({hue:e,saturation:i,lightness:s,alpha:o=1})=>"hsla("+Math.round(e)+", "+percent.transform(sanitize(i))+", "+percent.transform(sanitize(s))+", "+sanitize(alpha.transform(o))+")"},color={test:e=>rgba.test(e)||hex.test(e)||hsla.test(e),parse:e=>rgba.test(e)?rgba.parse(e):hsla.test(e)?hsla.parse(e):hex.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?rgba.transform(e):hsla.transform(e),getAnimatableNone:e=>{const i=color.parse(e);return i.alpha=0,color.transform(i)}},colorRegex=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function test(e){var i,s;return isNaN(e)&&typeof e=="string"&&(((i=e.match(floatRegex))==null?void 0:i.length)||0)+(((s=e.match(colorRegex))==null?void 0:s.length)||0)>0}const NUMBER_TOKEN="number",COLOR_TOKEN="color",VAR_TOKEN="var",VAR_FUNCTION_TOKEN="var(",SPLIT_TOKEN="${}",complexRegex=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function analyseComplexValue(e){const i=e.toString(),s=[],o={color:[],number:[],var:[]},a=[];let h=0;const g=i.replace(complexRegex,_e=>(color.test(_e)?(o.color.push(h),a.push(COLOR_TOKEN),s.push(color.parse(_e))):_e.startsWith(VAR_FUNCTION_TOKEN)?(o.var.push(h),a.push(VAR_TOKEN),s.push(_e)):(o.number.push(h),a.push(NUMBER_TOKEN),s.push(parseFloat(_e))),++h,SPLIT_TOKEN)).split(SPLIT_TOKEN);return{values:s,split:g,indexes:o,types:a}}function parseComplexValue(e){return analyseComplexValue(e).values}function createTransformer(e){const{split:i,types:s}=analyseComplexValue(e),o=i.length;return a=>{let h="";for(let _=0;_<o;_++)if(h+=i[_],a[_]!==void 0){const g=s[_];g===NUMBER_TOKEN?h+=sanitize(a[_]):g===COLOR_TOKEN?h+=color.transform(a[_]):h+=a[_]}return h}}const convertNumbersToZero=e=>typeof e=="number"?0:color.test(e)?color.getAnimatableNone(e):e;function getAnimatableNone$1(e){const i=parseComplexValue(e);return createTransformer(e)(i.map(convertNumbersToZero))}const complex={test,parse:parseComplexValue,createTransformer,getAnimatableNone:getAnimatableNone$1};function hueToRgb(e,i,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?e+(i-e)*6*s:s<1/2?i:s<2/3?e+(i-e)*(2/3-s)*6:e}function hslaToRgba({hue:e,saturation:i,lightness:s,alpha:o}){e/=360,i/=100,s/=100;let a=0,h=0,_=0;if(!i)a=h=_=s;else{const g=s<.5?s*(1+i):s+i-s*i,_e=2*s-g;a=hueToRgb(_e,g,e+1/3),h=hueToRgb(_e,g,e),_=hueToRgb(_e,g,e-1/3)}return{red:Math.round(a*255),green:Math.round(h*255),blue:Math.round(_*255),alpha:o}}function mixImmediate(e,i){return s=>s>0?i:e}const mixNumber$1=(e,i,s)=>e+(i-e)*s,mixLinearColor=(e,i,s)=>{const o=e*e,a=s*(i*i-o)+o;return a<0?0:Math.sqrt(a)},colorTypes=[hex,rgba,hsla],getColorType=e=>colorTypes.find(i=>i.test(e));function asRGBA(e){const i=getColorType(e);if(!i)return!1;let s=i.parse(e);return i===hsla&&(s=hslaToRgba(s)),s}const mixColor=(e,i)=>{const s=asRGBA(e),o=asRGBA(i);if(!s||!o)return mixImmediate(e,i);const a={...s};return h=>(a.red=mixLinearColor(s.red,o.red,h),a.green=mixLinearColor(s.green,o.green,h),a.blue=mixLinearColor(s.blue,o.blue,h),a.alpha=mixNumber$1(s.alpha,o.alpha,h),rgba.transform(a))},invisibleValues=new Set(["none","hidden"]);function mixVisibility(e,i){return invisibleValues.has(e)?s=>s<=0?e:i:s=>s>=1?i:e}function mixNumber(e,i){return s=>mixNumber$1(e,i,s)}function getMixer(e){return typeof e=="number"?mixNumber:typeof e=="string"?isCSSVariableToken(e)?mixImmediate:color.test(e)?mixColor:mixComplex:Array.isArray(e)?mixArray:typeof e=="object"?color.test(e)?mixColor:mixObject:mixImmediate}function mixArray(e,i){const s=[...e],o=s.length,a=e.map((h,_)=>getMixer(h)(h,i[_]));return h=>{for(let _=0;_<o;_++)s[_]=a[_](h);return s}}function mixObject(e,i){const s={...e,...i},o={};for(const a in s)e[a]!==void 0&&i[a]!==void 0&&(o[a]=getMixer(e[a])(e[a],i[a]));return a=>{for(const h in o)s[h]=o[h](a);return s}}function matchOrder(e,i){const s=[],o={color:0,var:0,number:0};for(let a=0;a<i.values.length;a++){const h=i.types[a],_=e.indexes[h][o[h]],g=e.values[_]??0;s[a]=g,o[h]++}return s}const mixComplex=(e,i)=>{const s=complex.createTransformer(i),o=analyseComplexValue(e),a=analyseComplexValue(i);return o.indexes.var.length===a.indexes.var.length&&o.indexes.color.length===a.indexes.color.length&&o.indexes.number.length>=a.indexes.number.length?invisibleValues.has(e)&&!a.values.length||invisibleValues.has(i)&&!o.values.length?mixVisibility(e,i):pipe(mixArray(matchOrder(o,a),a.values),s):mixImmediate(e,i)};function mix(e,i,s){return typeof e=="number"&&typeof i=="number"&&typeof s=="number"?mixNumber$1(e,i,s):getMixer(e)(e,i)}const frameloopDriver=e=>{const i=({timestamp:s})=>e(s);return{start:(s=!0)=>frame.update(i,s),stop:()=>cancelFrame(i),now:()=>frameData.isProcessing?frameData.timestamp:time.now()}},generateLinearEasing=(e,i,s=10)=>{let o="";const a=Math.max(Math.round(i/s),2);for(let h=0;h<a;h++)o+=Math.round(e(h/(a-1))*1e4)/1e4+", ";return`linear(${o.substring(0,o.length-2)})`},maxGeneratorDuration=2e4;function calcGeneratorDuration(e){let i=0;const s=50;let o=e.next(i);for(;!o.done&&i<maxGeneratorDuration;)i+=s,o=e.next(i);return i>=maxGeneratorDuration?1/0:i}function createGeneratorEasing(e,i=100,s){const o=s({...e,keyframes:[0,i]}),a=Math.min(calcGeneratorDuration(o),maxGeneratorDuration);return{type:"keyframes",ease:h=>o.next(a*h).value/i,duration:millisecondsToSeconds(a)}}const velocitySampleDuration=5;function calcGeneratorVelocity(e,i,s){const o=Math.max(i-velocitySampleDuration,0);return velocityPerSecond(s-e(o),i-o)}const springDefaults={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},safeMin=.001;function findSpring({duration:e=springDefaults.duration,bounce:i=springDefaults.bounce,velocity:s=springDefaults.velocity,mass:o=springDefaults.mass}){let a,h,_=1-i;_=clamp(springDefaults.minDamping,springDefaults.maxDamping,_),e=clamp(springDefaults.minDuration,springDefaults.maxDuration,millisecondsToSeconds(e)),_<1?(a=st=>{const tt=st*_,at=tt*e,ot=tt-s,lt=calcAngularFreq(st,_),ct=Math.exp(-at);return safeMin-ot/lt*ct},h=st=>{const at=st*_*e,ot=at*s+s,lt=Math.pow(_,2)*Math.pow(st,2)*e,ct=Math.exp(-at),$=calcAngularFreq(Math.pow(st,2),_);return(-a(st)+safeMin>0?-1:1)*((ot-lt)*ct)/$}):(a=st=>{const tt=Math.exp(-st*e),at=(st-s)*e+1;return-safeMin+tt*at},h=st=>{const tt=Math.exp(-st*e),at=(s-st)*(e*e);return tt*at});const g=5/e,_e=approximateRoot(a,h,g);if(e=secondsToMilliseconds(e),isNaN(_e))return{stiffness:springDefaults.stiffness,damping:springDefaults.damping,duration:e};{const st=Math.pow(_e,2)*o;return{stiffness:st,damping:_*2*Math.sqrt(o*st),duration:e}}}const rootIterations=12;function approximateRoot(e,i,s){let o=s;for(let a=1;a<rootIterations;a++)o=o-e(o)/i(o);return o}function calcAngularFreq(e,i){return e*Math.sqrt(1-i*i)}const durationKeys=["duration","bounce"],physicsKeys=["stiffness","damping","mass"];function isSpringType(e,i){return i.some(s=>e[s]!==void 0)}function getSpringOptions(e){let i={velocity:springDefaults.velocity,stiffness:springDefaults.stiffness,damping:springDefaults.damping,mass:springDefaults.mass,isResolvedFromDuration:!1,...e};if(!isSpringType(e,physicsKeys)&&isSpringType(e,durationKeys))if(e.visualDuration){const s=e.visualDuration,o=2*Math.PI/(s*1.2),a=o*o,h=2*clamp(.05,1,1-(e.bounce||0))*Math.sqrt(a);i={...i,mass:springDefaults.mass,stiffness:a,damping:h}}else{const s=findSpring(e);i={...i,...s,mass:springDefaults.mass},i.isResolvedFromDuration=!0}return i}function spring(e=springDefaults.visualDuration,i=springDefaults.bounce){const s=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:i}:e;let{restSpeed:o,restDelta:a}=s;const h=s.keyframes[0],_=s.keyframes[s.keyframes.length-1],g={done:!1,value:h},{stiffness:_e,damping:st,mass:tt,duration:at,velocity:ot,isResolvedFromDuration:lt}=getSpringOptions({...s,velocity:-millisecondsToSeconds(s.velocity||0)}),ct=ot||0,$=st/(2*Math.sqrt(_e*tt)),c=_-h,d=millisecondsToSeconds(Math.sqrt(_e/tt)),j=Math.abs(c)<5;o||(o=j?springDefaults.restSpeed.granular:springDefaults.restSpeed.default),a||(a=j?springDefaults.restDelta.granular:springDefaults.restDelta.default);let et;if($<1){const ut=calcAngularFreq(d,$);et=b=>{const it=Math.exp(-$*d*b);return _-it*((ct+$*d*c)/ut*Math.sin(ut*b)+c*Math.cos(ut*b))}}else if($===1)et=ut=>_-Math.exp(-d*ut)*(c+(ct+d*c)*ut);else{const ut=d*Math.sqrt($*$-1);et=b=>{const it=Math.exp(-$*d*b),rt=Math.min(ut*b,300);return _-it*((ct+$*d*c)*Math.sinh(rt)+ut*c*Math.cosh(rt))/ut}}const nt={calculatedDuration:lt&&at||null,next:ut=>{const b=et(ut);if(lt)g.done=ut>=at;else{let it=ut===0?ct:0;$<1&&(it=ut===0?secondsToMilliseconds(ct):calcGeneratorVelocity(et,ut,b));const rt=Math.abs(it)<=o,dt=Math.abs(_-b)<=a;g.done=rt&&dt}return g.value=g.done?_:b,g},toString:()=>{const ut=Math.min(calcGeneratorDuration(nt),maxGeneratorDuration),b=generateLinearEasing(it=>nt.next(ut*it).value,ut,30);return ut+"ms "+b},toTransition:()=>{}};return nt}spring.applyToOptions=e=>{const i=createGeneratorEasing(e,100,spring);return e.ease=i.ease,e.duration=secondsToMilliseconds(i.duration),e.type="keyframes",e};function inertia({keyframes:e,velocity:i=0,power:s=.8,timeConstant:o=325,bounceDamping:a=10,bounceStiffness:h=500,modifyTarget:_,min:g,max:_e,restDelta:st=.5,restSpeed:tt}){const at=e[0],ot={done:!1,value:at},lt=rt=>g!==void 0&&rt<g||_e!==void 0&&rt>_e,ct=rt=>g===void 0?_e:_e===void 0||Math.abs(g-rt)<Math.abs(_e-rt)?g:_e;let $=s*i;const c=at+$,d=_===void 0?c:_(c);d!==c&&($=d-at);const j=rt=>-$*Math.exp(-rt/o),et=rt=>d+j(rt),nt=rt=>{const dt=j(rt),ft=et(rt);ot.done=Math.abs(dt)<=st,ot.value=ot.done?d:ft};let ut,b;const it=rt=>{lt(ot.value)&&(ut=rt,b=spring({keyframes:[ot.value,ct(ot.value)],velocity:calcGeneratorVelocity(et,rt,ot.value),damping:a,stiffness:h,restDelta:st,restSpeed:tt}))};return it(0),{calculatedDuration:null,next:rt=>{let dt=!1;return!b&&ut===void 0&&(dt=!0,nt(rt),it(rt)),ut!==void 0&&rt>=ut?b.next(rt-ut):(!dt&&nt(rt),ot)}}}function createMixers(e,i,s){const o=[],a=s||MotionGlobalConfig.mix||mix,h=e.length-1;for(let _=0;_<h;_++){let g=a(e[_],e[_+1]);if(i){const _e=Array.isArray(i)?i[_]||noop:i;g=pipe(_e,g)}o.push(g)}return o}function interpolate(e,i,{clamp:s=!0,ease:o,mixer:a}={}){const h=e.length;if(invariant(h===i.length),h===1)return()=>i[0];if(h===2&&i[0]===i[1])return()=>i[1];const _=e[0]===e[1];e[0]>e[h-1]&&(e=[...e].reverse(),i=[...i].reverse());const g=createMixers(i,o,a),_e=g.length,st=tt=>{if(_&&tt<e[0])return i[0];let at=0;if(_e>1)for(;at<e.length-2&&!(tt<e[at+1]);at++);const ot=progress(e[at],e[at+1],tt);return g[at](ot)};return s?tt=>st(clamp(e[0],e[h-1],tt)):st}function fillOffset(e,i){const s=e[e.length-1];for(let o=1;o<=i;o++){const a=progress(0,i,o);e.push(mixNumber$1(s,1,a))}}function defaultOffset(e){const i=[0];return fillOffset(i,e.length-1),i}function convertOffsetToTimes(e,i){return e.map(s=>s*i)}function defaultEasing(e,i){return e.map(()=>i||easeInOut).splice(0,e.length-1)}function keyframes({duration:e=300,keyframes:i,times:s,ease:o="easeInOut"}){const a=isEasingArray(o)?o.map(easingDefinitionToFunction):easingDefinitionToFunction(o),h={done:!1,value:i[0]},_=convertOffsetToTimes(s&&s.length===i.length?s:defaultOffset(i),e),g=interpolate(_,i,{ease:Array.isArray(a)?a:defaultEasing(i,a)});return{calculatedDuration:e,next:_e=>(h.value=g(_e),h.done=_e>=e,h)}}const isNotNull$1=e=>e!==null;function getFinalKeyframe$1(e,{repeat:i,repeatType:s="loop"},o,a=1){const h=e.filter(isNotNull$1),g=a<0||i&&s!=="loop"&&i%2===1?0:h.length-1;return!g||o===void 0?h[g]:o}const transitionTypeMap={decay:inertia,inertia,tween:keyframes,keyframes,spring};function replaceTransitionType(e){typeof e.type=="string"&&(e.type=transitionTypeMap[e.type])}class WithPromise{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(i=>{this.resolve=i})}notifyFinished(){this.resolve()}then(i,s){return this.finished.then(i,s)}}const percentToProgress=e=>e/100;class JSAnimation extends WithPromise{constructor(i){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var o,a;const{motionValue:s}=this.options;s&&s.updatedAt!==time.now()&&this.tick(time.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(a=(o=this.options).onStop)==null||a.call(o))},this.options=i,this.initAnimation(),this.play(),i.autoplay===!1&&this.pause()}initAnimation(){const{options:i}=this;replaceTransitionType(i);const{type:s=keyframes,repeat:o=0,repeatDelay:a=0,repeatType:h,velocity:_=0}=i;let{keyframes:g}=i;const _e=s||keyframes;_e!==keyframes&&typeof g[0]!="number"&&(this.mixKeyframes=pipe(percentToProgress,mix(g[0],g[1])),g=[0,100]);const st=_e({...i,keyframes:g});h==="mirror"&&(this.mirroredGenerator=_e({...i,keyframes:[...g].reverse(),velocity:-_})),st.calculatedDuration===null&&(st.calculatedDuration=calcGeneratorDuration(st));const{calculatedDuration:tt}=st;this.calculatedDuration=tt,this.resolvedDuration=tt+a,this.totalDuration=this.resolvedDuration*(o+1)-a,this.generator=st}updateTime(i){const s=Math.round(i-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=s}tick(i,s=!1){const{generator:o,totalDuration:a,mixKeyframes:h,mirroredGenerator:_,resolvedDuration:g,calculatedDuration:_e}=this;if(this.startTime===null)return o.next(0);const{delay:st=0,keyframes:tt,repeat:at,repeatType:ot,repeatDelay:lt,type:ct,onUpdate:$,finalKeyframe:c}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,i):this.speed<0&&(this.startTime=Math.min(i-a/this.speed,this.startTime)),s?this.currentTime=i:this.updateTime(i);const d=this.currentTime-st*(this.playbackSpeed>=0?1:-1),j=this.playbackSpeed>=0?d<0:d>a;this.currentTime=Math.max(d,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=a);let et=this.currentTime,nt=o;if(at){const rt=Math.min(this.currentTime,a)/g;let dt=Math.floor(rt),ft=rt%1;!ft&&rt>=1&&(ft=1),ft===1&&dt--,dt=Math.min(dt,at+1),!!(dt%2)&&(ot==="reverse"?(ft=1-ft,lt&&(ft-=lt/g)):ot==="mirror"&&(nt=_)),et=clamp(0,1,ft)*g}const ut=j?{done:!1,value:tt[0]}:nt.next(et);h&&(ut.value=h(ut.value));let{done:b}=ut;!j&&_e!==null&&(b=this.playbackSpeed>=0?this.currentTime>=a:this.currentTime<=0);const it=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&b);return it&&ct!==inertia&&(ut.value=getFinalKeyframe$1(tt,this.options,c,this.speed)),$&&$(ut.value),it&&this.finish(),ut}then(i,s){return this.finished.then(i,s)}get duration(){return millisecondsToSeconds(this.calculatedDuration)}get iterationDuration(){const{delay:i=0}=this.options||{};return this.duration+millisecondsToSeconds(i)}get time(){return millisecondsToSeconds(this.currentTime)}set time(i){var s;i=secondsToMilliseconds(i),this.currentTime=i,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=i:this.driver&&(this.startTime=this.driver.now()-i/this.playbackSpeed),(s=this.driver)==null||s.start(!1)}get speed(){return this.playbackSpeed}set speed(i){this.updateTime(time.now());const s=this.playbackSpeed!==i;this.playbackSpeed=i,s&&(this.time=millisecondsToSeconds(this.currentTime))}play(){var a,h;if(this.isStopped)return;const{driver:i=frameloopDriver,startTime:s}=this.options;this.driver||(this.driver=i(_=>this.tick(_))),(h=(a=this.options).onPlay)==null||h.call(a);const o=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=o):this.holdTime!==null?this.startTime=o-this.holdTime:this.startTime||(this.startTime=s??o),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(time.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var i,s;this.notifyFinished(),this.teardown(),this.state="finished",(s=(i=this.options).onComplete)==null||s.call(i)}cancel(){var i,s;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(s=(i=this.options).onCancel)==null||s.call(i)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(i){return this.startTime=0,this.tick(i,!0)}attachTimeline(i){var s;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(s=this.driver)==null||s.stop(),i.observe(this)}}function fillWildcards(e){for(let i=1;i<e.length;i++)e[i]??(e[i]=e[i-1])}const radToDeg=e=>e*180/Math.PI,rotate=e=>{const i=radToDeg(Math.atan2(e[1],e[0]));return rebaseAngle(i)},matrix2dParsers={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate,rotateZ:rotate,skewX:e=>radToDeg(Math.atan(e[1])),skewY:e=>radToDeg(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},rebaseAngle=e=>(e=e%360,e<0&&(e+=360),e),rotateZ=rotate,scaleX=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),scaleY=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),matrix3dParsers={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX,scaleY,scale:e=>(scaleX(e)+scaleY(e))/2,rotateX:e=>rebaseAngle(radToDeg(Math.atan2(e[6],e[5]))),rotateY:e=>rebaseAngle(radToDeg(Math.atan2(-e[2],e[0]))),rotateZ,rotate:rotateZ,skewX:e=>radToDeg(Math.atan(e[4])),skewY:e=>radToDeg(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function defaultTransformValue(e){return e.includes("scale")?1:0}function parseValueFromTransform(e,i){if(!e||e==="none")return defaultTransformValue(i);const s=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let o,a;if(s)o=matrix3dParsers,a=s;else{const g=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);o=matrix2dParsers,a=g}if(!a)return defaultTransformValue(i);const h=o[i],_=a[1].split(",").map(convertTransformToNumber);return typeof h=="function"?h(_):_[h]}const readTransformValue=(e,i)=>{const{transform:s="none"}=getComputedStyle(e);return parseValueFromTransform(s,i)};function convertTransformToNumber(e){return parseFloat(e.trim())}const transformPropOrder=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],transformProps=new Set(transformPropOrder),isNumOrPxType=e=>e===number||e===px,transformKeys=new Set(["x","y","z"]),nonTranslationalTransformKeys=transformPropOrder.filter(e=>!transformKeys.has(e));function removeNonTranslationalTransform(e){const i=[];return nonTranslationalTransformKeys.forEach(s=>{const o=e.getValue(s);o!==void 0&&(i.push([s,o.get()]),o.set(s.startsWith("scale")?1:0))}),i}const positionalValues={width:({x:e},{paddingLeft:i="0",paddingRight:s="0"})=>e.max-e.min-parseFloat(i)-parseFloat(s),height:({y:e},{paddingTop:i="0",paddingBottom:s="0"})=>e.max-e.min-parseFloat(i)-parseFloat(s),top:(e,{top:i})=>parseFloat(i),left:(e,{left:i})=>parseFloat(i),bottom:({y:e},{top:i})=>parseFloat(i)+(e.max-e.min),right:({x:e},{left:i})=>parseFloat(i)+(e.max-e.min),x:(e,{transform:i})=>parseValueFromTransform(i,"x"),y:(e,{transform:i})=>parseValueFromTransform(i,"y")};positionalValues.translateX=positionalValues.x;positionalValues.translateY=positionalValues.y;const toResolve=new Set;let isScheduled=!1,anyNeedsMeasurement=!1,isForced=!1;function measureAllKeyframes(){if(anyNeedsMeasurement){const e=Array.from(toResolve).filter(o=>o.needsMeasurement),i=new Set(e.map(o=>o.element)),s=new Map;i.forEach(o=>{const a=removeNonTranslationalTransform(o);a.length&&(s.set(o,a),o.render())}),e.forEach(o=>o.measureInitialState()),i.forEach(o=>{o.render();const a=s.get(o);a&&a.forEach(([h,_])=>{var g;(g=o.getValue(h))==null||g.set(_)})}),e.forEach(o=>o.measureEndState()),e.forEach(o=>{o.suspendedScrollY!==void 0&&window.scrollTo(0,o.suspendedScrollY)})}anyNeedsMeasurement=!1,isScheduled=!1,toResolve.forEach(e=>e.complete(isForced)),toResolve.clear()}function readAllKeyframes(){toResolve.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(anyNeedsMeasurement=!0)})}function flushKeyframeResolvers(){isForced=!0,readAllKeyframes(),measureAllKeyframes(),isForced=!1}class KeyframeResolver{constructor(i,s,o,a,h,_=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...i],this.onComplete=s,this.name=o,this.motionValue=a,this.element=h,this.isAsync=_}scheduleResolve(){this.state="scheduled",this.isAsync?(toResolve.add(this),isScheduled||(isScheduled=!0,frame.read(readAllKeyframes),frame.resolveKeyframes(measureAllKeyframes))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:i,name:s,element:o,motionValue:a}=this;if(i[0]===null){const h=a==null?void 0:a.get(),_=i[i.length-1];if(h!==void 0)i[0]=h;else if(o&&s){const g=o.readValue(s,_);g!=null&&(i[0]=g)}i[0]===void 0&&(i[0]=_),a&&h===void 0&&a.set(i[0])}fillWildcards(i)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(i=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,i),toResolve.delete(this)}cancel(){this.state==="scheduled"&&(toResolve.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const isCSSVar=e=>e.startsWith("--");function setStyle(e,i,s){isCSSVar(i)?e.style.setProperty(i,s):e.style[i]=s}const supportsScrollTimeline=memo(()=>window.ScrollTimeline!==void 0),supportsFlags={};function memoSupports(e,i){const s=memo(e);return()=>supportsFlags[i]??s()}const supportsLinearEasing=memoSupports(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),cubicBezierAsString=([e,i,s,o])=>`cubic-bezier(${e}, ${i}, ${s}, ${o})`,supportedWaapiEasing={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:cubicBezierAsString([0,.65,.55,1]),circOut:cubicBezierAsString([.55,0,1,.45]),backIn:cubicBezierAsString([.31,.01,.66,-.59]),backOut:cubicBezierAsString([.33,1.53,.69,.99])};function mapEasingToNativeEasing(e,i){if(e)return typeof e=="function"?supportsLinearEasing()?generateLinearEasing(e,i):"ease-out":isBezierDefinition(e)?cubicBezierAsString(e):Array.isArray(e)?e.map(s=>mapEasingToNativeEasing(s,i)||supportedWaapiEasing.easeOut):supportedWaapiEasing[e]}function startWaapiAnimation(e,i,s,{delay:o=0,duration:a=300,repeat:h=0,repeatType:_="loop",ease:g="easeOut",times:_e}={},st=void 0){const tt={[i]:s};_e&&(tt.offset=_e);const at=mapEasingToNativeEasing(g,a);Array.isArray(at)&&(tt.easing=at);const ot={delay:o,duration:a,easing:Array.isArray(at)?"linear":at,fill:"both",iterations:h+1,direction:_==="reverse"?"alternate":"normal"};return st&&(ot.pseudoElement=st),e.animate(tt,ot)}function isGenerator(e){return typeof e=="function"&&"applyToOptions"in e}function applyGeneratorOptions({type:e,...i}){return isGenerator(e)&&supportsLinearEasing()?e.applyToOptions(i):(i.duration??(i.duration=300),i.ease??(i.ease="easeOut"),i)}class NativeAnimation extends WithPromise{constructor(i){if(super(),this.finishedTime=null,this.isStopped=!1,this.manualStartTime=null,!i)return;const{element:s,name:o,keyframes:a,pseudoElement:h,allowFlatten:_=!1,finalKeyframe:g,onComplete:_e}=i;this.isPseudoElement=!!h,this.allowFlatten=_,this.options=i,invariant(typeof i.type!="string");const st=applyGeneratorOptions(i);this.animation=startWaapiAnimation(s,o,a,st,h),st.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!h){const tt=getFinalKeyframe$1(a,this.options,g,this.speed);this.updateMotionValue?this.updateMotionValue(tt):setStyle(s,o,tt),this.animation.cancel()}_e==null||_e(),this.notifyFinished()}}play(){this.isStopped||(this.manualStartTime=null,this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var i,s;(s=(i=this.animation).finish)==null||s.call(i)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:i}=this;i==="idle"||i==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var s,o,a;const i=(s=this.options)==null?void 0:s.element;!this.isPseudoElement&&(i!=null&&i.isConnected)&&((a=(o=this.animation).commitStyles)==null||a.call(o))}get duration(){var s,o;const i=((o=(s=this.animation.effect)==null?void 0:s.getComputedTiming)==null?void 0:o.call(s).duration)||0;return millisecondsToSeconds(Number(i))}get iterationDuration(){const{delay:i=0}=this.options||{};return this.duration+millisecondsToSeconds(i)}get time(){return millisecondsToSeconds(Number(this.animation.currentTime)||0)}set time(i){this.manualStartTime=null,this.finishedTime=null,this.animation.currentTime=secondsToMilliseconds(i)}get speed(){return this.animation.playbackRate}set speed(i){i<0&&(this.finishedTime=null),this.animation.playbackRate=i}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return this.manualStartTime??Number(this.animation.startTime)}set startTime(i){this.manualStartTime=this.animation.startTime=i}attachTimeline({timeline:i,observe:s}){var o;return this.allowFlatten&&((o=this.animation.effect)==null||o.updateTiming({easing:"linear"})),this.animation.onfinish=null,i&&supportsScrollTimeline()?(this.animation.timeline=i,noop):s(this)}}const unsupportedEasingFunctions={anticipate,backInOut,circInOut};function isUnsupportedEase(e){return e in unsupportedEasingFunctions}function replaceStringEasing(e){typeof e.ease=="string"&&isUnsupportedEase(e.ease)&&(e.ease=unsupportedEasingFunctions[e.ease])}const sampleDelta=10;class NativeAnimationExtended extends NativeAnimation{constructor(i){replaceStringEasing(i),replaceTransitionType(i),super(i),i.startTime!==void 0&&(this.startTime=i.startTime),this.options=i}updateMotionValue(i){const{motionValue:s,onUpdate:o,onComplete:a,element:h,..._}=this.options;if(!s)return;if(i!==void 0){s.set(i);return}const g=new JSAnimation({..._,autoplay:!1}),_e=Math.max(sampleDelta,time.now()-this.startTime),st=clamp(0,sampleDelta,_e-sampleDelta);s.setWithVelocity(g.sample(Math.max(0,_e-st)).value,g.sample(_e).value,st),g.stop()}}const isAnimatable=(e,i)=>i==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(complex.test(e)||e==="0")&&!e.startsWith("url("));function hasKeyframesChanged(e){const i=e[0];if(e.length===1)return!0;for(let s=0;s<e.length;s++)if(e[s]!==i)return!0}function canAnimate(e,i,s,o){const a=e[0];if(a===null)return!1;if(i==="display"||i==="visibility")return!0;const h=e[e.length-1],_=isAnimatable(a,i),g=isAnimatable(h,i);return!_||!g?!1:hasKeyframesChanged(e)||(s==="spring"||isGenerator(s))&&o}function makeAnimationInstant(e){e.duration=0,e.type="keyframes"}const acceleratedValues$1=new Set(["opacity","clipPath","filter","transform"]),supportsWaapi=memo(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function supportsBrowserAnimation(e){var tt;const{motionValue:i,name:s,repeatDelay:o,repeatType:a,damping:h,type:_}=e;if(!(((tt=i==null?void 0:i.owner)==null?void 0:tt.current)instanceof HTMLElement))return!1;const{onUpdate:_e,transformTemplate:st}=i.owner.getProps();return supportsWaapi()&&s&&acceleratedValues$1.has(s)&&(s!=="transform"||!st)&&!_e&&!o&&a!=="mirror"&&h!==0&&_!=="inertia"}const MAX_RESOLVE_DELAY=40;class AsyncMotionValueAnimation extends WithPromise{constructor({autoplay:i=!0,delay:s=0,type:o="keyframes",repeat:a=0,repeatDelay:h=0,repeatType:_="loop",keyframes:g,name:_e,motionValue:st,element:tt,...at}){var ct;super(),this.stop=()=>{var $,c;this._animation&&(this._animation.stop(),($=this.stopTimeline)==null||$.call(this)),(c=this.keyframeResolver)==null||c.cancel()},this.createdAt=time.now();const ot={autoplay:i,delay:s,type:o,repeat:a,repeatDelay:h,repeatType:_,name:_e,motionValue:st,element:tt,...at},lt=(tt==null?void 0:tt.KeyframeResolver)||KeyframeResolver;this.keyframeResolver=new lt(g,($,c,d)=>this.onKeyframesResolved($,c,ot,!d),_e,st,tt),(ct=this.keyframeResolver)==null||ct.scheduleResolve()}onKeyframesResolved(i,s,o,a){var c,d;this.keyframeResolver=void 0;const{name:h,type:_,velocity:g,delay:_e,isHandoff:st,onUpdate:tt}=o;this.resolvedAt=time.now(),canAnimate(i,h,_,g)||((MotionGlobalConfig.instantAnimations||!_e)&&(tt==null||tt(getFinalKeyframe$1(i,o,s))),i[0]=i[i.length-1],makeAnimationInstant(o),o.repeat=0);const ot={startTime:a?this.resolvedAt?this.resolvedAt-this.createdAt>MAX_RESOLVE_DELAY?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:s,...o,keyframes:i},lt=!st&&supportsBrowserAnimation(ot),ct=(d=(c=ot.motionValue)==null?void 0:c.owner)==null?void 0:d.current,$=lt?new NativeAnimationExtended({...ot,element:ct}):new JSAnimation(ot);$.finished.then(()=>{this.notifyFinished()}).catch(noop),this.pendingTimeline&&(this.stopTimeline=$.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=$}get finished(){return this._animation?this.animation.finished:this._finished}then(i,s){return this.finished.finally(i).then(()=>{})}get animation(){var i;return this._animation||((i=this.keyframeResolver)==null||i.resume(),flushKeyframeResolvers()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(i){this.animation.time=i}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(i){this.animation.speed=i}get startTime(){return this.animation.startTime}attachTimeline(i){return this._animation?this.stopTimeline=this.animation.attachTimeline(i):this.pendingTimeline=i,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var i;this._animation&&this.animation.cancel(),(i=this.keyframeResolver)==null||i.cancel()}}function calcChildStagger(e,i,s,o=0,a=1){const h=Array.from(e).sort((st,tt)=>st.sortNodePosition(tt)).indexOf(i),_=e.size,g=(_-1)*o;return typeof s=="function"?s(h,_):a===1?h*o:g-h*o}const splitCSSVariableRegex=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function parseCSSVariable(e){const i=splitCSSVariableRegex.exec(e);if(!i)return[,];const[,s,o,a]=i;return[`--${s??o}`,a]}function getVariableValue(e,i,s=1){const[o,a]=parseCSSVariable(e);if(!o)return;const h=window.getComputedStyle(i).getPropertyValue(o);if(h){const _=h.trim();return isNumericalString(_)?parseFloat(_):_}return isCSSVariableToken(a)?getVariableValue(a,i,s+1):a}const underDampedSpring={type:"spring",stiffness:500,damping:25,restSpeed:10},criticallyDampedSpring=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),keyframesTransition={type:"keyframes",duration:.8},ease={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},getDefaultTransition=(e,{keyframes:i})=>i.length>2?keyframesTransition:transformProps.has(e)?e.startsWith("scale")?criticallyDampedSpring(i[1]):underDampedSpring:ease,isNotNull=e=>e!==null;function getFinalKeyframe(e,{repeat:i,repeatType:s="loop"},o){const a=e.filter(isNotNull),h=i&&s!=="loop"&&i%2===1?0:a.length-1;return a[h]}function resolveTransition(e,i){if(e!=null&&e.inherit&&i){const{inherit:s,...o}=e;return{...i,...o}}return e}function getValueTransition(e,i){const s=(e==null?void 0:e[i])??(e==null?void 0:e.default)??e;return s!==e?resolveTransition(s,e):s}function isTransitionDefined({when:e,delay:i,delayChildren:s,staggerChildren:o,staggerDirection:a,repeat:h,repeatType:_,repeatDelay:g,from:_e,elapsed:st,...tt}){return!!Object.keys(tt).length}const animateMotionValue=(e,i,s,o={},a,h)=>_=>{const g=getValueTransition(o,e)||{},_e=g.delay||o.delay||0;let{elapsed:st=0}=o;st=st-secondsToMilliseconds(_e);const tt={keyframes:Array.isArray(s)?s:[null,s],ease:"easeOut",velocity:i.getVelocity(),...g,delay:-st,onUpdate:ot=>{i.set(ot),g.onUpdate&&g.onUpdate(ot)},onComplete:()=>{_(),g.onComplete&&g.onComplete()},name:e,motionValue:i,element:h?void 0:a};isTransitionDefined(g)||Object.assign(tt,getDefaultTransition(e,tt)),tt.duration&&(tt.duration=secondsToMilliseconds(tt.duration)),tt.repeatDelay&&(tt.repeatDelay=secondsToMilliseconds(tt.repeatDelay)),tt.from!==void 0&&(tt.keyframes[0]=tt.from);let at=!1;if((tt.type===!1||tt.duration===0&&!tt.repeatDelay)&&(makeAnimationInstant(tt),tt.delay===0&&(at=!0)),(MotionGlobalConfig.instantAnimations||MotionGlobalConfig.skipAnimations||a!=null&&a.shouldSkipAnimations)&&(at=!0,makeAnimationInstant(tt),tt.delay=0),tt.allowFlatten=!g.type&&!g.ease,at&&!h&&i.get()!==void 0){const ot=getFinalKeyframe(tt.keyframes,g);if(ot!==void 0){frame.update(()=>{tt.onUpdate(ot),tt.onComplete()});return}}return g.isSync?new JSAnimation(tt):new AsyncMotionValueAnimation(tt)};function getValueState(e){const i=[{},{}];return e==null||e.values.forEach((s,o)=>{i[0][o]=s.get(),i[1][o]=s.getVelocity()}),i}function resolveVariantFromProps(e,i,s,o){if(typeof i=="function"){const[a,h]=getValueState(o);i=i(s!==void 0?s:e.custom,a,h)}if(typeof i=="string"&&(i=e.variants&&e.variants[i]),typeof i=="function"){const[a,h]=getValueState(o);i=i(s!==void 0?s:e.custom,a,h)}return i}function resolveVariant(e,i,s){const o=e.getProps();return resolveVariantFromProps(o,i,s!==void 0?s:o.custom,e)}const positionalKeys=new Set(["width","height","top","left","right","bottom",...transformPropOrder]),MAX_VELOCITY_DELTA=30,isFloat=e=>!isNaN(parseFloat(e));class MotionValue{constructor(i,s={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=o=>{var h;const a=time.now();if(this.updatedAt!==a&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(o),this.current!==this.prev&&((h=this.events.change)==null||h.notify(this.current),this.dependents))for(const _ of this.dependents)_.dirty()},this.hasAnimated=!1,this.setCurrent(i),this.owner=s.owner}setCurrent(i){this.current=i,this.updatedAt=time.now(),this.canTrackVelocity===null&&i!==void 0&&(this.canTrackVelocity=isFloat(this.current))}setPrevFrameValue(i=this.current){this.prevFrameValue=i,this.prevUpdatedAt=this.updatedAt}onChange(i){return this.on("change",i)}on(i,s){this.events[i]||(this.events[i]=new SubscriptionManager);const o=this.events[i].add(s);return i==="change"?()=>{o(),frame.read(()=>{this.events.change.getSize()||this.stop()})}:o}clearListeners(){for(const i in this.events)this.events[i].clear()}attach(i,s){this.passiveEffect=i,this.stopPassiveEffect=s}set(i){this.passiveEffect?this.passiveEffect(i,this.updateAndNotify):this.updateAndNotify(i)}setWithVelocity(i,s,o){this.set(s),this.prev=void 0,this.prevFrameValue=i,this.prevUpdatedAt=this.updatedAt-o}jump(i,s=!0){this.updateAndNotify(i),this.prev=i,this.prevUpdatedAt=this.prevFrameValue=void 0,s&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var i;(i=this.events.change)==null||i.notify(this.current)}addDependent(i){this.dependents||(this.dependents=new Set),this.dependents.add(i)}removeDependent(i){this.dependents&&this.dependents.delete(i)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const i=time.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||i-this.updatedAt>MAX_VELOCITY_DELTA)return 0;const s=Math.min(this.updatedAt-this.prevUpdatedAt,MAX_VELOCITY_DELTA);return velocityPerSecond(parseFloat(this.current)-parseFloat(this.prevFrameValue),s)}start(i){return this.stop(),new Promise(s=>{this.hasAnimated=!0,this.animation=i(s),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var i,s;(i=this.dependents)==null||i.clear(),(s=this.events.destroy)==null||s.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function motionValue(e,i){return new MotionValue(e,i)}const isKeyframesTarget=e=>Array.isArray(e);function setMotionValue(e,i,s){e.hasValue(i)?e.getValue(i).set(s):e.addValue(i,motionValue(s))}function resolveFinalValueInKeyframes(e){return isKeyframesTarget(e)?e[e.length-1]||0:e}function setTarget(e,i){const s=resolveVariant(e,i);let{transitionEnd:o={},transition:a={},...h}=s||{};h={...h,...o};for(const _ in h){const g=resolveFinalValueInKeyframes(h[_]);setMotionValue(e,_,g)}}const isMotionValue=e=>!!(e&&e.getVelocity);function isWillChangeMotionValue(e){return!!(isMotionValue(e)&&e.add)}function addValueToWillChange(e,i){const s=e.getValue("willChange");if(isWillChangeMotionValue(s))return s.add(i);if(!s&&MotionGlobalConfig.WillChange){const o=new MotionGlobalConfig.WillChange("auto");e.addValue("willChange",o),o.add(i)}}function camelToDash(e){return e.replace(/([A-Z])/g,i=>`-${i.toLowerCase()}`)}const optimizedAppearDataId="framerAppearId",optimizedAppearDataAttribute="data-"+camelToDash(optimizedAppearDataId);function getOptimisedAppearId(e){return e.props[optimizedAppearDataAttribute]}function shouldBlockAnimation({protectedKeys:e,needsAnimating:i},s){const o=e.hasOwnProperty(s)&&i[s]!==!0;return i[s]=!1,o}function animateTarget(e,i,{delay:s=0,transitionOverride:o,type:a}={}){let{transition:h,transitionEnd:_,...g}=i;const _e=e.getDefaultTransition();h=h?resolveTransition(h,_e):_e;const st=h==null?void 0:h.reduceMotion;o&&(h=o);const tt=[],at=a&&e.animationState&&e.animationState.getState()[a];for(const ot in g){const lt=e.getValue(ot,e.latestValues[ot]??null),ct=g[ot];if(ct===void 0||at&&shouldBlockAnimation(at,ot))continue;const $={delay:s,...getValueTransition(h||{},ot)},c=lt.get();if(c!==void 0&&!lt.isAnimating&&!Array.isArray(ct)&&ct===c&&!$.velocity)continue;let d=!1;if(window.MotionHandoffAnimation){const nt=getOptimisedAppearId(e);if(nt){const ut=window.MotionHandoffAnimation(nt,ot,frame);ut!==null&&($.startTime=ut,d=!0)}}addValueToWillChange(e,ot);const j=st??e.shouldReduceMotion;lt.start(animateMotionValue(ot,lt,ct,j&&positionalKeys.has(ot)?{type:!1}:$,e,d));const et=lt.animation;et&&tt.push(et)}if(_){const ot=()=>frame.update(()=>{_&&setTarget(e,_)});tt.length?Promise.all(tt).then(ot):ot()}return tt}function animateVariant(e,i,s={}){var _e;const o=resolveVariant(e,i,s.type==="exit"?(_e=e.presenceContext)==null?void 0:_e.custom:void 0);let{transition:a=e.getDefaultTransition()||{}}=o||{};s.transitionOverride&&(a=s.transitionOverride);const h=o?()=>Promise.all(animateTarget(e,o,s)):()=>Promise.resolve(),_=e.variantChildren&&e.variantChildren.size?(st=0)=>{const{delayChildren:tt=0,staggerChildren:at,staggerDirection:ot}=a;return animateChildren(e,i,st,tt,at,ot,s)}:()=>Promise.resolve(),{when:g}=a;if(g){const[st,tt]=g==="beforeChildren"?[h,_]:[_,h];return st().then(()=>tt())}else return Promise.all([h(),_(s.delay)])}function animateChildren(e,i,s=0,o=0,a=0,h=1,_){const g=[];for(const _e of e.variantChildren)_e.notify("AnimationStart",i),g.push(animateVariant(_e,i,{..._,delay:s+(typeof o=="function"?0:o)+calcChildStagger(e.variantChildren,_e,o,a,h)}).then(()=>_e.notify("AnimationComplete",i)));return Promise.all(g)}function animateVisualElement(e,i,s={}){e.notify("AnimationStart",i);let o;if(Array.isArray(i)){const a=i.map(h=>animateVariant(e,h,s));o=Promise.all(a)}else if(typeof i=="string")o=animateVariant(e,i,s);else{const a=typeof i=="function"?resolveVariant(e,i,s.custom):i;o=Promise.all(animateTarget(e,a,s))}return o.then(()=>{e.notify("AnimationComplete",i)})}const auto={test:e=>e==="auto",parse:e=>e},testValueType=e=>i=>i.test(e),dimensionValueTypes=[number,px,percent,degrees,vw,vh,auto],findDimensionValueType=e=>dimensionValueTypes.find(testValueType(e));function isNone(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||isZeroValueString(e):!0}const maxDefaults=new Set(["brightness","contrast","saturate","opacity"]);function applyDefaultFilter(e){const[i,s]=e.slice(0,-1).split("(");if(i==="drop-shadow")return e;const[o]=s.match(floatRegex)||[];if(!o)return e;const a=s.replace(o,"");let h=maxDefaults.has(i)?1:0;return o!==s&&(h*=100),i+"("+h+a+")"}const functionRegex=/\b([a-z-]*)\(.*?\)/gu,filter={...complex,getAnimatableNone:e=>{const i=e.match(functionRegex);return i?i.map(applyDefaultFilter).join(" "):e}},int={...number,transform:Math.round},transformValueTypes={rotate:degrees,rotateX:degrees,rotateY:degrees,rotateZ:degrees,scale,scaleX:scale,scaleY:scale,scaleZ:scale,skew:degrees,skewX:degrees,skewY:degrees,distance:px,translateX:px,translateY:px,translateZ:px,x:px,y:px,z:px,perspective:px,transformPerspective:px,opacity:alpha,originX:progressPercentage,originY:progressPercentage,originZ:px},numberValueTypes={borderWidth:px,borderTopWidth:px,borderRightWidth:px,borderBottomWidth:px,borderLeftWidth:px,borderRadius:px,borderTopLeftRadius:px,borderTopRightRadius:px,borderBottomRightRadius:px,borderBottomLeftRadius:px,width:px,maxWidth:px,height:px,maxHeight:px,top:px,right:px,bottom:px,left:px,inset:px,insetBlock:px,insetBlockStart:px,insetBlockEnd:px,insetInline:px,insetInlineStart:px,insetInlineEnd:px,padding:px,paddingTop:px,paddingRight:px,paddingBottom:px,paddingLeft:px,paddingBlock:px,paddingBlockStart:px,paddingBlockEnd:px,paddingInline:px,paddingInlineStart:px,paddingInlineEnd:px,margin:px,marginTop:px,marginRight:px,marginBottom:px,marginLeft:px,marginBlock:px,marginBlockStart:px,marginBlockEnd:px,marginInline:px,marginInlineStart:px,marginInlineEnd:px,fontSize:px,backgroundPositionX:px,backgroundPositionY:px,...transformValueTypes,zIndex:int,fillOpacity:alpha,strokeOpacity:alpha,numOctaves:int},defaultValueTypes={...numberValueTypes,color,backgroundColor:color,outlineColor:color,fill:color,stroke:color,borderColor:color,borderTopColor:color,borderRightColor:color,borderBottomColor:color,borderLeftColor:color,filter,WebkitFilter:filter},getDefaultValueType=e=>defaultValueTypes[e];function getAnimatableNone(e,i){let s=getDefaultValueType(e);return s!==filter&&(s=complex),s.getAnimatableNone?s.getAnimatableNone(i):void 0}const invalidTemplates=new Set(["auto","none","0"]);function makeNoneKeyframesAnimatable(e,i,s){let o=0,a;for(;o<e.length&&!a;){const h=e[o];typeof h=="string"&&!invalidTemplates.has(h)&&analyseComplexValue(h).values.length&&(a=e[o]),o++}if(a&&s)for(const h of i)e[h]=getAnimatableNone(s,a)}class DOMKeyframesResolver extends KeyframeResolver{constructor(i,s,o,a,h){super(i,s,o,a,h,!0)}readKeyframes(){const{unresolvedKeyframes:i,element:s,name:o}=this;if(!s||!s.current)return;super.readKeyframes();for(let tt=0;tt<i.length;tt++){let at=i[tt];if(typeof at=="string"&&(at=at.trim(),isCSSVariableToken(at))){const ot=getVariableValue(at,s.current);ot!==void 0&&(i[tt]=ot),tt===i.length-1&&(this.finalKeyframe=at)}}if(this.resolveNoneKeyframes(),!positionalKeys.has(o)||i.length!==2)return;const[a,h]=i,_=findDimensionValueType(a),g=findDimensionValueType(h),_e=containsCSSVariable(a),st=containsCSSVariable(h);if(_e!==st&&positionalValues[o]){this.needsMeasurement=!0;return}if(_!==g)if(isNumOrPxType(_)&&isNumOrPxType(g))for(let tt=0;tt<i.length;tt++){const at=i[tt];typeof at=="string"&&(i[tt]=parseFloat(at))}else positionalValues[o]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:i,name:s}=this,o=[];for(let a=0;a<i.length;a++)(i[a]===null||isNone(i[a]))&&o.push(a);o.length&&makeNoneKeyframesAnimatable(i,o,s)}measureInitialState(){const{element:i,unresolvedKeyframes:s,name:o}=this;if(!i||!i.current)return;o==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=positionalValues[o](i.measureViewportBox(),window.getComputedStyle(i.current)),s[0]=this.measuredOrigin;const a=s[s.length-1];a!==void 0&&i.getValue(o,a).jump(a,!1)}measureEndState(){var g;const{element:i,name:s,unresolvedKeyframes:o}=this;if(!i||!i.current)return;const a=i.getValue(s);a&&a.jump(this.measuredOrigin,!1);const h=o.length-1,_=o[h];o[h]=positionalValues[s](i.measureViewportBox(),window.getComputedStyle(i.current)),_!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=_),(g=this.removedTransforms)!=null&&g.length&&this.removedTransforms.forEach(([_e,st])=>{i.getValue(_e).set(st)}),this.resolveNoneKeyframes()}}const acceleratedValues=new Set(["opacity","clipPath","filter","transform"]);function resolveElements(e,i,s){if(e==null)return[];if(e instanceof EventTarget)return[e];if(typeof e=="string"){let o=document;const a=(s==null?void 0:s[e])??o.querySelectorAll(e);return a?Array.from(a):[]}return Array.from(e).filter(o=>o!=null)}const getValueAsType=(e,i)=>i&&typeof e=="number"?i.transform(e):e;function isHTMLElement(e){return isObject(e)&&"offsetHeight"in e}const{schedule:microtask}=createRenderBatcher(queueMicrotask,!1),isDragging={x:!1,y:!1};function isDragActive(){return isDragging.x||isDragging.y}function setDragLock(e){return e==="x"||e==="y"?isDragging[e]?null:(isDragging[e]=!0,()=>{isDragging[e]=!1}):isDragging.x||isDragging.y?null:(isDragging.x=isDragging.y=!0,()=>{isDragging.x=isDragging.y=!1})}function setupGesture(e,i){const s=resolveElements(e),o=new AbortController,a={passive:!0,...i,signal:o.signal};return[s,a,()=>o.abort()]}function isValidHover(e){return!(e.pointerType==="touch"||isDragActive())}function hover(e,i,s={}){const[o,a,h]=setupGesture(e,s);return o.forEach(_=>{let g=!1,_e=!1,st;const tt=()=>{_.removeEventListener("pointerleave",ct)},at=c=>{st&&(st(c),st=void 0),tt()},ot=c=>{g=!1,window.removeEventListener("pointerup",ot),window.removeEventListener("pointercancel",ot),_e&&(_e=!1,at(c))},lt=()=>{g=!0,window.addEventListener("pointerup",ot,a),window.addEventListener("pointercancel",ot,a)},ct=c=>{if(c.pointerType!=="touch"){if(g){_e=!0;return}at(c)}},$=c=>{if(!isValidHover(c))return;_e=!1;const d=i(_,c);typeof d=="function"&&(st=d,_.addEventListener("pointerleave",ct,a))};_.addEventListener("pointerenter",$,a),_.addEventListener("pointerdown",lt,a)}),h}const isNodeOrChild=(e,i)=>i?e===i?!0:isNodeOrChild(e,i.parentElement):!1,isPrimaryPointer=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,keyboardAccessibleElements=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function isElementKeyboardAccessible(e){return keyboardAccessibleElements.has(e.tagName)||e.isContentEditable===!0}const textInputElements=new Set(["INPUT","SELECT","TEXTAREA"]);function isElementTextInput(e){return textInputElements.has(e.tagName)||e.isContentEditable===!0}const isPressing=new WeakSet;function filterEvents(e){return i=>{i.key==="Enter"&&e(i)}}function firePointerEvent(e,i){e.dispatchEvent(new PointerEvent("pointer"+i,{isPrimary:!0,bubbles:!0}))}const enableKeyboardPress=(e,i)=>{const s=e.currentTarget;if(!s)return;const o=filterEvents(()=>{if(isPressing.has(s))return;firePointerEvent(s,"down");const a=filterEvents(()=>{firePointerEvent(s,"up")}),h=()=>firePointerEvent(s,"cancel");s.addEventListener("keyup",a,i),s.addEventListener("blur",h,i)});s.addEventListener("keydown",o,i),s.addEventListener("blur",()=>s.removeEventListener("keydown",o),i)};function isValidPressEvent(e){return isPrimaryPointer(e)&&!isDragActive()}const claimedPointerDownEvents=new WeakSet;function press(e,i,s={}){const[o,a,h]=setupGesture(e,s),_=g=>{const _e=g.currentTarget;if(!isValidPressEvent(g)||claimedPointerDownEvents.has(g))return;isPressing.add(_e),s.stopPropagation&&claimedPointerDownEvents.add(g);const st=i(_e,g),tt=(lt,ct)=>{window.removeEventListener("pointerup",at),window.removeEventListener("pointercancel",ot),isPressing.has(_e)&&isPressing.delete(_e),isValidPressEvent(lt)&&typeof st=="function"&&st(lt,{success:ct})},at=lt=>{tt(lt,_e===window||_e===document||s.useGlobalTarget||isNodeOrChild(_e,lt.target))},ot=lt=>{tt(lt,!1)};window.addEventListener("pointerup",at,a),window.addEventListener("pointercancel",ot,a)};return o.forEach(g=>{(s.useGlobalTarget?window:g).addEventListener("pointerdown",_,a),isHTMLElement(g)&&(g.addEventListener("focus",st=>enableKeyboardPress(st,a)),!isElementKeyboardAccessible(g)&&!g.hasAttribute("tabindex")&&(g.tabIndex=0))}),h}function isSVGElement(e){return isObject(e)&&"ownerSVGElement"in e}const resizeHandlers=new WeakMap;let observer;const getSize=(e,i,s)=>(o,a)=>a&&a[0]?a[0][e+"Size"]:isSVGElement(o)&&"getBBox"in o?o.getBBox()[i]:o[s],getWidth=getSize("inline","width","offsetWidth"),getHeight=getSize("block","height","offsetHeight");function notifyTarget({target:e,borderBoxSize:i}){var s;(s=resizeHandlers.get(e))==null||s.forEach(o=>{o(e,{get width(){return getWidth(e,i)},get height(){return getHeight(e,i)}})})}function notifyAll(e){e.forEach(notifyTarget)}function createResizeObserver(){typeof ResizeObserver>"u"||(observer=new ResizeObserver(notifyAll))}function resizeElement(e,i){observer||createResizeObserver();const s=resolveElements(e);return s.forEach(o=>{let a=resizeHandlers.get(o);a||(a=new Set,resizeHandlers.set(o,a)),a.add(i),observer==null||observer.observe(o)}),()=>{s.forEach(o=>{const a=resizeHandlers.get(o);a==null||a.delete(i),a!=null&&a.size||observer==null||observer.unobserve(o)})}}const windowCallbacks=new Set;let windowResizeHandler;function createWindowResizeHandler(){windowResizeHandler=()=>{const e={get width(){return window.innerWidth},get height(){return window.innerHeight}};windowCallbacks.forEach(i=>i(e))},window.addEventListener("resize",windowResizeHandler)}function resizeWindow(e){return windowCallbacks.add(e),windowResizeHandler||createWindowResizeHandler(),()=>{windowCallbacks.delete(e),!windowCallbacks.size&&typeof windowResizeHandler=="function"&&(window.removeEventListener("resize",windowResizeHandler),windowResizeHandler=void 0)}}function resize(e,i){return typeof e=="function"?resizeWindow(e):resizeElement(e,i)}function isSVGSVGElement(e){return isSVGElement(e)&&e.tagName==="svg"}const valueTypes=[...dimensionValueTypes,color,complex],findValueType=e=>valueTypes.find(testValueType(e)),createAxisDelta=()=>({translate:0,scale:1,origin:0,originPoint:0}),createDelta=()=>({x:createAxisDelta(),y:createAxisDelta()}),createAxis=()=>({min:0,max:0}),createBox=()=>({x:createAxis(),y:createAxis()}),visualElementStore=new WeakMap;function isAnimationControls(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function isVariantLabel(e){return typeof e=="string"||Array.isArray(e)}const variantPriorityOrder=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],variantProps=["initial",...variantPriorityOrder];function isControllingVariants(e){return isAnimationControls(e.animate)||variantProps.some(i=>isVariantLabel(e[i]))}function isVariantNode(e){return!!(isControllingVariants(e)||e.variants)}function updateMotionValuesFromProps(e,i,s){for(const o in i){const a=i[o],h=s[o];if(isMotionValue(a))e.addValue(o,a);else if(isMotionValue(h))e.addValue(o,motionValue(a,{owner:e}));else if(h!==a)if(e.hasValue(o)){const _=e.getValue(o);_.liveStyle===!0?_.jump(a):_.hasAnimated||_.set(a)}else{const _=e.getStaticValue(o);e.addValue(o,motionValue(_!==void 0?_:a,{owner:e}))}}for(const o in s)i[o]===void 0&&e.removeValue(o);return i}const prefersReducedMotion={current:null},hasReducedMotionListener={current:!1},isBrowser=typeof window<"u";function initPrefersReducedMotion(){if(hasReducedMotionListener.current=!0,!!isBrowser)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),i=()=>prefersReducedMotion.current=e.matches;e.addEventListener("change",i),i()}else prefersReducedMotion.current=!1}const propEventHandlers=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];let featureDefinitions={};function setFeatureDefinitions(e){featureDefinitions=e}function getFeatureDefinitions(){return featureDefinitions}class VisualElement{scrapeMotionValuesFromProps(i,s,o){return{}}constructor({parent:i,props:s,presenceContext:o,reducedMotionConfig:a,skipAnimations:h,blockInitialAnimation:_,visualState:g},_e={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.shouldSkipAnimations=!1,this.values=new Map,this.KeyframeResolver=KeyframeResolver,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.hasBeenMounted=!1,this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const lt=time.now();this.renderScheduledAt<lt&&(this.renderScheduledAt=lt,frame.render(this.render,!1,!0))};const{latestValues:st,renderState:tt}=g;this.latestValues=st,this.baseTarget={...st},this.initialValues=s.initial?{...st}:{},this.renderState=tt,this.parent=i,this.props=s,this.presenceContext=o,this.depth=i?i.depth+1:0,this.reducedMotionConfig=a,this.skipAnimationsConfig=h,this.options=_e,this.blockInitialAnimation=!!_,this.isControllingVariants=isControllingVariants(s),this.isVariantNode=isVariantNode(s),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(i&&i.current);const{willChange:at,...ot}=this.scrapeMotionValuesFromProps(s,{},this);for(const lt in ot){const ct=ot[lt];st[lt]!==void 0&&isMotionValue(ct)&&ct.set(st[lt])}}mount(i){var s,o;if(this.hasBeenMounted)for(const a in this.initialValues)(s=this.values.get(a))==null||s.jump(this.initialValues[a]),this.latestValues[a]=this.initialValues[a];this.current=i,visualElementStore.set(i,this),this.projection&&!this.projection.instance&&this.projection.mount(i),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((a,h)=>this.bindToMotionValue(h,a)),this.reducedMotionConfig==="never"?this.shouldReduceMotion=!1:this.reducedMotionConfig==="always"?this.shouldReduceMotion=!0:(hasReducedMotionListener.current||initPrefersReducedMotion(),this.shouldReduceMotion=prefersReducedMotion.current),this.shouldSkipAnimations=this.skipAnimationsConfig??!1,(o=this.parent)==null||o.addChild(this),this.update(this.props,this.presenceContext),this.hasBeenMounted=!0}unmount(){var i;this.projection&&this.projection.unmount(),cancelFrame(this.notifyUpdate),cancelFrame(this.render),this.valueSubscriptions.forEach(s=>s()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(i=this.parent)==null||i.removeChild(this);for(const s in this.events)this.events[s].clear();for(const s in this.features){const o=this.features[s];o&&(o.unmount(),o.isMounted=!1)}this.current=null}addChild(i){this.children.add(i),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(i)}removeChild(i){this.children.delete(i),this.enteringChildren&&this.enteringChildren.delete(i)}bindToMotionValue(i,s){if(this.valueSubscriptions.has(i)&&this.valueSubscriptions.get(i)(),s.accelerate&&acceleratedValues.has(i)&&this.current instanceof HTMLElement){const{factory:_,keyframes:g,times:_e,ease:st,duration:tt}=s.accelerate,at=new NativeAnimation({element:this.current,name:i,keyframes:g,times:_e,ease:st,duration:secondsToMilliseconds(tt)}),ot=_(at);this.valueSubscriptions.set(i,()=>{ot(),at.cancel()});return}const o=transformProps.has(i);o&&this.onBindTransform&&this.onBindTransform();const a=s.on("change",_=>{this.latestValues[i]=_,this.props.onUpdate&&frame.preRender(this.notifyUpdate),o&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let h;typeof window<"u"&&window.MotionCheckAppearSync&&(h=window.MotionCheckAppearSync(this,i,s)),this.valueSubscriptions.set(i,()=>{a(),h&&h(),s.owner&&s.stop()})}sortNodePosition(i){return!this.current||!this.sortInstanceNodePosition||this.type!==i.type?0:this.sortInstanceNodePosition(this.current,i.current)}updateFeatures(){let i="animation";for(i in featureDefinitions){const s=featureDefinitions[i];if(!s)continue;const{isEnabled:o,Feature:a}=s;if(!this.features[i]&&a&&o(this.props)&&(this.features[i]=new a(this)),this.features[i]){const h=this.features[i];h.isMounted?h.update():(h.mount(),h.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):createBox()}getStaticValue(i){return this.latestValues[i]}setStaticValue(i,s){this.latestValues[i]=s}update(i,s){(i.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=i,this.prevPresenceContext=this.presenceContext,this.presenceContext=s;for(let o=0;o<propEventHandlers.length;o++){const a=propEventHandlers[o];this.propEventSubscriptions[a]&&(this.propEventSubscriptions[a](),delete this.propEventSubscriptions[a]);const h="on"+a,_=i[h];_&&(this.propEventSubscriptions[a]=this.on(a,_))}this.prevMotionValues=updateMotionValuesFromProps(this,this.scrapeMotionValuesFromProps(i,this.prevProps||{},this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(i){return this.props.variants?this.props.variants[i]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(i){const s=this.getClosestVariantNode();if(s)return s.variantChildren&&s.variantChildren.add(i),()=>s.variantChildren.delete(i)}addValue(i,s){const o=this.values.get(i);s!==o&&(o&&this.removeValue(i),this.bindToMotionValue(i,s),this.values.set(i,s),this.latestValues[i]=s.get())}removeValue(i){this.values.delete(i);const s=this.valueSubscriptions.get(i);s&&(s(),this.valueSubscriptions.delete(i)),delete this.latestValues[i],this.removeValueFromRenderState(i,this.renderState)}hasValue(i){return this.values.has(i)}getValue(i,s){if(this.props.values&&this.props.values[i])return this.props.values[i];let o=this.values.get(i);return o===void 0&&s!==void 0&&(o=motionValue(s===null?void 0:s,{owner:this}),this.addValue(i,o)),o}readValue(i,s){let o=this.latestValues[i]!==void 0||!this.current?this.latestValues[i]:this.getBaseTargetFromProps(this.props,i)??this.readValueFromInstance(this.current,i,this.options);return o!=null&&(typeof o=="string"&&(isNumericalString(o)||isZeroValueString(o))?o=parseFloat(o):!findValueType(o)&&complex.test(s)&&(o=getAnimatableNone(i,s)),this.setBaseTarget(i,isMotionValue(o)?o.get():o)),isMotionValue(o)?o.get():o}setBaseTarget(i,s){this.baseTarget[i]=s}getBaseTarget(i){var h;const{initial:s}=this.props;let o;if(typeof s=="string"||typeof s=="object"){const _=resolveVariantFromProps(this.props,s,(h=this.presenceContext)==null?void 0:h.custom);_&&(o=_[i])}if(s&&o!==void 0)return o;const a=this.getBaseTargetFromProps(this.props,i);return a!==void 0&&!isMotionValue(a)?a:this.initialValues[i]!==void 0&&o===void 0?void 0:this.baseTarget[i]}on(i,s){return this.events[i]||(this.events[i]=new SubscriptionManager),this.events[i].add(s)}notify(i,...s){this.events[i]&&this.events[i].notify(...s)}scheduleRenderMicrotask(){microtask.render(this.render)}}class DOMVisualElement extends VisualElement{constructor(){super(...arguments),this.KeyframeResolver=DOMKeyframesResolver}sortInstanceNodePosition(i,s){return i.compareDocumentPosition(s)&2?1:-1}getBaseTargetFromProps(i,s){const o=i.style;return o?o[s]:void 0}removeValueFromRenderState(i,{vars:s,style:o}){delete s[i],delete o[i]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:i}=this.props;isMotionValue(i)&&(this.childSubscription=i.on("change",s=>{this.current&&(this.current.textContent=`${s}`)}))}}class Feature{constructor(i){this.isMounted=!1,this.node=i}update(){}}function convertBoundingBoxToBox({top:e,left:i,right:s,bottom:o}){return{x:{min:i,max:s},y:{min:e,max:o}}}function convertBoxToBoundingBox({x:e,y:i}){return{top:i.min,right:e.max,bottom:i.max,left:e.min}}function transformBoxPoints(e,i){if(!i)return e;const s=i({x:e.left,y:e.top}),o=i({x:e.right,y:e.bottom});return{top:s.y,left:s.x,bottom:o.y,right:o.x}}function isIdentityScale(e){return e===void 0||e===1}function hasScale({scale:e,scaleX:i,scaleY:s}){return!isIdentityScale(e)||!isIdentityScale(i)||!isIdentityScale(s)}function hasTransform(e){return hasScale(e)||has2DTranslate(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function has2DTranslate(e){return is2DTranslate(e.x)||is2DTranslate(e.y)}function is2DTranslate(e){return e&&e!=="0%"}function scalePoint(e,i,s){const o=e-s,a=i*o;return s+a}function applyPointDelta(e,i,s,o,a){return a!==void 0&&(e=scalePoint(e,a,o)),scalePoint(e,s,o)+i}function applyAxisDelta(e,i=0,s=1,o,a){e.min=applyPointDelta(e.min,i,s,o,a),e.max=applyPointDelta(e.max,i,s,o,a)}function applyBoxDelta(e,{x:i,y:s}){applyAxisDelta(e.x,i.translate,i.scale,i.originPoint),applyAxisDelta(e.y,s.translate,s.scale,s.originPoint)}const TREE_SCALE_SNAP_MIN=.999999999999,TREE_SCALE_SNAP_MAX=1.0000000000001;function applyTreeDeltas(e,i,s,o=!1){const a=s.length;if(!a)return;i.x=i.y=1;let h,_;for(let g=0;g<a;g++){h=s[g],_=h.projectionDelta;const{visualElement:_e}=h.options;_e&&_e.props.style&&_e.props.style.display==="contents"||(o&&h.options.layoutScroll&&h.scroll&&h!==h.root&&transformBox(e,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),_&&(i.x*=_.x.scale,i.y*=_.y.scale,applyBoxDelta(e,_)),o&&hasTransform(h.latestValues)&&transformBox(e,h.latestValues))}i.x<TREE_SCALE_SNAP_MAX&&i.x>TREE_SCALE_SNAP_MIN&&(i.x=1),i.y<TREE_SCALE_SNAP_MAX&&i.y>TREE_SCALE_SNAP_MIN&&(i.y=1)}function translateAxis(e,i){e.min=e.min+i,e.max=e.max+i}function transformAxis(e,i,s,o,a=.5){const h=mixNumber$1(e.min,e.max,a);applyAxisDelta(e,i,s,h,o)}function transformBox(e,i){transformAxis(e.x,i.x,i.scaleX,i.scale,i.originX),transformAxis(e.y,i.y,i.scaleY,i.scale,i.originY)}function measureViewportBox(e,i){return convertBoundingBoxToBox(transformBoxPoints(e.getBoundingClientRect(),i))}function measurePageBox(e,i,s){const o=measureViewportBox(e,s),{scroll:a}=i;return a&&(translateAxis(o.x,a.offset.x),translateAxis(o.y,a.offset.y)),o}const translateAlias={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},numTransforms=transformPropOrder.length;function buildTransform(e,i,s){let o="",a=!0;for(let h=0;h<numTransforms;h++){const _=transformPropOrder[h],g=e[_];if(g===void 0)continue;let _e=!0;if(typeof g=="number")_e=g===(_.startsWith("scale")?1:0);else{const st=parseFloat(g);_e=_.startsWith("scale")?st===1:st===0}if(!_e||s){const st=getValueAsType(g,numberValueTypes[_]);if(!_e){a=!1;const tt=translateAlias[_]||_;o+=`${tt}(${st}) `}s&&(i[_]=st)}}return o=o.trim(),s?o=s(i,a?"":o):a&&(o="none"),o}function buildHTMLStyles(e,i,s){const{style:o,vars:a,transformOrigin:h}=e;let _=!1,g=!1;for(const _e in i){const st=i[_e];if(transformProps.has(_e)){_=!0;continue}else if(isCSSVariableName(_e)){a[_e]=st;continue}else{const tt=getValueAsType(st,numberValueTypes[_e]);_e.startsWith("origin")?(g=!0,h[_e]=tt):o[_e]=tt}}if(i.transform||(_||s?o.transform=buildTransform(i,e.transform,s):o.transform&&(o.transform="none")),g){const{originX:_e="50%",originY:st="50%",originZ:tt=0}=h;o.transformOrigin=`${_e} ${st} ${tt}`}}function renderHTML(e,{style:i,vars:s},o,a){const h=e.style;let _;for(_ in i)h[_]=i[_];a==null||a.applyProjectionStyles(h,o);for(_ in s)h.setProperty(_,s[_])}function pixelsToPercent(e,i){return i.max===i.min?0:e/(i.max-i.min)*100}const correctBorderRadius={correct:(e,i)=>{if(!i.target)return e;if(typeof e=="string")if(px.test(e))e=parseFloat(e);else return e;const s=pixelsToPercent(e,i.target.x),o=pixelsToPercent(e,i.target.y);return`${s}% ${o}%`}},correctBoxShadow={correct:(e,{treeScale:i,projectionDelta:s})=>{const o=e,a=complex.parse(e);if(a.length>5)return o;const h=complex.createTransformer(e),_=typeof a[0]!="number"?1:0,g=s.x.scale*i.x,_e=s.y.scale*i.y;a[0+_]/=g,a[1+_]/=_e;const st=mixNumber$1(g,_e,.5);return typeof a[2+_]=="number"&&(a[2+_]/=st),typeof a[3+_]=="number"&&(a[3+_]/=st),h(a)}},scaleCorrectors={borderRadius:{...correctBorderRadius,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:correctBorderRadius,borderTopRightRadius:correctBorderRadius,borderBottomLeftRadius:correctBorderRadius,borderBottomRightRadius:correctBorderRadius,boxShadow:correctBoxShadow};function isForcedMotionValue(e,{layout:i,layoutId:s}){return transformProps.has(e)||e.startsWith("origin")||(i||s!==void 0)&&(!!scaleCorrectors[e]||e==="opacity")}function scrapeMotionValuesFromProps$1(e,i,s){var _;const o=e.style,a=i==null?void 0:i.style,h={};if(!o)return h;for(const g in o)(isMotionValue(o[g])||a&&isMotionValue(a[g])||isForcedMotionValue(g,e)||((_=s==null?void 0:s.getValue(g))==null?void 0:_.liveStyle)!==void 0)&&(h[g]=o[g]);return h}function getComputedStyle$1(e){return window.getComputedStyle(e)}class HTMLVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="html",this.renderInstance=renderHTML}readValueFromInstance(i,s){var o;if(transformProps.has(s))return(o=this.projection)!=null&&o.isProjecting?defaultTransformValue(s):readTransformValue(i,s);{const a=getComputedStyle$1(i),h=(isCSSVariableName(s)?a.getPropertyValue(s):a[s])||0;return typeof h=="string"?h.trim():h}}measureInstanceViewportBox(i,{transformPagePoint:s}){return measureViewportBox(i,s)}build(i,s,o){buildHTMLStyles(i,s,o.transformTemplate)}scrapeMotionValuesFromProps(i,s,o){return scrapeMotionValuesFromProps$1(i,s,o)}}const dashKeys={offset:"stroke-dashoffset",array:"stroke-dasharray"},camelKeys={offset:"strokeDashoffset",array:"strokeDasharray"};function buildSVGPath(e,i,s=1,o=0,a=!0){e.pathLength=1;const h=a?dashKeys:camelKeys;e[h.offset]=`${-o}`,e[h.array]=`${i} ${s}`}const cssMotionPathProperties=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function buildSVGAttrs(e,{attrX:i,attrY:s,attrScale:o,pathLength:a,pathSpacing:h=1,pathOffset:_=0,...g},_e,st,tt){if(buildHTMLStyles(e,g,st),_e){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:at,style:ot}=e;at.transform&&(ot.transform=at.transform,delete at.transform),(ot.transform||at.transformOrigin)&&(ot.transformOrigin=at.transformOrigin??"50% 50%",delete at.transformOrigin),ot.transform&&(ot.transformBox=(tt==null?void 0:tt.transformBox)??"fill-box",delete at.transformBox);for(const lt of cssMotionPathProperties)at[lt]!==void 0&&(ot[lt]=at[lt],delete at[lt]);i!==void 0&&(at.x=i),s!==void 0&&(at.y=s),o!==void 0&&(at.scale=o),a!==void 0&&buildSVGPath(at,a,h,_,!1)}const camelCaseAttributes=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),isSVGTag=e=>typeof e=="string"&&e.toLowerCase()==="svg";function renderSVG(e,i,s,o){renderHTML(e,i,void 0,o);for(const a in i.attrs)e.setAttribute(camelCaseAttributes.has(a)?a:camelToDash(a),i.attrs[a])}function scrapeMotionValuesFromProps(e,i,s){const o=scrapeMotionValuesFromProps$1(e,i,s);for(const a in e)if(isMotionValue(e[a])||isMotionValue(i[a])){const h=transformPropOrder.indexOf(a)!==-1?"attr"+a.charAt(0).toUpperCase()+a.substring(1):a;o[h]=e[a]}return o}class SVGVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=createBox}getBaseTargetFromProps(i,s){return i[s]}readValueFromInstance(i,s){if(transformProps.has(s)){const o=getDefaultValueType(s);return o&&o.default||0}return s=camelCaseAttributes.has(s)?s:camelToDash(s),i.getAttribute(s)}scrapeMotionValuesFromProps(i,s,o){return scrapeMotionValuesFromProps(i,s,o)}build(i,s,o){buildSVGAttrs(i,s,this.isSVGTag,o.transformTemplate,o.style)}renderInstance(i,s,o,a){renderSVG(i,s,o,a)}mount(i){this.isSVGTag=isSVGTag(i.tagName),super.mount(i)}}const numVariantProps=variantProps.length;function getVariantContext(e){if(!e)return;if(!e.isControllingVariants){const s=e.parent?getVariantContext(e.parent)||{}:{};return e.props.initial!==void 0&&(s.initial=e.props.initial),s}const i={};for(let s=0;s<numVariantProps;s++){const o=variantProps[s],a=e.props[o];(isVariantLabel(a)||a===!1)&&(i[o]=a)}return i}function shallowCompare(e,i){if(!Array.isArray(i))return!1;const s=i.length;if(s!==e.length)return!1;for(let o=0;o<s;o++)if(i[o]!==e[o])return!1;return!0}const reversePriorityOrder=[...variantPriorityOrder].reverse(),numAnimationTypes=variantPriorityOrder.length;function createAnimateFunction(e){return i=>Promise.all(i.map(({animation:s,options:o})=>animateVisualElement(e,s,o)))}function createAnimationState(e){let i=createAnimateFunction(e),s=createState(),o=!0;const a=_e=>(st,tt)=>{var ot;const at=resolveVariant(e,tt,_e==="exit"?(ot=e.presenceContext)==null?void 0:ot.custom:void 0);if(at){const{transition:lt,transitionEnd:ct,...$}=at;st={...st,...$,...ct}}return st};function h(_e){i=_e(e)}function _(_e){const{props:st}=e,tt=getVariantContext(e.parent)||{},at=[],ot=new Set;let lt={},ct=1/0;for(let c=0;c<numAnimationTypes;c++){const d=reversePriorityOrder[c],j=s[d],et=st[d]!==void 0?st[d]:tt[d],nt=isVariantLabel(et),ut=d===_e?j.isActive:null;ut===!1&&(ct=c);let b=et===tt[d]&&et!==st[d]&&nt;if(b&&o&&e.manuallyAnimateOnMount&&(b=!1),j.protectedKeys={...lt},!j.isActive&&ut===null||!et&&!j.prevProp||isAnimationControls(et)||typeof et=="boolean")continue;if(d==="exit"&&j.isActive&&ut!==!0){j.prevResolvedValues&&(lt={...lt,...j.prevResolvedValues});continue}const it=checkVariantsDidChange(j.prevProp,et);let rt=it||d===_e&&j.isActive&&!b&&nt||c>ct&&nt,dt=!1;const ft=Array.isArray(et)?et:[et];let mt=ft.reduce(a(d),{});ut===!1&&(mt={});const{prevResolvedValues:yt={}}=j,gt={...yt,...mt},_t=wt=>{rt=!0,ot.has(wt)&&(dt=!0,ot.delete(wt)),j.needsAnimating[wt]=!0;const Et=e.getValue(wt);Et&&(Et.liveStyle=!1)};for(const wt in gt){const Et=mt[wt],At=yt[wt];if(lt.hasOwnProperty(wt))continue;let St=!1;isKeyframesTarget(Et)&&isKeyframesTarget(At)?St=!shallowCompare(Et,At):St=Et!==At,St?Et!=null?_t(wt):ot.add(wt):Et!==void 0&&ot.has(wt)?_t(wt):j.protectedKeys[wt]=!0}j.prevProp=et,j.prevResolvedValues=mt,j.isActive&&(lt={...lt,...mt}),o&&e.blockInitialAnimation&&(rt=!1);const xt=b&&it;rt&&(!xt||dt)&&at.push(...ft.map(wt=>{const Et={type:d};if(typeof wt=="string"&&o&&!xt&&e.manuallyAnimateOnMount&&e.parent){const{parent:At}=e,St=resolveVariant(At,wt);if(At.enteringChildren&&St){const{delayChildren:bt}=St.transition||{};Et.delay=calcChildStagger(At.enteringChildren,e,bt)}}return{animation:wt,options:Et}}))}if(ot.size){const c={};if(typeof st.initial!="boolean"){const d=resolveVariant(e,Array.isArray(st.initial)?st.initial[0]:st.initial);d&&d.transition&&(c.transition=d.transition)}ot.forEach(d=>{const j=e.getBaseTarget(d),et=e.getValue(d);et&&(et.liveStyle=!0),c[d]=j??null}),at.push({animation:c})}let $=!!at.length;return o&&(st.initial===!1||st.initial===st.animate)&&!e.manuallyAnimateOnMount&&($=!1),o=!1,$?i(at):Promise.resolve()}function g(_e,st){var at;if(s[_e].isActive===st)return Promise.resolve();(at=e.variantChildren)==null||at.forEach(ot=>{var lt;return(lt=ot.animationState)==null?void 0:lt.setActive(_e,st)}),s[_e].isActive=st;const tt=_(_e);for(const ot in s)s[ot].protectedKeys={};return tt}return{animateChanges:_,setActive:g,setAnimateFunction:h,getState:()=>s,reset:()=>{s=createState()}}}function checkVariantsDidChange(e,i){return typeof i=="string"?i!==e:Array.isArray(i)?!shallowCompare(i,e):!1}function createTypeState(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function createState(){return{animate:createTypeState(!0),whileInView:createTypeState(),whileHover:createTypeState(),whileTap:createTypeState(),whileDrag:createTypeState(),whileFocus:createTypeState(),exit:createTypeState()}}function copyAxisInto(e,i){e.min=i.min,e.max=i.max}function copyBoxInto(e,i){copyAxisInto(e.x,i.x),copyAxisInto(e.y,i.y)}function copyAxisDeltaInto(e,i){e.translate=i.translate,e.scale=i.scale,e.originPoint=i.originPoint,e.origin=i.origin}const SCALE_PRECISION=1e-4,SCALE_MIN=1-SCALE_PRECISION,SCALE_MAX=1+SCALE_PRECISION,TRANSLATE_PRECISION=.01,TRANSLATE_MIN=0-TRANSLATE_PRECISION,TRANSLATE_MAX=0+TRANSLATE_PRECISION;function calcLength(e){return e.max-e.min}function isNear(e,i,s){return Math.abs(e-i)<=s}function calcAxisDelta(e,i,s,o=.5){e.origin=o,e.originPoint=mixNumber$1(i.min,i.max,e.origin),e.scale=calcLength(s)/calcLength(i),e.translate=mixNumber$1(s.min,s.max,e.origin)-e.originPoint,(e.scale>=SCALE_MIN&&e.scale<=SCALE_MAX||isNaN(e.scale))&&(e.scale=1),(e.translate>=TRANSLATE_MIN&&e.translate<=TRANSLATE_MAX||isNaN(e.translate))&&(e.translate=0)}function calcBoxDelta(e,i,s,o){calcAxisDelta(e.x,i.x,s.x,o?o.originX:void 0),calcAxisDelta(e.y,i.y,s.y,o?o.originY:void 0)}function calcRelativeAxis(e,i,s){e.min=s.min+i.min,e.max=e.min+calcLength(i)}function calcRelativeBox(e,i,s){calcRelativeAxis(e.x,i.x,s.x),calcRelativeAxis(e.y,i.y,s.y)}function calcRelativeAxisPosition(e,i,s){e.min=i.min-s.min,e.max=e.min+calcLength(i)}function calcRelativePosition(e,i,s){calcRelativeAxisPosition(e.x,i.x,s.x),calcRelativeAxisPosition(e.y,i.y,s.y)}function removePointDelta(e,i,s,o,a){return e-=i,e=scalePoint(e,1/s,o),a!==void 0&&(e=scalePoint(e,1/a,o)),e}function removeAxisDelta(e,i=0,s=1,o=.5,a,h=e,_=e){if(percent.test(i)&&(i=parseFloat(i),i=mixNumber$1(_.min,_.max,i/100)-_.min),typeof i!="number")return;let g=mixNumber$1(h.min,h.max,o);e===h&&(g-=i),e.min=removePointDelta(e.min,i,s,g,a),e.max=removePointDelta(e.max,i,s,g,a)}function removeAxisTransforms(e,i,[s,o,a],h,_){removeAxisDelta(e,i[s],i[o],i[a],i.scale,h,_)}const xKeys=["x","scaleX","originX"],yKeys=["y","scaleY","originY"];function removeBoxTransforms(e,i,s,o){removeAxisTransforms(e.x,i,xKeys,s?s.x:void 0,o?o.x:void 0),removeAxisTransforms(e.y,i,yKeys,s?s.y:void 0,o?o.y:void 0)}function isAxisDeltaZero(e){return e.translate===0&&e.scale===1}function isDeltaZero(e){return isAxisDeltaZero(e.x)&&isAxisDeltaZero(e.y)}function axisEquals(e,i){return e.min===i.min&&e.max===i.max}function boxEquals(e,i){return axisEquals(e.x,i.x)&&axisEquals(e.y,i.y)}function axisEqualsRounded(e,i){return Math.round(e.min)===Math.round(i.min)&&Math.round(e.max)===Math.round(i.max)}function boxEqualsRounded(e,i){return axisEqualsRounded(e.x,i.x)&&axisEqualsRounded(e.y,i.y)}function aspectRatio(e){return calcLength(e.x)/calcLength(e.y)}function axisDeltaEquals(e,i){return e.translate===i.translate&&e.scale===i.scale&&e.originPoint===i.originPoint}function eachAxis(e){return[e("x"),e("y")]}function buildProjectionTransform(e,i,s){let o="";const a=e.x.translate/i.x,h=e.y.translate/i.y,_=(s==null?void 0:s.z)||0;if((a||h||_)&&(o=`translate3d(${a}px, ${h}px, ${_}px) `),(i.x!==1||i.y!==1)&&(o+=`scale(${1/i.x}, ${1/i.y}) `),s){const{transformPerspective:st,rotate:tt,rotateX:at,rotateY:ot,skewX:lt,skewY:ct}=s;st&&(o=`perspective(${st}px) ${o}`),tt&&(o+=`rotate(${tt}deg) `),at&&(o+=`rotateX(${at}deg) `),ot&&(o+=`rotateY(${ot}deg) `),lt&&(o+=`skewX(${lt}deg) `),ct&&(o+=`skewY(${ct}deg) `)}const g=e.x.scale*i.x,_e=e.y.scale*i.y;return(g!==1||_e!==1)&&(o+=`scale(${g}, ${_e})`),o||"none"}const borders=["TopLeft","TopRight","BottomLeft","BottomRight"],numBorders=borders.length,asNumber=e=>typeof e=="string"?parseFloat(e):e,isPx=e=>typeof e=="number"||px.test(e);function mixValues(e,i,s,o,a,h){a?(e.opacity=mixNumber$1(0,s.opacity??1,easeCrossfadeIn(o)),e.opacityExit=mixNumber$1(i.opacity??1,0,easeCrossfadeOut(o))):h&&(e.opacity=mixNumber$1(i.opacity??1,s.opacity??1,o));for(let _=0;_<numBorders;_++){const g=`border${borders[_]}Radius`;let _e=getRadius(i,g),st=getRadius(s,g);if(_e===void 0&&st===void 0)continue;_e||(_e=0),st||(st=0),_e===0||st===0||isPx(_e)===isPx(st)?(e[g]=Math.max(mixNumber$1(asNumber(_e),asNumber(st),o),0),(percent.test(st)||percent.test(_e))&&(e[g]+="%")):e[g]=st}(i.rotate||s.rotate)&&(e.rotate=mixNumber$1(i.rotate||0,s.rotate||0,o))}function getRadius(e,i){return e[i]!==void 0?e[i]:e.borderRadius}const easeCrossfadeIn=compress(0,.5,circOut),easeCrossfadeOut=compress(.5,.95,noop);function compress(e,i,s){return o=>o<e?0:o>i?1:s(progress(e,i,o))}function animateSingleValue(e,i,s){const o=isMotionValue(e)?e:motionValue(e);return o.start(animateMotionValue("",o,i,s)),o.animation}function addDomEvent(e,i,s,o={passive:!0}){return e.addEventListener(i,s,o),()=>e.removeEventListener(i,s)}const compareByDepth=(e,i)=>e.depth-i.depth;class FlatTree{constructor(){this.children=[],this.isDirty=!1}add(i){addUniqueItem(this.children,i),this.isDirty=!0}remove(i){removeItem(this.children,i),this.isDirty=!0}forEach(i){this.isDirty&&this.children.sort(compareByDepth),this.isDirty=!1,this.children.forEach(i)}}function delay(e,i){const s=time.now(),o=({timestamp:a})=>{const h=a-s;h>=i&&(cancelFrame(o),e(h-i))};return frame.setup(o,!0),()=>cancelFrame(o)}function resolveMotionValue(e){return isMotionValue(e)?e.get():e}class NodeStack{constructor(){this.members=[]}add(i){addUniqueItem(this.members,i);for(let s=this.members.length-1;s>=0;s--){const o=this.members[s];if(o===i||o===this.lead||o===this.prevLead)continue;const a=o.instance;a&&a.isConnected===!1&&o.isPresent!==!1&&!o.snapshot&&removeItem(this.members,o)}i.scheduleRender()}remove(i){if(removeItem(this.members,i),i===this.prevLead&&(this.prevLead=void 0),i===this.lead){const s=this.members[this.members.length-1];s&&this.promote(s)}}relegate(i){const s=this.members.findIndex(a=>i===a);if(s===0)return!1;let o;for(let a=s;a>=0;a--){const h=this.members[a],_=h.instance;if(h.isPresent!==!1&&(!_||_.isConnected!==!1)){o=h;break}}return o?(this.promote(o),!0):!1}promote(i,s){const o=this.lead;if(i!==o&&(this.prevLead=o,this.lead=i,i.show(),o)){o.instance&&o.scheduleRender(),i.scheduleRender();const a=o.options.layoutDependency,h=i.options.layoutDependency;if(!(a!==void 0&&h!==void 0&&a===h)){const _e=o.instance;_e&&_e.isConnected===!1&&!o.snapshot||(i.resumeFrom=o,s&&(i.resumeFrom.preserveOpacity=!0),o.snapshot&&(i.snapshot=o.snapshot,i.snapshot.latestValues=o.animationValues||o.latestValues),i.root&&i.root.isUpdating&&(i.isLayoutDirty=!0))}const{crossfade:g}=i.options;g===!1&&o.hide()}}exitAnimationComplete(){this.members.forEach(i=>{const{options:s,resumingFrom:o}=i;s.onExitComplete&&s.onExitComplete(),o&&o.options.onExitComplete&&o.options.onExitComplete()})}scheduleRender(){this.members.forEach(i=>{i.instance&&i.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const globalProjectionState={hasAnimatedSinceResize:!0,hasEverUpdated:!1},transformAxes=["","X","Y","Z"],animationTarget=1e3;let id$1=0;function resetDistortingTransform(e,i,s,o){const{latestValues:a}=i;a[e]&&(s[e]=a[e],i.setStaticValue(e,0),o&&(o[e]=0))}function cancelTreeOptimisedTransformAnimations(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:i}=e.options;if(!i)return;const s=getOptimisedAppearId(i);if(window.MotionHasOptimisedAnimation(s,"transform")){const{layout:a,layoutId:h}=e.options;window.MotionCancelOptimisedAnimation(s,"transform",frame,!(a||h))}const{parent:o}=e;o&&!o.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(o)}function createProjectionNode$1({attachResizeListener:e,defaultParent:i,measureScroll:s,checkIsScrollRoot:o,resetTransform:a}){return class{constructor(_={},g=i==null?void 0:i()){this.id=id$1++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(propagateDirtyNodes),this.nodes.forEach(resolveTargetDelta),this.nodes.forEach(calcProjection),this.nodes.forEach(cleanDirtyNodes)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=_,this.root=g?g.root||g:this,this.path=g?[...g.path,g]:[],this.parent=g,this.depth=g?g.depth+1:0;for(let _e=0;_e<this.path.length;_e++)this.path[_e].shouldResetTransform=!0;this.root===this&&(this.nodes=new FlatTree)}addEventListener(_,g){return this.eventHandlers.has(_)||this.eventHandlers.set(_,new SubscriptionManager),this.eventHandlers.get(_).add(g)}notifyListeners(_,...g){const _e=this.eventHandlers.get(_);_e&&_e.notify(...g)}hasListeners(_){return this.eventHandlers.has(_)}mount(_){if(this.instance)return;this.isSVG=isSVGElement(_)&&!isSVGSVGElement(_),this.instance=_;const{layoutId:g,layout:_e,visualElement:st}=this.options;if(st&&!st.current&&st.mount(_),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(_e||g)&&(this.isLayoutDirty=!0),e){let tt,at=0;const ot=()=>this.root.updateBlockedByResize=!1;frame.read(()=>{at=window.innerWidth}),e(_,()=>{const lt=window.innerWidth;lt!==at&&(at=lt,this.root.updateBlockedByResize=!0,tt&&tt(),tt=delay(ot,250),globalProjectionState.hasAnimatedSinceResize&&(globalProjectionState.hasAnimatedSinceResize=!1,this.nodes.forEach(finishAnimation)))})}g&&this.root.registerSharedNode(g,this),this.options.animate!==!1&&st&&(g||_e)&&this.addEventListener("didUpdate",({delta:tt,hasLayoutChanged:at,hasRelativeLayoutChanged:ot,layout:lt})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const ct=this.options.transition||st.getDefaultTransition()||defaultLayoutTransition,{onLayoutAnimationStart:$,onLayoutAnimationComplete:c}=st.getProps(),d=!this.targetLayout||!boxEqualsRounded(this.targetLayout,lt),j=!at&&ot;if(this.options.layoutRoot||this.resumeFrom||j||at&&(d||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const et={...getValueTransition(ct,"layout"),onPlay:$,onComplete:c};(st.shouldReduceMotion||this.options.layoutRoot)&&(et.delay=0,et.type=!1),this.startAnimation(et),this.setAnimationOrigin(tt,j)}else at||finishAnimation(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=lt})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const _=this.getStack();_&&_.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),cancelFrame(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(resetSkewAndRotation),this.animationId++)}getTransformTemplate(){const{visualElement:_}=this.options;return _&&_.getProps().transformTemplate}willUpdate(_=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let tt=0;tt<this.path.length;tt++){const at=this.path[tt];at.shouldResetTransform=!0,at.updateScroll("snapshot"),at.options.layoutRoot&&at.willUpdate(!1)}const{layoutId:g,layout:_e}=this.options;if(g===void 0&&!_e)return;const st=this.getTransformTemplate();this.prevTransformTemplateValue=st?st(this.latestValues,""):void 0,this.updateSnapshot(),_&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(clearMeasurements);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(clearIsLayoutDirty);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(resetTransformStyle),this.nodes.forEach(updateLayout),this.nodes.forEach(notifyLayoutUpdate)):this.nodes.forEach(clearIsLayoutDirty),this.clearAllSnapshots();const g=time.now();frameData.delta=clamp(0,1e3/60,g-frameData.timestamp),frameData.timestamp=g,frameData.isProcessing=!0,frameSteps.update.process(frameData),frameSteps.preRender.process(frameData),frameSteps.render.process(frameData),frameData.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,microtask.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(clearSnapshot),this.sharedNodes.forEach(removeLeadSnapshots)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,frame.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){frame.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!calcLength(this.snapshot.measuredBox.x)&&!calcLength(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let _e=0;_e<this.path.length;_e++)this.path[_e].updateScroll();const _=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=createBox(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:g}=this.options;g&&g.notify("LayoutMeasure",this.layout.layoutBox,_?_.layoutBox:void 0)}updateScroll(_="measure"){let g=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===_&&(g=!1),g&&this.instance){const _e=o(this.instance);this.scroll={animationId:this.root.animationId,phase:_,isRoot:_e,offset:s(this.instance),wasRoot:this.scroll?this.scroll.isRoot:_e}}}resetTransform(){if(!a)return;const _=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,g=this.projectionDelta&&!isDeltaZero(this.projectionDelta),_e=this.getTransformTemplate(),st=_e?_e(this.latestValues,""):void 0,tt=st!==this.prevTransformTemplateValue;_&&this.instance&&(g||hasTransform(this.latestValues)||tt)&&(a(this.instance,st),this.shouldResetTransform=!1,this.scheduleRender())}measure(_=!0){const g=this.measurePageBox();let _e=this.removeElementScroll(g);return _&&(_e=this.removeTransform(_e)),roundBox(_e),{animationId:this.root.animationId,measuredBox:g,layoutBox:_e,latestValues:{},source:this.id}}measurePageBox(){var st;const{visualElement:_}=this.options;if(!_)return createBox();const g=_.measureViewportBox();if(!(((st=this.scroll)==null?void 0:st.wasRoot)||this.path.some(checkNodeWasScrollRoot))){const{scroll:tt}=this.root;tt&&(translateAxis(g.x,tt.offset.x),translateAxis(g.y,tt.offset.y))}return g}removeElementScroll(_){var _e;const g=createBox();if(copyBoxInto(g,_),(_e=this.scroll)!=null&&_e.wasRoot)return g;for(let st=0;st<this.path.length;st++){const tt=this.path[st],{scroll:at,options:ot}=tt;tt!==this.root&&at&&ot.layoutScroll&&(at.wasRoot&&copyBoxInto(g,_),translateAxis(g.x,at.offset.x),translateAxis(g.y,at.offset.y))}return g}applyTransform(_,g=!1){const _e=createBox();copyBoxInto(_e,_);for(let st=0;st<this.path.length;st++){const tt=this.path[st];!g&&tt.options.layoutScroll&&tt.scroll&&tt!==tt.root&&transformBox(_e,{x:-tt.scroll.offset.x,y:-tt.scroll.offset.y}),hasTransform(tt.latestValues)&&transformBox(_e,tt.latestValues)}return hasTransform(this.latestValues)&&transformBox(_e,this.latestValues),_e}removeTransform(_){const g=createBox();copyBoxInto(g,_);for(let _e=0;_e<this.path.length;_e++){const st=this.path[_e];if(!st.instance||!hasTransform(st.latestValues))continue;hasScale(st.latestValues)&&st.updateSnapshot();const tt=createBox(),at=st.measurePageBox();copyBoxInto(tt,at),removeBoxTransforms(g,st.latestValues,st.snapshot?st.snapshot.layoutBox:void 0,tt)}return hasTransform(this.latestValues)&&removeBoxTransforms(g,this.latestValues),g}setTargetDelta(_){this.targetDelta=_,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(_){this.options={...this.options,..._,crossfade:_.crossfade!==void 0?_.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==frameData.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(_=!1){var lt;const g=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=g.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=g.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=g.isSharedProjectionDirty);const _e=!!this.resumingFrom||this!==g;if(!(_||_e&&this.isSharedProjectionDirty||this.isProjectionDirty||(lt=this.parent)!=null&&lt.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:tt,layoutId:at}=this.options;if(!this.layout||!(tt||at))return;this.resolvedRelativeTargetAt=frameData.timestamp;const ot=this.getClosestProjectingParent();ot&&this.linkedParentVersion!==ot.layoutVersion&&!ot.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(ot&&ot.layout?this.createRelativeTarget(ot,this.layout.layoutBox,ot.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=createBox(),this.targetWithTransforms=createBox()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),calcRelativeBox(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):copyBoxInto(this.target,this.layout.layoutBox),applyBoxDelta(this.target,this.targetDelta)):copyBoxInto(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,ot&&!!ot.resumingFrom==!!this.resumingFrom&&!ot.options.layoutScroll&&ot.target&&this.animationProgress!==1?this.createRelativeTarget(ot,this.target,ot.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||hasScale(this.parent.latestValues)||has2DTranslate(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(_,g,_e){this.relativeParent=_,this.linkedParentVersion=_.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,g,_e),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){var ct;const _=this.getLead(),g=!!this.resumingFrom||this!==_;let _e=!0;if((this.isProjectionDirty||(ct=this.parent)!=null&&ct.isProjectionDirty)&&(_e=!1),g&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(_e=!1),this.resolvedRelativeTargetAt===frameData.timestamp&&(_e=!1),_e)return;const{layout:st,layoutId:tt}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(st||tt))return;copyBoxInto(this.layoutCorrected,this.layout.layoutBox);const at=this.treeScale.x,ot=this.treeScale.y;applyTreeDeltas(this.layoutCorrected,this.treeScale,this.path,g),_.layout&&!_.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(_.target=_.layout.layoutBox,_.targetWithTransforms=createBox());const{target:lt}=_;if(!lt){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(copyAxisDeltaInto(this.prevProjectionDelta.x,this.projectionDelta.x),copyAxisDeltaInto(this.prevProjectionDelta.y,this.projectionDelta.y)),calcBoxDelta(this.projectionDelta,this.layoutCorrected,lt,this.latestValues),(this.treeScale.x!==at||this.treeScale.y!==ot||!axisDeltaEquals(this.projectionDelta.x,this.prevProjectionDelta.x)||!axisDeltaEquals(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",lt))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(_=!0){var g;if((g=this.options.visualElement)==null||g.scheduleRender(),_){const _e=this.getStack();_e&&_e.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=createDelta(),this.projectionDelta=createDelta(),this.projectionDeltaWithTransform=createDelta()}setAnimationOrigin(_,g=!1){const _e=this.snapshot,st=_e?_e.latestValues:{},tt={...this.latestValues},at=createDelta();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!g;const ot=createBox(),lt=_e?_e.source:void 0,ct=this.layout?this.layout.source:void 0,$=lt!==ct,c=this.getStack(),d=!c||c.members.length<=1,j=!!($&&!d&&this.options.crossfade===!0&&!this.path.some(hasOpacityCrossfade));this.animationProgress=0;let et;this.mixTargetDelta=nt=>{const ut=nt/1e3;mixAxisDelta(at.x,_.x,ut),mixAxisDelta(at.y,_.y,ut),this.setTargetDelta(at),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(calcRelativePosition(ot,this.layout.layoutBox,this.relativeParent.layout.layoutBox),mixBox(this.relativeTarget,this.relativeTargetOrigin,ot,ut),et&&boxEquals(this.relativeTarget,et)&&(this.isProjectionDirty=!1),et||(et=createBox()),copyBoxInto(et,this.relativeTarget)),$&&(this.animationValues=tt,mixValues(tt,st,this.latestValues,ut,j,d)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=ut},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(_){var g,_e,st;this.notifyListeners("animationStart"),(g=this.currentAnimation)==null||g.stop(),(st=(_e=this.resumingFrom)==null?void 0:_e.currentAnimation)==null||st.stop(),this.pendingAnimation&&(cancelFrame(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=frame.update(()=>{globalProjectionState.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=motionValue(0)),this.currentAnimation=animateSingleValue(this.motionValue,[0,1e3],{..._,velocity:0,isSync:!0,onUpdate:tt=>{this.mixTargetDelta(tt),_.onUpdate&&_.onUpdate(tt)},onStop:()=>{},onComplete:()=>{_.onComplete&&_.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const _=this.getStack();_&&_.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(animationTarget),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const _=this.getLead();let{targetWithTransforms:g,target:_e,layout:st,latestValues:tt}=_;if(!(!g||!_e||!st)){if(this!==_&&this.layout&&st&&shouldAnimatePositionOnly(this.options.animationType,this.layout.layoutBox,st.layoutBox)){_e=this.target||createBox();const at=calcLength(this.layout.layoutBox.x);_e.x.min=_.target.x.min,_e.x.max=_e.x.min+at;const ot=calcLength(this.layout.layoutBox.y);_e.y.min=_.target.y.min,_e.y.max=_e.y.min+ot}copyBoxInto(g,_e),transformBox(g,tt),calcBoxDelta(this.projectionDeltaWithTransform,this.layoutCorrected,g,tt)}}registerSharedNode(_,g){this.sharedNodes.has(_)||this.sharedNodes.set(_,new NodeStack),this.sharedNodes.get(_).add(g);const st=g.options.initialPromotionConfig;g.promote({transition:st?st.transition:void 0,preserveFollowOpacity:st&&st.shouldPreserveFollowOpacity?st.shouldPreserveFollowOpacity(g):void 0})}isLead(){const _=this.getStack();return _?_.lead===this:!0}getLead(){var g;const{layoutId:_}=this.options;return _?((g=this.getStack())==null?void 0:g.lead)||this:this}getPrevLead(){var g;const{layoutId:_}=this.options;return _?(g=this.getStack())==null?void 0:g.prevLead:void 0}getStack(){const{layoutId:_}=this.options;if(_)return this.root.sharedNodes.get(_)}promote({needsReset:_,transition:g,preserveFollowOpacity:_e}={}){const st=this.getStack();st&&st.promote(this,_e),_&&(this.projectionDelta=void 0,this.needsReset=!0),g&&this.setOptions({transition:g})}relegate(){const _=this.getStack();return _?_.relegate(this):!1}resetSkewAndRotation(){const{visualElement:_}=this.options;if(!_)return;let g=!1;const{latestValues:_e}=_;if((_e.z||_e.rotate||_e.rotateX||_e.rotateY||_e.rotateZ||_e.skewX||_e.skewY)&&(g=!0),!g)return;const st={};_e.z&&resetDistortingTransform("z",_,st,this.animationValues);for(let tt=0;tt<transformAxes.length;tt++)resetDistortingTransform(`rotate${transformAxes[tt]}`,_,st,this.animationValues),resetDistortingTransform(`skew${transformAxes[tt]}`,_,st,this.animationValues);_.render();for(const tt in st)_.setStaticValue(tt,st[tt]),this.animationValues&&(this.animationValues[tt]=st[tt]);_.scheduleRender()}applyProjectionStyles(_,g){if(!this.instance||this.isSVG)return;if(!this.isVisible){_.visibility="hidden";return}const _e=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,_.visibility="",_.opacity="",_.pointerEvents=resolveMotionValue(g==null?void 0:g.pointerEvents)||"",_.transform=_e?_e(this.latestValues,""):"none";return}const st=this.getLead();if(!this.projectionDelta||!this.layout||!st.target){this.options.layoutId&&(_.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,_.pointerEvents=resolveMotionValue(g==null?void 0:g.pointerEvents)||""),this.hasProjected&&!hasTransform(this.latestValues)&&(_.transform=_e?_e({},""):"none",this.hasProjected=!1);return}_.visibility="";const tt=st.animationValues||st.latestValues;this.applyTransformsToTarget();let at=buildProjectionTransform(this.projectionDeltaWithTransform,this.treeScale,tt);_e&&(at=_e(tt,at)),_.transform=at;const{x:ot,y:lt}=this.projectionDelta;_.transformOrigin=`${ot.origin*100}% ${lt.origin*100}% 0`,st.animationValues?_.opacity=st===this?tt.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:tt.opacityExit:_.opacity=st===this?tt.opacity!==void 0?tt.opacity:"":tt.opacityExit!==void 0?tt.opacityExit:0;for(const ct in scaleCorrectors){if(tt[ct]===void 0)continue;const{correct:$,applyTo:c,isCSSVariable:d}=scaleCorrectors[ct],j=at==="none"?tt[ct]:$(tt[ct],st);if(c){const et=c.length;for(let nt=0;nt<et;nt++)_[c[nt]]=j}else d?this.options.visualElement.renderState.vars[ct]=j:_[ct]=j}this.options.layoutId&&(_.pointerEvents=st===this?resolveMotionValue(g==null?void 0:g.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(_=>{var g;return(g=_.currentAnimation)==null?void 0:g.stop()}),this.root.nodes.forEach(clearMeasurements),this.root.sharedNodes.clear()}}}function updateLayout(e){e.updateLayout()}function notifyLayoutUpdate(e){var s;const i=((s=e.resumeFrom)==null?void 0:s.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&i&&e.hasListeners("didUpdate")){const{layoutBox:o,measuredBox:a}=e.layout,{animationType:h}=e.options,_=i.source!==e.layout.source;h==="size"?eachAxis(at=>{const ot=_?i.measuredBox[at]:i.layoutBox[at],lt=calcLength(ot);ot.min=o[at].min,ot.max=ot.min+lt}):shouldAnimatePositionOnly(h,i.layoutBox,o)&&eachAxis(at=>{const ot=_?i.measuredBox[at]:i.layoutBox[at],lt=calcLength(o[at]);ot.max=ot.min+lt,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[at].max=e.relativeTarget[at].min+lt)});const g=createDelta();calcBoxDelta(g,o,i.layoutBox);const _e=createDelta();_?calcBoxDelta(_e,e.applyTransform(a,!0),i.measuredBox):calcBoxDelta(_e,o,i.layoutBox);const st=!isDeltaZero(g);let tt=!1;if(!e.resumeFrom){const at=e.getClosestProjectingParent();if(at&&!at.resumeFrom){const{snapshot:ot,layout:lt}=at;if(ot&&lt){const ct=createBox();calcRelativePosition(ct,i.layoutBox,ot.layoutBox);const $=createBox();calcRelativePosition($,o,lt.layoutBox),boxEqualsRounded(ct,$)||(tt=!0),at.options.layoutRoot&&(e.relativeTarget=$,e.relativeTargetOrigin=ct,e.relativeParent=at)}}}e.notifyListeners("didUpdate",{layout:o,snapshot:i,delta:_e,layoutDelta:g,hasLayoutChanged:st,hasRelativeLayoutChanged:tt})}else if(e.isLead()){const{onExitComplete:o}=e.options;o&&o()}e.options.transition=void 0}function propagateDirtyNodes(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function cleanDirtyNodes(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function clearSnapshot(e){e.clearSnapshot()}function clearMeasurements(e){e.clearMeasurements()}function clearIsLayoutDirty(e){e.isLayoutDirty=!1}function resetTransformStyle(e){const{visualElement:i}=e.options;i&&i.getProps().onBeforeLayoutMeasure&&i.notify("BeforeLayoutMeasure"),e.resetTransform()}function finishAnimation(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function resolveTargetDelta(e){e.resolveTargetDelta()}function calcProjection(e){e.calcProjection()}function resetSkewAndRotation(e){e.resetSkewAndRotation()}function removeLeadSnapshots(e){e.removeLeadSnapshot()}function mixAxisDelta(e,i,s){e.translate=mixNumber$1(i.translate,0,s),e.scale=mixNumber$1(i.scale,1,s),e.origin=i.origin,e.originPoint=i.originPoint}function mixAxis(e,i,s,o){e.min=mixNumber$1(i.min,s.min,o),e.max=mixNumber$1(i.max,s.max,o)}function mixBox(e,i,s,o){mixAxis(e.x,i.x,s.x,o),mixAxis(e.y,i.y,s.y,o)}function hasOpacityCrossfade(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const defaultLayoutTransition={duration:.45,ease:[.4,0,.1,1]},userAgentContains=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),roundPoint=userAgentContains("applewebkit/")&&!userAgentContains("chrome/")?Math.round:noop;function roundAxis(e){e.min=roundPoint(e.min),e.max=roundPoint(e.max)}function roundBox(e){roundAxis(e.x),roundAxis(e.y)}function shouldAnimatePositionOnly(e,i,s){return e==="position"||e==="preserve-aspect"&&!isNear(aspectRatio(i),aspectRatio(s),.2)}function checkNodeWasScrollRoot(e){var i;return e!==e.root&&((i=e.scroll)==null?void 0:i.wasRoot)}const DocumentProjectionNode=createProjectionNode$1({attachResizeListener:(e,i)=>addDomEvent(e,"resize",i),measureScroll:()=>{var e,i;return{x:document.documentElement.scrollLeft||((e=document.body)==null?void 0:e.scrollLeft)||0,y:document.documentElement.scrollTop||((i=document.body)==null?void 0:i.scrollTop)||0}},checkIsScrollRoot:()=>!0}),rootProjectionNode={current:void 0},HTMLProjectionNode=createProjectionNode$1({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!rootProjectionNode.current){const e=new DocumentProjectionNode({});e.mount(window),e.setOptions({layoutScroll:!0}),rootProjectionNode.current=e}return rootProjectionNode.current},resetTransform:(e,i)=>{e.style.transform=i!==void 0?i:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),MotionConfigContext=reactExports.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function usePresence(e=!0){const i=reactExports.useContext(PresenceContext);if(i===null)return[!0,null];const{isPresent:s,onExitComplete:o,register:a}=i,h=reactExports.useId();reactExports.useEffect(()=>{if(e)return a(h)},[e]);const _=reactExports.useCallback(()=>e&&o&&o(h),[h,o,e]);return!s&&o?[!1,_]:[!0]}const LazyContext=reactExports.createContext({strict:!1}),featureProps={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]};let isInitialized=!1;function initFeatureDefinitions(){if(isInitialized)return;const e={};for(const i in featureProps)e[i]={isEnabled:s=>featureProps[i].some(o=>!!s[o])};setFeatureDefinitions(e),isInitialized=!0}function getInitializedFeatureDefinitions(){return initFeatureDefinitions(),getFeatureDefinitions()}function loadFeatures(e){const i=getInitializedFeatureDefinitions();for(const s in e)i[s]={...i[s],...e[s]};setFeatureDefinitions(i)}const validMotionProps=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","propagate","ignoreStrict","viewport"]);function isValidMotionProp(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||validMotionProps.has(e)}let shouldForward=e=>!isValidMotionProp(e);function loadExternalIsValidProp(e){typeof e=="function"&&(shouldForward=i=>i.startsWith("on")?!isValidMotionProp(i):e(i))}try{loadExternalIsValidProp(require("@emotion/is-prop-valid").default)}catch{}function filterProps(e,i,s){const o={};for(const a in e)a==="values"&&typeof e.values=="object"||(shouldForward(a)||s===!0&&isValidMotionProp(a)||!i&&!isValidMotionProp(a)||e.draggable&&a.startsWith("onDrag"))&&(o[a]=e[a]);return o}const MotionContext=reactExports.createContext({});function getCurrentTreeVariants(e,i){if(isControllingVariants(e)){const{initial:s,animate:o}=e;return{initial:s===!1||isVariantLabel(s)?s:void 0,animate:isVariantLabel(o)?o:void 0}}return e.inherit!==!1?i:{}}function useCreateMotionContext(e){const{initial:i,animate:s}=getCurrentTreeVariants(e,reactExports.useContext(MotionContext));return reactExports.useMemo(()=>({initial:i,animate:s}),[variantLabelsAsDependency(i),variantLabelsAsDependency(s)])}function variantLabelsAsDependency(e){return Array.isArray(e)?e.join(" "):e}const createHtmlRenderState=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function copyRawValuesOnly(e,i,s){for(const o in i)!isMotionValue(i[o])&&!isForcedMotionValue(o,s)&&(e[o]=i[o])}function useInitialMotionValues({transformTemplate:e},i){return reactExports.useMemo(()=>{const s=createHtmlRenderState();return buildHTMLStyles(s,i,e),Object.assign({},s.vars,s.style)},[i])}function useStyle(e,i){const s=e.style||{},o={};return copyRawValuesOnly(o,s,e),Object.assign(o,useInitialMotionValues(e,i)),o}function useHTMLProps(e,i){const s={},o=useStyle(e,i);return e.drag&&e.dragListener!==!1&&(s.draggable=!1,o.userSelect=o.WebkitUserSelect=o.WebkitTouchCallout="none",o.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(s.tabIndex=0),s.style=o,s}const createSvgRenderState=()=>({...createHtmlRenderState(),attrs:{}});function useSVGProps(e,i,s,o){const a=reactExports.useMemo(()=>{const h=createSvgRenderState();return buildSVGAttrs(h,i,isSVGTag(o),e.transformTemplate,e.style),{...h.attrs,style:{...h.style}}},[i]);if(e.style){const h={};copyRawValuesOnly(h,e.style,e),a.style={...h,...a.style}}return a}const lowercaseSVGElements=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function isSVGComponent(e){return typeof e!="string"||e.includes("-")?!1:!!(lowercaseSVGElements.indexOf(e)>-1||/[A-Z]/u.test(e))}function useRender(e,i,s,{latestValues:o},a,h=!1,_){const _e=(_??isSVGComponent(e)?useSVGProps:useHTMLProps)(i,o,a,e),st=filterProps(i,typeof e=="string",h),tt=e!==reactExports.Fragment?{...st,..._e,ref:s}:{},{children:at}=i,ot=reactExports.useMemo(()=>isMotionValue(at)?at.get():at,[at]);return reactExports.createElement(e,{...tt,children:ot})}function makeState({scrapeMotionValuesFromProps:e,createRenderState:i},s,o,a){return{latestValues:makeLatestValues(s,o,a,e),renderState:i()}}function makeLatestValues(e,i,s,o){const a={},h=o(e,{});for(const ot in h)a[ot]=resolveMotionValue(h[ot]);let{initial:_,animate:g}=e;const _e=isControllingVariants(e),st=isVariantNode(e);i&&st&&!_e&&e.inherit!==!1&&(_===void 0&&(_=i.initial),g===void 0&&(g=i.animate));let tt=s?s.initial===!1:!1;tt=tt||_===!1;const at=tt?g:_;if(at&&typeof at!="boolean"&&!isAnimationControls(at)){const ot=Array.isArray(at)?at:[at];for(let lt=0;lt<ot.length;lt++){const ct=resolveVariantFromProps(e,ot[lt]);if(ct){const{transitionEnd:$,transition:c,...d}=ct;for(const j in d){let et=d[j];if(Array.isArray(et)){const nt=tt?et.length-1:0;et=et[nt]}et!==null&&(a[j]=et)}for(const j in $)a[j]=$[j]}}}return a}const makeUseVisualState=e=>(i,s)=>{const o=reactExports.useContext(MotionContext),a=reactExports.useContext(PresenceContext),h=()=>makeState(e,i,o,a);return s?h():useConstant(h)},useHTMLVisualState=makeUseVisualState({scrapeMotionValuesFromProps:scrapeMotionValuesFromProps$1,createRenderState:createHtmlRenderState}),useSVGVisualState=makeUseVisualState({scrapeMotionValuesFromProps,createRenderState:createSvgRenderState}),motionComponentSymbol=Symbol.for("motionComponentSymbol");function useMotionRef(e,i,s){const o=reactExports.useRef(s);reactExports.useInsertionEffect(()=>{o.current=s});const a=reactExports.useRef(null);return reactExports.useCallback(h=>{var g;h&&((g=e.onMount)==null||g.call(e,h)),i&&(h?i.mount(h):i.unmount());const _=o.current;if(typeof _=="function")if(h){const _e=_(h);typeof _e=="function"&&(a.current=_e)}else a.current?(a.current(),a.current=null):_(h);else _&&(_.current=h)},[i])}const SwitchLayoutGroupContext=reactExports.createContext({});function isRefObject(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function useVisualElement(e,i,s,o,a,h){var et,nt;const{visualElement:_}=reactExports.useContext(MotionContext),g=reactExports.useContext(LazyContext),_e=reactExports.useContext(PresenceContext),st=reactExports.useContext(MotionConfigContext),tt=st.reducedMotion,at=st.skipAnimations,ot=reactExports.useRef(null),lt=reactExports.useRef(!1);o=o||g.renderer,!ot.current&&o&&(ot.current=o(e,{visualState:i,parent:_,props:s,presenceContext:_e,blockInitialAnimation:_e?_e.initial===!1:!1,reducedMotionConfig:tt,skipAnimations:at,isSVG:h}),lt.current&&ot.current&&(ot.current.manuallyAnimateOnMount=!0));const ct=ot.current,$=reactExports.useContext(SwitchLayoutGroupContext);ct&&!ct.projection&&a&&(ct.type==="html"||ct.type==="svg")&&createProjectionNode(ot.current,s,a,$);const c=reactExports.useRef(!1);reactExports.useInsertionEffect(()=>{ct&&c.current&&ct.update(s,_e)});const d=s[optimizedAppearDataAttribute],j=reactExports.useRef(!!d&&!((et=window.MotionHandoffIsComplete)!=null&&et.call(window,d))&&((nt=window.MotionHasOptimisedAnimation)==null?void 0:nt.call(window,d)));return useIsomorphicLayoutEffect(()=>{lt.current=!0,ct&&(c.current=!0,window.MotionIsMounted=!0,ct.updateFeatures(),ct.scheduleRenderMicrotask(),j.current&&ct.animationState&&ct.animationState.animateChanges())}),reactExports.useEffect(()=>{ct&&(!j.current&&ct.animationState&&ct.animationState.animateChanges(),j.current&&(queueMicrotask(()=>{var ut;(ut=window.MotionHandoffMarkAsComplete)==null||ut.call(window,d)}),j.current=!1),ct.enteringChildren=void 0)}),ct}function createProjectionNode(e,i,s,o){const{layoutId:a,layout:h,drag:_,dragConstraints:g,layoutScroll:_e,layoutRoot:st,layoutCrossfade:tt}=i;e.projection=new s(e.latestValues,i["data-framer-portal-id"]?void 0:getClosestProjectingNode(e.parent)),e.projection.setOptions({layoutId:a,layout:h,alwaysMeasureLayout:!!_||g&&isRefObject(g),visualElement:e,animationType:typeof h=="string"?h:"both",initialPromotionConfig:o,crossfade:tt,layoutScroll:_e,layoutRoot:st})}function getClosestProjectingNode(e){if(e)return e.options.allowProjection!==!1?e.projection:getClosestProjectingNode(e.parent)}function createMotionComponent(e,{forwardMotionProps:i=!1,type:s}={},o,a){o&&loadFeatures(o);const h=s?s==="svg":isSVGComponent(e),_=h?useSVGVisualState:useHTMLVisualState;function g(st,tt){let at;const ot={...reactExports.useContext(MotionConfigContext),...st,layoutId:useLayoutId(st)},{isStatic:lt}=ot,ct=useCreateMotionContext(st),$=_(st,lt);if(!lt&&isBrowser$1){useStrictMode();const c=getProjectionFunctionality(ot);at=c.MeasureLayout,ct.visualElement=useVisualElement(e,$,ot,a,c.ProjectionNode,h)}return jsxRuntimeExports.jsxs(MotionContext.Provider,{value:ct,children:[at&&ct.visualElement?jsxRuntimeExports.jsx(at,{visualElement:ct.visualElement,...ot}):null,useRender(e,st,useMotionRef($,ct.visualElement,tt),$,lt,i,h)]})}g.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const _e=reactExports.forwardRef(g);return _e[motionComponentSymbol]=e,_e}function useLayoutId({layoutId:e}){const i=reactExports.useContext(LayoutGroupContext).id;return i&&e!==void 0?i+"-"+e:e}function useStrictMode(e,i){reactExports.useContext(LazyContext).strict}function getProjectionFunctionality(e){const i=getInitializedFeatureDefinitions(),{drag:s,layout:o}=i;if(!s&&!o)return{};const a={...s,...o};return{MeasureLayout:s!=null&&s.isEnabled(e)||o!=null&&o.isEnabled(e)?a.MeasureLayout:void 0,ProjectionNode:a.ProjectionNode}}function createMotionProxy(e,i){if(typeof Proxy>"u")return createMotionComponent;const s=new Map,o=(h,_)=>createMotionComponent(h,_,e,i),a=(h,_)=>o(h,_);return new Proxy(a,{get:(h,_)=>_==="create"?o:(s.has(_)||s.set(_,createMotionComponent(_,void 0,e,i)),s.get(_))})}const createDomVisualElement=(e,i)=>i.isSVG??isSVGComponent(e)?new SVGVisualElement(i):new HTMLVisualElement(i,{allowProjection:e!==reactExports.Fragment});class AnimationFeature extends Feature{constructor(i){super(i),i.animationState||(i.animationState=createAnimationState(i))}updateAnimationControlsSubscription(){const{animate:i}=this.node.getProps();isAnimationControls(i)&&(this.unmountControls=i.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:i}=this.node.getProps(),{animate:s}=this.node.prevProps||{};i!==s&&this.updateAnimationControlsSubscription()}unmount(){var i;this.node.animationState.reset(),(i=this.unmountControls)==null||i.call(this)}}let id=0;class ExitAnimationFeature extends Feature{constructor(){super(...arguments),this.id=id++}update(){if(!this.node.presenceContext)return;const{isPresent:i,onExitComplete:s}=this.node.presenceContext,{isPresent:o}=this.node.prevPresenceContext||{};if(!this.node.animationState||i===o)return;const a=this.node.animationState.setActive("exit",!i);s&&!i&&a.then(()=>{s(this.id)})}mount(){const{register:i,onExitComplete:s}=this.node.presenceContext||{};s&&s(this.id),i&&(this.unmount=i(this.id))}unmount(){}}const animations={animation:{Feature:AnimationFeature},exit:{Feature:ExitAnimationFeature}};function extractEventInfo(e){return{point:{x:e.pageX,y:e.pageY}}}const addPointerInfo=e=>i=>isPrimaryPointer(i)&&e(i,extractEventInfo(i));function addPointerEvent(e,i,s,o){return addDomEvent(e,i,addPointerInfo(s),o)}const getContextWindow=({current:e})=>e?e.ownerDocument.defaultView:null,distance=(e,i)=>Math.abs(e-i);function distance2D(e,i){const s=distance(e.x,i.x),o=distance(e.y,i.y);return Math.sqrt(s**2+o**2)}const overflowStyles=new Set(["auto","scroll"]);class PanSession{constructor(i,s,{transformPagePoint:o,contextWindow:a=window,dragSnapToOrigin:h=!1,distanceThreshold:_=3,element:g}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=lt=>{this.handleScroll(lt.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const lt=getPanInfo(this.lastMoveEventInfo,this.history),ct=this.startEvent!==null,$=distance2D(lt.offset,{x:0,y:0})>=this.distanceThreshold;if(!ct&&!$)return;const{point:c}=lt,{timestamp:d}=frameData;this.history.push({...c,timestamp:d});const{onStart:j,onMove:et}=this.handlers;ct||(j&&j(this.lastMoveEvent,lt),this.startEvent=this.lastMoveEvent),et&&et(this.lastMoveEvent,lt)},this.handlePointerMove=(lt,ct)=>{this.lastMoveEvent=lt,this.lastMoveEventInfo=transformPoint(ct,this.transformPagePoint),frame.update(this.updatePoint,!0)},this.handlePointerUp=(lt,ct)=>{this.end();const{onEnd:$,onSessionEnd:c,resumeAnimation:d}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&d&&d(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const j=getPanInfo(lt.type==="pointercancel"?this.lastMoveEventInfo:transformPoint(ct,this.transformPagePoint),this.history);this.startEvent&&$&&$(lt,j),c&&c(lt,j)},!isPrimaryPointer(i))return;this.dragSnapToOrigin=h,this.handlers=s,this.transformPagePoint=o,this.distanceThreshold=_,this.contextWindow=a||window;const _e=extractEventInfo(i),st=transformPoint(_e,this.transformPagePoint),{point:tt}=st,{timestamp:at}=frameData;this.history=[{...tt,timestamp:at}];const{onSessionStart:ot}=s;ot&&ot(i,getPanInfo(st,this.history)),this.removeListeners=pipe(addPointerEvent(this.contextWindow,"pointermove",this.handlePointerMove),addPointerEvent(this.contextWindow,"pointerup",this.handlePointerUp),addPointerEvent(this.contextWindow,"pointercancel",this.handlePointerUp)),g&&this.startScrollTracking(g)}startScrollTracking(i){let s=i.parentElement;for(;s;){const o=getComputedStyle(s);(overflowStyles.has(o.overflowX)||overflowStyles.has(o.overflowY))&&this.scrollPositions.set(s,{x:s.scrollLeft,y:s.scrollTop}),s=s.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0,passive:!0}),window.addEventListener("scroll",this.onWindowScroll,{passive:!0}),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(i){const s=this.scrollPositions.get(i);if(!s)return;const o=i===window,a=o?{x:window.scrollX,y:window.scrollY}:{x:i.scrollLeft,y:i.scrollTop},h={x:a.x-s.x,y:a.y-s.y};h.x===0&&h.y===0||(o?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=h.x,this.lastMoveEventInfo.point.y+=h.y):this.history.length>0&&(this.history[0].x-=h.x,this.history[0].y-=h.y),this.scrollPositions.set(i,a),frame.update(this.updatePoint,!0))}updateHandlers(i){this.handlers=i}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),cancelFrame(this.updatePoint)}}function transformPoint(e,i){return i?{point:i(e.point)}:e}function subtractPoint(e,i){return{x:e.x-i.x,y:e.y-i.y}}function getPanInfo({point:e},i){return{point:e,delta:subtractPoint(e,lastDevicePoint(i)),offset:subtractPoint(e,startDevicePoint(i)),velocity:getVelocity(i,.1)}}function startDevicePoint(e){return e[0]}function lastDevicePoint(e){return e[e.length-1]}function getVelocity(e,i){if(e.length<2)return{x:0,y:0};let s=e.length-1,o=null;const a=lastDevicePoint(e);for(;s>=0&&(o=e[s],!(a.timestamp-o.timestamp>secondsToMilliseconds(i)));)s--;if(!o)return{x:0,y:0};o===e[0]&&e.length>2&&a.timestamp-o.timestamp>secondsToMilliseconds(i)*2&&(o=e[1]);const h=millisecondsToSeconds(a.timestamp-o.timestamp);if(h===0)return{x:0,y:0};const _={x:(a.x-o.x)/h,y:(a.y-o.y)/h};return _.x===1/0&&(_.x=0),_.y===1/0&&(_.y=0),_}function applyConstraints(e,{min:i,max:s},o){return i!==void 0&&e<i?e=o?mixNumber$1(i,e,o.min):Math.max(e,i):s!==void 0&&e>s&&(e=o?mixNumber$1(s,e,o.max):Math.min(e,s)),e}function calcRelativeAxisConstraints(e,i,s){return{min:i!==void 0?e.min+i:void 0,max:s!==void 0?e.max+s-(e.max-e.min):void 0}}function calcRelativeConstraints(e,{top:i,left:s,bottom:o,right:a}){return{x:calcRelativeAxisConstraints(e.x,s,a),y:calcRelativeAxisConstraints(e.y,i,o)}}function calcViewportAxisConstraints(e,i){let s=i.min-e.min,o=i.max-e.max;return i.max-i.min<e.max-e.min&&([s,o]=[o,s]),{min:s,max:o}}function calcViewportConstraints(e,i){return{x:calcViewportAxisConstraints(e.x,i.x),y:calcViewportAxisConstraints(e.y,i.y)}}function calcOrigin(e,i){let s=.5;const o=calcLength(e),a=calcLength(i);return a>o?s=progress(i.min,i.max-o,e.min):o>a&&(s=progress(e.min,e.max-a,i.min)),clamp(0,1,s)}function rebaseAxisConstraints(e,i){const s={};return i.min!==void 0&&(s.min=i.min-e.min),i.max!==void 0&&(s.max=i.max-e.min),s}const defaultElastic=.35;function resolveDragElastic(e=defaultElastic){return e===!1?e=0:e===!0&&(e=defaultElastic),{x:resolveAxisElastic(e,"left","right"),y:resolveAxisElastic(e,"top","bottom")}}function resolveAxisElastic(e,i,s){return{min:resolvePointElastic(e,i),max:resolvePointElastic(e,s)}}function resolvePointElastic(e,i){return typeof e=="number"?e:e[i]||0}const elementDragControls=new WeakMap;class VisualElementDragControls{constructor(i){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=createBox(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=i}start(i,{snapToCursor:s=!1,distanceThreshold:o}={}){const{presenceContext:a}=this.visualElement;if(a&&a.isPresent===!1)return;const h=at=>{s&&this.snapToCursor(extractEventInfo(at).point),this.stopAnimation()},_=(at,ot)=>{const{drag:lt,dragPropagation:ct,onDragStart:$}=this.getProps();if(lt&&!ct&&(this.openDragLock&&this.openDragLock(),this.openDragLock=setDragLock(lt),!this.openDragLock))return;this.latestPointerEvent=at,this.latestPanInfo=ot,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),eachAxis(d=>{let j=this.getAxisMotionValue(d).get()||0;if(percent.test(j)){const{projection:et}=this.visualElement;if(et&&et.layout){const nt=et.layout.layoutBox[d];nt&&(j=calcLength(nt)*(parseFloat(j)/100))}}this.originPoint[d]=j}),$&&frame.update(()=>$(at,ot),!1,!0),addValueToWillChange(this.visualElement,"transform");const{animationState:c}=this.visualElement;c&&c.setActive("whileDrag",!0)},g=(at,ot)=>{this.latestPointerEvent=at,this.latestPanInfo=ot;const{dragPropagation:lt,dragDirectionLock:ct,onDirectionLock:$,onDrag:c}=this.getProps();if(!lt&&!this.openDragLock)return;const{offset:d}=ot;if(ct&&this.currentDirection===null){this.currentDirection=getCurrentDirection(d),this.currentDirection!==null&&$&&$(this.currentDirection);return}this.updateAxis("x",ot.point,d),this.updateAxis("y",ot.point,d),this.visualElement.render(),c&&frame.update(()=>c(at,ot),!1,!0)},_e=(at,ot)=>{this.latestPointerEvent=at,this.latestPanInfo=ot,this.stop(at,ot),this.latestPointerEvent=null,this.latestPanInfo=null},st=()=>{const{dragSnapToOrigin:at}=this.getProps();(at||this.constraints)&&this.startAnimation({x:0,y:0})},{dragSnapToOrigin:tt}=this.getProps();this.panSession=new PanSession(i,{onSessionStart:h,onStart:_,onMove:g,onSessionEnd:_e,resumeAnimation:st},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:tt,distanceThreshold:o,contextWindow:getContextWindow(this.visualElement),element:this.visualElement.current})}stop(i,s){const o=i||this.latestPointerEvent,a=s||this.latestPanInfo,h=this.isDragging;if(this.cancel(),!h||!a||!o)return;const{velocity:_}=a;this.startAnimation(_);const{onDragEnd:g}=this.getProps();g&&frame.postRender(()=>g(o,a))}cancel(){this.isDragging=!1;const{projection:i,animationState:s}=this.visualElement;i&&(i.isAnimationBlocked=!1),this.endPanSession();const{dragPropagation:o}=this.getProps();!o&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),s&&s.setActive("whileDrag",!1)}endPanSession(){this.panSession&&this.panSession.end(),this.panSession=void 0}updateAxis(i,s,o){const{drag:a}=this.getProps();if(!o||!shouldDrag(i,a,this.currentDirection))return;const h=this.getAxisMotionValue(i);let _=this.originPoint[i]+o[i];this.constraints&&this.constraints[i]&&(_=applyConstraints(_,this.constraints[i],this.elastic[i])),h.set(_)}resolveConstraints(){var h;const{dragConstraints:i,dragElastic:s}=this.getProps(),o=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(h=this.visualElement.projection)==null?void 0:h.layout,a=this.constraints;i&&isRefObject(i)?this.constraints||(this.constraints=this.resolveRefConstraints()):i&&o?this.constraints=calcRelativeConstraints(o.layoutBox,i):this.constraints=!1,this.elastic=resolveDragElastic(s),a!==this.constraints&&!isRefObject(i)&&o&&this.constraints&&!this.hasMutatedConstraints&&eachAxis(_=>{this.constraints!==!1&&this.getAxisMotionValue(_)&&(this.constraints[_]=rebaseAxisConstraints(o.layoutBox[_],this.constraints[_]))})}resolveRefConstraints(){const{dragConstraints:i,onMeasureDragConstraints:s}=this.getProps();if(!i||!isRefObject(i))return!1;const o=i.current,{projection:a}=this.visualElement;if(!a||!a.layout)return!1;const h=measurePageBox(o,a.root,this.visualElement.getTransformPagePoint());let _=calcViewportConstraints(a.layout.layoutBox,h);if(s){const g=s(convertBoxToBoundingBox(_));this.hasMutatedConstraints=!!g,g&&(_=convertBoundingBoxToBox(g))}return _}startAnimation(i){const{drag:s,dragMomentum:o,dragElastic:a,dragTransition:h,dragSnapToOrigin:_,onDragTransitionEnd:g}=this.getProps(),_e=this.constraints||{},st=eachAxis(tt=>{if(!shouldDrag(tt,s,this.currentDirection))return;let at=_e&&_e[tt]||{};_&&(at={min:0,max:0});const ot=a?200:1e6,lt=a?40:1e7,ct={type:"inertia",velocity:o?i[tt]:0,bounceStiffness:ot,bounceDamping:lt,timeConstant:750,restDelta:1,restSpeed:10,...h,...at};return this.startAxisValueAnimation(tt,ct)});return Promise.all(st).then(g)}startAxisValueAnimation(i,s){const o=this.getAxisMotionValue(i);return addValueToWillChange(this.visualElement,i),o.start(animateMotionValue(i,o,0,s,this.visualElement,!1))}stopAnimation(){eachAxis(i=>this.getAxisMotionValue(i).stop())}getAxisMotionValue(i){const s=`_drag${i.toUpperCase()}`,o=this.visualElement.getProps(),a=o[s];return a||this.visualElement.getValue(i,(o.initial?o.initial[i]:void 0)||0)}snapToCursor(i){eachAxis(s=>{const{drag:o}=this.getProps();if(!shouldDrag(s,o,this.currentDirection))return;const{projection:a}=this.visualElement,h=this.getAxisMotionValue(s);if(a&&a.layout){const{min:_,max:g}=a.layout.layoutBox[s],_e=h.get()||0;h.set(i[s]-mixNumber$1(_,g,.5)+_e)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:i,dragConstraints:s}=this.getProps(),{projection:o}=this.visualElement;if(!isRefObject(s)||!o||!this.constraints)return;this.stopAnimation();const a={x:0,y:0};eachAxis(_=>{const g=this.getAxisMotionValue(_);if(g&&this.constraints!==!1){const _e=g.get();a[_]=calcOrigin({min:_e,max:_e},this.constraints[_])}});const{transformTemplate:h}=this.visualElement.getProps();this.visualElement.current.style.transform=h?h({},""):"none",o.root&&o.root.updateScroll(),o.updateLayout(),this.constraints=!1,this.resolveConstraints(),eachAxis(_=>{if(!shouldDrag(_,i,null))return;const g=this.getAxisMotionValue(_),{min:_e,max:st}=this.constraints[_];g.set(mixNumber$1(_e,st,a[_]))}),this.visualElement.render()}addListeners(){if(!this.visualElement.current)return;elementDragControls.set(this.visualElement,this);const i=this.visualElement.current,s=addPointerEvent(i,"pointerdown",st=>{const{drag:tt,dragListener:at=!0}=this.getProps(),ot=st.target,lt=ot!==i&&isElementTextInput(ot);tt&&at&&!lt&&this.start(st)});let o;const a=()=>{const{dragConstraints:st}=this.getProps();isRefObject(st)&&st.current&&(this.constraints=this.resolveRefConstraints(),o||(o=startResizeObservers(i,st.current,()=>this.scalePositionWithinConstraints())))},{projection:h}=this.visualElement,_=h.addEventListener("measure",a);h&&!h.layout&&(h.root&&h.root.updateScroll(),h.updateLayout()),frame.read(a);const g=addDomEvent(window,"resize",()=>this.scalePositionWithinConstraints()),_e=h.addEventListener("didUpdate",({delta:st,hasLayoutChanged:tt})=>{this.isDragging&&tt&&(eachAxis(at=>{const ot=this.getAxisMotionValue(at);ot&&(this.originPoint[at]+=st[at].translate,ot.set(ot.get()+st[at].translate))}),this.visualElement.render())});return()=>{g(),s(),_(),_e&&_e(),o&&o()}}getProps(){const i=this.visualElement.getProps(),{drag:s=!1,dragDirectionLock:o=!1,dragPropagation:a=!1,dragConstraints:h=!1,dragElastic:_=defaultElastic,dragMomentum:g=!0}=i;return{...i,drag:s,dragDirectionLock:o,dragPropagation:a,dragConstraints:h,dragElastic:_,dragMomentum:g}}}function skipFirstCall(e){let i=!0;return()=>{if(i){i=!1;return}e()}}function startResizeObservers(e,i,s){const o=resize(e,skipFirstCall(s)),a=resize(i,skipFirstCall(s));return()=>{o(),a()}}function shouldDrag(e,i,s){return(i===!0||i===e)&&(s===null||s===e)}function getCurrentDirection(e,i=10){let s=null;return Math.abs(e.y)>i?s="y":Math.abs(e.x)>i&&(s="x"),s}class DragGesture extends Feature{constructor(i){super(i),this.removeGroupControls=noop,this.removeListeners=noop,this.controls=new VisualElementDragControls(i)}mount(){const{dragControls:i}=this.node.getProps();i&&(this.removeGroupControls=i.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||noop}update(){const{dragControls:i}=this.node.getProps(),{dragControls:s}=this.node.prevProps||{};i!==s&&(this.removeGroupControls(),i&&(this.removeGroupControls=i.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners(),this.controls.isDragging||this.controls.endPanSession()}}const asyncHandler=e=>(i,s)=>{e&&frame.update(()=>e(i,s),!1,!0)};class PanGesture extends Feature{constructor(){super(...arguments),this.removePointerDownListener=noop}onPointerDown(i){this.session=new PanSession(i,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:getContextWindow(this.node)})}createPanHandlers(){const{onPanSessionStart:i,onPanStart:s,onPan:o,onPanEnd:a}=this.node.getProps();return{onSessionStart:asyncHandler(i),onStart:asyncHandler(s),onMove:asyncHandler(o),onEnd:(h,_)=>{delete this.session,a&&frame.postRender(()=>a(h,_))}}}mount(){this.removePointerDownListener=addPointerEvent(this.node.current,"pointerdown",i=>this.onPointerDown(i))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}let hasTakenAnySnapshot=!1;class MeasureLayoutWithContext extends reactExports.Component{componentDidMount(){const{visualElement:i,layoutGroup:s,switchLayoutGroup:o,layoutId:a}=this.props,{projection:h}=i;h&&(s.group&&s.group.add(h),o&&o.register&&a&&o.register(h),hasTakenAnySnapshot&&h.root.didUpdate(),h.addEventListener("animationComplete",()=>{this.safeToRemove()}),h.setOptions({...h.options,layoutDependency:this.props.layoutDependency,onExitComplete:()=>this.safeToRemove()})),globalProjectionState.hasEverUpdated=!0}getSnapshotBeforeUpdate(i){const{layoutDependency:s,visualElement:o,drag:a,isPresent:h}=this.props,{projection:_}=o;return _&&(_.isPresent=h,i.layoutDependency!==s&&_.setOptions({..._.options,layoutDependency:s}),hasTakenAnySnapshot=!0,a||i.layoutDependency!==s||s===void 0||i.isPresent!==h?_.willUpdate():this.safeToRemove(),i.isPresent!==h&&(h?_.promote():_.relegate()||frame.postRender(()=>{const g=_.getStack();(!g||!g.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:i}=this.props.visualElement;i&&(i.root.didUpdate(),microtask.postRender(()=>{!i.currentAnimation&&i.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:i,layoutGroup:s,switchLayoutGroup:o}=this.props,{projection:a}=i;hasTakenAnySnapshot=!0,a&&(a.scheduleCheckAfterUnmount(),s&&s.group&&s.group.remove(a),o&&o.deregister&&o.deregister(a))}safeToRemove(){const{safeToRemove:i}=this.props;i&&i()}render(){return null}}function MeasureLayout(e){const[i,s]=usePresence(),o=reactExports.useContext(LayoutGroupContext);return jsxRuntimeExports.jsx(MeasureLayoutWithContext,{...e,layoutGroup:o,switchLayoutGroup:reactExports.useContext(SwitchLayoutGroupContext),isPresent:i,safeToRemove:s})}const drag={pan:{Feature:PanGesture},drag:{Feature:DragGesture,ProjectionNode:HTMLProjectionNode,MeasureLayout}};function handleHoverEvent(e,i,s){const{props:o}=e;e.animationState&&o.whileHover&&e.animationState.setActive("whileHover",s==="Start");const a="onHover"+s,h=o[a];h&&frame.postRender(()=>h(i,extractEventInfo(i)))}class HoverGesture extends Feature{mount(){const{current:i}=this.node;i&&(this.unmount=hover(i,(s,o)=>(handleHoverEvent(this.node,o,"Start"),a=>handleHoverEvent(this.node,a,"End"))))}unmount(){}}class FocusGesture extends Feature{constructor(){super(...arguments),this.isActive=!1}onFocus(){let i=!1;try{i=this.node.current.matches(":focus-visible")}catch{i=!0}!i||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=pipe(addDomEvent(this.node.current,"focus",()=>this.onFocus()),addDomEvent(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function handlePressEvent(e,i,s){const{props:o}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&o.whileTap&&e.animationState.setActive("whileTap",s==="Start");const a="onTap"+(s==="End"?"":s),h=o[a];h&&frame.postRender(()=>h(i,extractEventInfo(i)))}class PressGesture extends Feature{mount(){const{current:i}=this.node;if(!i)return;const{globalTapTarget:s,propagate:o}=this.node.props;this.unmount=press(i,(a,h)=>(handlePressEvent(this.node,h,"Start"),(_,{success:g})=>handlePressEvent(this.node,_,g?"End":"Cancel")),{useGlobalTarget:s,stopPropagation:(o==null?void 0:o.tap)===!1})}unmount(){}}const observerCallbacks=new WeakMap,observers=new WeakMap,fireObserverCallback=e=>{const i=observerCallbacks.get(e.target);i&&i(e)},fireAllObserverCallbacks=e=>{e.forEach(fireObserverCallback)};function initIntersectionObserver({root:e,...i}){const s=e||document;observers.has(s)||observers.set(s,{});const o=observers.get(s),a=JSON.stringify(i);return o[a]||(o[a]=new IntersectionObserver(fireAllObserverCallbacks,{root:e,...i})),o[a]}function observeIntersection(e,i,s){const o=initIntersectionObserver(i);return observerCallbacks.set(e,s),o.observe(e),()=>{observerCallbacks.delete(e),o.unobserve(e)}}const thresholdNames={some:0,all:1};class InViewFeature extends Feature{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:i={}}=this.node.getProps(),{root:s,margin:o,amount:a="some",once:h}=i,_={root:s?s.current:void 0,rootMargin:o,threshold:typeof a=="number"?a:thresholdNames[a]},g=_e=>{const{isIntersecting:st}=_e;if(this.isInView===st||(this.isInView=st,h&&!st&&this.hasEnteredView))return;st&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",st);const{onViewportEnter:tt,onViewportLeave:at}=this.node.getProps(),ot=st?tt:at;ot&&ot(_e)};return observeIntersection(this.node.current,_,g)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:i,prevProps:s}=this.node;["amount","margin","root"].some(hasViewportOptionChanged(i,s))&&this.startObserver()}unmount(){}}function hasViewportOptionChanged({viewport:e={}},{viewport:i={}}={}){return s=>e[s]!==i[s]}const gestureAnimations={inView:{Feature:InViewFeature},tap:{Feature:PressGesture},focus:{Feature:FocusGesture},hover:{Feature:HoverGesture}},layout={layout:{ProjectionNode:HTMLProjectionNode,MeasureLayout}},featureBundle={...animations,...gestureAnimations,...drag,...layout},motion=createMotionProxy(featureBundle,createDomVisualElement),Overview=()=>jsxRuntimeExports.jsx("div",{className:"min-h-[calc(100vh-4rem)] flex items-center justify-center px-8 py-16",children:jsxRuntimeExports.jsxs(motion.div,{className:"max-w-4xl mx-auto",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[jsxRuntimeExports.jsxs(motion.div,{className:"text-center mb-12",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.2},children:[jsxRuntimeExports.jsx("h1",{className:"text-5xl md:text-6xl font-bold mb-4 bg-gradient-to-r from-blue-400 via-purple-500 to-pink-500 bg-clip-text text-transparent",children:"SILCS FragMaps"}),jsxRuntimeExports.jsx("h2",{className:"text-3xl md:text-4xl font-light text-gray-300 mb-6",children:"P38 MAP Kinase Interactive Demo"}),jsxRuntimeExports.jsx("div",{className:"w-24 h-1 bg-gradient-to-r from-blue-400 to-purple-600 mx-auto rounded-full"})]}),jsxRuntimeExports.jsxs(motion.div,{className:"space-y-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:[jsxRuntimeExports.jsxs(motion.div,{className:"glass-morphism rounded-xl p-8",whileHover:{scale:1.02},transition:{type:"spring",stiffness:300},children:[jsxRuntimeExports.jsx("h3",{className:"text-2xl font-semibold mb-4 text-blue-400",children:"Scientific Overview"}),jsxRuntimeExports.jsxs("div",{className:"space-y-4 text-gray-300 leading-relaxed",children:[jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("strong",{children:"P38 MAP Kinase"})," is a crucial signaling protein that regulates cellular stress responses and inflammation pathways. As a member of the mitogen-activated protein kinase family, it controls essential processes including cell proliferation, differentiation, and apoptosis. The protein structure (PDB: 3FLY) displayed here showcases the characteristic bilobal kinase architecture, with the ATP-binding site strategically positioned between the N- and C-terminal lobes."]}),jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("strong",{children:"SILCS FragMaps"})," provide three-dimensional maps of favorable interaction sites within protein binding pockets. Generated through molecular dynamics simulations with small organic fragments, these maps reveal where different chemical functionalities preferentially bind. Each colored region represents energetically favorable locations for specific types of molecular interactionshydrophobic, hydrogen bonding, electrostatic, and aromatic."]})]})]}),jsxRuntimeExports.jsxs(motion.div,{className:"glass-morphism rounded-xl p-8",whileHover:{scale:1.02},transition:{type:"spring",stiffness:300},children:[jsxRuntimeExports.jsx("h3",{className:"text-2xl font-semibold mb-4 text-purple-400",children:"Interactive Exploration"}),jsxRuntimeExports.jsxs("div",{className:"space-y-4 text-gray-300 leading-relaxed",children:[jsxRuntimeExports.jsx("p",{children:"This interactive demo enables you to explore how ligand molecules interact with P38 MAP Kinase through the lens of SILCS FragMaps. You can toggle different FragMap types to visualize hydrophobic regions, hydrogen bond donors and acceptors, electrostatic hotspots, and aromatic interaction sites. By comparing crystal ligand positions with SILCS-MC refined poses, you'll gain insights into the molecular determinants of binding affinity and selectivity."}),jsxRuntimeExports.jsx("p",{children:"The visualization demonstrates how ligand functional groups align with favorable FragMap regions, providing a scientific basis for understanding structure-activity relationships and guiding rational drug design decisions."})]})]}),jsxRuntimeExports.jsx(motion.div,{className:"grid grid-cols-1 md:grid-cols-3 gap-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},children:[{title:"3D Molecular Viewer",description:"Interactive Mol* viewer with protein and ligand visualization",color:"from-blue-500 to-blue-600"},{title:"FragMap Overlays",description:"Toggle multiple FragMap types with adjustable isovalues",color:"from-purple-500 to-purple-600"},{title:"Scientific Narrative",description:"Guided exploration with scroll-driven storytelling",color:"from-pink-500 to-pink-600"}].map((e,i)=>jsxRuntimeExports.jsxs(motion.div,{className:"glass-morphism rounded-lg p-6 text-center",whileHover:{scale:1.05,y:-5},transition:{type:"spring",stiffness:300},children:[jsxRuntimeExports.jsx("div",{className:`w-16 h-16 mx-auto mb-4 rounded-full bg-gradient-to-r ${e.color} flex items-center justify-center`,children:jsxRuntimeExports.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:i===0?"M13 10V3L4 14h7v7l9-11h-7z":i===1?"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z":"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),jsxRuntimeExports.jsx("h4",{className:"text-lg font-semibold mb-2 text-white",children:e.title}),jsxRuntimeExports.jsx("p",{className:"text-gray-400 text-sm",children:e.description})]},i))}),jsxRuntimeExports.jsxs(motion.div,{className:"text-center mt-12",initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},children:[jsxRuntimeExports.jsx(motion.button,{onClick:()=>window.location.hash="#interactive",className:"px-8 py-4 bg-gradient-to-r from-blue-500 to-purple-600 text-white font-semibold rounded-lg shadow-lg hover:shadow-xl transition-all duration-300",whileHover:{scale:1.05},whileTap:{scale:.95},children:"Launch Interactive Demo"}),jsxRuntimeExports.jsx("p",{className:"mt-4 text-gray-400 text-sm",children:"Scroll down or click above to begin exploring"})]})]})]})}),initialState={viewer:null,isLoading:!0,error:null,activeFragMaps:new Set([]),isoValues:{},fragMapVolumes:{},fragMapRepresentations:{},selectedProteinPart:null,proteinSelectionBounds:null,selectedLigand:"crystal",loadedLigands:new Set,currentNarrative:"",isSpinning:!1,cameraReset:!1},actionTypes={SET_VIEWER:"SET_VIEWER",SET_LOADING:"SET_LOADING",SET_ERROR:"SET_ERROR",TOGGLE_FRAGMAP:"TOGGLE_FRAGMAP",SET_ISOVALUE:"SET_ISOVALUE",SET_FRAGMAP_VOLUMES:"SET_FRAGMAP_VOLUMES",SET_FRAGMAP_REPRESENTATIONS:"SET_FRAGMAP_REPRESENTATIONS",SET_PROTEIN_PART:"SET_PROTEIN_PART",SET_PROTEIN_SELECTION_BOUNDS:"SET_PROTEIN_SELECTION_BOUNDS",SET_SELECTED_LIGAND:"SET_SELECTED_LIGAND",ADD_LOADED_LIGAND:"ADD_LOADED_LIGAND",CLEAR_LOADED_LIGANDS:"CLEAR_LOADED_LIGANDS",SET_NARRATIVE:"SET_NARRATIVE",TOGGLE_SPIN:"TOGGLE_SPIN",RESET_CAMERA:"RESET_CAMERA",CLEAR_FRAGMAPS:"CLEAR_FRAGMAPS"},viewerReducer=(e,i)=>{switch(i.type){case actionTypes.SET_VIEWER:return{...e,viewer:i.payload,error:null};case actionTypes.SET_LOADING:return{...e,isLoading:i.payload};case actionTypes.SET_ERROR:return{...e,error:i.payload,isLoading:!1};case actionTypes.TOGGLE_FRAGMAP:const s=new Set(e.activeFragMaps);return s.has(i.payload)?s.delete(i.payload):s.add(i.payload),{...e,activeFragMaps:s};case actionTypes.SET_ISOVALUE:return{...e,isoValues:{...e.isoValues,[i.payload.fragMapId]:i.payload.value}};case actionTypes.SET_FRAGMAP_VOLUMES:return{...e,fragMapVolumes:i.payload};case actionTypes.SET_FRAGMAP_REPRESENTATIONS:return{...e,fragMapRepresentations:i.payload};case actionTypes.SET_PROTEIN_PART:return{...e,selectedProteinPart:i.payload};case actionTypes.SET_PROTEIN_SELECTION_BOUNDS:return{...e,proteinSelectionBounds:i.payload};case actionTypes.SET_SELECTED_LIGAND:return{...e,selectedLigand:i.payload};case actionTypes.ADD_LOADED_LIGAND:const o=new Set(e.loadedLigands);return o.add(i.payload),{...e,loadedLigands:o};case actionTypes.CLEAR_LOADED_LIGANDS:return{...e,loadedLigands:new Set};case actionTypes.SET_NARRATIVE:return{...e,currentNarrative:i.payload};case actionTypes.TOGGLE_SPIN:return{...e,isSpinning:!e.isSpinning};case actionTypes.RESET_CAMERA:return{...e,cameraReset:!e.cameraReset};case actionTypes.CLEAR_FRAGMAPS:return{...e,activeFragMaps:new Set};default:return e}},ViewerContext=reactExports.createContext(),ViewerProvider=({children:e})=>{const[i,s]=reactExports.useReducer(viewerReducer,initialState),o={setViewer:reactExports.useCallback(h=>{s({type:actionTypes.SET_VIEWER,payload:h})},[]),setLoading:reactExports.useCallback(h=>{s({type:actionTypes.SET_LOADING,payload:h})},[]),setError:reactExports.useCallback(h=>{s({type:actionTypes.SET_ERROR,payload:h})},[]),toggleFragMap:reactExports.useCallback(h=>{s({type:actionTypes.TOGGLE_FRAGMAP,payload:h})},[]),setIsoValue:reactExports.useCallback((h,_)=>{s({type:actionTypes.SET_ISOVALUE,payload:{fragMapId:h,value:_}})},[]),setFragMapVolumes:reactExports.useCallback(h=>{s({type:actionTypes.SET_FRAGMAP_VOLUMES,payload:h})},[]),setFragMapRepresentations:reactExports.useCallback(h=>{s({type:actionTypes.SET_FRAGMAP_REPRESENTATIONS,payload:h})},[]),setProteinPart:reactExports.useCallback(h=>{s({type:actionTypes.SET_PROTEIN_PART,payload:h})},[]),setProteinSelectionBounds:reactExports.useCallback(h=>{s({type:actionTypes.SET_PROTEIN_SELECTION_BOUNDS,payload:h})},[]),setSelectedLigand:reactExports.useCallback(h=>{s({type:actionTypes.SET_SELECTED_LIGAND,payload:h})},[]),addLoadedLigand:reactExports.useCallback(h=>{s({type:actionTypes.ADD_LOADED_LIGAND,payload:h})},[]),clearLoadedLigands:reactExports.useCallback(()=>{s({type:actionTypes.CLEAR_LOADED_LIGANDS})},[]),setNarrative:reactExports.useCallback(h=>{s({type:actionTypes.SET_NARRATIVE,payload:h})},[]),toggleSpin:reactExports.useCallback(()=>{s({type:actionTypes.TOGGLE_SPIN})},[]),resetCamera:reactExports.useCallback(()=>{s({type:actionTypes.RESET_CAMERA})},[]),clearFragMaps:reactExports.useCallback(()=>{s({type:actionTypes.CLEAR_FRAGMAPS})},[])},a={state:i,actions:o};return jsxRuntimeExports.jsx(ViewerContext.Provider,{value:a,children:e})},useViewer=()=>{const e=reactExports.useContext(ViewerContext);if(!e)throw new Error("useViewer must be used within a ViewerProvider");return e},fragMapTypes=[{id:"hydrophobic",name:"Hydrophobic",color:"#ffeb3b",description:"Favorable regions for non-polar groups where van der Waals interactions and water exclusion drive binding. These areas typically correspond to protein pockets with low solvent accessibility.",isoValue:-.8,minIsoValue:-2,maxIsoValue:.5,bindingRelevance:"Critical for ligand affinity through hydrophobic effect and desolvation energy contributions.",fileName:"3fly.apolar.gfe.dx",thresholdMode:"lower"},{id:"hbond-donor",name:"H-Bond Donor",color:"#2196f3",description:"Optimal locations for hydrogen bond donors (NH, OH groups) to form favorable interactions with protein acceptors. Geometry constraints: D-H...A distance < 3.5, angle > 120.",isoValue:-.8,minIsoValue:-2,maxIsoValue:.5,bindingRelevance:"Essential for specificity and binding enthalpy, particularly in the hinge region of kinases.",fileName:"3fly.hbdon.gfe.dx",thresholdMode:"lower"},{id:"hbond-acceptor",name:"H-Bond Acceptor",color:"#f44336",description:"Favorable sites for hydrogen bond acceptors (carbonyl O, heteroatoms) to receive hydrogen bonds from protein donors. Critical for anchoring ligands in the binding site.",isoValue:-.8,minIsoValue:-2,maxIsoValue:.5,bindingRelevance:"Provides directional interactions that determine binding orientation and specificity.",fileName:"3fly.hbacc.gfe.dx",thresholdMode:"lower"},{id:"positive",name:"Positive Ion",color:"#4caf50",description:"Regions where positively charged groups (amines, guanidinium) experience favorable electrostatic interactions with negative protein residues (Asp, Glu). Follows Coulombic attraction principles.",isoValue:-.8,minIsoValue:-2,maxIsoValue:.5,bindingRelevance:"Important for salt bridge formation and long-range electrostatic steering toward the binding site.",fileName:"3fly.mamn.gfe.dx",thresholdMode:"lower"},{id:"negative",name:"Negative Ion",color:"#9c27b0",description:"Areas where negatively charged groups (carboxylates, phosphates) can form favorable interactions with positive protein residues (Lys, Arg, His). Often found near active site entrances.",isoValue:-.8,minIsoValue:-2,maxIsoValue:.5,bindingRelevance:"Contributes to binding through ionic interactions and charge complementarity.",fileName:"3fly.meoo.gfe.dx",thresholdMode:"lower"},{id:"aromatic",name:"Aromatic",color:"#ff9800",description:"Favorable regions for aromatic ring systems to engage in - stacking or edge-to-face interactions. Optimal centroid distance: 3.4-4.0 with specific orientation preferences.",isoValue:-.8,minIsoValue:-2,maxIsoValue:.5,bindingRelevance:"Provides additional binding energy through dispersion forces and quadrupole interactions.",fileName:"3fly.acec.gfe.dx",thresholdMode:"lower"}],fragMapLegend=[{color:"#ffeb3b",name:"Hydrophobic",desc:"Non-polar interactions"},{color:"#2196f3",name:"H-Bond Donor",desc:"Hydrogen bond donors"},{color:"#f44336",name:"H-Bond Acceptor",desc:"Hydrogen bond acceptors"},{color:"#4caf50",name:"Positive Ion",desc:"Cationic interactions"},{color:"#9c27b0",name:"Negative Ion",desc:"Anionic interactions"},{color:"#ff9800",name:"Aromatic",desc:"- stacking"}],fragMapDefaults={gridSpacing:1,sphereRadius:.3,opacity:.6,defaultIsoValues:{hydrophobic:-.8,"hbond-donor":-.6,"hbond-acceptor":-.6,positive:-.5,negative:-.5,aromatic:-.7,water:.3,exclusion:.5},gridSampleRate:2,presetValues:[-1.5,-1,-.5,0],adaptiveSampling:!0,smoothingSigma:.8},fragMapTypes$1=Object.freeze(Object.defineProperty({__proto__:null,fragMapDefaults,fragMapLegend,fragMapTypes},Symbol.toStringTag,{value:"Module"})),scriptRel="modulepreload",assetsURL=function(e){return"/"+e},seen={},__vitePreload=function(i,s,o){let a=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const _=document.querySelector("meta[property=csp-nonce]"),g=(_==null?void 0:_.nonce)||(_==null?void 0:_.getAttribute("nonce"));a=Promise.allSettled(s.map(_e=>{if(_e=assetsURL(_e),_e in seen)return;seen[_e]=!0;const st=_e.endsWith(".css"),tt=st?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${_e}"]${tt}`))return;const at=document.createElement("link");if(at.rel=st?"stylesheet":scriptRel,st||(at.as="script"),at.crossOrigin="",at.href=_e,g&&at.setAttribute("nonce",g),document.head.appendChild(at),st)return new Promise((ot,lt)=>{at.addEventListener("load",ot),at.addEventListener("error",()=>lt(new Error(`Unable to preload CSS for ${_e}`)))})}))}function h(_){const g=new Event("vite:preloadError",{cancelable:!0});if(g.payload=_,window.dispatchEvent(g),!g.defaultPrevented)throw _}return a.then(_=>{for(const g of _||[])g.status==="rejected"&&h(g.reason);return i().catch(h)})},parseFragMapFile=e=>{console.log("[FRAGMAP-PARSER] === PARSING START ==="),console.log(`[FRAGMAP-PARSER] File content length: ${e.length} characters`);const i=e.split(`
`);console.log(`[FRAGMAP-PARSER] Total lines: ${i.length}`);const s={};let o=[],a=!0,h=0;for(let g=0;g<i.length;g++){const st=i[g].trim();if(st.startsWith("#")||st===""){console.log(`[FRAGMAP-PARSER] Line ${g+1}: Skipping comment/empty line`);continue}if(a){console.log(`[FRAGMAP-PARSER] Line ${g+1} (header): "${st}"`);const tt=st.match(/(\w+)\s+(.+)/);if(tt){const at=tt[1].trim();let ot=tt[2].trim();if(console.log(`[FRAGMAP-PARSER] Parsed header: ${at} = "${ot}"`),!isNaN(ot)&&ot!==""&&(ot=parseFloat(ot),console.log(`[FRAGMAP-PARSER] Converted to number: ${at} = ${ot}`)),at==="NELEMENTS"){const lt=ot.split(/\s+/).map(ct=>parseInt(ct.trim()));lt.length===3?(s.nx=lt[0],s.ny=lt[1],s.nz=lt[2],console.log(`[FRAGMAP-PARSER] Found dimensions: ${lt.join(" x ")}`)):console.warn(`[FRAGMAP-PARSER] Invalid NELEMENTS format: ${ot}`)}else if(at==="CENTER")if(typeof ot=="string"&&ot.includes(" ")){const lt=ot.split(/\s+/).map(ct=>parseFloat(ct.trim()));lt.length===3?(s.origin_x=lt[0],s.origin_y=lt[1],s.origin_z=lt[2],console.log(`[FRAGMAP-PARSER] Found CENTER coordinates: ${lt.join(", ")}`)):console.warn(`[FRAGMAP-PARSER] Invalid CENTER format: ${ot}`)}else s[at]=ot,console.log(`[FRAGMAP-PARSER] Found ${at}: ${ot}`);else at==="SPACING"?(s.grid_spacing=ot,console.log(`[FRAGMAP-PARSER] Found spacing: ${ot}`)):(s[at]=ot,console.log(`[FRAGMAP-PARSER] Stored header: ${at} = ${ot}`))}else/^\s*[\d\.\-]/.test(st)?(console.log(`[FRAGMAP-PARSER] Line ${g+1}: First data line detected, ending header section`),a=!1):console.log(`[FRAGMAP-PARSER] Line ${g+1}: Unparsed header line: "${st}"`)}if(!a){h++;const at=st.split(/\s+/).filter(ot=>ot!=="").map(ot=>{const lt=parseFloat(ot);return isNaN(lt)&&console.warn(`[FRAGMAP-PARSER] Line ${g+1}: Invalid number "${ot}"`),lt}).filter(ot=>!isNaN(ot));at.length>0&&(o=o.concat(at),(h<=5||h%1e4===0)&&console.log(`[FRAGMAP-PARSER] Line ${g+1}: Added ${at.length} values, total so far: ${o.length}`))}}console.log("[FRAGMAP-PARSER] === PARSING COMPLETE ==="),console.log("[FRAGMAP-PARSER] Header info:",s),console.log(`[FRAGMAP-PARSER] Data lines processed: ${h}`),console.log(`[FRAGMAP-PARSER] Total grid values: ${o.length}`);const _=(s.nx||40)*(s.ny||40)*(s.nz||40);if(console.log(`[FRAGMAP-PARSER] Expected grid points: ${_} (nx=${s.nx}, ny=${s.ny}, nz=${s.nz})`),console.log(`[FRAGMAP-PARSER] Actual grid points: ${o.length}`),o.length!==_){if(console.warn(`[FRAGMAP-PARSER] Grid data length mismatch: expected ${_}, got ${o.length}`),o.length>_)console.warn(`[FRAGMAP-PARSER] Truncating excess data from ${o.length} to ${_}`),o=o.slice(0,_);else{console.warn(`[FRAGMAP-PARSER] Padding missing data from ${o.length} to ${_} with zeros`);const g=new Float32Array(_);g.set(o),o=g}console.log(`[FRAGMAP-PARSER] Adjusted grid data length: ${o.length}`)}console.log("[FRAGMAP-PARSER]  Parsing successful, converting to Float32Array"),o=new Float32Array(o);try{console.log("[FRAGMAP-PARSER] First 10 values:",Array.from(o.slice(0,10))),console.log("[FRAGMAP-PARSER] Last 10 values:",Array.from(o.slice(-10)));let g=1/0,_e=-1/0;for(let st=0;st<Math.min(o.length,1e4);st++){const tt=o[st];tt<g&&(g=tt),tt>_e&&(_e=tt)}console.log(`[FRAGMAP-PARSER] Sampled min value: ${g}, max value: ${_e} (first 10k values)`)}catch{console.log("[FRAGMAP-PARSER] Debug logging skipped due to large array size")}return{gridInfo:s,gridData:o}},loadBinaryFragMap=async e=>{try{console.log(` [BINARY-LOADER] Loading binary FragMap ${e}...`);const i=fragMapTypes.find(tt=>tt.id===e);if(!i)throw new Error(`Unknown FragMap type: ${e}`);const o=`/assets/fragmaps-binary/${i.fileName.replace(".dx",".json")}`;console.log(` [BINARY-LOADER] Loading: ${o}`);const a=await fetch(o);if(!a.ok)throw new Error(`Binary file not found: ${o}`);const h=await a.json(),_=atob(h.gridDataBase64),g=new Uint8Array(_.length);for(let tt=0;tt<_.length;tt++)g[tt]=_.charCodeAt(tt);const _e=new Float32Array(g.buffer),st={gridInfo:h.metadata.gridInfo,gridData:_e,format:"binary",fragMapId:e,loadedAt:new Date().toISOString(),sourceFile:h.metadata.sourceFile};return console.log(` [BINARY-LOADER] Loaded ${e}:`,{gridDimensions:st.gridInfo,dataPoints:st.gridData.length,sourceFile:h.metadata.sourceFile,loadTime:"instant"}),st}catch(i){throw console.error(` [BINARY-LOADER] Error loading binary FragMap ${e}:`,i),i}},checkBinaryFilesAvailable=async()=>{try{return(await fetch("/assets/fragmaps-binary/index.json")).ok}catch{return!1}},parseMapFile=(e,i)=>(console.log(`Parsing .map file for ${i}`),{...parseFragMapFile(e),format:"map",fragMapId:i,loadedAt:new Date().toISOString()}),parseDxFile=(e,i)=>{console.log(`Parsing .dx file for ${i}`);const s=e.split(`
`),o={};let a=[],h=!1;for(const g of s){const _e=g.trim();if(!(_e.startsWith("#")||_e==="")){if(_e.includes("object 1 class grid")){const st=_e.match(/counts\s+(\d+)\s+(\d+)\s+(\d+)/);st&&(o.nx=parseInt(st[1]),o.ny=parseInt(st[2]),o.nz=parseInt(st[3]));continue}if(_e.includes("origin")){const st=_e.match(/origin\s+([-\d.]+)\s+([-\d.]+)\s+([-\d.]+)/);st&&(o.origin_x=parseFloat(st[1]),o.origin_y=parseFloat(st[2]),o.origin_z=parseFloat(st[3]));continue}if(_e.includes("delta")){const st=_e.match(/delta\s+([-\d.]+)\s+([-\d.]+)\s+([-\d.]+)/);st&&(o.grid_spacing=parseFloat(st[1]));continue}if(_e.includes("class array")&&_e.includes("data follows")){h=!0;continue}if(h&&_e){const st=_e.split(/\s+/).map(tt=>parseFloat(tt)).filter(tt=>!isNaN(tt));a=a.concat(st)}}}o.nx=o.nx||40,o.ny=o.ny||40,o.nz=o.nz||40,o.grid_spacing=o.grid_spacing||.8,o.origin_x=o.origin_x||4.81,o.origin_y=o.origin_y||-5.26,o.origin_z=o.origin_z||15.16;const _=o.nx*o.ny*o.nz;if(a.length!==_)if(console.warn(`DX file has ${a.length} values, expected ${_}`),a.length<_){const g=new Float32Array(_);g.set(a),a=g}else a=new Float32Array(a.slice(0,_));else a=new Float32Array(a);return{gridInfo:o,gridData:a,format:"dx",fragMapId:i,loadedAt:new Date().toISOString()}},FRAGMAP_FORMATS={MAP:{extension:".map",parser:parseMapFile,description:"SILCS native format with grid metadata"},DX:{extension:".dx",parser:parseDxFile,description:"OpenDX format for volumetric data"}},loadFragMapData=async(e,i="/assets/fragmaps-dx",s="dx")=>{try{console.log(`Loading FragMap ${e}...`);const{fragMapTypes:o}=await __vitePreload(async()=>{const{fragMapTypes:_e}=await Promise.resolve().then(()=>fragMapTypes$1);return{fragMapTypes:_e}},void 0),a=o.find(_e=>_e.id===e);if(!a)throw new Error(`Unknown FragMap type: ${e}`);if(await checkBinaryFilesAvailable())try{console.log(" [FRAGMAP-LOADER] Using binary loader for instant loading");const _e=await loadBinaryFragMap(e);if(!validateFragMapData(_e))throw new Error(`Invalid binary FragMap data for ${e}`);return console.log(` [FRAGMAP-LOADER] Successfully loaded binary FragMap ${e}:`,{gridDimensions:_e.gridInfo,dataPoints:_e.gridData.length,energyRange:getEnergyRange(_e.gridData),loadMethod:"binary"}),_e}catch(_e){console.warn(" [FRAGMAP-LOADER] Binary load failed, falling back to DX:",_e.message)}console.log(` [FRAGMAP-LOADER] Using DX file loader for ${e}`);const _=a.fileName||`${e}${s==="dx"?".dx":".map"}`;console.log(`Loading FragMap file: ${_}`);const g=await tryLoadFile(_,i,s);if(!g)throw new Error(`Could not load FragMap ${e} (${_}) - file not found or parsing failed`);if(!validateFragMapData(g))throw new Error(`Invalid FragMap data for ${e}`);return console.log(`Successfully loaded FragMap ${e}:`,{gridDimensions:g.gridInfo,dataPoints:g.gridData.length,energyRange:getEnergyRange(g.gridData),loadMethod:"dx"}),g}catch(o){throw console.error(`Error loading FragMap ${e}:`,o),o}},tryLoadFile=async(e,i,s)=>{try{console.log("[FRAGMAP-LOADER] === FILE LOAD START ==="),console.log(`[FRAGMAP-LOADER] Attempting to load: ${e}`),console.log(`[FRAGMAP-LOADER] Base URL: ${i}`),console.log(`[FRAGMAP-LOADER] Format: ${s}`);const o=FRAGMAP_FORMATS[s.toUpperCase()];if(!o)return console.error(`[FRAGMAP-LOADER] Unsupported format: ${s}`),null;const a=`${i}/${e}`;console.log(`[FRAGMAP-LOADER] Full file URL: ${a}`),console.log("[FRAGMAP-LOADER] Initiating fetch request...");const h=await fetch(a);if(console.log(`[FRAGMAP-LOADER] Fetch response status: ${h.status} ${h.statusText}`),console.log("[FRAGMAP-LOADER] Response headers:",Object.fromEntries(h.headers.entries())),!h.ok)return console.log(`[FRAGMAP-LOADER] File not found or not accessible: ${a}`),null;const _=await h.text();console.log(`[FRAGMAP-LOADER] File content length: ${_.length} characters`),console.log("[FRAGMAP-LOADER] First 200 characters:",_.substring(0,200)),console.log("[FRAGMAP-LOADER] Last 200 characters:",_.substring(-200));const g=_.split(`
`);console.log(`[FRAGMAP-LOADER] Total lines in file: ${g.length}`),console.log("[FRAGMAP-LOADER] First 10 lines:"),g.slice(0,10).forEach((tt,at)=>{console.log(`[FRAGMAP-LOADER] Line ${at+1}: "${tt}"`)});const _e=g.filter(tt=>{const at=tt.trim();return at&&!at.startsWith("#")&&/^[\d\.\d]/.test(at)});console.log(`[FRAGMAP-LOADER] Data lines (starting with numbers): ${_e.length}`),_e.length===0&&console.warn("[FRAGMAP-LOADER] No data lines found in file - this might be the issue"),console.log(`[FRAGMAP-LOADER] Parsing with ${s} format parser...`);const st=o.parser(_,e);return console.log("[FRAGMAP-LOADER] Parse result:",st),st&&st.gridData?console.log(`[FRAGMAP-LOADER]  Successfully parsed ${st.gridData.length} grid values`):console.error("[FRAGMAP-LOADER]  Parse failed - no grid data found"),st}catch(o){return console.error(`[FRAGMAP-LOADER] Failed to load ${s} format for ${e}:`,o),console.error("[FRAGMAP-LOADER] Error details:",o.message,o.stack),null}},validateFragMapData=e=>{if(!e||typeof e!="object")return!1;const{gridInfo:i,gridData:s}=e;if(!i||typeof i!="object")return!1;const o=["nx","ny","nz"];for(const h of o)if(!i[h]||typeof i[h]!="number")return!1;if(!s||!(s instanceof Float32Array))return!1;const a=i.nx*i.ny*i.nz;return s.length===a},getEnergyRange=e=>{if(!e||e.length===0)return{min:0,max:0,mean:0};let i=0,s=1/0,o=-1/0;for(let h=0;h<e.length;h++){const _=e[h];i+=_,s=Math.min(s,_),o=Math.max(o,_)}const a=i/e.length;return{min:s,max:o,mean:a}},remove3DmolFragMap=async(e,i)=>{var s;try{console.log(` [3DMOL-FRAGMAP] Removing FragMap shapes (group: ${i})...`);const o=e.viewer,a=(s=e.shapeIds)==null?void 0:s.get(i);if(a&&Array.isArray(a)){for(const h of a)try{o.removeShape(h)}catch{}e.shapeIds.delete(i)}else console.warn(` [3DMOL-FRAGMAP] No shape handles found for ${i}, clearing all shapes`),o.removeAllShapes();return o.render(),console.log(" [3DMOL-FRAGMAP] FragMap shapes removed"),!0}catch(o){return console.error(" [3DMOL-FRAGMAP] Error removing FragMap:",o),!1}},load3DmolSphereFragMap=async(e,i,s)=>{var o;try{console.log(` [3DMOL-SPHERES] Loading sphere-based FragMap ${i}...`);const a=await loadFragMapData(i);if(!a)throw new Error(`Failed to load FragMap data for ${i}`);let h=null,_=15;if(!((o=s.selectedProteinPart)!=null&&o.bounds)&&e.models){let at=null;for(const[ot,lt]of e.models)if(lt.type==="ligand"){at=ot;break}if(at){const ot=at.selectedAtoms({});if(ot.length>0){let lt=0,ct=0,$=0;ot.forEach(c=>{lt+=c.x,ct+=c.y,$+=c.z}),h={x:lt/ot.length,y:ct/ot.length,z:$/ot.length},console.log(" [3DMOL-SPHERES] Filtering spheres around ligand center:",h)}}}const g=generateSpheresFromGrid(a,{...s,filterCenter:h,filterRadius:_});if(!g||g.length===0)return console.warn(` [3DMOL-SPHERES] No spheres generated for ${i}`),null;console.log(` [3DMOL-SPHERES] Generated ${g.length} spheres for ${i}`);const _e=e.viewer,st=[];for(const at of g){const ot=_e.addSphere({center:{x:at.x,y:at.y,z:at.z},radius:at.radius,color:at.color,alpha:at.alpha});ot!=null&&st.push(ot)}const tt=`fragmap_${i}_${Date.now()}`;return e.shapeIds.set(tt,st),_e.render(),console.log(` [3DMOL-SPHERES] Sphere representation created for ${i} (${st.length} shapes, group: ${tt})`),{modelId:tt,sphereCount:g.length,representation:{type:"spheres",shapeGroupId:tt,fragMapId:i,config:s}}}catch(a){throw console.error(` [3DMOL-SPHERES] Error loading sphere FragMap ${i}:`,a),a}},generateSpheresFromGrid=(e,i)=>{const{gridInfo:s,gridData:o}=e,a=[],{isoValue:h=1,sphereSize:_=.25,maxSpheres:g=1500,selectedProteinPart:_e,maxDistance:st=100,color:tt="white",filterCenter:at,filterRadius:ot=15}=i,ct=(i.thresholdMode||(h<0?"lower":"higher"))==="lower",$=h,c=s.grid_spacing||.8,d=convertColorToHex(tt);for(let j=0;j<o.length;j++){const et=o[j];let nt=!1;if(ct?et<=$&&(nt=!0):et>=$&&(nt=!0),nt){const ut=j%s.nx,b=Math.floor(j/s.nx)%s.ny,it=Math.floor(j/(s.nx*s.ny)),rt=ut*c+(s.origin_x||0),dt=b*c+(s.origin_y||0),ft=it*c+(s.origin_z||0);if(_e!=null&&_e.bounds){if(calculateDistanceToBounds(rt,dt,ft,_e.bounds)>st)continue}else if(at){const mt=rt-at.x,yt=dt-at.y,gt=ft-at.z;if(Math.sqrt(mt*mt+yt*yt+gt*gt)>ot)continue}a.push({x:rt,y:dt,z:ft,radius:_,color:d,alpha:i.alpha||.6,intensity:et})}}return ct?a.sort((j,et)=>j.intensity-et.intensity):a.sort((j,et)=>et.intensity-j.intensity),a.length>g?a.slice(0,g):a},convertColorToHex=e=>{const i={yellow:"#FFFF00",blue:"#0000FF",red:"#FF0000",green:"#00FF00",purple:"#800080",orange:"#FFA500",white:"#FFFFFF",gray:"#808080",black:"#000000"};return typeof e!="string"?"#FFFFFF":e.startsWith("#")?e:i[e.toLowerCase()]||e},calculateDistanceToBounds=(e,i,s,o)=>{if(!o)return 0;const a=Math.max(o.minX-e,0,e-o.maxX),h=Math.max(o.minY-i,0,i-o.maxY),_=Math.max(o.minZ-s,0,s-o.maxZ);return Math.sqrt(a*a+h*h+_*_)},FragMapManager=()=>{const{state:e,actions:i}=useViewer(),{viewer:s,activeFragMaps:o,isoValues:a,selectedProteinPart:h}=e,{setNarrative:_}=i,g=React.useRef(new Map),_e=React.useRef(new Set),st=reactExports.useCallback(async(tt,at,ot=!1)=>{var ct;if(!s||_e.current.has(tt)&&!ot)return;const lt=g.current.get(tt);if(!ot&&at&&lt){console.log(` [FRAGMAP-MANAGER] ${tt} already active with representation, skipping`);return}if(!ot&&!at&&!lt&&!o.has(tt)){console.log(` [FRAGMAP-MANAGER] ${tt} already inactive, skipping`);return}_e.current.add(tt),console.log(` [FRAGMAP-MANAGER] ${at?"Activating":"Deactivating"} FragMap: ${tt} (force: ${ot})`);try{const $=fragMapTypes.find(c=>c.id===tt);if(!$)return;if((lt||ot)&&(console.log(" Cleaning up existing 3Dmol FragMap representation..."),lt&&await remove3DmolFragMap(s,lt),g.current.delete(tt)),at){(ct=h==null?void 0:h.residues)!=null&&ct.length||console.log(` [FRAGMAP-MANAGER] No protein region selected - showing global FragMap for ${tt}`);const c=a[tt]||$.isoValue;try{console.log(` [FRAGMAP-MANAGER] Loading 3Dmol FragMap for ${tt}...`);const d=await load3DmolSphereFragMap(s,tt,{...$,isoValue:c,alpha:.6,sphereSize:.25,selectedProteinPart:h,isoValueRange:.1,maxDistance:100});if(!d){console.warn(`[FRAGMAP-MANAGER] No spheres returned for ${tt} - may be outside selected region or energy range`),_(`No ${$.name} spheres found in selected region. Try adjusting isovalues or selecting a different protein region.`);return}const{modelId:j}=d;g.current.set(tt,j),console.log(` [FRAGMAP-MANAGER] Created 3Dmol sphere representation for ${$.name}`)}catch(d){console.error(`[FRAGMAP-MANAGER] 3Dmol sphere rendering failed for ${tt}:`,d),_(`Failed to load ${$.name} spheres. Please try adjusting the isovalue.`)}}}catch($){console.error(`[FRAGMAP-MANAGER] Error updating ${tt}:`,$)}finally{_e.current.delete(tt)}},[s,h,a]);return reactExports.useEffect(()=>{s&&fragMapTypes.forEach(tt=>{const at=o.has(tt.id);st(tt.id,at)})},[o,s,st]),reactExports.useEffect(()=>{!s||o.size===0||o.forEach(tt=>{st(tt,!0,!0)})},[a,h,s,st]),reactExports.useEffect(()=>{var tt;s&&((tt=h==null?void 0:h.residues)!=null&&tt.length)&&o.size===0&&(localStorage.getItem("fragmap-user-interacted")==="true"||(fragMapTypes.forEach(ot=>{i.toggleFragMap(ot.id)}),_(`Protein region selected: ${h.description}. Automatically enabled all FragMaps.`)))},[h,s,o.size,i,_]),reactExports.useEffect(()=>{const tt=at=>{const ot=localStorage.getItem("fragmap-user-interacted")==="true";o.size===0&&!ot&&(fragMapTypes.forEach(lt=>i.toggleFragMap(lt.id)),_(`${at.detail.ligandName} loaded. Automatically enabled FragMaps.`))};return window.addEventListener("ligandLoaded",tt),()=>window.removeEventListener("ligandLoaded",tt)},[o.size,i,_]),reactExports.useEffect(()=>{o.size>0&&localStorage.setItem("fragmap-user-interacted","true")},[o.size]),null},IsoValueSlider=reactExports.memo(({label:e,value:i,onChange:s,min:o=-2,max:a=.5,step:h=.1,color:_="#ffffff",presetValues:g=[-1.5,-1,-.5,0]})=>{const _e=tt=>{s(parseFloat(tt.target.value))},st=()=>{const tt=(i-o)/(a-o)*100;return{background:`linear-gradient(to right, ${_} 0%, ${_} ${tt}%, rgba(255,255,255,0.1) ${tt}%, rgba(255,255,255,0.1) 100%)`}};return jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("label",{className:"text-xs font-medium text-gray-300",children:e}),jsxRuntimeExports.jsx("span",{className:"text-xs font-mono bg-white/10 px-2 py-1 rounded",style:{color:_},children:i.toFixed(1)})]}),jsxRuntimeExports.jsx("div",{className:"relative",children:jsxRuntimeExports.jsx("input",{type:"range",min:o,max:a,step:h,value:i,onChange:_e,onMouseDown:tt=>tt.stopPropagation(),onMouseUp:tt=>tt.stopPropagation(),onClick:tt=>tt.stopPropagation(),onPointerDown:tt=>tt.stopPropagation(),onPointerUp:tt=>tt.stopPropagation(),className:"w-full h-2 rounded-lg appearance-none cursor-pointer slider",style:st()})}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[jsxRuntimeExports.jsx("span",{children:o.toFixed(1)}),jsxRuntimeExports.jsx("span",{children:a.toFixed(1)})]})]})}),FragMapToggles=reactExports.memo(({activeFragMaps:e,onToggleFragMap:i,fragMapTypes:s,isoValues:o,onIsoValueChange:a,selectedProteinPart:h})=>jsxRuntimeExports.jsxs("div",{className:"control-panel",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold mb-4 text-white leading-relaxed",children:"SILCS FragMaps"}),!h||!h.residues||h.residues.length===0?jsxRuntimeExports.jsx("div",{className:"mb-4 p-3 bg-yellow-500/20 border border-yellow-500/50 rounded-lg",children:jsxRuntimeExports.jsxs("p",{className:"text-sm text-yellow-200",children:[jsxRuntimeExports.jsx("span",{className:"font-semibold",children:"Instructions:"})," Begin interacting with the protein, then enable FragMaps to learn more about binding sites."]})}):null,jsxRuntimeExports.jsx("div",{className:"space-y-3",children:s.map(_=>{const g=e.has(_.id),_e=o[_.id]||_.isoValue,st=!h||!h.residues||h.residues.length===0;return jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx("button",{onClick:tt=>{if(st){tt.preventDefault();return}console.log(` BUTTON CLICKED: ${_.id}`),tt.preventDefault(),tt.stopPropagation(),i(_.id)},disabled:st,className:`w-full fragmap-button text-left text-sm transition-colors ${g?"active":"inactive"} ${st?"opacity-50 cursor-not-allowed":"hover:bg-white/10"}`,title:st?"Select a protein part first":`Toggle ${_.name} FragMap`,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-4 h-4 rounded-full mr-3 border-2 border-white/50",style:{backgroundColor:_.color}}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"font-medium",children:_.name}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-400",children:_.description}),g&&_.bindingRelevance&&jsxRuntimeExports.jsx("div",{className:"text-xs text-blue-400 mt-1 italic",children:_.bindingRelevance})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[g&&jsxRuntimeExports.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full mr-2"}),jsxRuntimeExports.jsx("svg",{className:`w-4 h-4 transition-transform duration-200 ${g?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]})}),g&&jsxRuntimeExports.jsx("div",{className:"pl-7 pr-2",onMouseDown:tt=>tt.stopPropagation(),onMouseUp:tt=>tt.stopPropagation(),onClick:tt=>tt.stopPropagation(),onDoubleClick:tt=>tt.stopPropagation(),onPointerDown:tt=>tt.stopPropagation(),onPointerUp:tt=>tt.stopPropagation(),children:jsxRuntimeExports.jsx(IsoValueSlider,{label:"Isovalue",value:_e,onChange:tt=>a(_.id,tt),min:_.minIsoValue||fragMapDefaults.minIsoValue,max:_.maxIsoValue||fragMapDefaults.maxIsoValue,step:fragMapDefaults.isoValueStep,color:_.color,presetValues:fragMapDefaults.presetValues})})]},_.id)})})]})),ligandOptions=[{id:"crystal",name:"Crystal Ligand",description:"Original ligand from X-ray crystal structure (PDB: 3FLY). This represents the experimentally observed binding conformation with high resolution (1.8), providing the gold standard reference for evaluating computational predictions.",file:"3fly_cryst_lig.sdf",type:"crystal",significance:"Serves as the experimental ground truth for P38 MAP kinase inhibition, demonstrating key interactions with the hinge region and ATP-binding pocket."},{id:"silcs-mc-posref",name:"SILCS-MC Pose Refinement",description:"SILCS-Monte Carlo refined pose of the crystal ligand after performing limited MC sampling of translation, rotation and dihedrals to achieve minimized pose and LGFE score in the field of FragMaps. Atom-wise GFE is provided in the properties section.",file:"3fly_cryst_lig_posref.sdf",type:"silcs-mc",significance:"Demonstrates the SILCS-MC Pose Refinement protocol capability to optimize ligand poses within the FragMaps field, potentially improving binding affinity and complementarity."},{id:"goldstein-05",name:"Goldstein Ligand 05",description:"Goldstein series ligand (compound 05_2e) docked using the SILCS-MC Pose Refinement protocol. This ligand was first aligned to the crystal ligand from PDB 3FLY before refinement.",file:"p38_goldstein_05_2e.sdf",type:"silcs-mc",significance:"Represents a novel chemical scaffold optimized through SILCS-MC sampling, exploring alternative binding modes and interactions within the P38 MAP kinase binding pocket."}],LigandSelector=({selectedLigand:e,onLigandSelect:i,ligandOptions:s,isLoading:o,loadingMessage:a})=>{const h=_=>{if(console.log(` [LIGAND SELECTOR] User clicked ligand: ${_}`),console.log(` [LIGAND SELECTOR] Current selected: ${e}`),console.log(` [LIGAND SELECTOR] Is loading: ${o}`),o){console.log(" [LIGAND SELECTOR] Ignoring click - currently loading");return}console.log(e===_?` [LIGAND SELECTOR] Reloading same ligand: ${_}`:` [LIGAND SELECTOR] Switching from ${e} to ${_}`),i(_)};return jsxRuntimeExports.jsxs("div",{className:"control-panel",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold mb-4 text-white",children:"Ligand Selection"}),o&&jsxRuntimeExports.jsx("div",{className:"mb-4 p-3 bg-blue-900/20 border border-blue-500/30 rounded-lg",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center text-blue-300",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-300 mr-2"}),jsxRuntimeExports.jsx("span",{className:"text-sm",children:a})]})}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:s.map(_=>{const g=e===_.id;return jsxRuntimeExports.jsx("button",{onClick:_e=>{_e.preventDefault(),_e.stopPropagation(),h(_.id)},className:`w-full fragmap-button text-left text-sm transition-all duration-200 ${g?"active":"inactive"} ${o?"opacity-50 cursor-not-allowed":""}`,disabled:o,children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-4 h-4 rounded-full mr-3 bg-gradient-to-br from-green-400 to-blue-500 border-2 border-white/50"}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx("div",{className:"font-medium",children:_.name})})]}),g&&jsxRuntimeExports.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full"})]})},_.id)})})]})},CaptionPanel=({caption:e})=>{const{state:i}=useViewer(),{activeFragMaps:s,selectedLigand:o}=i;return jsxRuntimeExports.jsxs("div",{className:"control-panel h-full",children:[jsxRuntimeExports.jsx("div",{className:"p-4",children:jsxRuntimeExports.jsxs("div",{className:"space-y-2 text-sm text-gray-400",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),"P38 MAP Kinase (3FLY)"]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mr-2"}),s.size," Active FragMaps"]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full mr-2"}),o==="crystal"?"Crystal Ligand":o==="sil1"?"SILCS-MC Pose 1":o==="sil2"?"SILCS-MC Pose 2":"Crystal Ligand"]})]})}),jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsx("h4",{className:"text-sm font-medium text-gray-300 mb-2",children:"FragMap Colors"}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:fragMapLegend.map(a=>jsxRuntimeExports.jsxs("div",{className:"flex items-center text-xs",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full mr-2 border border-white/30",style:{backgroundColor:a.color}}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("span",{className:"text-gray-300",children:a.name}),jsxRuntimeExports.jsxs("span",{className:"text-gray-500 ml-1",children:["(",a.desc,")"]})]})]},a.name))})]})]})};let proteinStructureCache=null;const loadProteinStructure=async()=>{if(proteinStructureCache)return console.log(" [PROTEIN-LOADER] Using cached protein structure"),proteinStructureCache;console.log(" [PROTEIN-LOADER] Loading protein structure from PDB file...");try{const e=await fetch("/assets/pdb/3FLY.pdb");if(!e.ok)throw new Error(`Failed to load PDB file: ${e.status}`);const i=await e.text();console.log(` [PROTEIN-LOADER] Loaded PDB file: ${i.length} characters`);const s=parsePDBFile(i);return proteinStructureCache=s,console.log(" [PROTEIN-LOADER] Successfully loaded protein structure:"),console.log(`  - Chains: ${s.chains.length}`),console.log(`  - Total residues: ${s.residues.length}`),console.log(`  - Total atoms: ${s.atoms.length}`),s}catch(e){throw console.error(" [PROTEIN-LOADER] Error loading protein structure:",e),e}},parsePDBFile=e=>{const i=e.split(`
`),s=[],o=new Map,a=new Set;console.log(` [PROTEIN-LOADER] Parsing ${i.length} lines from PDB file`);for(let _=0;_<i.length;_++){const g=i[_];if(g.startsWith("ATOM  ")||g.startsWith("HETATM")){const _e=parseAtomLine(g);if(_e){s.push(_e),a.add(_e.chainId);const st=`${_e.chainId}:${_e.resSeq}:${_e.resName}`;o.has(st)||o.set(st,{chainId:_e.chainId,resSeq:_e.resSeq,resName:_e.resName,atoms:[],center:{x:0,y:0,z:0}}),o.get(st).atoms.push(_e)}}}for(const _ of o.values()){let g=0,_e=0,st=0;for(const tt of _.atoms)g+=tt.x,_e+=tt.y,st+=tt.z;_.center={x:g/_.atoms.length,y:_e/_.atoms.length,z:st/_.atoms.length}}const h=Array.from(o.values()).sort((_,g)=>_.chainId!==g.chainId?_.chainId.localeCompare(g.chainId):_.resSeq-g.resSeq);return{atoms:s,residues:h,chains:Array.from(a).sort(),pdbContent:e,metadata:{filename:"3FLY.pdb",description:"P38 MAP Kinase",totalAtoms:s.length,totalResidues:h.length}}},parseAtomLine=e=>{try{return{serial:parseInt(e.substring(6,11).trim()),name:e.substring(12,16).trim(),resName:e.substring(17,20).trim(),chainId:e.substring(21,22).trim(),resSeq:parseInt(e.substring(22,26).trim()),x:parseFloat(e.substring(30,38).trim()),y:parseFloat(e.substring(38,46).trim()),z:parseFloat(e.substring(46,54).trim()),element:e.substring(76,78).trim(),line:e}}catch(i){return console.warn(" [PROTEIN-LOADER] Error parsing atom line:",e,i),null}},findNearbyResidues=(e,i,s=8)=>{console.log(` [PROTEIN-LOADER] Finding residues within ${s} of position (${i.x.toFixed(1)}, ${i.y.toFixed(1)}, ${i.z.toFixed(1)})`);const o=[];for(const a of e.residues){const h=calculateDistance(i,a.center);h<=s&&o.push({...a,distance:h,elementIndex:o.length})}return o.sort((a,h)=>a.distance-h.distance),console.log(` [PROTEIN-LOADER] Found ${o.length} nearby residues`),console.log(` [PROTEIN-LOADER] Distance range: ${o.length>0?o[0].distance.toFixed(2):"N/A"} to ${o.length>0?o[o.length-1].distance.toFixed(2):"N/A"} `),o},calculateDistance=(e,i)=>{const s=e.x-i.x,o=e.y-i.y,a=e.z-i.z;return Math.sqrt(s*s+o*o+a*a)},screenTo3DPosition=(e,i,s)=>{try{if(e&&e.canvas3d&&e.canvas3d.camera)try{const c=e.canvas3d.camera,d=e.canvas3d.canvas;if(d&&c){const j=d.getBoundingClientRect(),et=(i-j.left)/j.width*2-1,nt=-((s-j.top)/j.height)*2+1,ut=c.getRay(et,nt);if(ut&&ut.origin&&ut.direction){const it={x:ut.origin[0]+ut.direction[0]*50,y:ut.origin[1]+ut.direction[1]*50,z:ut.origin[2]+ut.direction[2]*50};return console.log(" [PROTEIN-LOADER] Ray-casted position:",it),it}}}catch(c){console.warn(" [PROTEIN-LOADER] Mol* coordinate mapping failed:",c)}if(!proteinStructureCache)return console.warn(" [PROTEIN-LOADER] No protein structure loaded, using center position"),{x:42.7,y:34.8,z:30.8};let o=1/0,a=1/0,h=1/0,_=-1/0,g=-1/0,_e=-1/0;for(const c of proteinStructureCache.residues){const d=c.center;o=Math.min(o,d.x),a=Math.min(a,d.y),h=Math.min(h,d.z),_=Math.max(_,d.x),g=Math.max(g,d.y),_e=Math.max(_e,d.z)}const st=(o+_)/2,tt=(a+g)/2,at=(h+_e)/2,ot=5,lt=(i-400)/200*ot,ct=(s-300)/200*ot,$={x:st+lt,y:tt+ct,z:at};return console.log(" [PROTEIN-LOADER] Fallback position:",$),$}catch(o){return console.error(" [PROTEIN-LOADER] Error in screenTo3DPosition:",o),{x:42.7,y:34.8,z:30.8}}},getResidueSelectionDescription=e=>{if(e.length===0)return"No residues selected";if(e.length===1){const a=e[0];return`${a.resName}${a.resSeq} (chain ${a.chainId})`}const i=e[0],s=e[e.length-1];if(i.chainId===s.chainId&&e.every((h,_)=>_===0?!0:h.resSeq===e[_-1].resSeq+1))return`${i.chainId}: ${i.resName}${i.resSeq}-${s.resName}${s.resSeq}`;const o=new Set(e.map(a=>a.chainId)).size;return`${e.length} residues across ${o} chain${o>1?"s":""}`},detectProteinRegion=async(e,i,s)=>{console.log(` [PROTEIN-ANALYZER] Detecting protein region at (${i}, ${s}) using PDB data`);try{const o=await loadProteinStructure(),a=screenTo3DPosition(e,i,s);console.log(" [PROTEIN-ANALYZER] Mapped screen coords to 3D position:",a),console.log(" [PROTEIN-ANALYZER] FragMap coordinate ranges (from converted data):"),console.log("   X: ~4-84 , Y: ~2-66 , Z: ~1-59 "),console.log(" [PROTEIN-ANALYZER] Protein structure bounds:");let h=1/0,_=1/0,g=1/0,_e=-1/0,st=-1/0,tt=-1/0;for(const $ of o.residues){const c=$.center;h=Math.min(h,c.x),_=Math.min(_,c.y),g=Math.min(g,c.z),_e=Math.max(_e,c.x),st=Math.max(st,c.y),tt=Math.max(tt,c.z)}console.log(`   X: ${h.toFixed(1)} to ${_e.toFixed(1)} `),console.log(`   Y: ${_.toFixed(1)} to ${st.toFixed(1)} `),console.log(`   Z: ${g.toFixed(1)} to ${tt.toFixed(1)} `);const at=Math.abs(h-4)>10||Math.abs(_e-84)>10||Math.abs(_-2)>10||Math.abs(st-66)>10;at&&(console.warn(" [PROTEIN-ANALYZER] Protein coordinates may not align with FragMap coordinates!"),console.warn("   Consider applying coordinate transformation to align systems"));const ot=findNearbyResidues(o,a,8);if(ot.length===0)return console.log(" [PROTEIN-ANALYZER] No residues found near click position"),null;const lt=ot.map($=>{let c=$.center;return c={x:$.center.x*2+20,y:$.center.y*2+20,z:$.center.z*2+15},console.log(" [PROTEIN-ANALYZER] Transformed coordinates:",$.center,"",c),{chainId:$.chainId,seqId:$.resSeq,resName:$.resName,elementIndex:$.elementIndex,coordinates:c,atomCount:$.atoms.length,distance:$.distance}}),ct=calculateResidueBounds(lt,e);return console.log(` [PROTEIN-ANALYZER] Found ${lt.length} residues using PDB data`),console.log(` [PROTEIN-ANALYZER] Selection: ${getResidueSelectionDescription(ot)}`),console.log(" [PROTEIN-ANALYZER] Bounds:",ct),{residues:lt,bounds:ct,loci:null,isDummy:!1,source:"pdb-data"}}catch(o){return console.error(" [PROTEIN-ANALYZER] Error detecting protein region:",o),console.error(" [PROTEIN-ANALYZER] Error details:",o.message,o.stack),null}},calculateResidueBounds=(e,i)=>{if(console.log(` [PROTEIN-ANALYZER] Calculating bounds for ${e.length} residues`),e.length===0)return{min:[0,0,0],max:[0,0,0]};let s=1/0,o=1/0,a=1/0,h=-1/0,_=-1/0,g=-1/0;for(const tt of e)if(tt.coordinates){const{x:at,y:ot,z:lt}=tt.coordinates;s=Math.min(s,at),o=Math.min(o,ot),a=Math.min(a,lt),h=Math.max(h,at),_=Math.max(_,ot),g=Math.max(g,lt)}const _e=5,st={min:[s-_e,o-_e,a-_e],max:[h+_e,_+_e,g+_e]};return console.log(" [PROTEIN-ANALYZER] Calculated bounds:",st),console.log(` [PROTEIN-ANALYZER] Region size: ${h-s} x ${_-o} x ${g-a} `),st},getRegionDescription=e=>getResidueSelectionDescription(e);var _3Dmol={exports:{}};/*!
 * 3dmol v2.5.4
 * JavaScript/TypeScript molecular visualization library
 * Author: David Koes and contributors
 */(function(module,exports$1){(function(i,s){module.exports=s()})(commonjsGlobal,()=>(()=>{var __webpack_modules__={"./node_modules/iobuffer/lib-esm/IOBuffer.js"(e,i,s){s.r(i),s.d(i,{IOBuffer:()=>g});var o=s("./node_modules/iobuffer/lib-esm/text.js");const a=1024*8,h=(()=>{const _e=new Uint8Array(4),st=new Uint32Array(_e.buffer);return!((st[0]=1)&_e[0])})(),_={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class g{constructor(st=a,tt={}){yn(this,"buffer");yn(this,"byteLength");yn(this,"byteOffset");yn(this,"length");yn(this,"offset");yn(this,"lastWrittenByte");yn(this,"littleEndian");yn(this,"_data");yn(this,"_mark");yn(this,"_marks");let at=!1;typeof st=="number"?st=new ArrayBuffer(st):(at=!0,this.lastWrittenByte=st.byteLength);const ot=tt.offset?tt.offset>>>0:0,lt=st.byteLength-ot;let ct=ot;(ArrayBuffer.isView(st)||st instanceof g)&&(st.byteLength!==st.buffer.byteLength&&(ct=st.byteOffset+ot),st=st.buffer),at?this.lastWrittenByte=lt:this.lastWrittenByte=0,this.buffer=st,this.length=lt,this.byteLength=lt,this.byteOffset=ct,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,ct,lt),this._mark=0,this._marks=[]}available(st=1){return this.offset+st<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(st=1){return this.offset+=st,this}back(st=1){return this.offset-=st,this}seek(st){return this.offset=st,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const st=this._marks.pop();if(st===void 0)throw new Error("Mark stack empty");return this.seek(st),this}rewind(){return this.offset=0,this}ensureAvailable(st=1){if(!this.available(st)){const at=(this.offset+st)*2,ot=new Uint8Array(at);ot.set(new Uint8Array(this.buffer)),this.buffer=ot.buffer,this.length=at,this.byteLength=at,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(st=1){return this.readArray(st,"uint8")}readArray(st,tt){const at=_[tt].BYTES_PER_ELEMENT*st,ot=this.byteOffset+this.offset,lt=this.buffer.slice(ot,ot+at);if(this.littleEndian===h&&tt!=="uint8"&&tt!=="int8"){const $=new Uint8Array(this.buffer.slice(ot,ot+at));$.reverse();const c=new _[tt]($.buffer);return this.offset+=at,c.reverse(),c}const ct=new _[tt](lt);return this.offset+=at,ct}readInt16(){const st=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,st}readUint16(){const st=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,st}readInt32(){const st=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,st}readUint32(){const st=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,st}readFloat32(){const st=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,st}readFloat64(){const st=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,st}readBigInt64(){const st=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,st}readBigUint64(){const st=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,st}readChar(){return String.fromCharCode(this.readInt8())}readChars(st=1){let tt="";for(let at=0;at<st;at++)tt+=this.readChar();return tt}readUtf8(st=1){return(0,o.decode)(this.readBytes(st))}decodeText(st=1,tt="utf8"){return(0,o.decode)(this.readBytes(st),tt)}writeBoolean(st){return this.writeUint8(st?255:0),this}writeInt8(st){return this.ensureAvailable(1),this._data.setInt8(this.offset++,st),this._updateLastWrittenByte(),this}writeUint8(st){return this.ensureAvailable(1),this._data.setUint8(this.offset++,st),this._updateLastWrittenByte(),this}writeByte(st){return this.writeUint8(st)}writeBytes(st){this.ensureAvailable(st.length);for(let tt=0;tt<st.length;tt++)this._data.setUint8(this.offset++,st[tt]);return this._updateLastWrittenByte(),this}writeInt16(st){return this.ensureAvailable(2),this._data.setInt16(this.offset,st,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(st){return this.ensureAvailable(2),this._data.setUint16(this.offset,st,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(st){return this.ensureAvailable(4),this._data.setInt32(this.offset,st,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(st){return this.ensureAvailable(4),this._data.setUint32(this.offset,st,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(st){return this.ensureAvailable(4),this._data.setFloat32(this.offset,st,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(st){return this.ensureAvailable(8),this._data.setFloat64(this.offset,st,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(st){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,st,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(st){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,st,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(st){return this.writeUint8(st.charCodeAt(0))}writeChars(st){for(let tt=0;tt<st.length;tt++)this.writeUint8(st.charCodeAt(tt));return this}writeUtf8(st){return this.writeBytes((0,o.encode)(st))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}},"./node_modules/iobuffer/lib-esm/text.js"(e,i,s){s.r(i),s.d(i,{decode:()=>o,encode:()=>h});function o(_,g="utf8"){return new TextDecoder(g).decode(_)}const a=new TextEncoder;function h(_){return a.encode(_)}},"./node_modules/netcdfjs/lib-esm/data.js"(e,i,s){s.r(i),s.d(i,{nonRecord:()=>a,record:()=>h});var o=s("./node_modules/netcdfjs/lib-esm/types.js");function a(_,g){const _e=(0,o.str2num)(g.type),st=g.size/(0,o.num2bytes)(_e),tt=new Array(st);for(let at=0;at<st;at++)tt[at]=(0,o.readType)(_,_e,1);return tt}function h(_,g,_e){const st=(0,o.str2num)(g.type),tt=g.size?g.size/(0,o.num2bytes)(st):1,at=_e.length,ot=new Array(at),lt=_e.recordStep;if(lt)for(let ct=0;ct<at;ct++){const $=_.offset;ot[ct]=(0,o.readType)(_,st,tt),_.seek($+lt)}else throw new Error("recordDimension.recordStep is undefined");return ot}},"./node_modules/netcdfjs/lib-esm/header.js"(e,i,s){s.r(i),s.d(i,{header:()=>tt});var o=s("./node_modules/netcdfjs/lib-esm/types.js"),a=s("./node_modules/netcdfjs/lib-esm/utils.js");const h=0,_=10,g=11,_e=12,st=0;function tt(ct,$){const c={version:$},d={length:ct.readUint32()},j=at(ct);Array.isArray(j)||(d.id=j.recordId,d.name=j.recordName,c.dimensions=j.dimensions),c.globalAttributes=ot(ct);const et=lt(ct,d==null?void 0:d.id,$);return Array.isArray(et)||(c.variables=et.variables,d.recordStep=et.recordStep),c.recordDimension=d,c}function at(ct){const $={};let c,d;const j=ct.readUint32();let et;if(j===h)return(0,a.notNetcdf)(ct.readUint32()!==h,"wrong empty tag for list of dimensions"),[];{(0,a.notNetcdf)(j!==_,"wrong tag for list of dimensions");const nt=ct.readUint32();et=new Array(nt);for(let ut=0;ut<nt;ut++){const b=(0,a.readName)(ct),it=ct.readUint32();it===st&&(c=ut,d=b),et[ut]={name:b,size:it}}}return c!==void 0&&($.recordId=c),d!==void 0&&($.recordName=d),$.dimensions=et,$}function ot(ct){const $=ct.readUint32();let c;if($===h)return(0,a.notNetcdf)(ct.readUint32()!==h,"wrong empty tag for list of attributes"),[];{(0,a.notNetcdf)($!==_e,"wrong tag for list of attributes");const d=ct.readUint32();c=new Array(d);for(let j=0;j<d;j++){const et=(0,a.readName)(ct),nt=ct.readUint32();(0,a.notNetcdf)(nt<1||nt>6,`non valid type ${nt}`);const ut=ct.readUint32(),b=(0,o.readType)(ct,nt,ut);(0,a.padding)(ct),c[j]={name:et,type:(0,o.num2str)(nt),value:b}}}return c}function lt(ct,$,c){const d=ct.readUint32();let j=0,et;if(d===h)return(0,a.notNetcdf)(ct.readUint32()!==h,"wrong empty tag for list of variables"),[];{(0,a.notNetcdf)(d!==g,"wrong tag for list of variables");const nt=ct.readUint32();et=new Array(nt);for(let ut=0;ut<nt;ut++){const b=(0,a.readName)(ct),it=ct.readUint32(),rt=new Array(it);for(let _t=0;_t<it;_t++)rt[_t]=ct.readUint32();const dt=ot(ct),ft=ct.readUint32();(0,a.notNetcdf)(ft<1&&ft>6,`non valid type ${ft}`);const mt=ct.readUint32();let yt=ct.readUint32();c===2&&((0,a.notNetcdf)(yt>0,"offsets larger than 4GB not supported"),yt=ct.readUint32());let gt=!1;typeof $<"u"&&rt[0]===$&&(j+=mt,gt=!0),et[ut]={name:b,dimensions:rt,attributes:dt,type:(0,o.num2str)(ft),size:mt,offset:yt,record:gt}}}return{variables:et,recordStep:j}}},"./node_modules/netcdfjs/lib-esm/index.js"(e,i,s){s.r(i),s.d(i,{NetCDFReader:()=>o.NetCDFReader});var o=s("./node_modules/netcdfjs/lib-esm/parser.js")},"./node_modules/netcdfjs/lib-esm/parser.js"(e,i,s){s.r(i),s.d(i,{NetCDFReader:()=>_e});var o=s("./node_modules/iobuffer/lib-esm/IOBuffer.js"),a=s("./node_modules/netcdfjs/lib-esm/data.js"),h=s("./node_modules/netcdfjs/lib-esm/header.js"),_=s("./node_modules/netcdfjs/lib-esm/toString.js"),g=s("./node_modules/netcdfjs/lib-esm/utils.js");class _e{constructor(tt){this.toString=_.toString;const at=new o.IOBuffer(tt);at.setBigEndian(),(0,g.notNetcdf)(at.readChars(3)!=="CDF","should start with CDF");const ot=at.readByte();(0,g.notNetcdf)(ot>2,"unknown version"),this.header=(0,h.header)(at,ot),this.buffer=at}get version(){return this.header.version===1?"classic format":"64-bit offset format"}get recordDimension(){return this.header.recordDimension}get dimensions(){return this.header.dimensions}get globalAttributes(){return this.header.globalAttributes}getAttribute(tt){const at=this.globalAttributes.find(ot=>ot.name===tt);return at?at.value:null}getDataVariableAsString(tt){const at=this.getDataVariable(tt);return at?at.join(""):null}get variables(){return this.header.variables}getDataVariable(tt){let at;if(typeof tt=="string"?at=this.header.variables.find(ot=>ot.name===tt):at=tt,at===void 0)throw new Error("Not a valid NetCDF v3.x file: variable not found");return this.buffer.seek(at.offset),at.record?(0,a.record)(this.buffer,at,this.header.recordDimension):(0,a.nonRecord)(this.buffer,at)}dataVariableExists(tt){return this.header.variables.find(ot=>ot.name===tt)!==void 0}attributeExists(tt){return this.globalAttributes.find(ot=>ot.name===tt)!==void 0}}},"./node_modules/netcdfjs/lib-esm/toString.js"(e,i,s){s.r(i),s.d(i,{toString:()=>o});function o(){const a=[];a.push("DIMENSIONS");for(const _ of this.dimensions)a.push(`  ${_.name.padEnd(30)} = size: ${_.size}`);a.push(""),a.push("GLOBAL ATTRIBUTES");for(const _ of this.globalAttributes)a.push(`  ${_.name.padEnd(30)} = ${_.value}`);const h=JSON.parse(JSON.stringify(this.variables));a.push(""),a.push("VARIABLES:");for(const _ of h){_.value=this.getDataVariable(_);let g=JSON.stringify(_.value);g.length>50&&(g=g.substring(0,50)),isNaN(_.value.length)||(g+=` (length: ${_.value.length})`),a.push(`  ${_.name.padEnd(30)} = ${g}`)}return a.join(`
`)}},"./node_modules/netcdfjs/lib-esm/types.js"(e,i,s){s.r(i),s.d(i,{num2bytes:()=>h,num2str:()=>a,readType:()=>_e,str2num:()=>_});const o={BYTE:1,CHAR:2,SHORT:3,INT:4,FLOAT:5,DOUBLE:6};function a(tt){switch(Number(tt)){case o.BYTE:return"byte";case o.CHAR:return"char";case o.SHORT:return"short";case o.INT:return"int";case o.FLOAT:return"float";case o.DOUBLE:return"double";default:return"undefined"}}function h(tt){switch(Number(tt)){case o.BYTE:return 1;case o.CHAR:return 1;case o.SHORT:return 2;case o.INT:return 4;case o.FLOAT:return 4;case o.DOUBLE:return 8;default:return-1}}function _(tt){switch(String(tt)){case"byte":return o.BYTE;case"char":return o.CHAR;case"short":return o.SHORT;case"int":return o.INT;case"float":return o.FLOAT;case"double":return o.DOUBLE;default:return-1}}function g(tt,at){if(tt!==1){const ot=new Array(tt);for(let lt=0;lt<tt;lt++)ot[lt]=at();return ot}else return at()}function _e(tt,at,ot){switch(at){case o.BYTE:return Array.from(tt.readBytes(ot));case o.CHAR:return st(tt.readChars(ot));case o.SHORT:return g(ot,tt.readInt16.bind(tt));case o.INT:return g(ot,tt.readInt32.bind(tt));case o.FLOAT:return g(ot,tt.readFloat32.bind(tt));case o.DOUBLE:return g(ot,tt.readFloat64.bind(tt));default:throw new Error(`non valid type ${at}`)}}function st(tt){return tt.charCodeAt(tt.length-1)===0?tt.substring(0,tt.length-1):tt}},"./node_modules/netcdfjs/lib-esm/utils.js"(e,i,s){s.r(i),s.d(i,{notNetcdf:()=>o,padding:()=>a,readName:()=>h});function o(_,g){if(_)throw new TypeError(`Not a valid NetCDF v3.x file: ${g}`)}function a(_){_.offset%4!==0&&_.skip(4-_.offset%4)}function h(_){const g=_.readUint32(),_e=_.readChars(g);return a(_),_e}},"./node_modules/pako/dist/pako.esm.mjs"(e,i,s){s.r(i),s.d(i,{Deflate:()=>Mo,Inflate:()=>Lo,constants:()=>Io,default:()=>Wu,deflate:()=>To,deflateRaw:()=>Co,gzip:()=>Do,inflate:()=>Po,inflateRaw:()=>Ro,ungzip:()=>Oo});/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const o=4,a=0,h=1,_=2;function g(ht){let Tt=ht.length;for(;--Tt>=0;)ht[Tt]=0}const _e=0,st=1,tt=2,at=3,ot=258,lt=29,ct=256,$=ct+1+lt,c=30,d=19,j=2*$+1,et=15,nt=16,ut=7,b=256,it=16,rt=17,dt=18,ft=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),mt=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),yt=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),gt=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),_t=512,xt=new Array(($+2)*2);g(xt);const Mt=new Array(c*2);g(Mt);const wt=new Array(_t);g(wt);const Et=new Array(ot-at+1);g(Et);const At=new Array(lt);g(At);const St=new Array(c);g(St);function bt(ht,Tt,pt,It,Bt){this.static_tree=ht,this.extra_bits=Tt,this.extra_base=pt,this.elems=It,this.max_length=Bt,this.has_stree=ht&&ht.length}let Ct,Nt,kt;function Ht(ht,Tt){this.dyn_tree=ht,this.max_code=0,this.stat_desc=Tt}const jt=ht=>ht<256?wt[ht]:wt[256+(ht>>>7)],Zt=(ht,Tt)=>{ht.pending_buf[ht.pending++]=Tt&255,ht.pending_buf[ht.pending++]=Tt>>>8&255},Xt=(ht,Tt,pt)=>{ht.bi_valid>nt-pt?(ht.bi_buf|=Tt<<ht.bi_valid&65535,Zt(ht,ht.bi_buf),ht.bi_buf=Tt>>nt-ht.bi_valid,ht.bi_valid+=pt-nt):(ht.bi_buf|=Tt<<ht.bi_valid&65535,ht.bi_valid+=pt)},Kt=(ht,Tt,pt)=>{Xt(ht,pt[Tt*2],pt[Tt*2+1])},ar=(ht,Tt)=>{let pt=0;do pt|=ht&1,ht>>>=1,pt<<=1;while(--Tt>0);return pt>>>1},or=ht=>{ht.bi_valid===16?(Zt(ht,ht.bi_buf),ht.bi_buf=0,ht.bi_valid=0):ht.bi_valid>=8&&(ht.pending_buf[ht.pending++]=ht.bi_buf&255,ht.bi_buf>>=8,ht.bi_valid-=8)},_r=(ht,Tt)=>{const pt=Tt.dyn_tree,It=Tt.max_code,Bt=Tt.stat_desc.static_tree,Ft=Tt.stat_desc.has_stree,lr=Tt.stat_desc.extra_bits,qt=Tt.stat_desc.extra_base,Or=Tt.stat_desc.max_length;let $t,ur,Jr,Rr,Ar,Fr,ln=0;for(Rr=0;Rr<=et;Rr++)ht.bl_count[Rr]=0;for(pt[ht.heap[ht.heap_max]*2+1]=0,$t=ht.heap_max+1;$t<j;$t++)ur=ht.heap[$t],Rr=pt[pt[ur*2+1]*2+1]+1,Rr>Or&&(Rr=Or,ln++),pt[ur*2+1]=Rr,!(ur>It)&&(ht.bl_count[Rr]++,Ar=0,ur>=qt&&(Ar=lr[ur-qt]),Fr=pt[ur*2],ht.opt_len+=Fr*(Rr+Ar),Ft&&(ht.static_len+=Fr*(Bt[ur*2+1]+Ar)));if(ln!==0){do{for(Rr=Or-1;ht.bl_count[Rr]===0;)Rr--;ht.bl_count[Rr]--,ht.bl_count[Rr+1]+=2,ht.bl_count[Or]--,ln-=2}while(ln>0);for(Rr=Or;Rr!==0;Rr--)for(ur=ht.bl_count[Rr];ur!==0;)Jr=ht.heap[--$t],!(Jr>It)&&(pt[Jr*2+1]!==Rr&&(ht.opt_len+=(Rr-pt[Jr*2+1])*pt[Jr*2],pt[Jr*2+1]=Rr),ur--)}},nr=(ht,Tt,pt)=>{const It=new Array(et+1);let Bt=0,Ft,lr;for(Ft=1;Ft<=et;Ft++)Bt=Bt+pt[Ft-1]<<1,It[Ft]=Bt;for(lr=0;lr<=Tt;lr++){let qt=ht[lr*2+1];qt!==0&&(ht[lr*2]=ar(It[qt]++,qt))}},Vt=()=>{let ht,Tt,pt,It,Bt;const Ft=new Array(et+1);for(pt=0,It=0;It<lt-1;It++)for(At[It]=pt,ht=0;ht<1<<ft[It];ht++)Et[pt++]=It;for(Et[pt-1]=It,Bt=0,It=0;It<16;It++)for(St[It]=Bt,ht=0;ht<1<<mt[It];ht++)wt[Bt++]=It;for(Bt>>=7;It<c;It++)for(St[It]=Bt<<7,ht=0;ht<1<<mt[It]-7;ht++)wt[256+Bt++]=It;for(Tt=0;Tt<=et;Tt++)Ft[Tt]=0;for(ht=0;ht<=143;)xt[ht*2+1]=8,ht++,Ft[8]++;for(;ht<=255;)xt[ht*2+1]=9,ht++,Ft[9]++;for(;ht<=279;)xt[ht*2+1]=7,ht++,Ft[7]++;for(;ht<=287;)xt[ht*2+1]=8,ht++,Ft[8]++;for(nr(xt,$+1,Ft),ht=0;ht<c;ht++)Mt[ht*2+1]=5,Mt[ht*2]=ar(ht,5);Ct=new bt(xt,ft,ct+1,$,et),Nt=new bt(Mt,mt,0,c,et),kt=new bt(new Array(0),yt,0,d,ut)},tr=ht=>{let Tt;for(Tt=0;Tt<$;Tt++)ht.dyn_ltree[Tt*2]=0;for(Tt=0;Tt<c;Tt++)ht.dyn_dtree[Tt*2]=0;for(Tt=0;Tt<d;Tt++)ht.bl_tree[Tt*2]=0;ht.dyn_ltree[b*2]=1,ht.opt_len=ht.static_len=0,ht.sym_next=ht.matches=0},mr=ht=>{ht.bi_valid>8?Zt(ht,ht.bi_buf):ht.bi_valid>0&&(ht.pending_buf[ht.pending++]=ht.bi_buf),ht.bi_buf=0,ht.bi_valid=0},wr=(ht,Tt,pt,It)=>{const Bt=Tt*2,Ft=pt*2;return ht[Bt]<ht[Ft]||ht[Bt]===ht[Ft]&&It[Tt]<=It[pt]},Er=(ht,Tt,pt)=>{const It=ht.heap[pt];let Bt=pt<<1;for(;Bt<=ht.heap_len&&(Bt<ht.heap_len&&wr(Tt,ht.heap[Bt+1],ht.heap[Bt],ht.depth)&&Bt++,!wr(Tt,It,ht.heap[Bt],ht.depth));)ht.heap[pt]=ht.heap[Bt],pt=Bt,Bt<<=1;ht.heap[pt]=It},Sr=(ht,Tt,pt)=>{let It,Bt,Ft=0,lr,qt;if(ht.sym_next!==0)do It=ht.pending_buf[ht.sym_buf+Ft++]&255,It+=(ht.pending_buf[ht.sym_buf+Ft++]&255)<<8,Bt=ht.pending_buf[ht.sym_buf+Ft++],It===0?Kt(ht,Bt,Tt):(lr=Et[Bt],Kt(ht,lr+ct+1,Tt),qt=ft[lr],qt!==0&&(Bt-=At[lr],Xt(ht,Bt,qt)),It--,lr=jt(It),Kt(ht,lr,pt),qt=mt[lr],qt!==0&&(It-=St[lr],Xt(ht,It,qt)));while(Ft<ht.sym_next);Kt(ht,b,Tt)},br=(ht,Tt)=>{const pt=Tt.dyn_tree,It=Tt.stat_desc.static_tree,Bt=Tt.stat_desc.has_stree,Ft=Tt.stat_desc.elems;let lr,qt,Or=-1,$t;for(ht.heap_len=0,ht.heap_max=j,lr=0;lr<Ft;lr++)pt[lr*2]!==0?(ht.heap[++ht.heap_len]=Or=lr,ht.depth[lr]=0):pt[lr*2+1]=0;for(;ht.heap_len<2;)$t=ht.heap[++ht.heap_len]=Or<2?++Or:0,pt[$t*2]=1,ht.depth[$t]=0,ht.opt_len--,Bt&&(ht.static_len-=It[$t*2+1]);for(Tt.max_code=Or,lr=ht.heap_len>>1;lr>=1;lr--)Er(ht,pt,lr);$t=Ft;do lr=ht.heap[1],ht.heap[1]=ht.heap[ht.heap_len--],Er(ht,pt,1),qt=ht.heap[1],ht.heap[--ht.heap_max]=lr,ht.heap[--ht.heap_max]=qt,pt[$t*2]=pt[lr*2]+pt[qt*2],ht.depth[$t]=(ht.depth[lr]>=ht.depth[qt]?ht.depth[lr]:ht.depth[qt])+1,pt[lr*2+1]=pt[qt*2+1]=$t,ht.heap[1]=$t++,Er(ht,pt,1);while(ht.heap_len>=2);ht.heap[--ht.heap_max]=ht.heap[1],_r(ht,Tt),nr(pt,Or,ht.bl_count)},gr=(ht,Tt,pt)=>{let It,Bt=-1,Ft,lr=Tt[0*2+1],qt=0,Or=7,$t=4;for(lr===0&&(Or=138,$t=3),Tt[(pt+1)*2+1]=65535,It=0;It<=pt;It++)Ft=lr,lr=Tt[(It+1)*2+1],!(++qt<Or&&Ft===lr)&&(qt<$t?ht.bl_tree[Ft*2]+=qt:Ft!==0?(Ft!==Bt&&ht.bl_tree[Ft*2]++,ht.bl_tree[it*2]++):qt<=10?ht.bl_tree[rt*2]++:ht.bl_tree[dt*2]++,qt=0,Bt=Ft,lr===0?(Or=138,$t=3):Ft===lr?(Or=6,$t=3):(Or=7,$t=4))},xr=(ht,Tt,pt)=>{let It,Bt=-1,Ft,lr=Tt[0*2+1],qt=0,Or=7,$t=4;for(lr===0&&(Or=138,$t=3),It=0;It<=pt;It++)if(Ft=lr,lr=Tt[(It+1)*2+1],!(++qt<Or&&Ft===lr)){if(qt<$t)do Kt(ht,Ft,ht.bl_tree);while(--qt!==0);else Ft!==0?(Ft!==Bt&&(Kt(ht,Ft,ht.bl_tree),qt--),Kt(ht,it,ht.bl_tree),Xt(ht,qt-3,2)):qt<=10?(Kt(ht,rt,ht.bl_tree),Xt(ht,qt-3,3)):(Kt(ht,dt,ht.bl_tree),Xt(ht,qt-11,7));qt=0,Bt=Ft,lr===0?(Or=138,$t=3):Ft===lr?(Or=6,$t=3):(Or=7,$t=4)}},vr=ht=>{let Tt;for(gr(ht,ht.dyn_ltree,ht.l_desc.max_code),gr(ht,ht.dyn_dtree,ht.d_desc.max_code),br(ht,ht.bl_desc),Tt=d-1;Tt>=3&&ht.bl_tree[gt[Tt]*2+1]===0;Tt--);return ht.opt_len+=3*(Tt+1)+5+5+4,Tt},pr=(ht,Tt,pt,It)=>{let Bt;for(Xt(ht,Tt-257,5),Xt(ht,pt-1,5),Xt(ht,It-4,4),Bt=0;Bt<It;Bt++)Xt(ht,ht.bl_tree[gt[Bt]*2+1],3);xr(ht,ht.dyn_ltree,Tt-1),xr(ht,ht.dyn_dtree,pt-1)},Tr=ht=>{let Tt=4093624447,pt;for(pt=0;pt<=31;pt++,Tt>>>=1)if(Tt&1&&ht.dyn_ltree[pt*2]!==0)return a;if(ht.dyn_ltree[9*2]!==0||ht.dyn_ltree[10*2]!==0||ht.dyn_ltree[13*2]!==0)return h;for(pt=32;pt<ct;pt++)if(ht.dyn_ltree[pt*2]!==0)return h;return a};let Cr=!1;const Pt=ht=>{Cr||(Vt(),Cr=!0),ht.l_desc=new Ht(ht.dyn_ltree,Ct),ht.d_desc=new Ht(ht.dyn_dtree,Nt),ht.bl_desc=new Ht(ht.bl_tree,kt),ht.bi_buf=0,ht.bi_valid=0,tr(ht)},Ot=(ht,Tt,pt,It)=>{Xt(ht,(_e<<1)+(It?1:0),3),mr(ht),Zt(ht,pt),Zt(ht,~pt),pt&&ht.pending_buf.set(ht.window.subarray(Tt,Tt+pt),ht.pending),ht.pending+=pt},zt=ht=>{Xt(ht,st<<1,3),Kt(ht,b,xt),or(ht)},rr=(ht,Tt,pt,It)=>{let Bt,Ft,lr=0;ht.level>0?(ht.strm.data_type===_&&(ht.strm.data_type=Tr(ht)),br(ht,ht.l_desc),br(ht,ht.d_desc),lr=vr(ht),Bt=ht.opt_len+3+7>>>3,Ft=ht.static_len+3+7>>>3,Ft<=Bt&&(Bt=Ft)):Bt=Ft=pt+5,pt+4<=Bt&&Tt!==-1?Ot(ht,Tt,pt,It):ht.strategy===o||Ft===Bt?(Xt(ht,(st<<1)+(It?1:0),3),Sr(ht,xt,Mt)):(Xt(ht,(tt<<1)+(It?1:0),3),pr(ht,ht.l_desc.max_code+1,ht.d_desc.max_code+1,lr+1),Sr(ht,ht.dyn_ltree,ht.dyn_dtree)),tr(ht),It&&mr(ht)},Jt=(ht,Tt,pt)=>(ht.pending_buf[ht.sym_buf+ht.sym_next++]=Tt,ht.pending_buf[ht.sym_buf+ht.sym_next++]=Tt>>8,ht.pending_buf[ht.sym_buf+ht.sym_next++]=pt,Tt===0?ht.dyn_ltree[pt*2]++:(ht.matches++,Tt--,ht.dyn_ltree[(Et[pt]+ct+1)*2]++,ht.dyn_dtree[jt(Tt)*2]++),ht.sym_next===ht.sym_end);var cr=Pt,dr=Ot,Dt=rr,Gt=Jt,er=zt,fr={_tr_init:cr,_tr_stored_block:dr,_tr_flush_block:Dt,_tr_tally:Gt,_tr_align:er},sr=(ht,Tt,pt,It)=>{let Bt=ht&65535|0,Ft=ht>>>16&65535|0,lr=0;for(;pt!==0;){lr=pt>2e3?2e3:pt,pt-=lr;do Bt=Bt+Tt[It++]|0,Ft=Ft+Bt|0;while(--lr);Bt%=65521,Ft%=65521}return Bt|Ft<<16|0};const Lt=()=>{let ht,Tt=[];for(var pt=0;pt<256;pt++){ht=pt;for(var It=0;It<8;It++)ht=ht&1?3988292384^ht>>>1:ht>>>1;Tt[pt]=ht}return Tt},hr=new Uint32Array(Lt());var vt=(ht,Tt,pt,It)=>{const Bt=hr,Ft=It+pt;ht^=-1;for(let lr=It;lr<Ft;lr++)ht=ht>>>8^Bt[(ht^Tt[lr])&255];return ht^-1},Qt={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Yt={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Rt,_tr_stored_block:Wt,_tr_flush_block:ir,_tr_tally:Lr,_tr_align:Dr}=fr,{Z_NO_FLUSH:Mr,Z_PARTIAL_FLUSH:kr,Z_FULL_FLUSH:nn,Z_FINISH:Vr,Z_BLOCK:Ir,Z_OK:zr,Z_STREAM_END:Kr,Z_STREAM_ERROR:Gr,Z_DATA_ERROR:cn,Z_BUF_ERROR:en,Z_DEFAULT_COMPRESSION:jr,Z_FILTERED:Ur,Z_HUFFMAN_ONLY:Nr,Z_RLE:tn,Z_FIXED:sn,Z_DEFAULT_STRATEGY:un,Z_UNKNOWN:dn,Z_DEFLATED:fn}=Yt,_n=9,On=15,Qn=8,cs=256+1+29,Fo=30,Bo=19,ko=2*cs+1,No=15,Xr=3,An=258,xn=An+Xr+1,Vo=32,In=42,hs=57,ds=69,fs=73,ps=91,ms=103,Tn=113,Vn=666,pn=1,zn=2,Cn=3,Fn=4,Uo=3,Dn=(ht,Tt)=>(ht.msg=Qt[Tt],Tt),Cs=ht=>ht*2-(ht>4?9:0),Sn=ht=>{let Tt=ht.length;for(;--Tt>=0;)ht[Tt]=0},jo=ht=>{let Tt,pt,It,Bt=ht.w_size;Tt=ht.hash_size,It=Tt;do pt=ht.head[--It],ht.head[It]=pt>=Bt?pt-Bt:0;while(--Tt);Tt=Bt,It=Tt;do pt=ht.prev[--It],ht.prev[It]=pt>=Bt?pt-Bt:0;while(--Tt)};let Mn=(ht,Tt,pt)=>(Tt<<ht.hash_shift^pt)&ht.hash_mask;const mn=ht=>{const Tt=ht.state;let pt=Tt.pending;pt>ht.avail_out&&(pt=ht.avail_out),pt!==0&&(ht.output.set(Tt.pending_buf.subarray(Tt.pending_out,Tt.pending_out+pt),ht.next_out),ht.next_out+=pt,Tt.pending_out+=pt,ht.total_out+=pt,ht.avail_out-=pt,Tt.pending-=pt,Tt.pending===0&&(Tt.pending_out=0))},gn=(ht,Tt)=>{ir(ht,ht.block_start>=0?ht.block_start:-1,ht.strstart-ht.block_start,Tt),ht.block_start=ht.strstart,mn(ht.strm)},qr=(ht,Tt)=>{ht.pending_buf[ht.pending++]=Tt},Un=(ht,Tt)=>{ht.pending_buf[ht.pending++]=Tt>>>8&255,ht.pending_buf[ht.pending++]=Tt&255},gs=(ht,Tt,pt,It)=>{let Bt=ht.avail_in;return Bt>It&&(Bt=It),Bt===0?0:(ht.avail_in-=Bt,Tt.set(ht.input.subarray(ht.next_in,ht.next_in+Bt),pt),ht.state.wrap===1?ht.adler=sr(ht.adler,Tt,Bt,pt):ht.state.wrap===2&&(ht.adler=vt(ht.adler,Tt,Bt,pt)),ht.next_in+=Bt,ht.total_in+=Bt,Bt)},Ds=(ht,Tt)=>{let pt=ht.max_chain_length,It=ht.strstart,Bt,Ft,lr=ht.prev_length,qt=ht.nice_match;const Or=ht.strstart>ht.w_size-xn?ht.strstart-(ht.w_size-xn):0,$t=ht.window,ur=ht.w_mask,Jr=ht.prev,Rr=ht.strstart+An;let Ar=$t[It+lr-1],Fr=$t[It+lr];ht.prev_length>=ht.good_match&&(pt>>=2),qt>ht.lookahead&&(qt=ht.lookahead);do if(Bt=Tt,!($t[Bt+lr]!==Fr||$t[Bt+lr-1]!==Ar||$t[Bt]!==$t[It]||$t[++Bt]!==$t[It+1])){It+=2,Bt++;do;while($t[++It]===$t[++Bt]&&$t[++It]===$t[++Bt]&&$t[++It]===$t[++Bt]&&$t[++It]===$t[++Bt]&&$t[++It]===$t[++Bt]&&$t[++It]===$t[++Bt]&&$t[++It]===$t[++Bt]&&$t[++It]===$t[++Bt]&&It<Rr);if(Ft=An-(Rr-It),It=Rr-An,Ft>lr){if(ht.match_start=Tt,lr=Ft,Ft>=qt)break;Ar=$t[It+lr-1],Fr=$t[It+lr]}}while((Tt=Jr[Tt&ur])>Or&&--pt!==0);return lr<=ht.lookahead?lr:ht.lookahead},Bn=ht=>{const Tt=ht.w_size;let pt,It,Bt;do{if(It=ht.window_size-ht.lookahead-ht.strstart,ht.strstart>=Tt+(Tt-xn)&&(ht.window.set(ht.window.subarray(Tt,Tt+Tt-It),0),ht.match_start-=Tt,ht.strstart-=Tt,ht.block_start-=Tt,ht.insert>ht.strstart&&(ht.insert=ht.strstart),jo(ht),It+=Tt),ht.strm.avail_in===0)break;if(pt=gs(ht.strm,ht.window,ht.strstart+ht.lookahead,It),ht.lookahead+=pt,ht.lookahead+ht.insert>=Xr)for(Bt=ht.strstart-ht.insert,ht.ins_h=ht.window[Bt],ht.ins_h=Mn(ht,ht.ins_h,ht.window[Bt+1]);ht.insert&&(ht.ins_h=Mn(ht,ht.ins_h,ht.window[Bt+Xr-1]),ht.prev[Bt&ht.w_mask]=ht.head[ht.ins_h],ht.head[ht.ins_h]=Bt,Bt++,ht.insert--,!(ht.lookahead+ht.insert<Xr)););}while(ht.lookahead<xn&&ht.strm.avail_in!==0)},Ls=(ht,Tt)=>{let pt=ht.pending_buf_size-5>ht.w_size?ht.w_size:ht.pending_buf_size-5,It,Bt,Ft,lr=0,qt=ht.strm.avail_in;do{if(It=65535,Ft=ht.bi_valid+42>>3,ht.strm.avail_out<Ft||(Ft=ht.strm.avail_out-Ft,Bt=ht.strstart-ht.block_start,It>Bt+ht.strm.avail_in&&(It=Bt+ht.strm.avail_in),It>Ft&&(It=Ft),It<pt&&(It===0&&Tt!==Vr||Tt===Mr||It!==Bt+ht.strm.avail_in)))break;lr=Tt===Vr&&It===Bt+ht.strm.avail_in?1:0,Wt(ht,0,0,lr),ht.pending_buf[ht.pending-4]=It,ht.pending_buf[ht.pending-3]=It>>8,ht.pending_buf[ht.pending-2]=~It,ht.pending_buf[ht.pending-1]=~It>>8,mn(ht.strm),Bt&&(Bt>It&&(Bt=It),ht.strm.output.set(ht.window.subarray(ht.block_start,ht.block_start+Bt),ht.strm.next_out),ht.strm.next_out+=Bt,ht.strm.avail_out-=Bt,ht.strm.total_out+=Bt,ht.block_start+=Bt,It-=Bt),It&&(gs(ht.strm,ht.strm.output,ht.strm.next_out,It),ht.strm.next_out+=It,ht.strm.avail_out-=It,ht.strm.total_out+=It)}while(lr===0);return qt-=ht.strm.avail_in,qt&&(qt>=ht.w_size?(ht.matches=2,ht.window.set(ht.strm.input.subarray(ht.strm.next_in-ht.w_size,ht.strm.next_in),0),ht.strstart=ht.w_size,ht.insert=ht.strstart):(ht.window_size-ht.strstart<=qt&&(ht.strstart-=ht.w_size,ht.window.set(ht.window.subarray(ht.w_size,ht.w_size+ht.strstart),0),ht.matches<2&&ht.matches++,ht.insert>ht.strstart&&(ht.insert=ht.strstart)),ht.window.set(ht.strm.input.subarray(ht.strm.next_in-qt,ht.strm.next_in),ht.strstart),ht.strstart+=qt,ht.insert+=qt>ht.w_size-ht.insert?ht.w_size-ht.insert:qt),ht.block_start=ht.strstart),ht.high_water<ht.strstart&&(ht.high_water=ht.strstart),lr?Fn:Tt!==Mr&&Tt!==Vr&&ht.strm.avail_in===0&&ht.strstart===ht.block_start?zn:(Ft=ht.window_size-ht.strstart,ht.strm.avail_in>Ft&&ht.block_start>=ht.w_size&&(ht.block_start-=ht.w_size,ht.strstart-=ht.w_size,ht.window.set(ht.window.subarray(ht.w_size,ht.w_size+ht.strstart),0),ht.matches<2&&ht.matches++,Ft+=ht.w_size,ht.insert>ht.strstart&&(ht.insert=ht.strstart)),Ft>ht.strm.avail_in&&(Ft=ht.strm.avail_in),Ft&&(gs(ht.strm,ht.window,ht.strstart,Ft),ht.strstart+=Ft,ht.insert+=Ft>ht.w_size-ht.insert?ht.w_size-ht.insert:Ft),ht.high_water<ht.strstart&&(ht.high_water=ht.strstart),Ft=ht.bi_valid+42>>3,Ft=ht.pending_buf_size-Ft>65535?65535:ht.pending_buf_size-Ft,pt=Ft>ht.w_size?ht.w_size:Ft,Bt=ht.strstart-ht.block_start,(Bt>=pt||(Bt||Tt===Vr)&&Tt!==Mr&&ht.strm.avail_in===0&&Bt<=Ft)&&(It=Bt>Ft?Ft:Bt,lr=Tt===Vr&&ht.strm.avail_in===0&&It===Bt?1:0,Wt(ht,ht.block_start,It,lr),ht.block_start+=It,mn(ht.strm)),lr?Cn:pn)},vs=(ht,Tt)=>{let pt,It;for(;;){if(ht.lookahead<xn){if(Bn(ht),ht.lookahead<xn&&Tt===Mr)return pn;if(ht.lookahead===0)break}if(pt=0,ht.lookahead>=Xr&&(ht.ins_h=Mn(ht,ht.ins_h,ht.window[ht.strstart+Xr-1]),pt=ht.prev[ht.strstart&ht.w_mask]=ht.head[ht.ins_h],ht.head[ht.ins_h]=ht.strstart),pt!==0&&ht.strstart-pt<=ht.w_size-xn&&(ht.match_length=Ds(ht,pt)),ht.match_length>=Xr)if(It=Lr(ht,ht.strstart-ht.match_start,ht.match_length-Xr),ht.lookahead-=ht.match_length,ht.match_length<=ht.max_lazy_match&&ht.lookahead>=Xr){ht.match_length--;do ht.strstart++,ht.ins_h=Mn(ht,ht.ins_h,ht.window[ht.strstart+Xr-1]),pt=ht.prev[ht.strstart&ht.w_mask]=ht.head[ht.ins_h],ht.head[ht.ins_h]=ht.strstart;while(--ht.match_length!==0);ht.strstart++}else ht.strstart+=ht.match_length,ht.match_length=0,ht.ins_h=ht.window[ht.strstart],ht.ins_h=Mn(ht,ht.ins_h,ht.window[ht.strstart+1]);else It=Lr(ht,0,ht.window[ht.strstart]),ht.lookahead--,ht.strstart++;if(It&&(gn(ht,!1),ht.strm.avail_out===0))return pn}return ht.insert=ht.strstart<Xr-1?ht.strstart:Xr-1,Tt===Vr?(gn(ht,!0),ht.strm.avail_out===0?Cn:Fn):ht.sym_next&&(gn(ht,!1),ht.strm.avail_out===0)?pn:zn},kn=(ht,Tt)=>{let pt,It,Bt;for(;;){if(ht.lookahead<xn){if(Bn(ht),ht.lookahead<xn&&Tt===Mr)return pn;if(ht.lookahead===0)break}if(pt=0,ht.lookahead>=Xr&&(ht.ins_h=Mn(ht,ht.ins_h,ht.window[ht.strstart+Xr-1]),pt=ht.prev[ht.strstart&ht.w_mask]=ht.head[ht.ins_h],ht.head[ht.ins_h]=ht.strstart),ht.prev_length=ht.match_length,ht.prev_match=ht.match_start,ht.match_length=Xr-1,pt!==0&&ht.prev_length<ht.max_lazy_match&&ht.strstart-pt<=ht.w_size-xn&&(ht.match_length=Ds(ht,pt),ht.match_length<=5&&(ht.strategy===Ur||ht.match_length===Xr&&ht.strstart-ht.match_start>4096)&&(ht.match_length=Xr-1)),ht.prev_length>=Xr&&ht.match_length<=ht.prev_length){Bt=ht.strstart+ht.lookahead-Xr,It=Lr(ht,ht.strstart-1-ht.prev_match,ht.prev_length-Xr),ht.lookahead-=ht.prev_length-1,ht.prev_length-=2;do++ht.strstart<=Bt&&(ht.ins_h=Mn(ht,ht.ins_h,ht.window[ht.strstart+Xr-1]),pt=ht.prev[ht.strstart&ht.w_mask]=ht.head[ht.ins_h],ht.head[ht.ins_h]=ht.strstart);while(--ht.prev_length!==0);if(ht.match_available=0,ht.match_length=Xr-1,ht.strstart++,It&&(gn(ht,!1),ht.strm.avail_out===0))return pn}else if(ht.match_available){if(It=Lr(ht,0,ht.window[ht.strstart-1]),It&&gn(ht,!1),ht.strstart++,ht.lookahead--,ht.strm.avail_out===0)return pn}else ht.match_available=1,ht.strstart++,ht.lookahead--}return ht.match_available&&(It=Lr(ht,0,ht.window[ht.strstart-1]),ht.match_available=0),ht.insert=ht.strstart<Xr-1?ht.strstart:Xr-1,Tt===Vr?(gn(ht,!0),ht.strm.avail_out===0?Cn:Fn):ht.sym_next&&(gn(ht,!1),ht.strm.avail_out===0)?pn:zn},Wo=(ht,Tt)=>{let pt,It,Bt,Ft;const lr=ht.window;for(;;){if(ht.lookahead<=An){if(Bn(ht),ht.lookahead<=An&&Tt===Mr)return pn;if(ht.lookahead===0)break}if(ht.match_length=0,ht.lookahead>=Xr&&ht.strstart>0&&(Bt=ht.strstart-1,It=lr[Bt],It===lr[++Bt]&&It===lr[++Bt]&&It===lr[++Bt])){Ft=ht.strstart+An;do;while(It===lr[++Bt]&&It===lr[++Bt]&&It===lr[++Bt]&&It===lr[++Bt]&&It===lr[++Bt]&&It===lr[++Bt]&&It===lr[++Bt]&&It===lr[++Bt]&&Bt<Ft);ht.match_length=An-(Ft-Bt),ht.match_length>ht.lookahead&&(ht.match_length=ht.lookahead)}if(ht.match_length>=Xr?(pt=Lr(ht,1,ht.match_length-Xr),ht.lookahead-=ht.match_length,ht.strstart+=ht.match_length,ht.match_length=0):(pt=Lr(ht,0,ht.window[ht.strstart]),ht.lookahead--,ht.strstart++),pt&&(gn(ht,!1),ht.strm.avail_out===0))return pn}return ht.insert=0,Tt===Vr?(gn(ht,!0),ht.strm.avail_out===0?Cn:Fn):ht.sym_next&&(gn(ht,!1),ht.strm.avail_out===0)?pn:zn},Go=(ht,Tt)=>{let pt;for(;;){if(ht.lookahead===0&&(Bn(ht),ht.lookahead===0)){if(Tt===Mr)return pn;break}if(ht.match_length=0,pt=Lr(ht,0,ht.window[ht.strstart]),ht.lookahead--,ht.strstart++,pt&&(gn(ht,!1),ht.strm.avail_out===0))return pn}return ht.insert=0,Tt===Vr?(gn(ht,!0),ht.strm.avail_out===0?Cn:Fn):ht.sym_next&&(gn(ht,!1),ht.strm.avail_out===0)?pn:zn};function En(ht,Tt,pt,It,Bt){this.good_length=ht,this.max_lazy=Tt,this.nice_length=pt,this.max_chain=It,this.func=Bt}const jn=[new En(0,0,0,0,Ls),new En(4,4,8,4,vs),new En(4,5,16,8,vs),new En(4,6,32,32,vs),new En(4,4,16,16,kn),new En(8,16,32,32,kn),new En(8,16,128,128,kn),new En(8,32,128,256,kn),new En(32,128,258,1024,kn),new En(32,258,258,4096,kn)],Ho=ht=>{ht.window_size=2*ht.w_size,Sn(ht.head),ht.max_lazy_match=jn[ht.level].max_lazy,ht.good_match=jn[ht.level].good_length,ht.nice_match=jn[ht.level].nice_length,ht.max_chain_length=jn[ht.level].max_chain,ht.strstart=0,ht.block_start=0,ht.lookahead=0,ht.insert=0,ht.match_length=ht.prev_length=Xr-1,ht.match_available=0,ht.ins_h=0};function Ko(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=fn,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(ko*2),this.dyn_dtree=new Uint16Array((2*Fo+1)*2),this.bl_tree=new Uint16Array((2*Bo+1)*2),Sn(this.dyn_ltree),Sn(this.dyn_dtree),Sn(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(No+1),this.heap=new Uint16Array(2*cs+1),Sn(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*cs+1),Sn(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Wn=ht=>{if(!ht)return 1;const Tt=ht.state;return!Tt||Tt.strm!==ht||Tt.status!==In&&Tt.status!==hs&&Tt.status!==ds&&Tt.status!==fs&&Tt.status!==ps&&Tt.status!==ms&&Tt.status!==Tn&&Tt.status!==Vn?1:0},Ps=ht=>{if(Wn(ht))return Dn(ht,Gr);ht.total_in=ht.total_out=0,ht.data_type=dn;const Tt=ht.state;return Tt.pending=0,Tt.pending_out=0,Tt.wrap<0&&(Tt.wrap=-Tt.wrap),Tt.status=Tt.wrap===2?hs:Tt.wrap?In:Tn,ht.adler=Tt.wrap===2?0:1,Tt.last_flush=-2,Rt(Tt),zr},Rs=ht=>{const Tt=Ps(ht);return Tt===zr&&Ho(ht.state),Tt},$o=(ht,Tt)=>Wn(ht)||ht.state.wrap!==2?Gr:(ht.state.gzhead=Tt,zr),Os=(ht,Tt,pt,It,Bt,Ft)=>{if(!ht)return Gr;let lr=1;if(Tt===jr&&(Tt=6),It<0?(lr=0,It=-It):It>15&&(lr=2,It-=16),Bt<1||Bt>_n||pt!==fn||It<8||It>15||Tt<0||Tt>9||Ft<0||Ft>sn||It===8&&lr!==1)return Dn(ht,Gr);It===8&&(It=9);const qt=new Ko;return ht.state=qt,qt.strm=ht,qt.status=In,qt.wrap=lr,qt.gzhead=null,qt.w_bits=It,qt.w_size=1<<qt.w_bits,qt.w_mask=qt.w_size-1,qt.hash_bits=Bt+7,qt.hash_size=1<<qt.hash_bits,qt.hash_mask=qt.hash_size-1,qt.hash_shift=~~((qt.hash_bits+Xr-1)/Xr),qt.window=new Uint8Array(qt.w_size*2),qt.head=new Uint16Array(qt.hash_size),qt.prev=new Uint16Array(qt.w_size),qt.lit_bufsize=1<<Bt+6,qt.pending_buf_size=qt.lit_bufsize*4,qt.pending_buf=new Uint8Array(qt.pending_buf_size),qt.sym_buf=qt.lit_bufsize,qt.sym_end=(qt.lit_bufsize-1)*3,qt.level=Tt,qt.strategy=Ft,qt.method=pt,Rs(ht)},Xo=(ht,Tt)=>Os(ht,Tt,fn,On,Qn,un),Yo=(ht,Tt)=>{if(Wn(ht)||Tt>Ir||Tt<0)return ht?Dn(ht,Gr):Gr;const pt=ht.state;if(!ht.output||ht.avail_in!==0&&!ht.input||pt.status===Vn&&Tt!==Vr)return Dn(ht,ht.avail_out===0?en:Gr);const It=pt.last_flush;if(pt.last_flush=Tt,pt.pending!==0){if(mn(ht),ht.avail_out===0)return pt.last_flush=-1,zr}else if(ht.avail_in===0&&Cs(Tt)<=Cs(It)&&Tt!==Vr)return Dn(ht,en);if(pt.status===Vn&&ht.avail_in!==0)return Dn(ht,en);if(pt.status===In&&pt.wrap===0&&(pt.status=Tn),pt.status===In){let Bt=fn+(pt.w_bits-8<<4)<<8,Ft=-1;if(pt.strategy>=Nr||pt.level<2?Ft=0:pt.level<6?Ft=1:pt.level===6?Ft=2:Ft=3,Bt|=Ft<<6,pt.strstart!==0&&(Bt|=Vo),Bt+=31-Bt%31,Un(pt,Bt),pt.strstart!==0&&(Un(pt,ht.adler>>>16),Un(pt,ht.adler&65535)),ht.adler=1,pt.status=Tn,mn(ht),pt.pending!==0)return pt.last_flush=-1,zr}if(pt.status===hs){if(ht.adler=0,qr(pt,31),qr(pt,139),qr(pt,8),pt.gzhead)qr(pt,(pt.gzhead.text?1:0)+(pt.gzhead.hcrc?2:0)+(pt.gzhead.extra?4:0)+(pt.gzhead.name?8:0)+(pt.gzhead.comment?16:0)),qr(pt,pt.gzhead.time&255),qr(pt,pt.gzhead.time>>8&255),qr(pt,pt.gzhead.time>>16&255),qr(pt,pt.gzhead.time>>24&255),qr(pt,pt.level===9?2:pt.strategy>=Nr||pt.level<2?4:0),qr(pt,pt.gzhead.os&255),pt.gzhead.extra&&pt.gzhead.extra.length&&(qr(pt,pt.gzhead.extra.length&255),qr(pt,pt.gzhead.extra.length>>8&255)),pt.gzhead.hcrc&&(ht.adler=vt(ht.adler,pt.pending_buf,pt.pending,0)),pt.gzindex=0,pt.status=ds;else if(qr(pt,0),qr(pt,0),qr(pt,0),qr(pt,0),qr(pt,0),qr(pt,pt.level===9?2:pt.strategy>=Nr||pt.level<2?4:0),qr(pt,Uo),pt.status=Tn,mn(ht),pt.pending!==0)return pt.last_flush=-1,zr}if(pt.status===ds){if(pt.gzhead.extra){let Bt=pt.pending,Ft=(pt.gzhead.extra.length&65535)-pt.gzindex;for(;pt.pending+Ft>pt.pending_buf_size;){let qt=pt.pending_buf_size-pt.pending;if(pt.pending_buf.set(pt.gzhead.extra.subarray(pt.gzindex,pt.gzindex+qt),pt.pending),pt.pending=pt.pending_buf_size,pt.gzhead.hcrc&&pt.pending>Bt&&(ht.adler=vt(ht.adler,pt.pending_buf,pt.pending-Bt,Bt)),pt.gzindex+=qt,mn(ht),pt.pending!==0)return pt.last_flush=-1,zr;Bt=0,Ft-=qt}let lr=new Uint8Array(pt.gzhead.extra);pt.pending_buf.set(lr.subarray(pt.gzindex,pt.gzindex+Ft),pt.pending),pt.pending+=Ft,pt.gzhead.hcrc&&pt.pending>Bt&&(ht.adler=vt(ht.adler,pt.pending_buf,pt.pending-Bt,Bt)),pt.gzindex=0}pt.status=fs}if(pt.status===fs){if(pt.gzhead.name){let Bt=pt.pending,Ft;do{if(pt.pending===pt.pending_buf_size){if(pt.gzhead.hcrc&&pt.pending>Bt&&(ht.adler=vt(ht.adler,pt.pending_buf,pt.pending-Bt,Bt)),mn(ht),pt.pending!==0)return pt.last_flush=-1,zr;Bt=0}pt.gzindex<pt.gzhead.name.length?Ft=pt.gzhead.name.charCodeAt(pt.gzindex++)&255:Ft=0,qr(pt,Ft)}while(Ft!==0);pt.gzhead.hcrc&&pt.pending>Bt&&(ht.adler=vt(ht.adler,pt.pending_buf,pt.pending-Bt,Bt)),pt.gzindex=0}pt.status=ps}if(pt.status===ps){if(pt.gzhead.comment){let Bt=pt.pending,Ft;do{if(pt.pending===pt.pending_buf_size){if(pt.gzhead.hcrc&&pt.pending>Bt&&(ht.adler=vt(ht.adler,pt.pending_buf,pt.pending-Bt,Bt)),mn(ht),pt.pending!==0)return pt.last_flush=-1,zr;Bt=0}pt.gzindex<pt.gzhead.comment.length?Ft=pt.gzhead.comment.charCodeAt(pt.gzindex++)&255:Ft=0,qr(pt,Ft)}while(Ft!==0);pt.gzhead.hcrc&&pt.pending>Bt&&(ht.adler=vt(ht.adler,pt.pending_buf,pt.pending-Bt,Bt))}pt.status=ms}if(pt.status===ms){if(pt.gzhead.hcrc){if(pt.pending+2>pt.pending_buf_size&&(mn(ht),pt.pending!==0))return pt.last_flush=-1,zr;qr(pt,ht.adler&255),qr(pt,ht.adler>>8&255),ht.adler=0}if(pt.status=Tn,mn(ht),pt.pending!==0)return pt.last_flush=-1,zr}if(ht.avail_in!==0||pt.lookahead!==0||Tt!==Mr&&pt.status!==Vn){let Bt=pt.level===0?Ls(pt,Tt):pt.strategy===Nr?Go(pt,Tt):pt.strategy===tn?Wo(pt,Tt):jn[pt.level].func(pt,Tt);if((Bt===Cn||Bt===Fn)&&(pt.status=Vn),Bt===pn||Bt===Cn)return ht.avail_out===0&&(pt.last_flush=-1),zr;if(Bt===zn&&(Tt===kr?Dr(pt):Tt!==Ir&&(Wt(pt,0,0,!1),Tt===nn&&(Sn(pt.head),pt.lookahead===0&&(pt.strstart=0,pt.block_start=0,pt.insert=0))),mn(ht),ht.avail_out===0))return pt.last_flush=-1,zr}return Tt!==Vr?zr:pt.wrap<=0?Kr:(pt.wrap===2?(qr(pt,ht.adler&255),qr(pt,ht.adler>>8&255),qr(pt,ht.adler>>16&255),qr(pt,ht.adler>>24&255),qr(pt,ht.total_in&255),qr(pt,ht.total_in>>8&255),qr(pt,ht.total_in>>16&255),qr(pt,ht.total_in>>24&255)):(Un(pt,ht.adler>>>16),Un(pt,ht.adler&65535)),mn(ht),pt.wrap>0&&(pt.wrap=-pt.wrap),pt.pending!==0?zr:Kr)},Zo=ht=>{if(Wn(ht))return Gr;const Tt=ht.state.status;return ht.state=null,Tt===Tn?Dn(ht,cn):zr},Qo=(ht,Tt)=>{let pt=Tt.length;if(Wn(ht))return Gr;const It=ht.state,Bt=It.wrap;if(Bt===2||Bt===1&&It.status!==In||It.lookahead)return Gr;if(Bt===1&&(ht.adler=sr(ht.adler,Tt,pt,0)),It.wrap=0,pt>=It.w_size){Bt===0&&(Sn(It.head),It.strstart=0,It.block_start=0,It.insert=0);let Or=new Uint8Array(It.w_size);Or.set(Tt.subarray(pt-It.w_size,pt),0),Tt=Or,pt=It.w_size}const Ft=ht.avail_in,lr=ht.next_in,qt=ht.input;for(ht.avail_in=pt,ht.next_in=0,ht.input=Tt,Bn(It);It.lookahead>=Xr;){let Or=It.strstart,$t=It.lookahead-(Xr-1);do It.ins_h=Mn(It,It.ins_h,It.window[Or+Xr-1]),It.prev[Or&It.w_mask]=It.head[It.ins_h],It.head[It.ins_h]=Or,Or++;while(--$t);It.strstart=Or,It.lookahead=Xr-1,Bn(It)}return It.strstart+=It.lookahead,It.block_start=It.strstart,It.insert=It.lookahead,It.lookahead=0,It.match_length=It.prev_length=Xr-1,It.match_available=0,ht.next_in=lr,ht.input=qt,ht.avail_in=Ft,It.wrap=Bt,zr};var Jo=Xo,qo=Os,na=Rs,ga=Ps,_a=$o,xa=Yo,ba=Zo,$a=Qo,yl="pako deflate (from Nodeca project)",Gn={deflateInit:Jo,deflateInit2:qo,deflateReset:na,deflateResetKeep:ga,deflateSetHeader:_a,deflate:xa,deflateEnd:ba,deflateSetDictionary:$a,deflateInfo:yl};const _l=(ht,Tt)=>Object.prototype.hasOwnProperty.call(ht,Tt);var xl=function(ht){const Tt=Array.prototype.slice.call(arguments,1);for(;Tt.length;){const pt=Tt.shift();if(pt){if(typeof pt!="object")throw new TypeError(pt+"must be non-object");for(const It in pt)_l(pt,It)&&(ht[It]=pt[It])}}return ht},El=ht=>{let Tt=0;for(let It=0,Bt=ht.length;It<Bt;It++)Tt+=ht[It].length;const pt=new Uint8Array(Tt);for(let It=0,Bt=0,Ft=ht.length;It<Ft;It++){let lr=ht[It];pt.set(lr,Bt),Bt+=lr.length}return pt},es={assign:xl,flattenChunks:El};let Is=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Is=!1}const Hn=new Uint8Array(256);for(let ht=0;ht<256;ht++)Hn[ht]=ht>=252?6:ht>=248?5:ht>=240?4:ht>=224?3:ht>=192?2:1;Hn[254]=Hn[254]=1;var wl=ht=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(ht);let Tt,pt,It,Bt,Ft,lr=ht.length,qt=0;for(Bt=0;Bt<lr;Bt++)pt=ht.charCodeAt(Bt),(pt&64512)===55296&&Bt+1<lr&&(It=ht.charCodeAt(Bt+1),(It&64512)===56320&&(pt=65536+(pt-55296<<10)+(It-56320),Bt++)),qt+=pt<128?1:pt<2048?2:pt<65536?3:4;for(Tt=new Uint8Array(qt),Ft=0,Bt=0;Ft<qt;Bt++)pt=ht.charCodeAt(Bt),(pt&64512)===55296&&Bt+1<lr&&(It=ht.charCodeAt(Bt+1),(It&64512)===56320&&(pt=65536+(pt-55296<<10)+(It-56320),Bt++)),pt<128?Tt[Ft++]=pt:pt<2048?(Tt[Ft++]=192|pt>>>6,Tt[Ft++]=128|pt&63):pt<65536?(Tt[Ft++]=224|pt>>>12,Tt[Ft++]=128|pt>>>6&63,Tt[Ft++]=128|pt&63):(Tt[Ft++]=240|pt>>>18,Tt[Ft++]=128|pt>>>12&63,Tt[Ft++]=128|pt>>>6&63,Tt[Ft++]=128|pt&63);return Tt};const Al=(ht,Tt)=>{if(Tt<65534&&ht.subarray&&Is)return String.fromCharCode.apply(null,ht.length===Tt?ht:ht.subarray(0,Tt));let pt="";for(let It=0;It<Tt;It++)pt+=String.fromCharCode(ht[It]);return pt};var Sl=(ht,Tt)=>{const pt=Tt||ht.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(ht.subarray(0,Tt));let It,Bt;const Ft=new Array(pt*2);for(Bt=0,It=0;It<pt;){let lr=ht[It++];if(lr<128){Ft[Bt++]=lr;continue}let qt=Hn[lr];if(qt>4){Ft[Bt++]=65533,It+=qt-1;continue}for(lr&=qt===2?31:qt===3?15:7;qt>1&&It<pt;)lr=lr<<6|ht[It++]&63,qt--;if(qt>1){Ft[Bt++]=65533;continue}lr<65536?Ft[Bt++]=lr:(lr-=65536,Ft[Bt++]=55296|lr>>10&1023,Ft[Bt++]=56320|lr&1023)}return Al(Ft,Bt)},Ml=(ht,Tt)=>{Tt=Tt||ht.length,Tt>ht.length&&(Tt=ht.length);let pt=Tt-1;for(;pt>=0&&(ht[pt]&192)===128;)pt--;return pt<0||pt===0?Tt:pt+Hn[ht[pt]]>Tt?pt:Tt},Kn={string2buf:wl,buf2string:Sl,utf8border:Ml};function Tl(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zs=Tl;const Fs=Object.prototype.toString,{Z_NO_FLUSH:Cl,Z_SYNC_FLUSH:Dl,Z_FULL_FLUSH:Ll,Z_FINISH:Pl,Z_OK:ts,Z_STREAM_END:Rl,Z_DEFAULT_COMPRESSION:Ol,Z_DEFAULT_STRATEGY:Il,Z_DEFLATED:zl}=Yt;function $n(ht){this.options=es.assign({level:Ol,method:zl,chunkSize:16384,windowBits:15,memLevel:8,strategy:Il},ht||{});let Tt=this.options;Tt.raw&&Tt.windowBits>0?Tt.windowBits=-Tt.windowBits:Tt.gzip&&Tt.windowBits>0&&Tt.windowBits<16&&(Tt.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zs,this.strm.avail_out=0;let pt=Gn.deflateInit2(this.strm,Tt.level,Tt.method,Tt.windowBits,Tt.memLevel,Tt.strategy);if(pt!==ts)throw new Error(Qt[pt]);if(Tt.header&&Gn.deflateSetHeader(this.strm,Tt.header),Tt.dictionary){let It;if(typeof Tt.dictionary=="string"?It=Kn.string2buf(Tt.dictionary):Fs.call(Tt.dictionary)==="[object ArrayBuffer]"?It=new Uint8Array(Tt.dictionary):It=Tt.dictionary,pt=Gn.deflateSetDictionary(this.strm,It),pt!==ts)throw new Error(Qt[pt]);this._dict_set=!0}}$n.prototype.push=function(ht,Tt){const pt=this.strm,It=this.options.chunkSize;let Bt,Ft;if(this.ended)return!1;for(Tt===~~Tt?Ft=Tt:Ft=Tt===!0?Pl:Cl,typeof ht=="string"?pt.input=Kn.string2buf(ht):Fs.call(ht)==="[object ArrayBuffer]"?pt.input=new Uint8Array(ht):pt.input=ht,pt.next_in=0,pt.avail_in=pt.input.length;;){if(pt.avail_out===0&&(pt.output=new Uint8Array(It),pt.next_out=0,pt.avail_out=It),(Ft===Dl||Ft===Ll)&&pt.avail_out<=6){this.onData(pt.output.subarray(0,pt.next_out)),pt.avail_out=0;continue}if(Bt=Gn.deflate(pt,Ft),Bt===Rl)return pt.next_out>0&&this.onData(pt.output.subarray(0,pt.next_out)),Bt=Gn.deflateEnd(this.strm),this.onEnd(Bt),this.ended=!0,Bt===ts;if(pt.avail_out===0){this.onData(pt.output);continue}if(Ft>0&&pt.next_out>0){this.onData(pt.output.subarray(0,pt.next_out)),pt.avail_out=0;continue}if(pt.avail_in===0)break}return!0},$n.prototype.onData=function(ht){this.chunks.push(ht)},$n.prototype.onEnd=function(ht){ht===ts&&(this.result=es.flattenChunks(this.chunks)),this.chunks=[],this.err=ht,this.msg=this.strm.msg};function ys(ht,Tt){const pt=new $n(Tt);if(pt.push(ht,!0),pt.err)throw pt.msg||Qt[pt.err];return pt.result}function Fl(ht,Tt){return Tt=Tt||{},Tt.raw=!0,ys(ht,Tt)}function Bl(ht,Tt){return Tt=Tt||{},Tt.gzip=!0,ys(ht,Tt)}var Nl=$n,Vl=ys,Ul=Fl,Wl=Bl,Gl={Deflate:Nl,deflate:Vl,deflateRaw:Ul,gzip:Wl};const rs=16209,Hl=16191;var Kl=function(Tt,pt){let It,Bt,Ft,lr,qt,Or,$t,ur,Jr,Rr,Ar,Fr,ln,Zr,Hr,rn,$r,Pr,_i,hn,Br,on,Qr,Wr;const Yr=Tt.state;It=Tt.next_in,Qr=Tt.input,Bt=It+(Tt.avail_in-5),Ft=Tt.next_out,Wr=Tt.output,lr=Ft-(pt-Tt.avail_out),qt=Ft+(Tt.avail_out-257),Or=Yr.dmax,$t=Yr.wsize,ur=Yr.whave,Jr=Yr.wnext,Rr=Yr.window,Ar=Yr.hold,Fr=Yr.bits,ln=Yr.lencode,Zr=Yr.distcode,Hr=(1<<Yr.lenbits)-1,rn=(1<<Yr.distbits)-1;e:do{Fr<15&&(Ar+=Qr[It++]<<Fr,Fr+=8,Ar+=Qr[It++]<<Fr,Fr+=8),$r=ln[Ar&Hr];t:for(;;){if(Pr=$r>>>24,Ar>>>=Pr,Fr-=Pr,Pr=$r>>>16&255,Pr===0)Wr[Ft++]=$r&65535;else if(Pr&16){_i=$r&65535,Pr&=15,Pr&&(Fr<Pr&&(Ar+=Qr[It++]<<Fr,Fr+=8),_i+=Ar&(1<<Pr)-1,Ar>>>=Pr,Fr-=Pr),Fr<15&&(Ar+=Qr[It++]<<Fr,Fr+=8,Ar+=Qr[It++]<<Fr,Fr+=8),$r=Zr[Ar&rn];r:for(;;){if(Pr=$r>>>24,Ar>>>=Pr,Fr-=Pr,Pr=$r>>>16&255,Pr&16){if(hn=$r&65535,Pr&=15,Fr<Pr&&(Ar+=Qr[It++]<<Fr,Fr+=8,Fr<Pr&&(Ar+=Qr[It++]<<Fr,Fr+=8)),hn+=Ar&(1<<Pr)-1,hn>Or){Tt.msg="invalid distance too far back",Yr.mode=rs;break e}if(Ar>>>=Pr,Fr-=Pr,Pr=Ft-lr,hn>Pr){if(Pr=hn-Pr,Pr>ur&&Yr.sane){Tt.msg="invalid distance too far back",Yr.mode=rs;break e}if(Br=0,on=Rr,Jr===0){if(Br+=$t-Pr,Pr<_i){_i-=Pr;do Wr[Ft++]=Rr[Br++];while(--Pr);Br=Ft-hn,on=Wr}}else if(Jr<Pr){if(Br+=$t+Jr-Pr,Pr-=Jr,Pr<_i){_i-=Pr;do Wr[Ft++]=Rr[Br++];while(--Pr);if(Br=0,Jr<_i){Pr=Jr,_i-=Pr;do Wr[Ft++]=Rr[Br++];while(--Pr);Br=Ft-hn,on=Wr}}}else if(Br+=Jr-Pr,Pr<_i){_i-=Pr;do Wr[Ft++]=Rr[Br++];while(--Pr);Br=Ft-hn,on=Wr}for(;_i>2;)Wr[Ft++]=on[Br++],Wr[Ft++]=on[Br++],Wr[Ft++]=on[Br++],_i-=3;_i&&(Wr[Ft++]=on[Br++],_i>1&&(Wr[Ft++]=on[Br++]))}else{Br=Ft-hn;do Wr[Ft++]=Wr[Br++],Wr[Ft++]=Wr[Br++],Wr[Ft++]=Wr[Br++],_i-=3;while(_i>2);_i&&(Wr[Ft++]=Wr[Br++],_i>1&&(Wr[Ft++]=Wr[Br++]))}}else if(Pr&64){Tt.msg="invalid distance code",Yr.mode=rs;break e}else{$r=Zr[($r&65535)+(Ar&(1<<Pr)-1)];continue r}break}}else if(Pr&64)if(Pr&32){Yr.mode=Hl;break e}else{Tt.msg="invalid literal/length code",Yr.mode=rs;break e}else{$r=ln[($r&65535)+(Ar&(1<<Pr)-1)];continue t}break}}while(It<Bt&&Ft<qt);_i=Fr>>3,It-=_i,Fr-=_i<<3,Ar&=(1<<Fr)-1,Tt.next_in=It,Tt.next_out=Ft,Tt.avail_in=It<Bt?5+(Bt-It):5-(It-Bt),Tt.avail_out=Ft<qt?257+(qt-Ft):257-(Ft-qt),Yr.hold=Ar,Yr.bits=Fr};const Nn=15,Bs=852,ks=592,Ns=0,_s=1,Vs=2,$l=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Xl=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Yl=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Zl=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Xn=(ht,Tt,pt,It,Bt,Ft,lr,qt)=>{const Or=qt.bits;let $t=0,ur=0,Jr=0,Rr=0,Ar=0,Fr=0,ln=0,Zr=0,Hr=0,rn=0,$r,Pr,_i,hn,Br,on=null,Qr;const Wr=new Uint16Array(Nn+1),Yr=new Uint16Array(Nn+1);let Rn=null,zo,ls,us;for($t=0;$t<=Nn;$t++)Wr[$t]=0;for(ur=0;ur<It;ur++)Wr[Tt[pt+ur]]++;for(Ar=Or,Rr=Nn;Rr>=1&&Wr[Rr]===0;Rr--);if(Ar>Rr&&(Ar=Rr),Rr===0)return Bt[Ft++]=1<<24|64<<16|0,Bt[Ft++]=1<<24|64<<16|0,qt.bits=1,0;for(Jr=1;Jr<Rr&&Wr[Jr]===0;Jr++);for(Ar<Jr&&(Ar=Jr),Zr=1,$t=1;$t<=Nn;$t++)if(Zr<<=1,Zr-=Wr[$t],Zr<0)return-1;if(Zr>0&&(ht===Ns||Rr!==1))return-1;for(Yr[1]=0,$t=1;$t<Nn;$t++)Yr[$t+1]=Yr[$t]+Wr[$t];for(ur=0;ur<It;ur++)Tt[pt+ur]!==0&&(lr[Yr[Tt[pt+ur]]++]=ur);if(ht===Ns?(on=Rn=lr,Qr=20):ht===_s?(on=$l,Rn=Xl,Qr=257):(on=Yl,Rn=Zl,Qr=0),rn=0,ur=0,$t=Jr,Br=Ft,Fr=Ar,ln=0,_i=-1,Hr=1<<Ar,hn=Hr-1,ht===_s&&Hr>Bs||ht===Vs&&Hr>ks)return 1;for(;;){zo=$t-ln,lr[ur]+1<Qr?(ls=0,us=lr[ur]):lr[ur]>=Qr?(ls=Rn[lr[ur]-Qr],us=on[lr[ur]-Qr]):(ls=96,us=0),$r=1<<$t-ln,Pr=1<<Fr,Jr=Pr;do Pr-=$r,Bt[Br+(rn>>ln)+Pr]=zo<<24|ls<<16|us|0;while(Pr!==0);for($r=1<<$t-1;rn&$r;)$r>>=1;if($r!==0?(rn&=$r-1,rn+=$r):rn=0,ur++,--Wr[$t]===0){if($t===Rr)break;$t=Tt[pt+lr[ur]]}if($t>Ar&&(rn&hn)!==_i){for(ln===0&&(ln=Ar),Br+=Jr,Fr=$t-ln,Zr=1<<Fr;Fr+ln<Rr&&(Zr-=Wr[Fr+ln],!(Zr<=0));)Fr++,Zr<<=1;if(Hr+=1<<Fr,ht===_s&&Hr>Bs||ht===Vs&&Hr>ks)return 1;_i=rn&hn,Bt[_i]=Ar<<24|Fr<<16|Br-Ft|0}}return rn!==0&&(Bt[Br+rn]=$t-ln<<24|64<<16|0),qt.bits=Ar,0};const Ql=0,Us=1,js=2,{Z_FINISH:Ws,Z_BLOCK:Jl,Z_TREES:is,Z_OK:Ln,Z_STREAM_END:eu,Z_NEED_DICT:tu,Z_STREAM_ERROR:vn,Z_DATA_ERROR:Gs,Z_MEM_ERROR:Hs,Z_BUF_ERROR:ru,Z_DEFLATED:Ks}=Yt,ns=16180,$s=16181,Xs=16182,Ys=16183,Zs=16184,Qs=16185,Js=16186,qs=16187,eo=16188,to=16189,ss=16190,bn=16191,xs=16192,ro=16193,Es=16194,io=16195,no=16196,so=16197,oo=16198,os=16199,as=16200,ao=16201,lo=16202,uo=16203,co=16204,ho=16205,bs=16206,fo=16207,po=16208,an=16209,mo=16210,go=16211,iu=852,nu=592,su=15,vo=ht=>(ht>>>24&255)+(ht>>>8&65280)+((ht&65280)<<8)+((ht&255)<<24);function ou(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Pn=ht=>{if(!ht)return 1;const Tt=ht.state;return!Tt||Tt.strm!==ht||Tt.mode<ns||Tt.mode>go?1:0},yo=ht=>{if(Pn(ht))return vn;const Tt=ht.state;return ht.total_in=ht.total_out=Tt.total=0,ht.msg="",Tt.wrap&&(ht.adler=Tt.wrap&1),Tt.mode=ns,Tt.last=0,Tt.havedict=0,Tt.flags=-1,Tt.dmax=32768,Tt.head=null,Tt.hold=0,Tt.bits=0,Tt.lencode=Tt.lendyn=new Int32Array(iu),Tt.distcode=Tt.distdyn=new Int32Array(nu),Tt.sane=1,Tt.back=-1,Ln},_o=ht=>{if(Pn(ht))return vn;const Tt=ht.state;return Tt.wsize=0,Tt.whave=0,Tt.wnext=0,yo(ht)},xo=(ht,Tt)=>{let pt;if(Pn(ht))return vn;const It=ht.state;return Tt<0?(pt=0,Tt=-Tt):(pt=(Tt>>4)+5,Tt<48&&(Tt&=15)),Tt&&(Tt<8||Tt>15)?vn:(It.window!==null&&It.wbits!==Tt&&(It.window=null),It.wrap=pt,It.wbits=Tt,_o(ht))},Eo=(ht,Tt)=>{if(!ht)return vn;const pt=new ou;ht.state=pt,pt.strm=ht,pt.window=null,pt.mode=ns;const It=xo(ht,Tt);return It!==Ln&&(ht.state=null),It},au=ht=>Eo(ht,su);let bo=!0,ws,As;const lu=ht=>{if(bo){ws=new Int32Array(512),As=new Int32Array(32);let Tt=0;for(;Tt<144;)ht.lens[Tt++]=8;for(;Tt<256;)ht.lens[Tt++]=9;for(;Tt<280;)ht.lens[Tt++]=7;for(;Tt<288;)ht.lens[Tt++]=8;for(Xn(Us,ht.lens,0,288,ws,0,ht.work,{bits:9}),Tt=0;Tt<32;)ht.lens[Tt++]=5;Xn(js,ht.lens,0,32,As,0,ht.work,{bits:5}),bo=!1}ht.lencode=ws,ht.lenbits=9,ht.distcode=As,ht.distbits=5},wo=(ht,Tt,pt,It)=>{let Bt;const Ft=ht.state;return Ft.window===null&&(Ft.wsize=1<<Ft.wbits,Ft.wnext=0,Ft.whave=0,Ft.window=new Uint8Array(Ft.wsize)),It>=Ft.wsize?(Ft.window.set(Tt.subarray(pt-Ft.wsize,pt),0),Ft.wnext=0,Ft.whave=Ft.wsize):(Bt=Ft.wsize-Ft.wnext,Bt>It&&(Bt=It),Ft.window.set(Tt.subarray(pt-It,pt-It+Bt),Ft.wnext),It-=Bt,It?(Ft.window.set(Tt.subarray(pt-It,pt),0),Ft.wnext=It,Ft.whave=Ft.wsize):(Ft.wnext+=Bt,Ft.wnext===Ft.wsize&&(Ft.wnext=0),Ft.whave<Ft.wsize&&(Ft.whave+=Bt))),0},uu=(ht,Tt)=>{let pt,It,Bt,Ft,lr,qt,Or,$t,ur,Jr,Rr,Ar,Fr,ln,Zr=0,Hr,rn,$r,Pr,_i,hn,Br,on;const Qr=new Uint8Array(4);let Wr,Yr;const Rn=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Pn(ht)||!ht.output||!ht.input&&ht.avail_in!==0)return vn;pt=ht.state,pt.mode===bn&&(pt.mode=xs),lr=ht.next_out,Bt=ht.output,Or=ht.avail_out,Ft=ht.next_in,It=ht.input,qt=ht.avail_in,$t=pt.hold,ur=pt.bits,Jr=qt,Rr=Or,on=Ln;e:for(;;)switch(pt.mode){case ns:if(pt.wrap===0){pt.mode=xs;break}for(;ur<16;){if(qt===0)break e;qt--,$t+=It[Ft++]<<ur,ur+=8}if(pt.wrap&2&&$t===35615){pt.wbits===0&&(pt.wbits=15),pt.check=0,Qr[0]=$t&255,Qr[1]=$t>>>8&255,pt.check=vt(pt.check,Qr,2,0),$t=0,ur=0,pt.mode=$s;break}if(pt.head&&(pt.head.done=!1),!(pt.wrap&1)||((($t&255)<<8)+($t>>8))%31){ht.msg="incorrect header check",pt.mode=an;break}if(($t&15)!==Ks){ht.msg="unknown compression method",pt.mode=an;break}if($t>>>=4,ur-=4,Br=($t&15)+8,pt.wbits===0&&(pt.wbits=Br),Br>15||Br>pt.wbits){ht.msg="invalid window size",pt.mode=an;break}pt.dmax=1<<pt.wbits,pt.flags=0,ht.adler=pt.check=1,pt.mode=$t&512?to:bn,$t=0,ur=0;break;case $s:for(;ur<16;){if(qt===0)break e;qt--,$t+=It[Ft++]<<ur,ur+=8}if(pt.flags=$t,(pt.flags&255)!==Ks){ht.msg="unknown compression method",pt.mode=an;break}if(pt.flags&57344){ht.msg="unknown header flags set",pt.mode=an;break}pt.head&&(pt.head.text=$t>>8&1),pt.flags&512&&pt.wrap&4&&(Qr[0]=$t&255,Qr[1]=$t>>>8&255,pt.check=vt(pt.check,Qr,2,0)),$t=0,ur=0,pt.mode=Xs;case Xs:for(;ur<32;){if(qt===0)break e;qt--,$t+=It[Ft++]<<ur,ur+=8}pt.head&&(pt.head.time=$t),pt.flags&512&&pt.wrap&4&&(Qr[0]=$t&255,Qr[1]=$t>>>8&255,Qr[2]=$t>>>16&255,Qr[3]=$t>>>24&255,pt.check=vt(pt.check,Qr,4,0)),$t=0,ur=0,pt.mode=Ys;case Ys:for(;ur<16;){if(qt===0)break e;qt--,$t+=It[Ft++]<<ur,ur+=8}pt.head&&(pt.head.xflags=$t&255,pt.head.os=$t>>8),pt.flags&512&&pt.wrap&4&&(Qr[0]=$t&255,Qr[1]=$t>>>8&255,pt.check=vt(pt.check,Qr,2,0)),$t=0,ur=0,pt.mode=Zs;case Zs:if(pt.flags&1024){for(;ur<16;){if(qt===0)break e;qt--,$t+=It[Ft++]<<ur,ur+=8}pt.length=$t,pt.head&&(pt.head.extra_len=$t),pt.flags&512&&pt.wrap&4&&(Qr[0]=$t&255,Qr[1]=$t>>>8&255,pt.check=vt(pt.check,Qr,2,0)),$t=0,ur=0}else pt.head&&(pt.head.extra=null);pt.mode=Qs;case Qs:if(pt.flags&1024&&(Ar=pt.length,Ar>qt&&(Ar=qt),Ar&&(pt.head&&(Br=pt.head.extra_len-pt.length,pt.head.extra||(pt.head.extra=new Uint8Array(pt.head.extra_len)),pt.head.extra.set(It.subarray(Ft,Ft+Ar),Br)),pt.flags&512&&pt.wrap&4&&(pt.check=vt(pt.check,It,Ar,Ft)),qt-=Ar,Ft+=Ar,pt.length-=Ar),pt.length))break e;pt.length=0,pt.mode=Js;case Js:if(pt.flags&2048){if(qt===0)break e;Ar=0;do Br=It[Ft+Ar++],pt.head&&Br&&pt.length<65536&&(pt.head.name+=String.fromCharCode(Br));while(Br&&Ar<qt);if(pt.flags&512&&pt.wrap&4&&(pt.check=vt(pt.check,It,Ar,Ft)),qt-=Ar,Ft+=Ar,Br)break e}else pt.head&&(pt.head.name=null);pt.length=0,pt.mode=qs;case qs:if(pt.flags&4096){if(qt===0)break e;Ar=0;do Br=It[Ft+Ar++],pt.head&&Br&&pt.length<65536&&(pt.head.comment+=String.fromCharCode(Br));while(Br&&Ar<qt);if(pt.flags&512&&pt.wrap&4&&(pt.check=vt(pt.check,It,Ar,Ft)),qt-=Ar,Ft+=Ar,Br)break e}else pt.head&&(pt.head.comment=null);pt.mode=eo;case eo:if(pt.flags&512){for(;ur<16;){if(qt===0)break e;qt--,$t+=It[Ft++]<<ur,ur+=8}if(pt.wrap&4&&$t!==(pt.check&65535)){ht.msg="header crc mismatch",pt.mode=an;break}$t=0,ur=0}pt.head&&(pt.head.hcrc=pt.flags>>9&1,pt.head.done=!0),ht.adler=pt.check=0,pt.mode=bn;break;case to:for(;ur<32;){if(qt===0)break e;qt--,$t+=It[Ft++]<<ur,ur+=8}ht.adler=pt.check=vo($t),$t=0,ur=0,pt.mode=ss;case ss:if(pt.havedict===0)return ht.next_out=lr,ht.avail_out=Or,ht.next_in=Ft,ht.avail_in=qt,pt.hold=$t,pt.bits=ur,tu;ht.adler=pt.check=1,pt.mode=bn;case bn:if(Tt===Jl||Tt===is)break e;case xs:if(pt.last){$t>>>=ur&7,ur-=ur&7,pt.mode=bs;break}for(;ur<3;){if(qt===0)break e;qt--,$t+=It[Ft++]<<ur,ur+=8}switch(pt.last=$t&1,$t>>>=1,ur-=1,$t&3){case 0:pt.mode=ro;break;case 1:if(lu(pt),pt.mode=os,Tt===is){$t>>>=2,ur-=2;break e}break;case 2:pt.mode=no;break;case 3:ht.msg="invalid block type",pt.mode=an}$t>>>=2,ur-=2;break;case ro:for($t>>>=ur&7,ur-=ur&7;ur<32;){if(qt===0)break e;qt--,$t+=It[Ft++]<<ur,ur+=8}if(($t&65535)!==($t>>>16^65535)){ht.msg="invalid stored block lengths",pt.mode=an;break}if(pt.length=$t&65535,$t=0,ur=0,pt.mode=Es,Tt===is)break e;case Es:pt.mode=io;case io:if(Ar=pt.length,Ar){if(Ar>qt&&(Ar=qt),Ar>Or&&(Ar=Or),Ar===0)break e;Bt.set(It.subarray(Ft,Ft+Ar),lr),qt-=Ar,Ft+=Ar,Or-=Ar,lr+=Ar,pt.length-=Ar;break}pt.mode=bn;break;case no:for(;ur<14;){if(qt===0)break e;qt--,$t+=It[Ft++]<<ur,ur+=8}if(pt.nlen=($t&31)+257,$t>>>=5,ur-=5,pt.ndist=($t&31)+1,$t>>>=5,ur-=5,pt.ncode=($t&15)+4,$t>>>=4,ur-=4,pt.nlen>286||pt.ndist>30){ht.msg="too many length or distance symbols",pt.mode=an;break}pt.have=0,pt.mode=so;case so:for(;pt.have<pt.ncode;){for(;ur<3;){if(qt===0)break e;qt--,$t+=It[Ft++]<<ur,ur+=8}pt.lens[Rn[pt.have++]]=$t&7,$t>>>=3,ur-=3}for(;pt.have<19;)pt.lens[Rn[pt.have++]]=0;if(pt.lencode=pt.lendyn,pt.lenbits=7,Wr={bits:pt.lenbits},on=Xn(Ql,pt.lens,0,19,pt.lencode,0,pt.work,Wr),pt.lenbits=Wr.bits,on){ht.msg="invalid code lengths set",pt.mode=an;break}pt.have=0,pt.mode=oo;case oo:for(;pt.have<pt.nlen+pt.ndist;){for(;Zr=pt.lencode[$t&(1<<pt.lenbits)-1],Hr=Zr>>>24,rn=Zr>>>16&255,$r=Zr&65535,!(Hr<=ur);){if(qt===0)break e;qt--,$t+=It[Ft++]<<ur,ur+=8}if($r<16)$t>>>=Hr,ur-=Hr,pt.lens[pt.have++]=$r;else{if($r===16){for(Yr=Hr+2;ur<Yr;){if(qt===0)break e;qt--,$t+=It[Ft++]<<ur,ur+=8}if($t>>>=Hr,ur-=Hr,pt.have===0){ht.msg="invalid bit length repeat",pt.mode=an;break}Br=pt.lens[pt.have-1],Ar=3+($t&3),$t>>>=2,ur-=2}else if($r===17){for(Yr=Hr+3;ur<Yr;){if(qt===0)break e;qt--,$t+=It[Ft++]<<ur,ur+=8}$t>>>=Hr,ur-=Hr,Br=0,Ar=3+($t&7),$t>>>=3,ur-=3}else{for(Yr=Hr+7;ur<Yr;){if(qt===0)break e;qt--,$t+=It[Ft++]<<ur,ur+=8}$t>>>=Hr,ur-=Hr,Br=0,Ar=11+($t&127),$t>>>=7,ur-=7}if(pt.have+Ar>pt.nlen+pt.ndist){ht.msg="invalid bit length repeat",pt.mode=an;break}for(;Ar--;)pt.lens[pt.have++]=Br}}if(pt.mode===an)break;if(pt.lens[256]===0){ht.msg="invalid code -- missing end-of-block",pt.mode=an;break}if(pt.lenbits=9,Wr={bits:pt.lenbits},on=Xn(Us,pt.lens,0,pt.nlen,pt.lencode,0,pt.work,Wr),pt.lenbits=Wr.bits,on){ht.msg="invalid literal/lengths set",pt.mode=an;break}if(pt.distbits=6,pt.distcode=pt.distdyn,Wr={bits:pt.distbits},on=Xn(js,pt.lens,pt.nlen,pt.ndist,pt.distcode,0,pt.work,Wr),pt.distbits=Wr.bits,on){ht.msg="invalid distances set",pt.mode=an;break}if(pt.mode=os,Tt===is)break e;case os:pt.mode=as;case as:if(qt>=6&&Or>=258){ht.next_out=lr,ht.avail_out=Or,ht.next_in=Ft,ht.avail_in=qt,pt.hold=$t,pt.bits=ur,Kl(ht,Rr),lr=ht.next_out,Bt=ht.output,Or=ht.avail_out,Ft=ht.next_in,It=ht.input,qt=ht.avail_in,$t=pt.hold,ur=pt.bits,pt.mode===bn&&(pt.back=-1);break}for(pt.back=0;Zr=pt.lencode[$t&(1<<pt.lenbits)-1],Hr=Zr>>>24,rn=Zr>>>16&255,$r=Zr&65535,!(Hr<=ur);){if(qt===0)break e;qt--,$t+=It[Ft++]<<ur,ur+=8}if(rn&&!(rn&240)){for(Pr=Hr,_i=rn,hn=$r;Zr=pt.lencode[hn+(($t&(1<<Pr+_i)-1)>>Pr)],Hr=Zr>>>24,rn=Zr>>>16&255,$r=Zr&65535,!(Pr+Hr<=ur);){if(qt===0)break e;qt--,$t+=It[Ft++]<<ur,ur+=8}$t>>>=Pr,ur-=Pr,pt.back+=Pr}if($t>>>=Hr,ur-=Hr,pt.back+=Hr,pt.length=$r,rn===0){pt.mode=ho;break}if(rn&32){pt.back=-1,pt.mode=bn;break}if(rn&64){ht.msg="invalid literal/length code",pt.mode=an;break}pt.extra=rn&15,pt.mode=ao;case ao:if(pt.extra){for(Yr=pt.extra;ur<Yr;){if(qt===0)break e;qt--,$t+=It[Ft++]<<ur,ur+=8}pt.length+=$t&(1<<pt.extra)-1,$t>>>=pt.extra,ur-=pt.extra,pt.back+=pt.extra}pt.was=pt.length,pt.mode=lo;case lo:for(;Zr=pt.distcode[$t&(1<<pt.distbits)-1],Hr=Zr>>>24,rn=Zr>>>16&255,$r=Zr&65535,!(Hr<=ur);){if(qt===0)break e;qt--,$t+=It[Ft++]<<ur,ur+=8}if(!(rn&240)){for(Pr=Hr,_i=rn,hn=$r;Zr=pt.distcode[hn+(($t&(1<<Pr+_i)-1)>>Pr)],Hr=Zr>>>24,rn=Zr>>>16&255,$r=Zr&65535,!(Pr+Hr<=ur);){if(qt===0)break e;qt--,$t+=It[Ft++]<<ur,ur+=8}$t>>>=Pr,ur-=Pr,pt.back+=Pr}if($t>>>=Hr,ur-=Hr,pt.back+=Hr,rn&64){ht.msg="invalid distance code",pt.mode=an;break}pt.offset=$r,pt.extra=rn&15,pt.mode=uo;case uo:if(pt.extra){for(Yr=pt.extra;ur<Yr;){if(qt===0)break e;qt--,$t+=It[Ft++]<<ur,ur+=8}pt.offset+=$t&(1<<pt.extra)-1,$t>>>=pt.extra,ur-=pt.extra,pt.back+=pt.extra}if(pt.offset>pt.dmax){ht.msg="invalid distance too far back",pt.mode=an;break}pt.mode=co;case co:if(Or===0)break e;if(Ar=Rr-Or,pt.offset>Ar){if(Ar=pt.offset-Ar,Ar>pt.whave&&pt.sane){ht.msg="invalid distance too far back",pt.mode=an;break}Ar>pt.wnext?(Ar-=pt.wnext,Fr=pt.wsize-Ar):Fr=pt.wnext-Ar,Ar>pt.length&&(Ar=pt.length),ln=pt.window}else ln=Bt,Fr=lr-pt.offset,Ar=pt.length;Ar>Or&&(Ar=Or),Or-=Ar,pt.length-=Ar;do Bt[lr++]=ln[Fr++];while(--Ar);pt.length===0&&(pt.mode=as);break;case ho:if(Or===0)break e;Bt[lr++]=pt.length,Or--,pt.mode=as;break;case bs:if(pt.wrap){for(;ur<32;){if(qt===0)break e;qt--,$t|=It[Ft++]<<ur,ur+=8}if(Rr-=Or,ht.total_out+=Rr,pt.total+=Rr,pt.wrap&4&&Rr&&(ht.adler=pt.check=pt.flags?vt(pt.check,Bt,Rr,lr-Rr):sr(pt.check,Bt,Rr,lr-Rr)),Rr=Or,pt.wrap&4&&(pt.flags?$t:vo($t))!==pt.check){ht.msg="incorrect data check",pt.mode=an;break}$t=0,ur=0}pt.mode=fo;case fo:if(pt.wrap&&pt.flags){for(;ur<32;){if(qt===0)break e;qt--,$t+=It[Ft++]<<ur,ur+=8}if(pt.wrap&4&&$t!==(pt.total&4294967295)){ht.msg="incorrect length check",pt.mode=an;break}$t=0,ur=0}pt.mode=po;case po:on=eu;break e;case an:on=Gs;break e;case mo:return Hs;case go:default:return vn}return ht.next_out=lr,ht.avail_out=Or,ht.next_in=Ft,ht.avail_in=qt,pt.hold=$t,pt.bits=ur,(pt.wsize||Rr!==ht.avail_out&&pt.mode<an&&(pt.mode<bs||Tt!==Ws))&&wo(ht,ht.output,ht.next_out,Rr-ht.avail_out),Jr-=ht.avail_in,Rr-=ht.avail_out,ht.total_in+=Jr,ht.total_out+=Rr,pt.total+=Rr,pt.wrap&4&&Rr&&(ht.adler=pt.check=pt.flags?vt(pt.check,Bt,Rr,ht.next_out-Rr):sr(pt.check,Bt,Rr,ht.next_out-Rr)),ht.data_type=pt.bits+(pt.last?64:0)+(pt.mode===bn?128:0)+(pt.mode===os||pt.mode===Es?256:0),(Jr===0&&Rr===0||Tt===Ws)&&on===Ln&&(on=ru),on},cu=ht=>{if(Pn(ht))return vn;let Tt=ht.state;return Tt.window&&(Tt.window=null),ht.state=null,Ln},hu=(ht,Tt)=>{if(Pn(ht))return vn;const pt=ht.state;return pt.wrap&2?(pt.head=Tt,Tt.done=!1,Ln):vn},du=(ht,Tt)=>{const pt=Tt.length;let It,Bt,Ft;return Pn(ht)||(It=ht.state,It.wrap!==0&&It.mode!==ss)?vn:It.mode===ss&&(Bt=1,Bt=sr(Bt,Tt,pt,0),Bt!==It.check)?Gs:(Ft=wo(ht,Tt,pt,pt),Ft?(It.mode=mo,Hs):(It.havedict=1,Ln))};var fu=_o,pu=xo,mu=yo,gu=au,vu=Eo,yu=uu,_u=cu,xu=hu,Eu=du,bu="pako inflate (from Nodeca project)",wn={inflateReset:fu,inflateReset2:pu,inflateResetKeep:mu,inflateInit:gu,inflateInit2:vu,inflate:yu,inflateEnd:_u,inflateGetHeader:xu,inflateSetDictionary:Eu,inflateInfo:bu};function wu(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Au=wu;const Ao=Object.prototype.toString,{Z_NO_FLUSH:Su,Z_FINISH:Mu,Z_OK:Yn,Z_STREAM_END:Ss,Z_NEED_DICT:Ms,Z_STREAM_ERROR:Tu,Z_DATA_ERROR:So,Z_MEM_ERROR:Cu}=Yt;function Zn(ht){this.options=es.assign({chunkSize:65536,windowBits:15,to:""},ht||{});const Tt=this.options;Tt.raw&&Tt.windowBits>=0&&Tt.windowBits<16&&(Tt.windowBits=-Tt.windowBits,Tt.windowBits===0&&(Tt.windowBits=-15)),Tt.windowBits>=0&&Tt.windowBits<16&&!(ht&&ht.windowBits)&&(Tt.windowBits+=32),Tt.windowBits>15&&Tt.windowBits<48&&(Tt.windowBits&15||(Tt.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zs,this.strm.avail_out=0;let pt=wn.inflateInit2(this.strm,Tt.windowBits);if(pt!==Yn)throw new Error(Qt[pt]);if(this.header=new Au,wn.inflateGetHeader(this.strm,this.header),Tt.dictionary&&(typeof Tt.dictionary=="string"?Tt.dictionary=Kn.string2buf(Tt.dictionary):Ao.call(Tt.dictionary)==="[object ArrayBuffer]"&&(Tt.dictionary=new Uint8Array(Tt.dictionary)),Tt.raw&&(pt=wn.inflateSetDictionary(this.strm,Tt.dictionary),pt!==Yn)))throw new Error(Qt[pt])}Zn.prototype.push=function(ht,Tt){const pt=this.strm,It=this.options.chunkSize,Bt=this.options.dictionary;let Ft,lr,qt;if(this.ended)return!1;for(Tt===~~Tt?lr=Tt:lr=Tt===!0?Mu:Su,Ao.call(ht)==="[object ArrayBuffer]"?pt.input=new Uint8Array(ht):pt.input=ht,pt.next_in=0,pt.avail_in=pt.input.length;;){for(pt.avail_out===0&&(pt.output=new Uint8Array(It),pt.next_out=0,pt.avail_out=It),Ft=wn.inflate(pt,lr),Ft===Ms&&Bt&&(Ft=wn.inflateSetDictionary(pt,Bt),Ft===Yn?Ft=wn.inflate(pt,lr):Ft===So&&(Ft=Ms));pt.avail_in>0&&Ft===Ss&&pt.state.wrap>0&&ht[pt.next_in]!==0;)wn.inflateReset(pt),Ft=wn.inflate(pt,lr);switch(Ft){case Tu:case So:case Ms:case Cu:return this.onEnd(Ft),this.ended=!0,!1}if(qt=pt.avail_out,pt.next_out&&(pt.avail_out===0||Ft===Ss))if(this.options.to==="string"){let Or=Kn.utf8border(pt.output,pt.next_out),$t=pt.next_out-Or,ur=Kn.buf2string(pt.output,Or);pt.next_out=$t,pt.avail_out=It-$t,$t&&pt.output.set(pt.output.subarray(Or,Or+$t),0),this.onData(ur)}else this.onData(pt.output.length===pt.next_out?pt.output:pt.output.subarray(0,pt.next_out));if(!(Ft===Yn&&qt===0)){if(Ft===Ss)return Ft=wn.inflateEnd(this.strm),this.onEnd(Ft),this.ended=!0,!0;if(pt.avail_in===0)break}}return!0},Zn.prototype.onData=function(ht){this.chunks.push(ht)},Zn.prototype.onEnd=function(ht){ht===Yn&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=es.flattenChunks(this.chunks)),this.chunks=[],this.err=ht,this.msg=this.strm.msg};function Ts(ht,Tt){const pt=new Zn(Tt);if(pt.push(ht),pt.err)throw pt.msg||Qt[pt.err];return pt.result}function Du(ht,Tt){return Tt=Tt||{},Tt.raw=!0,Ts(ht,Tt)}var Lu=Zn,Pu=Ts,Ru=Du,Ou=Ts,Iu={Inflate:Lu,inflate:Pu,inflateRaw:Ru,ungzip:Ou};const{Deflate:zu,deflate:Fu,deflateRaw:Bu,gzip:ku}=Gl,{Inflate:Nu,inflate:Vu,inflateRaw:Uu,ungzip:ju}=Iu;var Mo=zu,To=Fu,Co=Bu,Do=ku,Lo=Nu,Po=Vu,Ro=Uu,Oo=ju,Io=Yt,Wu={Deflate:Mo,deflate:To,deflateRaw:Co,gzip:Do,Inflate:Lo,inflate:Po,inflateRaw:Ro,ungzip:Oo,constants:Io}},"./node_modules/upng-js/UPNG.js"(e,i,s){(function(){var o={},a;e.exports=o,a=s("./node_modules/upng-js/node_modules/pako/index.js"),function(h,_){h.toRGBA8=function(g){var _e=g.width,st=g.height;if(g.tabs.acTL==null)return[h.toRGBA8.decodeImage(g.data,_e,st,g).buffer];var tt=[];g.frames[0].data==null&&(g.frames[0].data=g.data);for(var at,ot=new Uint8Array(_e*st*4),lt=0;lt<g.frames.length;lt++){var ct=g.frames[lt],$=ct.rect.x,c=ct.rect.y,d=ct.rect.width,j=ct.rect.height,et=h.toRGBA8.decodeImage(ct.data,d,j,g);if(lt==0?at=et:ct.blend==0?h._copyTile(et,d,j,at,_e,st,$,c,0):ct.blend==1&&h._copyTile(et,d,j,at,_e,st,$,c,1),tt.push(at.buffer),at=at.slice(0),ct.dispose!=0){if(ct.dispose==1)h._copyTile(ot,d,j,at,_e,st,$,c,0);else if(ct.dispose==2){for(var nt=lt-1;g.frames[nt].dispose==2;)nt--;at=new Uint8Array(tt[nt]).slice(0)}}}return tt},h.toRGBA8.decodeImage=function(g,_e,st,tt){var at=_e*st,ot=h.decode._getBPP(tt),lt=Math.ceil(_e*ot/8),ct=new Uint8Array(at*4),$=new Uint32Array(ct.buffer),c=tt.ctype,d=tt.depth,j=h._bin.readUshort;if(c==6){var et=at<<2;if(d==8)for(var nt=0;nt<et;nt++)ct[nt]=g[nt];if(d==16)for(var nt=0;nt<et;nt++)ct[nt]=g[nt<<1]}else if(c==2){var ut=tt.tabs.tRNS,b=-1,it=-1,rt=-1;if(ut&&(b=ut[0],it=ut[1],rt=ut[2]),d==8)for(var nt=0;nt<at;nt++){var dt=nt<<2,ft=nt*3;ct[dt]=g[ft],ct[dt+1]=g[ft+1],ct[dt+2]=g[ft+2],ct[dt+3]=255,b!=-1&&g[ft]==b&&g[ft+1]==it&&g[ft+2]==rt&&(ct[dt+3]=0)}if(d==16)for(var nt=0;nt<at;nt++){var dt=nt<<2,ft=nt*6;ct[dt]=g[ft],ct[dt+1]=g[ft+2],ct[dt+2]=g[ft+4],ct[dt+3]=255,b!=-1&&j(g,ft)==b&&j(g,ft+2)==it&&j(g,ft+4)==rt&&(ct[dt+3]=0)}}else if(c==3){var mt=tt.tabs.PLTE,yt=tt.tabs.tRNS,gt=yt?yt.length:0;if(d==1)for(var _t=0;_t<st;_t++)for(var xt=_t*lt,Mt=_t*_e,nt=0;nt<_e;nt++){var dt=Mt+nt<<2,wt=g[xt+(nt>>3)]>>7-((nt&7)<<0)&1,Et=3*wt;ct[dt]=mt[Et],ct[dt+1]=mt[Et+1],ct[dt+2]=mt[Et+2],ct[dt+3]=wt<gt?yt[wt]:255}if(d==2)for(var _t=0;_t<st;_t++)for(var xt=_t*lt,Mt=_t*_e,nt=0;nt<_e;nt++){var dt=Mt+nt<<2,wt=g[xt+(nt>>2)]>>6-((nt&3)<<1)&3,Et=3*wt;ct[dt]=mt[Et],ct[dt+1]=mt[Et+1],ct[dt+2]=mt[Et+2],ct[dt+3]=wt<gt?yt[wt]:255}if(d==4)for(var _t=0;_t<st;_t++)for(var xt=_t*lt,Mt=_t*_e,nt=0;nt<_e;nt++){var dt=Mt+nt<<2,wt=g[xt+(nt>>1)]>>4-((nt&1)<<2)&15,Et=3*wt;ct[dt]=mt[Et],ct[dt+1]=mt[Et+1],ct[dt+2]=mt[Et+2],ct[dt+3]=wt<gt?yt[wt]:255}if(d==8)for(var nt=0;nt<at;nt++){var dt=nt<<2,wt=g[nt],Et=3*wt;ct[dt]=mt[Et],ct[dt+1]=mt[Et+1],ct[dt+2]=mt[Et+2],ct[dt+3]=wt<gt?yt[wt]:255}}else if(c==4){if(d==8)for(var nt=0;nt<at;nt++){var dt=nt<<2,At=nt<<1,St=g[At];ct[dt]=St,ct[dt+1]=St,ct[dt+2]=St,ct[dt+3]=g[At+1]}if(d==16)for(var nt=0;nt<at;nt++){var dt=nt<<2,At=nt<<2,St=g[At];ct[dt]=St,ct[dt+1]=St,ct[dt+2]=St,ct[dt+3]=g[At+2]}}else if(c==0){var b=tt.tabs.tRNS?tt.tabs.tRNS:-1;if(d==1)for(var nt=0;nt<at;nt++){var St=255*(g[nt>>3]>>7-(nt&7)&1),bt=St==b*255?0:255;$[nt]=bt<<24|St<<16|St<<8|St}if(d==2)for(var nt=0;nt<at;nt++){var St=85*(g[nt>>2]>>6-((nt&3)<<1)&3),bt=St==b*85?0:255;$[nt]=bt<<24|St<<16|St<<8|St}if(d==4)for(var nt=0;nt<at;nt++){var St=17*(g[nt>>1]>>4-((nt&1)<<2)&15),bt=St==b*17?0:255;$[nt]=bt<<24|St<<16|St<<8|St}if(d==8)for(var nt=0;nt<at;nt++){var St=g[nt],bt=St==b?0:255;$[nt]=bt<<24|St<<16|St<<8|St}if(d==16)for(var nt=0;nt<at;nt++){var St=g[nt<<1],bt=j(g,nt<<1)==b?0:255;$[nt]=bt<<24|St<<16|St<<8|St}}return ct},h.decode=function(g){for(var _e=new Uint8Array(g),st=8,tt=h._bin,at=tt.readUshort,ot=tt.readUint,lt={tabs:{},frames:[]},ct=new Uint8Array(_e.length),$=0,c,d=0,j=[137,80,78,71,13,10,26,10],et=0;et<8;et++)if(_e[et]!=j[et])throw"The input is not a PNG file!";for(;st<_e.length;){var nt=tt.readUint(_e,st);st+=4;var ut=tt.readASCII(_e,st,4);if(st+=4,ut=="IHDR")h.decode._IHDR(_e,st,lt);else if(ut=="IDAT"){for(var et=0;et<nt;et++)ct[$+et]=_e[st+et];$+=nt}else if(ut=="acTL")lt.tabs[ut]={num_frames:ot(_e,st),num_plays:ot(_e,st+4)},c=new Uint8Array(_e.length);else if(ut=="fcTL"){if(d!=0){var b=lt.frames[lt.frames.length-1];b.data=h.decode._decompress(lt,c.slice(0,d),b.rect.width,b.rect.height),d=0}var it={x:ot(_e,st+12),y:ot(_e,st+16),width:ot(_e,st+4),height:ot(_e,st+8)},rt=at(_e,st+22);rt=at(_e,st+20)/(rt==0?100:rt);var dt={rect:it,delay:Math.round(rt*1e3),dispose:_e[st+24],blend:_e[st+25]};lt.frames.push(dt)}else if(ut=="fdAT"){for(var et=0;et<nt-4;et++)c[d+et]=_e[st+et+4];d+=nt-4}else if(ut=="pHYs")lt.tabs[ut]=[tt.readUint(_e,st),tt.readUint(_e,st+4),_e[st+8]];else if(ut=="cHRM"){lt.tabs[ut]=[];for(var et=0;et<8;et++)lt.tabs[ut].push(tt.readUint(_e,st+et*4))}else if(ut=="tEXt"){lt.tabs[ut]==null&&(lt.tabs[ut]={});var ft=tt.nextZero(_e,st),mt=tt.readASCII(_e,st,ft-st),yt=tt.readASCII(_e,ft+1,st+nt-ft-1);lt.tabs[ut][mt]=yt}else if(ut=="iTXt"){lt.tabs[ut]==null&&(lt.tabs[ut]={});var ft=0,gt=st;ft=tt.nextZero(_e,gt);var mt=tt.readASCII(_e,gt,ft-gt);gt=ft+1,_e[gt],_e[gt+1],gt+=2,ft=tt.nextZero(_e,gt),tt.readASCII(_e,gt,ft-gt),gt=ft+1,ft=tt.nextZero(_e,gt),tt.readUTF8(_e,gt,ft-gt),gt=ft+1;var yt=tt.readUTF8(_e,gt,nt-(gt-st));lt.tabs[ut][mt]=yt}else if(ut=="PLTE")lt.tabs[ut]=tt.readBytes(_e,st,nt);else if(ut=="hIST"){var _t=lt.tabs.PLTE.length/3;lt.tabs[ut]=[];for(var et=0;et<_t;et++)lt.tabs[ut].push(at(_e,st+et*2))}else if(ut=="tRNS")lt.ctype==3?lt.tabs[ut]=tt.readBytes(_e,st,nt):lt.ctype==0?lt.tabs[ut]=at(_e,st):lt.ctype==2&&(lt.tabs[ut]=[at(_e,st),at(_e,st+2),at(_e,st+4)]);else if(ut=="gAMA")lt.tabs[ut]=tt.readUint(_e,st)/1e5;else if(ut=="sRGB")lt.tabs[ut]=_e[st];else if(ut=="bKGD")lt.ctype==0||lt.ctype==4?lt.tabs[ut]=[at(_e,st)]:lt.ctype==2||lt.ctype==6?lt.tabs[ut]=[at(_e,st),at(_e,st+2),at(_e,st+4)]:lt.ctype==3&&(lt.tabs[ut]=_e[st]);else if(ut=="IEND"){if(d!=0){var b=lt.frames[lt.frames.length-1];b.data=h.decode._decompress(lt,c.slice(0,d),b.rect.width,b.rect.height),d=0}lt.data=h.decode._decompress(lt,ct,lt.width,lt.height);break}st+=nt,tt.readUint(_e,st),st+=4}return delete lt.compress,delete lt.interlace,delete lt.filter,lt},h.decode._decompress=function(g,_e,st,tt){return g.compress==0&&(_e=h.decode._inflate(_e)),g.interlace==0?_e=h.decode._filterZero(_e,g,0,st,tt):g.interlace==1&&(_e=h.decode._readInterlace(_e,g)),_e},h.decode._inflate=function(g){return _.inflate(g)},h.decode._readInterlace=function(g,_e){for(var st=_e.width,tt=_e.height,at=h.decode._getBPP(_e),ot=at>>3,lt=Math.ceil(st*at/8),ct=new Uint8Array(tt*lt),$=0,c=[0,0,4,0,2,0,1],d=[0,4,0,2,0,1,0],j=[8,8,8,4,4,2,2],et=[8,8,4,4,2,2,1],nt=0;nt<7;){for(var ut=j[nt],b=et[nt],it=0,rt=0,dt=c[nt];dt<tt;)dt+=ut,rt++;for(var ft=d[nt];ft<st;)ft+=b,it++;var mt=Math.ceil(it*at/8);h.decode._filterZero(g,_e,$,it,rt);for(var yt=0,gt=c[nt];gt<tt;){for(var _t=d[nt],xt=$+yt*mt<<3;_t<st;){if(at==1){var Mt=g[xt>>3];Mt=Mt>>7-(xt&7)&1,ct[gt*lt+(_t>>3)]|=Mt<<7-((_t&3)<<0)}if(at==2){var Mt=g[xt>>3];Mt=Mt>>6-(xt&7)&3,ct[gt*lt+(_t>>2)]|=Mt<<6-((_t&3)<<1)}if(at==4){var Mt=g[xt>>3];Mt=Mt>>4-(xt&7)&15,ct[gt*lt+(_t>>1)]|=Mt<<4-((_t&1)<<2)}if(at>=8)for(var wt=gt*lt+_t*ot,Et=0;Et<ot;Et++)ct[wt+Et]=g[(xt>>3)+Et];xt+=at,_t+=b}yt++,gt+=ut}it*rt!=0&&($+=rt*(1+mt)),nt=nt+1}return ct},h.decode._getBPP=function(g){var _e=[1,null,3,1,2,null,4][g.ctype];return _e*g.depth},h.decode._filterZero=function(g,_e,st,tt,at){var ot=h.decode._getBPP(_e),lt=Math.ceil(tt*ot/8),ct=h.decode._paeth;ot=Math.ceil(ot/8);for(var $=0;$<at;$++){var c=st+$*lt,d=c+$+1,j=g[d-1];if(j==0)for(var et=0;et<lt;et++)g[c+et]=g[d+et];else if(j==1){for(var et=0;et<ot;et++)g[c+et]=g[d+et];for(var et=ot;et<lt;et++)g[c+et]=g[d+et]+g[c+et-ot]&255}else if($==0){for(var et=0;et<ot;et++)g[c+et]=g[d+et];if(j==2)for(var et=ot;et<lt;et++)g[c+et]=g[d+et]&255;if(j==3)for(var et=ot;et<lt;et++)g[c+et]=g[d+et]+(g[c+et-ot]>>1)&255;if(j==4)for(var et=ot;et<lt;et++)g[c+et]=g[d+et]+ct(g[c+et-ot],0,0)&255}else{if(j==2)for(var et=0;et<lt;et++)g[c+et]=g[d+et]+g[c+et-lt]&255;if(j==3){for(var et=0;et<ot;et++)g[c+et]=g[d+et]+(g[c+et-lt]>>1)&255;for(var et=ot;et<lt;et++)g[c+et]=g[d+et]+(g[c+et-lt]+g[c+et-ot]>>1)&255}if(j==4){for(var et=0;et<ot;et++)g[c+et]=g[d+et]+ct(0,g[c+et-lt],0)&255;for(var et=ot;et<lt;et++)g[c+et]=g[d+et]+ct(g[c+et-ot],g[c+et-lt],g[c+et-ot-lt])&255}}}return g},h.decode._paeth=function(g,_e,st){var tt=g+_e-st,at=Math.abs(tt-g),ot=Math.abs(tt-_e),lt=Math.abs(tt-st);return at<=ot&&at<=lt?g:ot<=lt?_e:st},h.decode._IHDR=function(g,_e,st){var tt=h._bin;st.width=tt.readUint(g,_e),_e+=4,st.height=tt.readUint(g,_e),_e+=4,st.depth=g[_e],_e++,st.ctype=g[_e],_e++,st.compress=g[_e],_e++,st.filter=g[_e],_e++,st.interlace=g[_e],_e++},h._bin={nextZero:function(g,_e){for(;g[_e]!=0;)_e++;return _e},readUshort:function(g,_e){return g[_e]<<8|g[_e+1]},writeUshort:function(g,_e,st){g[_e]=st>>8&255,g[_e+1]=st&255},readUint:function(g,_e){return g[_e]*16777216+(g[_e+1]<<16|g[_e+2]<<8|g[_e+3])},writeUint:function(g,_e,st){g[_e]=st>>24&255,g[_e+1]=st>>16&255,g[_e+2]=st>>8&255,g[_e+3]=st&255},readASCII:function(g,_e,st){for(var tt="",at=0;at<st;at++)tt+=String.fromCharCode(g[_e+at]);return tt},writeASCII:function(g,_e,st){for(var tt=0;tt<st.length;tt++)g[_e+tt]=st.charCodeAt(tt)},readBytes:function(g,_e,st){for(var tt=[],at=0;at<st;at++)tt.push(g[_e+at]);return tt},pad:function(g){return g.length<2?"0"+g:g},readUTF8:function(g,_e,st){for(var tt="",at,ot=0;ot<st;ot++)tt+="%"+h._bin.pad(g[_e+ot].toString(16));try{at=decodeURIComponent(tt)}catch{return h._bin.readASCII(g,_e,st)}return at}},h._copyTile=function(g,_e,st,tt,at,ot,lt,ct,$){for(var c=Math.min(_e,at),d=Math.min(st,ot),j=0,et=0,nt=0;nt<d;nt++)for(var ut=0;ut<c;ut++)if(lt>=0&&ct>=0?(j=nt*_e+ut<<2,et=(ct+nt)*at+lt+ut<<2):(j=(-ct+nt)*_e-lt+ut<<2,et=nt*at+ut<<2),$==0)tt[et]=g[j],tt[et+1]=g[j+1],tt[et+2]=g[j+2],tt[et+3]=g[j+3];else if($==1){var b=g[j+3]*.00392156862745098,it=g[j]*b,rt=g[j+1]*b,dt=g[j+2]*b,ft=tt[et+3]*(1/255),mt=tt[et]*ft,yt=tt[et+1]*ft,gt=tt[et+2]*ft,_t=1-b,xt=b+ft*_t,Mt=xt==0?0:1/xt;tt[et+3]=255*xt,tt[et+0]=(it+mt*_t)*Mt,tt[et+1]=(rt+yt*_t)*Mt,tt[et+2]=(dt+gt*_t)*Mt}else if($==2){var b=g[j+3],it=g[j],rt=g[j+1],dt=g[j+2],ft=tt[et+3],mt=tt[et],yt=tt[et+1],gt=tt[et+2];b==ft&&it==mt&&rt==yt&&dt==gt?(tt[et]=0,tt[et+1]=0,tt[et+2]=0,tt[et+3]=0):(tt[et]=it,tt[et+1]=rt,tt[et+2]=dt,tt[et+3]=b)}else if($==3){var b=g[j+3],it=g[j],rt=g[j+1],dt=g[j+2],ft=tt[et+3],mt=tt[et],yt=tt[et+1],gt=tt[et+2];if(b==ft&&it==mt&&rt==yt&&dt==gt)continue;if(b<220&&ft>20)return!1}return!0},h.encode=function(g,_e,st,tt,at,ot){tt==null&&(tt=0),ot==null&&(ot=!1);for(var lt=new Uint8Array(g[0].byteLength*g.length+100),ct=[137,80,78,71,13,10,26,10],$=0;$<8;$++)lt[$]=ct[$];var c=8,d=h._bin,j=h.crc.crc,et=d.writeUint,nt=d.writeUshort,ut=d.writeASCII,b=h.encode.compressPNG(g,_e,st,tt,ot);et(lt,c,13),c+=4,ut(lt,c,"IHDR"),c+=4,et(lt,c,_e),c+=4,et(lt,c,st),c+=4,lt[c]=b.depth,c++,lt[c]=b.ctype,c++,lt[c]=0,c++,lt[c]=0,c++,lt[c]=0,c++,et(lt,c,j(lt,c-17,17)),c+=4,et(lt,c,1),c+=4,ut(lt,c,"sRGB"),c+=4,lt[c]=1,c++,et(lt,c,j(lt,c-5,5)),c+=4;var it=g.length>1;if(it&&(et(lt,c,8),c+=4,ut(lt,c,"acTL"),c+=4,et(lt,c,g.length),c+=4,et(lt,c,0),c+=4,et(lt,c,j(lt,c-12,12)),c+=4),b.ctype==3){var rt=b.plte.length;et(lt,c,rt*3),c+=4,ut(lt,c,"PLTE"),c+=4;for(var $=0;$<rt;$++){var dt=$*3,ft=b.plte[$],mt=ft&255,yt=ft>>8&255,gt=ft>>16&255;lt[c+dt+0]=mt,lt[c+dt+1]=yt,lt[c+dt+2]=gt}if(c+=rt*3,et(lt,c,j(lt,c-rt*3-4,rt*3+4)),c+=4,b.gotAlpha){et(lt,c,rt),c+=4,ut(lt,c,"tRNS"),c+=4;for(var $=0;$<rt;$++)lt[c+$]=b.plte[$]>>24&255;c+=rt,et(lt,c,j(lt,c-rt-4,rt+4)),c+=4}}for(var _t=0,xt=0;xt<b.frames.length;xt++){var Mt=b.frames[xt];it&&(et(lt,c,26),c+=4,ut(lt,c,"fcTL"),c+=4,et(lt,c,_t++),c+=4,et(lt,c,Mt.rect.width),c+=4,et(lt,c,Mt.rect.height),c+=4,et(lt,c,Mt.rect.x),c+=4,et(lt,c,Mt.rect.y),c+=4,nt(lt,c,at[xt]),c+=2,nt(lt,c,1e3),c+=2,lt[c]=Mt.dispose,c++,lt[c]=Mt.blend,c++,et(lt,c,j(lt,c-30,30)),c+=4);var wt=Mt.cimg,rt=wt.length;et(lt,c,rt+(xt==0?0:4)),c+=4;var Et=c;ut(lt,c,xt==0?"IDAT":"fdAT"),c+=4,xt!=0&&(et(lt,c,_t++),c+=4);for(var $=0;$<rt;$++)lt[c+$]=wt[$];c+=rt,et(lt,c,j(lt,Et,c-Et)),c+=4}return et(lt,c,0),c+=4,ut(lt,c,"IEND"),c+=4,et(lt,c,j(lt,c-4,4)),c+=4,lt.buffer.slice(0,c)},h.encode.compressPNG=function(g,_e,st,tt,at){for(var ot=h.encode.compress(g,_e,st,tt,!1,at),lt=0;lt<g.length;lt++){var ct=ot.frames[lt];ct.rect.width;var $=ct.rect.height,c=ct.bpl,d=ct.bpp,j=new Uint8Array($*c+$);ct.cimg=h.encode._filterZero(ct.img,$,d,c,j)}return ot},h.encode.compress=function(g,_e,st,tt,at,ot){ot==null&&(ot=!1);for(var lt=6,ct=8,$=4,c=255,d=0;d<g.length;d++)for(var j=new Uint8Array(g[d]),et=j.length,nt=0;nt<et;nt+=4)c&=j[nt+3];var ut=c!=255,b={},it=[];if(g.length!=0&&(b[0]=0,it.push(0),tt!=0&&tt--),tt!=0){var rt=h.quantize(g,tt,at);g=rt.bufs;for(var nt=0;nt<rt.plte.length;nt++){var dt=rt.plte[nt].est.rgba;b[dt]==null&&(b[dt]=it.length,it.push(dt))}}else for(var d=0;d<g.length;d++)for(var ft=new Uint32Array(g[d]),et=ft.length,nt=0;nt<et;nt++){var dt=ft[nt];if((nt<_e||dt!=ft[nt-1]&&dt!=ft[nt-_e])&&b[dt]==null&&(b[dt]=it.length,it.push(dt),it.length>=300))break}var mt=ut?at:!1,yt=it.length;yt<=256&&ot==!1&&(yt<=2?ct=1:yt<=4?ct=2:yt<=16?ct=4:ct=8,at&&(ct=8),ut=!0);for(var gt=[],d=0;d<g.length;d++){var _t=new Uint8Array(g[d]),xt=new Uint32Array(_t.buffer),Mt=0,wt=0,Et=_e,At=st,St=0;if(d!=0&&!mt){for(var bt=at||d==1||gt[gt.length-2].dispose==2?1:2,Ct=0,Nt=1e9,kt=0;kt<bt;kt++){for(var nr=new Uint8Array(g[d-1-kt]),Ht=new Uint32Array(g[d-1-kt]),jt=_e,Zt=st,Xt=-1,Kt=-1,ar=0;ar<st;ar++)for(var or=0;or<_e;or++){var nt=ar*_e+or;xt[nt]!=Ht[nt]&&(or<jt&&(jt=or),or>Xt&&(Xt=or),ar<Zt&&(Zt=ar),ar>Kt&&(Kt=ar))}var _r=Xt==-1?1:(Xt-jt+1)*(Kt-Zt+1);_r<Nt&&(Nt=_r,Ct=kt,Xt==-1?(Mt=wt=0,Et=At=1):(Mt=jt,wt=Zt,Et=Xt-jt+1,At=Kt-Zt+1))}var nr=new Uint8Array(g[d-1-Ct]);Ct==1&&(gt[gt.length-1].dispose=2);var Vt=new Uint8Array(Et*At*4);new Uint32Array(Vt.buffer),h._copyTile(nr,_e,st,Vt,Et,At,-Mt,-wt,0),h._copyTile(_t,_e,st,Vt,Et,At,-Mt,-wt,3)?(h._copyTile(_t,_e,st,Vt,Et,At,-Mt,-wt,2),St=1):(h._copyTile(_t,_e,st,Vt,Et,At,-Mt,-wt,0),St=0),_t=Vt,xt=new Uint32Array(_t.buffer)}var tr=4*Et;if(yt<=256&&ot==!1){tr=Math.ceil(ct*Et/8);for(var Vt=new Uint8Array(tr*At),ar=0;ar<At;ar++){var nt=ar*tr,mr=ar*Et;if(ct==8)for(var or=0;or<Et;or++)Vt[nt+or]=b[xt[mr+or]];else if(ct==4)for(var or=0;or<Et;or++)Vt[nt+(or>>1)]|=b[xt[mr+or]]<<4-(or&1)*4;else if(ct==2)for(var or=0;or<Et;or++)Vt[nt+(or>>2)]|=b[xt[mr+or]]<<6-(or&3)*2;else if(ct==1)for(var or=0;or<Et;or++)Vt[nt+(or>>3)]|=b[xt[mr+or]]<<7-(or&7)*1}_t=Vt,lt=3,$=1}else if(ut==!1&&g.length==1){for(var Vt=new Uint8Array(Et*At*3),wr=Et*At,nt=0;nt<wr;nt++){var Er=nt*3,Sr=nt*4;Vt[Er]=_t[Sr],Vt[Er+1]=_t[Sr+1],Vt[Er+2]=_t[Sr+2]}_t=Vt,lt=2,$=3,tr=3*Et}gt.push({rect:{x:Mt,y:wt,width:Et,height:At},img:_t,bpl:tr,bpp:$,blend:St,dispose:mt?1:0})}return{ctype:lt,depth:ct,plte:it,gotAlpha:ut,frames:gt}},h.encode._filterZero=function(g,_e,st,tt,at){for(var ot=[],lt=0;lt<5;lt++)if(!(_e*tt>5e5&&(lt==2||lt==3||lt==4))){for(var ct=0;ct<_e;ct++)h.encode._filterLine(at,g,ct,tt,st,lt);if(ot.push(_.deflate(at)),st==1)break}for(var $,c=1e9,d=0;d<ot.length;d++)ot[d].length<c&&($=d,c=ot[d].length);return ot[$]},h.encode._filterLine=function(g,_e,st,tt,at,ot){var lt=st*tt,ct=lt+st,$=h.decode._paeth;if(g[ct]=ot,ct++,ot==0)for(var c=0;c<tt;c++)g[ct+c]=_e[lt+c];else if(ot==1){for(var c=0;c<at;c++)g[ct+c]=_e[lt+c];for(var c=at;c<tt;c++)g[ct+c]=_e[lt+c]-_e[lt+c-at]+256&255}else if(st==0){for(var c=0;c<at;c++)g[ct+c]=_e[lt+c];if(ot==2)for(var c=at;c<tt;c++)g[ct+c]=_e[lt+c];if(ot==3)for(var c=at;c<tt;c++)g[ct+c]=_e[lt+c]-(_e[lt+c-at]>>1)+256&255;if(ot==4)for(var c=at;c<tt;c++)g[ct+c]=_e[lt+c]-$(_e[lt+c-at],0,0)+256&255}else{if(ot==2)for(var c=0;c<tt;c++)g[ct+c]=_e[lt+c]+256-_e[lt+c-tt]&255;if(ot==3){for(var c=0;c<at;c++)g[ct+c]=_e[lt+c]+256-(_e[lt+c-tt]>>1)&255;for(var c=at;c<tt;c++)g[ct+c]=_e[lt+c]+256-(_e[lt+c-tt]+_e[lt+c-at]>>1)&255}if(ot==4){for(var c=0;c<at;c++)g[ct+c]=_e[lt+c]+256-$(0,_e[lt+c-tt],0)&255;for(var c=at;c<tt;c++)g[ct+c]=_e[lt+c]+256-$(_e[lt+c-at],_e[lt+c-tt],_e[lt+c-at-tt])&255}}},h.crc={table:function(){for(var g=new Uint32Array(256),_e=0;_e<256;_e++){for(var st=_e,tt=0;tt<8;tt++)st&1?st=3988292384^st>>>1:st=st>>>1;g[_e]=st}return g}(),update:function(g,_e,st,tt){for(var at=0;at<tt;at++)g=h.crc.table[(g^_e[st+at])&255]^g>>>8;return g},crc:function(g,_e,st){return h.crc.update(4294967295,g,_e,st)^4294967295}},h.quantize=function(g,_e,st){for(var tt=[],at=0,ot=0;ot<g.length;ot++)tt.push(h.encode.alphaMul(new Uint8Array(g[ot]),st)),at+=g[ot].byteLength;for(var lt=new Uint8Array(at),ct=new Uint32Array(lt.buffer),$=0,ot=0;ot<tt.length;ot++){for(var c=tt[ot],d=c.length,j=0;j<d;j++)lt[$+j]=c[j];$+=d}var et={i0:0,i1:lt.length,bst:null,est:null,tdst:0,left:null,right:null};et.bst=h.quantize.stats(lt,et.i0,et.i1),et.est=h.quantize.estats(et.bst);for(var nt=[et];nt.length<_e;){for(var ut=0,b=0,ot=0;ot<nt.length;ot++)nt[ot].est.L>ut&&(ut=nt[ot].est.L,b=ot);if(ut<.001)break;var it=nt[b],rt=h.quantize.splitPixels(lt,ct,it.i0,it.i1,it.est.e,it.est.eMq255),dt={i0:it.i0,i1:rt,bst:null,est:null,tdst:0,left:null,right:null};dt.bst=h.quantize.stats(lt,dt.i0,dt.i1),dt.est=h.quantize.estats(dt.bst);var ft={i0:rt,i1:it.i1,bst:null,est:null,tdst:0,left:null,right:null};ft.bst={R:[],m:[],N:it.bst.N-dt.bst.N};for(var ot=0;ot<16;ot++)ft.bst.R[ot]=it.bst.R[ot]-dt.bst.R[ot];for(var ot=0;ot<4;ot++)ft.bst.m[ot]=it.bst.m[ot]-dt.bst.m[ot];ft.est=h.quantize.estats(ft.bst),it.left=dt,it.right=ft,nt[b]=dt,nt.push(ft)}nt.sort(function(bt,Ct){return Ct.bst.N-bt.bst.N});for(var mt=0;mt<tt.length;mt++){for(var yt=h.quantize.planeDst,gt=new Uint8Array(tt[mt].buffer),_t=new Uint32Array(tt[mt].buffer),xt=gt.length,ot=0;ot<xt;ot+=4){for(var Mt=gt[ot]*.00392156862745098,wt=gt[ot+1]*(1/255),Et=gt[ot+2]*(1/255),At=gt[ot+3]*(1/255),St=et;St.left;)St=yt(St.est,Mt,wt,Et,At)<=0?St.left:St.right;_t[ot>>2]=St.est.rgba}tt[mt]=_t.buffer}return{bufs:tt,plte:nt}},h.quantize.getNearest=function(g,_e,st,tt,at){if(g.left==null)return g.tdst=h.quantize.dist(g.est.q,_e,st,tt,at),g;var ot=h.quantize.planeDst(g.est,_e,st,tt,at),lt=g.left,ct=g.right;ot>0&&(lt=g.right,ct=g.left);var $=h.quantize.getNearest(lt,_e,st,tt,at);if($.tdst<=ot*ot)return $;var c=h.quantize.getNearest(ct,_e,st,tt,at);return c.tdst<$.tdst?c:$},h.quantize.planeDst=function(g,_e,st,tt,at){var ot=g.e;return ot[0]*_e+ot[1]*st+ot[2]*tt+ot[3]*at-g.eMq},h.quantize.dist=function(g,_e,st,tt,at){var ot=_e-g[0],lt=st-g[1],ct=tt-g[2],$=at-g[3];return ot*ot+lt*lt+ct*ct+$*$},h.quantize.splitPixels=function(g,_e,st,tt,at,ot){var lt=h.quantize.vecDot;for(tt-=4;st<tt;){for(;lt(g,st,at)<=ot;)st+=4;for(;lt(g,tt,at)>ot;)tt-=4;if(st>=tt)break;var ct=_e[st>>2];_e[st>>2]=_e[tt>>2],_e[tt>>2]=ct,st+=4,tt-=4}for(;lt(g,st,at)>ot;)st-=4;return st+4},h.quantize.vecDot=function(g,_e,st){return g[_e]*st[0]+g[_e+1]*st[1]+g[_e+2]*st[2]+g[_e+3]*st[3]},h.quantize.stats=function(g,_e,st){for(var tt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],at=[0,0,0,0],ot=st-_e>>2,lt=_e;lt<st;lt+=4){var ct=g[lt]*.00392156862745098,$=g[lt+1]*(1/255),c=g[lt+2]*(1/255),d=g[lt+3]*(1/255);at[0]+=ct,at[1]+=$,at[2]+=c,at[3]+=d,tt[0]+=ct*ct,tt[1]+=ct*$,tt[2]+=ct*c,tt[3]+=ct*d,tt[5]+=$*$,tt[6]+=$*c,tt[7]+=$*d,tt[10]+=c*c,tt[11]+=c*d,tt[15]+=d*d}return tt[4]=tt[1],tt[8]=tt[2],tt[12]=tt[3],tt[9]=tt[6],tt[13]=tt[7],tt[14]=tt[11],{R:tt,m:at,N:ot}},h.quantize.estats=function(g){var _e=g.R,st=g.m,tt=g.N,at=st[0],ot=st[1],lt=st[2],ct=st[3],$=tt==0?0:1/tt,c=[_e[0]-at*at*$,_e[1]-at*ot*$,_e[2]-at*lt*$,_e[3]-at*ct*$,_e[4]-ot*at*$,_e[5]-ot*ot*$,_e[6]-ot*lt*$,_e[7]-ot*ct*$,_e[8]-lt*at*$,_e[9]-lt*ot*$,_e[10]-lt*lt*$,_e[11]-lt*ct*$,_e[12]-ct*at*$,_e[13]-ct*ot*$,_e[14]-ct*lt*$,_e[15]-ct*ct*$],d=c,j=h.M4,et=[.5,.5,.5,.5],nt=0,ut=0;if(tt!=0)for(var b=0;b<10&&(et=j.multVec(d,et),ut=Math.sqrt(j.dot(et,et)),et=j.sml(1/ut,et),!(Math.abs(ut-nt)<1e-9));b++)nt=ut;var it=[at*$,ot*$,lt*$,ct*$],rt=j.dot(j.sml(255,it),et),dt=it[3]<.001?0:1/it[3];return{Cov:c,q:it,e:et,L:nt,eMq255:rt,eMq:j.dot(et,it),rgba:(Math.round(255*it[3])<<24|Math.round(255*it[2]*dt)<<16|Math.round(255*it[1]*dt)<<8|Math.round(255*it[0]*dt)<<0)>>>0}},h.M4={multVec:function(g,_e){return[g[0]*_e[0]+g[1]*_e[1]+g[2]*_e[2]+g[3]*_e[3],g[4]*_e[0]+g[5]*_e[1]+g[6]*_e[2]+g[7]*_e[3],g[8]*_e[0]+g[9]*_e[1]+g[10]*_e[2]+g[11]*_e[3],g[12]*_e[0]+g[13]*_e[1]+g[14]*_e[2]+g[15]*_e[3]]},dot:function(g,_e){return g[0]*_e[0]+g[1]*_e[1]+g[2]*_e[2]+g[3]*_e[3]},sml:function(g,_e){return[g*_e[0],g*_e[1],g*_e[2],g*_e[3]]}},h.encode.alphaMul=function(g,_e){for(var st=new Uint8Array(g.length),tt=g.length>>2,at=0;at<tt;at++){var ot=at<<2,lt=g[ot+3];_e&&(lt=lt<128?0:255);var ct=lt*(1/255);st[ot+0]=g[ot+0]*ct,st[ot+1]=g[ot+1]*ct,st[ot+2]=g[ot+2]*ct,st[ot+3]=lt}return st}}(o,a)})()},"./node_modules/upng-js/node_modules/pako/index.js"(e,i,s){var o=s("./node_modules/upng-js/node_modules/pako/lib/utils/common.js").assign,a=s("./node_modules/upng-js/node_modules/pako/lib/deflate.js"),h=s("./node_modules/upng-js/node_modules/pako/lib/inflate.js"),_=s("./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js"),g={};o(g,a,h,_),e.exports=g},"./node_modules/upng-js/node_modules/pako/lib/deflate.js"(e,i,s){var o=s("./node_modules/upng-js/node_modules/pako/lib/zlib/deflate.js"),a=s("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),h=s("./node_modules/upng-js/node_modules/pako/lib/utils/strings.js"),_=s("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),g=s("./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js"),_e=Object.prototype.toString,st=0,tt=4,at=0,ot=1,lt=2,ct=-1,$=0,c=8;function d(ut){if(!(this instanceof d))return new d(ut);this.options=a.assign({level:ct,method:c,chunkSize:16384,windowBits:15,memLevel:8,strategy:$,to:""},ut||{});var b=this.options;b.raw&&b.windowBits>0?b.windowBits=-b.windowBits:b.gzip&&b.windowBits>0&&b.windowBits<16&&(b.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new g,this.strm.avail_out=0;var it=o.deflateInit2(this.strm,b.level,b.method,b.windowBits,b.memLevel,b.strategy);if(it!==at)throw new Error(_[it]);if(b.header&&o.deflateSetHeader(this.strm,b.header),b.dictionary){var rt;if(typeof b.dictionary=="string"?rt=h.string2buf(b.dictionary):_e.call(b.dictionary)==="[object ArrayBuffer]"?rt=new Uint8Array(b.dictionary):rt=b.dictionary,it=o.deflateSetDictionary(this.strm,rt),it!==at)throw new Error(_[it]);this._dict_set=!0}}d.prototype.push=function(ut,b){var it=this.strm,rt=this.options.chunkSize,dt,ft;if(this.ended)return!1;ft=b===~~b?b:b===!0?tt:st,typeof ut=="string"?it.input=h.string2buf(ut):_e.call(ut)==="[object ArrayBuffer]"?it.input=new Uint8Array(ut):it.input=ut,it.next_in=0,it.avail_in=it.input.length;do{if(it.avail_out===0&&(it.output=new a.Buf8(rt),it.next_out=0,it.avail_out=rt),dt=o.deflate(it,ft),dt!==ot&&dt!==at)return this.onEnd(dt),this.ended=!0,!1;(it.avail_out===0||it.avail_in===0&&(ft===tt||ft===lt))&&(this.options.to==="string"?this.onData(h.buf2binstring(a.shrinkBuf(it.output,it.next_out))):this.onData(a.shrinkBuf(it.output,it.next_out)))}while((it.avail_in>0||it.avail_out===0)&&dt!==ot);return ft===tt?(dt=o.deflateEnd(this.strm),this.onEnd(dt),this.ended=!0,dt===at):(ft===lt&&(this.onEnd(at),it.avail_out=0),!0)},d.prototype.onData=function(ut){this.chunks.push(ut)},d.prototype.onEnd=function(ut){ut===at&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=ut,this.msg=this.strm.msg};function j(ut,b){var it=new d(b);if(it.push(ut,!0),it.err)throw it.msg||_[it.err];return it.result}function et(ut,b){return b=b||{},b.raw=!0,j(ut,b)}function nt(ut,b){return b=b||{},b.gzip=!0,j(ut,b)}i.Deflate=d,i.deflate=j,i.deflateRaw=et,i.gzip=nt},"./node_modules/upng-js/node_modules/pako/lib/inflate.js"(e,i,s){var o=s("./node_modules/upng-js/node_modules/pako/lib/zlib/inflate.js"),a=s("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),h=s("./node_modules/upng-js/node_modules/pako/lib/utils/strings.js"),_=s("./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js"),g=s("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),_e=s("./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js"),st=s("./node_modules/upng-js/node_modules/pako/lib/zlib/gzheader.js"),tt=Object.prototype.toString;function at(ct){if(!(this instanceof at))return new at(ct);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},ct||{});var $=this.options;$.raw&&$.windowBits>=0&&$.windowBits<16&&($.windowBits=-$.windowBits,$.windowBits===0&&($.windowBits=-15)),$.windowBits>=0&&$.windowBits<16&&!(ct&&ct.windowBits)&&($.windowBits+=32),$.windowBits>15&&$.windowBits<48&&($.windowBits&15||($.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new _e,this.strm.avail_out=0;var c=o.inflateInit2(this.strm,$.windowBits);if(c!==_.Z_OK)throw new Error(g[c]);if(this.header=new st,o.inflateGetHeader(this.strm,this.header),$.dictionary&&(typeof $.dictionary=="string"?$.dictionary=h.string2buf($.dictionary):tt.call($.dictionary)==="[object ArrayBuffer]"&&($.dictionary=new Uint8Array($.dictionary)),$.raw&&(c=o.inflateSetDictionary(this.strm,$.dictionary),c!==_.Z_OK)))throw new Error(g[c])}at.prototype.push=function(ct,$){var c=this.strm,d=this.options.chunkSize,j=this.options.dictionary,et,nt,ut,b,it,rt=!1;if(this.ended)return!1;nt=$===~~$?$:$===!0?_.Z_FINISH:_.Z_NO_FLUSH,typeof ct=="string"?c.input=h.binstring2buf(ct):tt.call(ct)==="[object ArrayBuffer]"?c.input=new Uint8Array(ct):c.input=ct,c.next_in=0,c.avail_in=c.input.length;do{if(c.avail_out===0&&(c.output=new a.Buf8(d),c.next_out=0,c.avail_out=d),et=o.inflate(c,_.Z_NO_FLUSH),et===_.Z_NEED_DICT&&j&&(et=o.inflateSetDictionary(this.strm,j)),et===_.Z_BUF_ERROR&&rt===!0&&(et=_.Z_OK,rt=!1),et!==_.Z_STREAM_END&&et!==_.Z_OK)return this.onEnd(et),this.ended=!0,!1;c.next_out&&(c.avail_out===0||et===_.Z_STREAM_END||c.avail_in===0&&(nt===_.Z_FINISH||nt===_.Z_SYNC_FLUSH))&&(this.options.to==="string"?(ut=h.utf8border(c.output,c.next_out),b=c.next_out-ut,it=h.buf2string(c.output,ut),c.next_out=b,c.avail_out=d-b,b&&a.arraySet(c.output,c.output,ut,b,0),this.onData(it)):this.onData(a.shrinkBuf(c.output,c.next_out))),c.avail_in===0&&c.avail_out===0&&(rt=!0)}while((c.avail_in>0||c.avail_out===0)&&et!==_.Z_STREAM_END);return et===_.Z_STREAM_END&&(nt=_.Z_FINISH),nt===_.Z_FINISH?(et=o.inflateEnd(this.strm),this.onEnd(et),this.ended=!0,et===_.Z_OK):(nt===_.Z_SYNC_FLUSH&&(this.onEnd(_.Z_OK),c.avail_out=0),!0)},at.prototype.onData=function(ct){this.chunks.push(ct)},at.prototype.onEnd=function(ct){ct===_.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=ct,this.msg=this.strm.msg};function ot(ct,$){var c=new at($);if(c.push(ct,!0),c.err)throw c.msg||g[c.err];return c.result}function lt(ct,$){return $=$||{},$.raw=!0,ot(ct,$)}i.Inflate=at,i.inflate=ot,i.inflateRaw=lt,i.ungzip=ot},"./node_modules/upng-js/node_modules/pako/lib/utils/common.js"(e,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function o(_,g){return Object.prototype.hasOwnProperty.call(_,g)}i.assign=function(_){for(var g=Array.prototype.slice.call(arguments,1);g.length;){var _e=g.shift();if(_e){if(typeof _e!="object")throw new TypeError(_e+"must be non-object");for(var st in _e)o(_e,st)&&(_[st]=_e[st])}}return _},i.shrinkBuf=function(_,g){return _.length===g?_:_.subarray?_.subarray(0,g):(_.length=g,_)};var a={arraySet:function(_,g,_e,st,tt){if(g.subarray&&_.subarray){_.set(g.subarray(_e,_e+st),tt);return}for(var at=0;at<st;at++)_[tt+at]=g[_e+at]},flattenChunks:function(_){var g,_e,st,tt,at,ot;for(st=0,g=0,_e=_.length;g<_e;g++)st+=_[g].length;for(ot=new Uint8Array(st),tt=0,g=0,_e=_.length;g<_e;g++)at=_[g],ot.set(at,tt),tt+=at.length;return ot}},h={arraySet:function(_,g,_e,st,tt){for(var at=0;at<st;at++)_[tt+at]=g[_e+at]},flattenChunks:function(_){return[].concat.apply([],_)}};i.setTyped=function(_){_?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,a)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,h))},i.setTyped(s)},"./node_modules/upng-js/node_modules/pako/lib/utils/strings.js"(e,i,s){var o=s("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),a=!0,h=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{h=!1}for(var _=new o.Buf8(256),g=0;g<256;g++)_[g]=g>=252?6:g>=248?5:g>=240?4:g>=224?3:g>=192?2:1;_[254]=_[254]=1,i.string2buf=function(st){var tt,at,ot,lt,ct,$=st.length,c=0;for(lt=0;lt<$;lt++)at=st.charCodeAt(lt),(at&64512)===55296&&lt+1<$&&(ot=st.charCodeAt(lt+1),(ot&64512)===56320&&(at=65536+(at-55296<<10)+(ot-56320),lt++)),c+=at<128?1:at<2048?2:at<65536?3:4;for(tt=new o.Buf8(c),ct=0,lt=0;ct<c;lt++)at=st.charCodeAt(lt),(at&64512)===55296&&lt+1<$&&(ot=st.charCodeAt(lt+1),(ot&64512)===56320&&(at=65536+(at-55296<<10)+(ot-56320),lt++)),at<128?tt[ct++]=at:at<2048?(tt[ct++]=192|at>>>6,tt[ct++]=128|at&63):at<65536?(tt[ct++]=224|at>>>12,tt[ct++]=128|at>>>6&63,tt[ct++]=128|at&63):(tt[ct++]=240|at>>>18,tt[ct++]=128|at>>>12&63,tt[ct++]=128|at>>>6&63,tt[ct++]=128|at&63);return tt};function _e(st,tt){if(tt<65534&&(st.subarray&&h||!st.subarray&&a))return String.fromCharCode.apply(null,o.shrinkBuf(st,tt));for(var at="",ot=0;ot<tt;ot++)at+=String.fromCharCode(st[ot]);return at}i.buf2binstring=function(st){return _e(st,st.length)},i.binstring2buf=function(st){for(var tt=new o.Buf8(st.length),at=0,ot=tt.length;at<ot;at++)tt[at]=st.charCodeAt(at);return tt},i.buf2string=function(st,tt){var at,ot,lt,ct,$=tt||st.length,c=new Array($*2);for(ot=0,at=0;at<$;){if(lt=st[at++],lt<128){c[ot++]=lt;continue}if(ct=_[lt],ct>4){c[ot++]=65533,at+=ct-1;continue}for(lt&=ct===2?31:ct===3?15:7;ct>1&&at<$;)lt=lt<<6|st[at++]&63,ct--;if(ct>1){c[ot++]=65533;continue}lt<65536?c[ot++]=lt:(lt-=65536,c[ot++]=55296|lt>>10&1023,c[ot++]=56320|lt&1023)}return _e(c,ot)},i.utf8border=function(st,tt){var at;for(tt=tt||st.length,tt>st.length&&(tt=st.length),at=tt-1;at>=0&&(st[at]&192)===128;)at--;return at<0||at===0?tt:at+_[st[at]]>tt?at:tt}},"./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js"(e){function i(s,o,a,h){for(var _=s&65535|0,g=s>>>16&65535|0,_e=0;a!==0;){_e=a>2e3?2e3:a,a-=_e;do _=_+o[h++]|0,g=g+_|0;while(--_e);_%=65521,g%=65521}return _|g<<16|0}e.exports=i},"./node_modules/upng-js/node_modules/pako/lib/zlib/constants.js"(e){e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},"./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js"(e){function i(){for(var a,h=[],_=0;_<256;_++){a=_;for(var g=0;g<8;g++)a=a&1?3988292384^a>>>1:a>>>1;h[_]=a}return h}var s=i();function o(a,h,_,g){var _e=s,st=g+_;a^=-1;for(var tt=g;tt<st;tt++)a=a>>>8^_e[(a^h[tt])&255];return a^-1}e.exports=o},"./node_modules/upng-js/node_modules/pako/lib/zlib/deflate.js"(e,i,s){var o=s("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),a=s("./node_modules/upng-js/node_modules/pako/lib/zlib/trees.js"),h=s("./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js"),_=s("./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js"),g=s("./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"),_e=0,st=1,tt=3,at=4,ot=5,lt=0,ct=1,$=-2,c=-3,d=-5,j=-1,et=1,nt=2,ut=3,b=4,it=0,rt=2,dt=8,ft=9,mt=15,yt=8,gt=29,_t=256,xt=_t+1+gt,Mt=30,wt=19,Et=2*xt+1,At=15,St=3,bt=258,Ct=bt+St+1,Nt=32,kt=42,Ht=69,jt=73,Zt=91,Xt=103,Kt=113,ar=666,or=1,_r=2,nr=3,Vt=4,tr=3;function mr(vt,Qt){return vt.msg=g[Qt],Qt}function wr(vt){return(vt<<1)-(vt>4?9:0)}function Er(vt){for(var Qt=vt.length;--Qt>=0;)vt[Qt]=0}function Sr(vt){var Qt=vt.state,Yt=Qt.pending;Yt>vt.avail_out&&(Yt=vt.avail_out),Yt!==0&&(o.arraySet(vt.output,Qt.pending_buf,Qt.pending_out,Yt,vt.next_out),vt.next_out+=Yt,Qt.pending_out+=Yt,vt.total_out+=Yt,vt.avail_out-=Yt,Qt.pending-=Yt,Qt.pending===0&&(Qt.pending_out=0))}function br(vt,Qt){a._tr_flush_block(vt,vt.block_start>=0?vt.block_start:-1,vt.strstart-vt.block_start,Qt),vt.block_start=vt.strstart,Sr(vt.strm)}function gr(vt,Qt){vt.pending_buf[vt.pending++]=Qt}function xr(vt,Qt){vt.pending_buf[vt.pending++]=Qt>>>8&255,vt.pending_buf[vt.pending++]=Qt&255}function vr(vt,Qt,Yt,Rt){var Wt=vt.avail_in;return Wt>Rt&&(Wt=Rt),Wt===0?0:(vt.avail_in-=Wt,o.arraySet(Qt,vt.input,vt.next_in,Wt,Yt),vt.state.wrap===1?vt.adler=h(vt.adler,Qt,Wt,Yt):vt.state.wrap===2&&(vt.adler=_(vt.adler,Qt,Wt,Yt)),vt.next_in+=Wt,vt.total_in+=Wt,Wt)}function pr(vt,Qt){var Yt=vt.max_chain_length,Rt=vt.strstart,Wt,ir,Lr=vt.prev_length,Dr=vt.nice_match,Mr=vt.strstart>vt.w_size-Ct?vt.strstart-(vt.w_size-Ct):0,kr=vt.window,nn=vt.w_mask,Vr=vt.prev,Ir=vt.strstart+bt,zr=kr[Rt+Lr-1],Kr=kr[Rt+Lr];vt.prev_length>=vt.good_match&&(Yt>>=2),Dr>vt.lookahead&&(Dr=vt.lookahead);do if(Wt=Qt,!(kr[Wt+Lr]!==Kr||kr[Wt+Lr-1]!==zr||kr[Wt]!==kr[Rt]||kr[++Wt]!==kr[Rt+1])){Rt+=2,Wt++;do;while(kr[++Rt]===kr[++Wt]&&kr[++Rt]===kr[++Wt]&&kr[++Rt]===kr[++Wt]&&kr[++Rt]===kr[++Wt]&&kr[++Rt]===kr[++Wt]&&kr[++Rt]===kr[++Wt]&&kr[++Rt]===kr[++Wt]&&kr[++Rt]===kr[++Wt]&&Rt<Ir);if(ir=bt-(Ir-Rt),Rt=Ir-bt,ir>Lr){if(vt.match_start=Qt,Lr=ir,ir>=Dr)break;zr=kr[Rt+Lr-1],Kr=kr[Rt+Lr]}}while((Qt=Vr[Qt&nn])>Mr&&--Yt!==0);return Lr<=vt.lookahead?Lr:vt.lookahead}function Tr(vt){var Qt=vt.w_size,Yt,Rt,Wt,ir,Lr;do{if(ir=vt.window_size-vt.lookahead-vt.strstart,vt.strstart>=Qt+(Qt-Ct)){o.arraySet(vt.window,vt.window,Qt,Qt,0),vt.match_start-=Qt,vt.strstart-=Qt,vt.block_start-=Qt,Rt=vt.hash_size,Yt=Rt;do Wt=vt.head[--Yt],vt.head[Yt]=Wt>=Qt?Wt-Qt:0;while(--Rt);Rt=Qt,Yt=Rt;do Wt=vt.prev[--Yt],vt.prev[Yt]=Wt>=Qt?Wt-Qt:0;while(--Rt);ir+=Qt}if(vt.strm.avail_in===0)break;if(Rt=vr(vt.strm,vt.window,vt.strstart+vt.lookahead,ir),vt.lookahead+=Rt,vt.lookahead+vt.insert>=St)for(Lr=vt.strstart-vt.insert,vt.ins_h=vt.window[Lr],vt.ins_h=(vt.ins_h<<vt.hash_shift^vt.window[Lr+1])&vt.hash_mask;vt.insert&&(vt.ins_h=(vt.ins_h<<vt.hash_shift^vt.window[Lr+St-1])&vt.hash_mask,vt.prev[Lr&vt.w_mask]=vt.head[vt.ins_h],vt.head[vt.ins_h]=Lr,Lr++,vt.insert--,!(vt.lookahead+vt.insert<St)););}while(vt.lookahead<Ct&&vt.strm.avail_in!==0)}function Cr(vt,Qt){var Yt=65535;for(Yt>vt.pending_buf_size-5&&(Yt=vt.pending_buf_size-5);;){if(vt.lookahead<=1){if(Tr(vt),vt.lookahead===0&&Qt===_e)return or;if(vt.lookahead===0)break}vt.strstart+=vt.lookahead,vt.lookahead=0;var Rt=vt.block_start+Yt;if((vt.strstart===0||vt.strstart>=Rt)&&(vt.lookahead=vt.strstart-Rt,vt.strstart=Rt,br(vt,!1),vt.strm.avail_out===0)||vt.strstart-vt.block_start>=vt.w_size-Ct&&(br(vt,!1),vt.strm.avail_out===0))return or}return vt.insert=0,Qt===at?(br(vt,!0),vt.strm.avail_out===0?nr:Vt):(vt.strstart>vt.block_start&&(br(vt,!1),vt.strm.avail_out===0),or)}function Pt(vt,Qt){for(var Yt,Rt;;){if(vt.lookahead<Ct){if(Tr(vt),vt.lookahead<Ct&&Qt===_e)return or;if(vt.lookahead===0)break}if(Yt=0,vt.lookahead>=St&&(vt.ins_h=(vt.ins_h<<vt.hash_shift^vt.window[vt.strstart+St-1])&vt.hash_mask,Yt=vt.prev[vt.strstart&vt.w_mask]=vt.head[vt.ins_h],vt.head[vt.ins_h]=vt.strstart),Yt!==0&&vt.strstart-Yt<=vt.w_size-Ct&&(vt.match_length=pr(vt,Yt)),vt.match_length>=St)if(Rt=a._tr_tally(vt,vt.strstart-vt.match_start,vt.match_length-St),vt.lookahead-=vt.match_length,vt.match_length<=vt.max_lazy_match&&vt.lookahead>=St){vt.match_length--;do vt.strstart++,vt.ins_h=(vt.ins_h<<vt.hash_shift^vt.window[vt.strstart+St-1])&vt.hash_mask,Yt=vt.prev[vt.strstart&vt.w_mask]=vt.head[vt.ins_h],vt.head[vt.ins_h]=vt.strstart;while(--vt.match_length!==0);vt.strstart++}else vt.strstart+=vt.match_length,vt.match_length=0,vt.ins_h=vt.window[vt.strstart],vt.ins_h=(vt.ins_h<<vt.hash_shift^vt.window[vt.strstart+1])&vt.hash_mask;else Rt=a._tr_tally(vt,0,vt.window[vt.strstart]),vt.lookahead--,vt.strstart++;if(Rt&&(br(vt,!1),vt.strm.avail_out===0))return or}return vt.insert=vt.strstart<St-1?vt.strstart:St-1,Qt===at?(br(vt,!0),vt.strm.avail_out===0?nr:Vt):vt.last_lit&&(br(vt,!1),vt.strm.avail_out===0)?or:_r}function Ot(vt,Qt){for(var Yt,Rt,Wt;;){if(vt.lookahead<Ct){if(Tr(vt),vt.lookahead<Ct&&Qt===_e)return or;if(vt.lookahead===0)break}if(Yt=0,vt.lookahead>=St&&(vt.ins_h=(vt.ins_h<<vt.hash_shift^vt.window[vt.strstart+St-1])&vt.hash_mask,Yt=vt.prev[vt.strstart&vt.w_mask]=vt.head[vt.ins_h],vt.head[vt.ins_h]=vt.strstart),vt.prev_length=vt.match_length,vt.prev_match=vt.match_start,vt.match_length=St-1,Yt!==0&&vt.prev_length<vt.max_lazy_match&&vt.strstart-Yt<=vt.w_size-Ct&&(vt.match_length=pr(vt,Yt),vt.match_length<=5&&(vt.strategy===et||vt.match_length===St&&vt.strstart-vt.match_start>4096)&&(vt.match_length=St-1)),vt.prev_length>=St&&vt.match_length<=vt.prev_length){Wt=vt.strstart+vt.lookahead-St,Rt=a._tr_tally(vt,vt.strstart-1-vt.prev_match,vt.prev_length-St),vt.lookahead-=vt.prev_length-1,vt.prev_length-=2;do++vt.strstart<=Wt&&(vt.ins_h=(vt.ins_h<<vt.hash_shift^vt.window[vt.strstart+St-1])&vt.hash_mask,Yt=vt.prev[vt.strstart&vt.w_mask]=vt.head[vt.ins_h],vt.head[vt.ins_h]=vt.strstart);while(--vt.prev_length!==0);if(vt.match_available=0,vt.match_length=St-1,vt.strstart++,Rt&&(br(vt,!1),vt.strm.avail_out===0))return or}else if(vt.match_available){if(Rt=a._tr_tally(vt,0,vt.window[vt.strstart-1]),Rt&&br(vt,!1),vt.strstart++,vt.lookahead--,vt.strm.avail_out===0)return or}else vt.match_available=1,vt.strstart++,vt.lookahead--}return vt.match_available&&(Rt=a._tr_tally(vt,0,vt.window[vt.strstart-1]),vt.match_available=0),vt.insert=vt.strstart<St-1?vt.strstart:St-1,Qt===at?(br(vt,!0),vt.strm.avail_out===0?nr:Vt):vt.last_lit&&(br(vt,!1),vt.strm.avail_out===0)?or:_r}function zt(vt,Qt){for(var Yt,Rt,Wt,ir,Lr=vt.window;;){if(vt.lookahead<=bt){if(Tr(vt),vt.lookahead<=bt&&Qt===_e)return or;if(vt.lookahead===0)break}if(vt.match_length=0,vt.lookahead>=St&&vt.strstart>0&&(Wt=vt.strstart-1,Rt=Lr[Wt],Rt===Lr[++Wt]&&Rt===Lr[++Wt]&&Rt===Lr[++Wt])){ir=vt.strstart+bt;do;while(Rt===Lr[++Wt]&&Rt===Lr[++Wt]&&Rt===Lr[++Wt]&&Rt===Lr[++Wt]&&Rt===Lr[++Wt]&&Rt===Lr[++Wt]&&Rt===Lr[++Wt]&&Rt===Lr[++Wt]&&Wt<ir);vt.match_length=bt-(ir-Wt),vt.match_length>vt.lookahead&&(vt.match_length=vt.lookahead)}if(vt.match_length>=St?(Yt=a._tr_tally(vt,1,vt.match_length-St),vt.lookahead-=vt.match_length,vt.strstart+=vt.match_length,vt.match_length=0):(Yt=a._tr_tally(vt,0,vt.window[vt.strstart]),vt.lookahead--,vt.strstart++),Yt&&(br(vt,!1),vt.strm.avail_out===0))return or}return vt.insert=0,Qt===at?(br(vt,!0),vt.strm.avail_out===0?nr:Vt):vt.last_lit&&(br(vt,!1),vt.strm.avail_out===0)?or:_r}function rr(vt,Qt){for(var Yt;;){if(vt.lookahead===0&&(Tr(vt),vt.lookahead===0)){if(Qt===_e)return or;break}if(vt.match_length=0,Yt=a._tr_tally(vt,0,vt.window[vt.strstart]),vt.lookahead--,vt.strstart++,Yt&&(br(vt,!1),vt.strm.avail_out===0))return or}return vt.insert=0,Qt===at?(br(vt,!0),vt.strm.avail_out===0?nr:Vt):vt.last_lit&&(br(vt,!1),vt.strm.avail_out===0)?or:_r}function Jt(vt,Qt,Yt,Rt,Wt){this.good_length=vt,this.max_lazy=Qt,this.nice_length=Yt,this.max_chain=Rt,this.func=Wt}var cr;cr=[new Jt(0,0,0,0,Cr),new Jt(4,4,8,4,Pt),new Jt(4,5,16,8,Pt),new Jt(4,6,32,32,Pt),new Jt(4,4,16,16,Ot),new Jt(8,16,32,32,Ot),new Jt(8,16,128,128,Ot),new Jt(8,32,128,256,Ot),new Jt(32,128,258,1024,Ot),new Jt(32,258,258,4096,Ot)];function dr(vt){vt.window_size=2*vt.w_size,Er(vt.head),vt.max_lazy_match=cr[vt.level].max_lazy,vt.good_match=cr[vt.level].good_length,vt.nice_match=cr[vt.level].nice_length,vt.max_chain_length=cr[vt.level].max_chain,vt.strstart=0,vt.block_start=0,vt.lookahead=0,vt.insert=0,vt.match_length=vt.prev_length=St-1,vt.match_available=0,vt.ins_h=0}function Dt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=dt,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(Et*2),this.dyn_dtree=new o.Buf16((2*Mt+1)*2),this.bl_tree=new o.Buf16((2*wt+1)*2),Er(this.dyn_ltree),Er(this.dyn_dtree),Er(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(At+1),this.heap=new o.Buf16(2*xt+1),Er(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*xt+1),Er(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Gt(vt){var Qt;return!vt||!vt.state?mr(vt,$):(vt.total_in=vt.total_out=0,vt.data_type=rt,Qt=vt.state,Qt.pending=0,Qt.pending_out=0,Qt.wrap<0&&(Qt.wrap=-Qt.wrap),Qt.status=Qt.wrap?kt:Kt,vt.adler=Qt.wrap===2?0:1,Qt.last_flush=_e,a._tr_init(Qt),lt)}function er(vt){var Qt=Gt(vt);return Qt===lt&&dr(vt.state),Qt}function fr(vt,Qt){return!vt||!vt.state||vt.state.wrap!==2?$:(vt.state.gzhead=Qt,lt)}function Ut(vt,Qt,Yt,Rt,Wt,ir){if(!vt)return $;var Lr=1;if(Qt===j&&(Qt=6),Rt<0?(Lr=0,Rt=-Rt):Rt>15&&(Lr=2,Rt-=16),Wt<1||Wt>ft||Yt!==dt||Rt<8||Rt>15||Qt<0||Qt>9||ir<0||ir>b)return mr(vt,$);Rt===8&&(Rt=9);var Dr=new Dt;return vt.state=Dr,Dr.strm=vt,Dr.wrap=Lr,Dr.gzhead=null,Dr.w_bits=Rt,Dr.w_size=1<<Dr.w_bits,Dr.w_mask=Dr.w_size-1,Dr.hash_bits=Wt+7,Dr.hash_size=1<<Dr.hash_bits,Dr.hash_mask=Dr.hash_size-1,Dr.hash_shift=~~((Dr.hash_bits+St-1)/St),Dr.window=new o.Buf8(Dr.w_size*2),Dr.head=new o.Buf16(Dr.hash_size),Dr.prev=new o.Buf16(Dr.w_size),Dr.lit_bufsize=1<<Wt+6,Dr.pending_buf_size=Dr.lit_bufsize*4,Dr.pending_buf=new o.Buf8(Dr.pending_buf_size),Dr.d_buf=1*Dr.lit_bufsize,Dr.l_buf=3*Dr.lit_bufsize,Dr.level=Qt,Dr.strategy=ir,Dr.method=Yt,er(vt)}function sr(vt,Qt){return Ut(vt,Qt,dt,mt,yt,it)}function Lt(vt,Qt){var Yt,Rt,Wt,ir;if(!vt||!vt.state||Qt>ot||Qt<0)return vt?mr(vt,$):$;if(Rt=vt.state,!vt.output||!vt.input&&vt.avail_in!==0||Rt.status===ar&&Qt!==at)return mr(vt,vt.avail_out===0?d:$);if(Rt.strm=vt,Yt=Rt.last_flush,Rt.last_flush=Qt,Rt.status===kt)if(Rt.wrap===2)vt.adler=0,gr(Rt,31),gr(Rt,139),gr(Rt,8),Rt.gzhead?(gr(Rt,(Rt.gzhead.text?1:0)+(Rt.gzhead.hcrc?2:0)+(Rt.gzhead.extra?4:0)+(Rt.gzhead.name?8:0)+(Rt.gzhead.comment?16:0)),gr(Rt,Rt.gzhead.time&255),gr(Rt,Rt.gzhead.time>>8&255),gr(Rt,Rt.gzhead.time>>16&255),gr(Rt,Rt.gzhead.time>>24&255),gr(Rt,Rt.level===9?2:Rt.strategy>=nt||Rt.level<2?4:0),gr(Rt,Rt.gzhead.os&255),Rt.gzhead.extra&&Rt.gzhead.extra.length&&(gr(Rt,Rt.gzhead.extra.length&255),gr(Rt,Rt.gzhead.extra.length>>8&255)),Rt.gzhead.hcrc&&(vt.adler=_(vt.adler,Rt.pending_buf,Rt.pending,0)),Rt.gzindex=0,Rt.status=Ht):(gr(Rt,0),gr(Rt,0),gr(Rt,0),gr(Rt,0),gr(Rt,0),gr(Rt,Rt.level===9?2:Rt.strategy>=nt||Rt.level<2?4:0),gr(Rt,tr),Rt.status=Kt);else{var Lr=dt+(Rt.w_bits-8<<4)<<8,Dr=-1;Rt.strategy>=nt||Rt.level<2?Dr=0:Rt.level<6?Dr=1:Rt.level===6?Dr=2:Dr=3,Lr|=Dr<<6,Rt.strstart!==0&&(Lr|=Nt),Lr+=31-Lr%31,Rt.status=Kt,xr(Rt,Lr),Rt.strstart!==0&&(xr(Rt,vt.adler>>>16),xr(Rt,vt.adler&65535)),vt.adler=1}if(Rt.status===Ht)if(Rt.gzhead.extra){for(Wt=Rt.pending;Rt.gzindex<(Rt.gzhead.extra.length&65535)&&!(Rt.pending===Rt.pending_buf_size&&(Rt.gzhead.hcrc&&Rt.pending>Wt&&(vt.adler=_(vt.adler,Rt.pending_buf,Rt.pending-Wt,Wt)),Sr(vt),Wt=Rt.pending,Rt.pending===Rt.pending_buf_size));)gr(Rt,Rt.gzhead.extra[Rt.gzindex]&255),Rt.gzindex++;Rt.gzhead.hcrc&&Rt.pending>Wt&&(vt.adler=_(vt.adler,Rt.pending_buf,Rt.pending-Wt,Wt)),Rt.gzindex===Rt.gzhead.extra.length&&(Rt.gzindex=0,Rt.status=jt)}else Rt.status=jt;if(Rt.status===jt)if(Rt.gzhead.name){Wt=Rt.pending;do{if(Rt.pending===Rt.pending_buf_size&&(Rt.gzhead.hcrc&&Rt.pending>Wt&&(vt.adler=_(vt.adler,Rt.pending_buf,Rt.pending-Wt,Wt)),Sr(vt),Wt=Rt.pending,Rt.pending===Rt.pending_buf_size)){ir=1;break}Rt.gzindex<Rt.gzhead.name.length?ir=Rt.gzhead.name.charCodeAt(Rt.gzindex++)&255:ir=0,gr(Rt,ir)}while(ir!==0);Rt.gzhead.hcrc&&Rt.pending>Wt&&(vt.adler=_(vt.adler,Rt.pending_buf,Rt.pending-Wt,Wt)),ir===0&&(Rt.gzindex=0,Rt.status=Zt)}else Rt.status=Zt;if(Rt.status===Zt)if(Rt.gzhead.comment){Wt=Rt.pending;do{if(Rt.pending===Rt.pending_buf_size&&(Rt.gzhead.hcrc&&Rt.pending>Wt&&(vt.adler=_(vt.adler,Rt.pending_buf,Rt.pending-Wt,Wt)),Sr(vt),Wt=Rt.pending,Rt.pending===Rt.pending_buf_size)){ir=1;break}Rt.gzindex<Rt.gzhead.comment.length?ir=Rt.gzhead.comment.charCodeAt(Rt.gzindex++)&255:ir=0,gr(Rt,ir)}while(ir!==0);Rt.gzhead.hcrc&&Rt.pending>Wt&&(vt.adler=_(vt.adler,Rt.pending_buf,Rt.pending-Wt,Wt)),ir===0&&(Rt.status=Xt)}else Rt.status=Xt;if(Rt.status===Xt&&(Rt.gzhead.hcrc?(Rt.pending+2>Rt.pending_buf_size&&Sr(vt),Rt.pending+2<=Rt.pending_buf_size&&(gr(Rt,vt.adler&255),gr(Rt,vt.adler>>8&255),vt.adler=0,Rt.status=Kt)):Rt.status=Kt),Rt.pending!==0){if(Sr(vt),vt.avail_out===0)return Rt.last_flush=-1,lt}else if(vt.avail_in===0&&wr(Qt)<=wr(Yt)&&Qt!==at)return mr(vt,d);if(Rt.status===ar&&vt.avail_in!==0)return mr(vt,d);if(vt.avail_in!==0||Rt.lookahead!==0||Qt!==_e&&Rt.status!==ar){var Mr=Rt.strategy===nt?rr(Rt,Qt):Rt.strategy===ut?zt(Rt,Qt):cr[Rt.level].func(Rt,Qt);if((Mr===nr||Mr===Vt)&&(Rt.status=ar),Mr===or||Mr===nr)return vt.avail_out===0&&(Rt.last_flush=-1),lt;if(Mr===_r&&(Qt===st?a._tr_align(Rt):Qt!==ot&&(a._tr_stored_block(Rt,0,0,!1),Qt===tt&&(Er(Rt.head),Rt.lookahead===0&&(Rt.strstart=0,Rt.block_start=0,Rt.insert=0))),Sr(vt),vt.avail_out===0))return Rt.last_flush=-1,lt}return Qt!==at?lt:Rt.wrap<=0?ct:(Rt.wrap===2?(gr(Rt,vt.adler&255),gr(Rt,vt.adler>>8&255),gr(Rt,vt.adler>>16&255),gr(Rt,vt.adler>>24&255),gr(Rt,vt.total_in&255),gr(Rt,vt.total_in>>8&255),gr(Rt,vt.total_in>>16&255),gr(Rt,vt.total_in>>24&255)):(xr(Rt,vt.adler>>>16),xr(Rt,vt.adler&65535)),Sr(vt),Rt.wrap>0&&(Rt.wrap=-Rt.wrap),Rt.pending!==0?lt:ct)}function hr(vt){var Qt;return!vt||!vt.state?$:(Qt=vt.state.status,Qt!==kt&&Qt!==Ht&&Qt!==jt&&Qt!==Zt&&Qt!==Xt&&Qt!==Kt&&Qt!==ar?mr(vt,$):(vt.state=null,Qt===Kt?mr(vt,c):lt))}function yr(vt,Qt){var Yt=Qt.length,Rt,Wt,ir,Lr,Dr,Mr,kr,nn;if(!vt||!vt.state||(Rt=vt.state,Lr=Rt.wrap,Lr===2||Lr===1&&Rt.status!==kt||Rt.lookahead))return $;for(Lr===1&&(vt.adler=h(vt.adler,Qt,Yt,0)),Rt.wrap=0,Yt>=Rt.w_size&&(Lr===0&&(Er(Rt.head),Rt.strstart=0,Rt.block_start=0,Rt.insert=0),nn=new o.Buf8(Rt.w_size),o.arraySet(nn,Qt,Yt-Rt.w_size,Rt.w_size,0),Qt=nn,Yt=Rt.w_size),Dr=vt.avail_in,Mr=vt.next_in,kr=vt.input,vt.avail_in=Yt,vt.next_in=0,vt.input=Qt,Tr(Rt);Rt.lookahead>=St;){Wt=Rt.strstart,ir=Rt.lookahead-(St-1);do Rt.ins_h=(Rt.ins_h<<Rt.hash_shift^Rt.window[Wt+St-1])&Rt.hash_mask,Rt.prev[Wt&Rt.w_mask]=Rt.head[Rt.ins_h],Rt.head[Rt.ins_h]=Wt,Wt++;while(--ir);Rt.strstart=Wt,Rt.lookahead=St-1,Tr(Rt)}return Rt.strstart+=Rt.lookahead,Rt.block_start=Rt.strstart,Rt.insert=Rt.lookahead,Rt.lookahead=0,Rt.match_length=Rt.prev_length=St-1,Rt.match_available=0,vt.next_in=Mr,vt.input=kr,vt.avail_in=Dr,Rt.wrap=Lr,lt}i.deflateInit=sr,i.deflateInit2=Ut,i.deflateReset=er,i.deflateResetKeep=Gt,i.deflateSetHeader=fr,i.deflate=Lt,i.deflateEnd=hr,i.deflateSetDictionary=yr,i.deflateInfo="pako deflate (from Nodeca project)"},"./node_modules/upng-js/node_modules/pako/lib/zlib/gzheader.js"(e){function i(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}e.exports=i},"./node_modules/upng-js/node_modules/pako/lib/zlib/inffast.js"(e){var i=30,s=12;e.exports=function(a,h){var _,g,_e,st,tt,at,ot,lt,ct,$,c,d,j,et,nt,ut,b,it,rt,dt,ft,mt,yt,gt,_t;_=a.state,g=a.next_in,gt=a.input,_e=g+(a.avail_in-5),st=a.next_out,_t=a.output,tt=st-(h-a.avail_out),at=st+(a.avail_out-257),ot=_.dmax,lt=_.wsize,ct=_.whave,$=_.wnext,c=_.window,d=_.hold,j=_.bits,et=_.lencode,nt=_.distcode,ut=(1<<_.lenbits)-1,b=(1<<_.distbits)-1;e:do{j<15&&(d+=gt[g++]<<j,j+=8,d+=gt[g++]<<j,j+=8),it=et[d&ut];t:for(;;){if(rt=it>>>24,d>>>=rt,j-=rt,rt=it>>>16&255,rt===0)_t[st++]=it&65535;else if(rt&16){dt=it&65535,rt&=15,rt&&(j<rt&&(d+=gt[g++]<<j,j+=8),dt+=d&(1<<rt)-1,d>>>=rt,j-=rt),j<15&&(d+=gt[g++]<<j,j+=8,d+=gt[g++]<<j,j+=8),it=nt[d&b];r:for(;;){if(rt=it>>>24,d>>>=rt,j-=rt,rt=it>>>16&255,rt&16){if(ft=it&65535,rt&=15,j<rt&&(d+=gt[g++]<<j,j+=8,j<rt&&(d+=gt[g++]<<j,j+=8)),ft+=d&(1<<rt)-1,ft>ot){a.msg="invalid distance too far back",_.mode=i;break e}if(d>>>=rt,j-=rt,rt=st-tt,ft>rt){if(rt=ft-rt,rt>ct&&_.sane){a.msg="invalid distance too far back",_.mode=i;break e}if(mt=0,yt=c,$===0){if(mt+=lt-rt,rt<dt){dt-=rt;do _t[st++]=c[mt++];while(--rt);mt=st-ft,yt=_t}}else if($<rt){if(mt+=lt+$-rt,rt-=$,rt<dt){dt-=rt;do _t[st++]=c[mt++];while(--rt);if(mt=0,$<dt){rt=$,dt-=rt;do _t[st++]=c[mt++];while(--rt);mt=st-ft,yt=_t}}}else if(mt+=$-rt,rt<dt){dt-=rt;do _t[st++]=c[mt++];while(--rt);mt=st-ft,yt=_t}for(;dt>2;)_t[st++]=yt[mt++],_t[st++]=yt[mt++],_t[st++]=yt[mt++],dt-=3;dt&&(_t[st++]=yt[mt++],dt>1&&(_t[st++]=yt[mt++]))}else{mt=st-ft;do _t[st++]=_t[mt++],_t[st++]=_t[mt++],_t[st++]=_t[mt++],dt-=3;while(dt>2);dt&&(_t[st++]=_t[mt++],dt>1&&(_t[st++]=_t[mt++]))}}else if(rt&64){a.msg="invalid distance code",_.mode=i;break e}else{it=nt[(it&65535)+(d&(1<<rt)-1)];continue r}break}}else if(rt&64)if(rt&32){_.mode=s;break e}else{a.msg="invalid literal/length code",_.mode=i;break e}else{it=et[(it&65535)+(d&(1<<rt)-1)];continue t}break}}while(g<_e&&st<at);dt=j>>3,g-=dt,j-=dt<<3,d&=(1<<j)-1,a.next_in=g,a.next_out=st,a.avail_in=g<_e?5+(_e-g):5-(g-_e),a.avail_out=st<at?257+(at-st):257-(st-at),_.hold=d,_.bits=j}},"./node_modules/upng-js/node_modules/pako/lib/zlib/inflate.js"(e,i,s){var o=s("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),a=s("./node_modules/upng-js/node_modules/pako/lib/zlib/adler32.js"),h=s("./node_modules/upng-js/node_modules/pako/lib/zlib/crc32.js"),_=s("./node_modules/upng-js/node_modules/pako/lib/zlib/inffast.js"),g=s("./node_modules/upng-js/node_modules/pako/lib/zlib/inftrees.js"),_e=0,st=1,tt=2,at=4,ot=5,lt=6,ct=0,$=1,c=2,d=-2,j=-3,et=-4,nt=-5,ut=8,b=1,it=2,rt=3,dt=4,ft=5,mt=6,yt=7,gt=8,_t=9,xt=10,Mt=11,wt=12,Et=13,At=14,St=15,bt=16,Ct=17,Nt=18,kt=19,Ht=20,jt=21,Zt=22,Xt=23,Kt=24,ar=25,or=26,_r=27,nr=28,Vt=29,tr=30,mr=31,wr=32,Er=852,Sr=592,br=15,gr=br;function xr(Ut){return(Ut>>>24&255)+(Ut>>>8&65280)+((Ut&65280)<<8)+((Ut&255)<<24)}function vr(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function pr(Ut){var sr;return!Ut||!Ut.state?d:(sr=Ut.state,Ut.total_in=Ut.total_out=sr.total=0,Ut.msg="",sr.wrap&&(Ut.adler=sr.wrap&1),sr.mode=b,sr.last=0,sr.havedict=0,sr.dmax=32768,sr.head=null,sr.hold=0,sr.bits=0,sr.lencode=sr.lendyn=new o.Buf32(Er),sr.distcode=sr.distdyn=new o.Buf32(Sr),sr.sane=1,sr.back=-1,ct)}function Tr(Ut){var sr;return!Ut||!Ut.state?d:(sr=Ut.state,sr.wsize=0,sr.whave=0,sr.wnext=0,pr(Ut))}function Cr(Ut,sr){var Lt,hr;return!Ut||!Ut.state||(hr=Ut.state,sr<0?(Lt=0,sr=-sr):(Lt=(sr>>4)+1,sr<48&&(sr&=15)),sr&&(sr<8||sr>15))?d:(hr.window!==null&&hr.wbits!==sr&&(hr.window=null),hr.wrap=Lt,hr.wbits=sr,Tr(Ut))}function Pt(Ut,sr){var Lt,hr;return Ut?(hr=new vr,Ut.state=hr,hr.window=null,Lt=Cr(Ut,sr),Lt!==ct&&(Ut.state=null),Lt):d}function Ot(Ut){return Pt(Ut,gr)}var zt=!0,rr,Jt;function cr(Ut){if(zt){var sr;for(rr=new o.Buf32(512),Jt=new o.Buf32(32),sr=0;sr<144;)Ut.lens[sr++]=8;for(;sr<256;)Ut.lens[sr++]=9;for(;sr<280;)Ut.lens[sr++]=7;for(;sr<288;)Ut.lens[sr++]=8;for(g(st,Ut.lens,0,288,rr,0,Ut.work,{bits:9}),sr=0;sr<32;)Ut.lens[sr++]=5;g(tt,Ut.lens,0,32,Jt,0,Ut.work,{bits:5}),zt=!1}Ut.lencode=rr,Ut.lenbits=9,Ut.distcode=Jt,Ut.distbits=5}function dr(Ut,sr,Lt,hr){var yr,vt=Ut.state;return vt.window===null&&(vt.wsize=1<<vt.wbits,vt.wnext=0,vt.whave=0,vt.window=new o.Buf8(vt.wsize)),hr>=vt.wsize?(o.arraySet(vt.window,sr,Lt-vt.wsize,vt.wsize,0),vt.wnext=0,vt.whave=vt.wsize):(yr=vt.wsize-vt.wnext,yr>hr&&(yr=hr),o.arraySet(vt.window,sr,Lt-hr,yr,vt.wnext),hr-=yr,hr?(o.arraySet(vt.window,sr,Lt-hr,hr,0),vt.wnext=hr,vt.whave=vt.wsize):(vt.wnext+=yr,vt.wnext===vt.wsize&&(vt.wnext=0),vt.whave<vt.wsize&&(vt.whave+=yr))),0}function Dt(Ut,sr){var Lt,hr,yr,vt,Qt,Yt,Rt,Wt,ir,Lr,Dr,Mr,kr,nn,Vr=0,Ir,zr,Kr,Gr,cn,en,jr,Ur,Nr=new o.Buf8(4),tn,sn,un=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!Ut||!Ut.state||!Ut.output||!Ut.input&&Ut.avail_in!==0)return d;Lt=Ut.state,Lt.mode===wt&&(Lt.mode=Et),Qt=Ut.next_out,yr=Ut.output,Rt=Ut.avail_out,vt=Ut.next_in,hr=Ut.input,Yt=Ut.avail_in,Wt=Lt.hold,ir=Lt.bits,Lr=Yt,Dr=Rt,Ur=ct;e:for(;;)switch(Lt.mode){case b:if(Lt.wrap===0){Lt.mode=Et;break}for(;ir<16;){if(Yt===0)break e;Yt--,Wt+=hr[vt++]<<ir,ir+=8}if(Lt.wrap&2&&Wt===35615){Lt.check=0,Nr[0]=Wt&255,Nr[1]=Wt>>>8&255,Lt.check=h(Lt.check,Nr,2,0),Wt=0,ir=0,Lt.mode=it;break}if(Lt.flags=0,Lt.head&&(Lt.head.done=!1),!(Lt.wrap&1)||(((Wt&255)<<8)+(Wt>>8))%31){Ut.msg="incorrect header check",Lt.mode=tr;break}if((Wt&15)!==ut){Ut.msg="unknown compression method",Lt.mode=tr;break}if(Wt>>>=4,ir-=4,jr=(Wt&15)+8,Lt.wbits===0)Lt.wbits=jr;else if(jr>Lt.wbits){Ut.msg="invalid window size",Lt.mode=tr;break}Lt.dmax=1<<jr,Ut.adler=Lt.check=1,Lt.mode=Wt&512?xt:wt,Wt=0,ir=0;break;case it:for(;ir<16;){if(Yt===0)break e;Yt--,Wt+=hr[vt++]<<ir,ir+=8}if(Lt.flags=Wt,(Lt.flags&255)!==ut){Ut.msg="unknown compression method",Lt.mode=tr;break}if(Lt.flags&57344){Ut.msg="unknown header flags set",Lt.mode=tr;break}Lt.head&&(Lt.head.text=Wt>>8&1),Lt.flags&512&&(Nr[0]=Wt&255,Nr[1]=Wt>>>8&255,Lt.check=h(Lt.check,Nr,2,0)),Wt=0,ir=0,Lt.mode=rt;case rt:for(;ir<32;){if(Yt===0)break e;Yt--,Wt+=hr[vt++]<<ir,ir+=8}Lt.head&&(Lt.head.time=Wt),Lt.flags&512&&(Nr[0]=Wt&255,Nr[1]=Wt>>>8&255,Nr[2]=Wt>>>16&255,Nr[3]=Wt>>>24&255,Lt.check=h(Lt.check,Nr,4,0)),Wt=0,ir=0,Lt.mode=dt;case dt:for(;ir<16;){if(Yt===0)break e;Yt--,Wt+=hr[vt++]<<ir,ir+=8}Lt.head&&(Lt.head.xflags=Wt&255,Lt.head.os=Wt>>8),Lt.flags&512&&(Nr[0]=Wt&255,Nr[1]=Wt>>>8&255,Lt.check=h(Lt.check,Nr,2,0)),Wt=0,ir=0,Lt.mode=ft;case ft:if(Lt.flags&1024){for(;ir<16;){if(Yt===0)break e;Yt--,Wt+=hr[vt++]<<ir,ir+=8}Lt.length=Wt,Lt.head&&(Lt.head.extra_len=Wt),Lt.flags&512&&(Nr[0]=Wt&255,Nr[1]=Wt>>>8&255,Lt.check=h(Lt.check,Nr,2,0)),Wt=0,ir=0}else Lt.head&&(Lt.head.extra=null);Lt.mode=mt;case mt:if(Lt.flags&1024&&(Mr=Lt.length,Mr>Yt&&(Mr=Yt),Mr&&(Lt.head&&(jr=Lt.head.extra_len-Lt.length,Lt.head.extra||(Lt.head.extra=new Array(Lt.head.extra_len)),o.arraySet(Lt.head.extra,hr,vt,Mr,jr)),Lt.flags&512&&(Lt.check=h(Lt.check,hr,Mr,vt)),Yt-=Mr,vt+=Mr,Lt.length-=Mr),Lt.length))break e;Lt.length=0,Lt.mode=yt;case yt:if(Lt.flags&2048){if(Yt===0)break e;Mr=0;do jr=hr[vt+Mr++],Lt.head&&jr&&Lt.length<65536&&(Lt.head.name+=String.fromCharCode(jr));while(jr&&Mr<Yt);if(Lt.flags&512&&(Lt.check=h(Lt.check,hr,Mr,vt)),Yt-=Mr,vt+=Mr,jr)break e}else Lt.head&&(Lt.head.name=null);Lt.length=0,Lt.mode=gt;case gt:if(Lt.flags&4096){if(Yt===0)break e;Mr=0;do jr=hr[vt+Mr++],Lt.head&&jr&&Lt.length<65536&&(Lt.head.comment+=String.fromCharCode(jr));while(jr&&Mr<Yt);if(Lt.flags&512&&(Lt.check=h(Lt.check,hr,Mr,vt)),Yt-=Mr,vt+=Mr,jr)break e}else Lt.head&&(Lt.head.comment=null);Lt.mode=_t;case _t:if(Lt.flags&512){for(;ir<16;){if(Yt===0)break e;Yt--,Wt+=hr[vt++]<<ir,ir+=8}if(Wt!==(Lt.check&65535)){Ut.msg="header crc mismatch",Lt.mode=tr;break}Wt=0,ir=0}Lt.head&&(Lt.head.hcrc=Lt.flags>>9&1,Lt.head.done=!0),Ut.adler=Lt.check=0,Lt.mode=wt;break;case xt:for(;ir<32;){if(Yt===0)break e;Yt--,Wt+=hr[vt++]<<ir,ir+=8}Ut.adler=Lt.check=xr(Wt),Wt=0,ir=0,Lt.mode=Mt;case Mt:if(Lt.havedict===0)return Ut.next_out=Qt,Ut.avail_out=Rt,Ut.next_in=vt,Ut.avail_in=Yt,Lt.hold=Wt,Lt.bits=ir,c;Ut.adler=Lt.check=1,Lt.mode=wt;case wt:if(sr===ot||sr===lt)break e;case Et:if(Lt.last){Wt>>>=ir&7,ir-=ir&7,Lt.mode=_r;break}for(;ir<3;){if(Yt===0)break e;Yt--,Wt+=hr[vt++]<<ir,ir+=8}switch(Lt.last=Wt&1,Wt>>>=1,ir-=1,Wt&3){case 0:Lt.mode=At;break;case 1:if(cr(Lt),Lt.mode=Ht,sr===lt){Wt>>>=2,ir-=2;break e}break;case 2:Lt.mode=Ct;break;case 3:Ut.msg="invalid block type",Lt.mode=tr}Wt>>>=2,ir-=2;break;case At:for(Wt>>>=ir&7,ir-=ir&7;ir<32;){if(Yt===0)break e;Yt--,Wt+=hr[vt++]<<ir,ir+=8}if((Wt&65535)!==(Wt>>>16^65535)){Ut.msg="invalid stored block lengths",Lt.mode=tr;break}if(Lt.length=Wt&65535,Wt=0,ir=0,Lt.mode=St,sr===lt)break e;case St:Lt.mode=bt;case bt:if(Mr=Lt.length,Mr){if(Mr>Yt&&(Mr=Yt),Mr>Rt&&(Mr=Rt),Mr===0)break e;o.arraySet(yr,hr,vt,Mr,Qt),Yt-=Mr,vt+=Mr,Rt-=Mr,Qt+=Mr,Lt.length-=Mr;break}Lt.mode=wt;break;case Ct:for(;ir<14;){if(Yt===0)break e;Yt--,Wt+=hr[vt++]<<ir,ir+=8}if(Lt.nlen=(Wt&31)+257,Wt>>>=5,ir-=5,Lt.ndist=(Wt&31)+1,Wt>>>=5,ir-=5,Lt.ncode=(Wt&15)+4,Wt>>>=4,ir-=4,Lt.nlen>286||Lt.ndist>30){Ut.msg="too many length or distance symbols",Lt.mode=tr;break}Lt.have=0,Lt.mode=Nt;case Nt:for(;Lt.have<Lt.ncode;){for(;ir<3;){if(Yt===0)break e;Yt--,Wt+=hr[vt++]<<ir,ir+=8}Lt.lens[un[Lt.have++]]=Wt&7,Wt>>>=3,ir-=3}for(;Lt.have<19;)Lt.lens[un[Lt.have++]]=0;if(Lt.lencode=Lt.lendyn,Lt.lenbits=7,tn={bits:Lt.lenbits},Ur=g(_e,Lt.lens,0,19,Lt.lencode,0,Lt.work,tn),Lt.lenbits=tn.bits,Ur){Ut.msg="invalid code lengths set",Lt.mode=tr;break}Lt.have=0,Lt.mode=kt;case kt:for(;Lt.have<Lt.nlen+Lt.ndist;){for(;Vr=Lt.lencode[Wt&(1<<Lt.lenbits)-1],Ir=Vr>>>24,zr=Vr>>>16&255,Kr=Vr&65535,!(Ir<=ir);){if(Yt===0)break e;Yt--,Wt+=hr[vt++]<<ir,ir+=8}if(Kr<16)Wt>>>=Ir,ir-=Ir,Lt.lens[Lt.have++]=Kr;else{if(Kr===16){for(sn=Ir+2;ir<sn;){if(Yt===0)break e;Yt--,Wt+=hr[vt++]<<ir,ir+=8}if(Wt>>>=Ir,ir-=Ir,Lt.have===0){Ut.msg="invalid bit length repeat",Lt.mode=tr;break}jr=Lt.lens[Lt.have-1],Mr=3+(Wt&3),Wt>>>=2,ir-=2}else if(Kr===17){for(sn=Ir+3;ir<sn;){if(Yt===0)break e;Yt--,Wt+=hr[vt++]<<ir,ir+=8}Wt>>>=Ir,ir-=Ir,jr=0,Mr=3+(Wt&7),Wt>>>=3,ir-=3}else{for(sn=Ir+7;ir<sn;){if(Yt===0)break e;Yt--,Wt+=hr[vt++]<<ir,ir+=8}Wt>>>=Ir,ir-=Ir,jr=0,Mr=11+(Wt&127),Wt>>>=7,ir-=7}if(Lt.have+Mr>Lt.nlen+Lt.ndist){Ut.msg="invalid bit length repeat",Lt.mode=tr;break}for(;Mr--;)Lt.lens[Lt.have++]=jr}}if(Lt.mode===tr)break;if(Lt.lens[256]===0){Ut.msg="invalid code -- missing end-of-block",Lt.mode=tr;break}if(Lt.lenbits=9,tn={bits:Lt.lenbits},Ur=g(st,Lt.lens,0,Lt.nlen,Lt.lencode,0,Lt.work,tn),Lt.lenbits=tn.bits,Ur){Ut.msg="invalid literal/lengths set",Lt.mode=tr;break}if(Lt.distbits=6,Lt.distcode=Lt.distdyn,tn={bits:Lt.distbits},Ur=g(tt,Lt.lens,Lt.nlen,Lt.ndist,Lt.distcode,0,Lt.work,tn),Lt.distbits=tn.bits,Ur){Ut.msg="invalid distances set",Lt.mode=tr;break}if(Lt.mode=Ht,sr===lt)break e;case Ht:Lt.mode=jt;case jt:if(Yt>=6&&Rt>=258){Ut.next_out=Qt,Ut.avail_out=Rt,Ut.next_in=vt,Ut.avail_in=Yt,Lt.hold=Wt,Lt.bits=ir,_(Ut,Dr),Qt=Ut.next_out,yr=Ut.output,Rt=Ut.avail_out,vt=Ut.next_in,hr=Ut.input,Yt=Ut.avail_in,Wt=Lt.hold,ir=Lt.bits,Lt.mode===wt&&(Lt.back=-1);break}for(Lt.back=0;Vr=Lt.lencode[Wt&(1<<Lt.lenbits)-1],Ir=Vr>>>24,zr=Vr>>>16&255,Kr=Vr&65535,!(Ir<=ir);){if(Yt===0)break e;Yt--,Wt+=hr[vt++]<<ir,ir+=8}if(zr&&!(zr&240)){for(Gr=Ir,cn=zr,en=Kr;Vr=Lt.lencode[en+((Wt&(1<<Gr+cn)-1)>>Gr)],Ir=Vr>>>24,zr=Vr>>>16&255,Kr=Vr&65535,!(Gr+Ir<=ir);){if(Yt===0)break e;Yt--,Wt+=hr[vt++]<<ir,ir+=8}Wt>>>=Gr,ir-=Gr,Lt.back+=Gr}if(Wt>>>=Ir,ir-=Ir,Lt.back+=Ir,Lt.length=Kr,zr===0){Lt.mode=or;break}if(zr&32){Lt.back=-1,Lt.mode=wt;break}if(zr&64){Ut.msg="invalid literal/length code",Lt.mode=tr;break}Lt.extra=zr&15,Lt.mode=Zt;case Zt:if(Lt.extra){for(sn=Lt.extra;ir<sn;){if(Yt===0)break e;Yt--,Wt+=hr[vt++]<<ir,ir+=8}Lt.length+=Wt&(1<<Lt.extra)-1,Wt>>>=Lt.extra,ir-=Lt.extra,Lt.back+=Lt.extra}Lt.was=Lt.length,Lt.mode=Xt;case Xt:for(;Vr=Lt.distcode[Wt&(1<<Lt.distbits)-1],Ir=Vr>>>24,zr=Vr>>>16&255,Kr=Vr&65535,!(Ir<=ir);){if(Yt===0)break e;Yt--,Wt+=hr[vt++]<<ir,ir+=8}if(!(zr&240)){for(Gr=Ir,cn=zr,en=Kr;Vr=Lt.distcode[en+((Wt&(1<<Gr+cn)-1)>>Gr)],Ir=Vr>>>24,zr=Vr>>>16&255,Kr=Vr&65535,!(Gr+Ir<=ir);){if(Yt===0)break e;Yt--,Wt+=hr[vt++]<<ir,ir+=8}Wt>>>=Gr,ir-=Gr,Lt.back+=Gr}if(Wt>>>=Ir,ir-=Ir,Lt.back+=Ir,zr&64){Ut.msg="invalid distance code",Lt.mode=tr;break}Lt.offset=Kr,Lt.extra=zr&15,Lt.mode=Kt;case Kt:if(Lt.extra){for(sn=Lt.extra;ir<sn;){if(Yt===0)break e;Yt--,Wt+=hr[vt++]<<ir,ir+=8}Lt.offset+=Wt&(1<<Lt.extra)-1,Wt>>>=Lt.extra,ir-=Lt.extra,Lt.back+=Lt.extra}if(Lt.offset>Lt.dmax){Ut.msg="invalid distance too far back",Lt.mode=tr;break}Lt.mode=ar;case ar:if(Rt===0)break e;if(Mr=Dr-Rt,Lt.offset>Mr){if(Mr=Lt.offset-Mr,Mr>Lt.whave&&Lt.sane){Ut.msg="invalid distance too far back",Lt.mode=tr;break}Mr>Lt.wnext?(Mr-=Lt.wnext,kr=Lt.wsize-Mr):kr=Lt.wnext-Mr,Mr>Lt.length&&(Mr=Lt.length),nn=Lt.window}else nn=yr,kr=Qt-Lt.offset,Mr=Lt.length;Mr>Rt&&(Mr=Rt),Rt-=Mr,Lt.length-=Mr;do yr[Qt++]=nn[kr++];while(--Mr);Lt.length===0&&(Lt.mode=jt);break;case or:if(Rt===0)break e;yr[Qt++]=Lt.length,Rt--,Lt.mode=jt;break;case _r:if(Lt.wrap){for(;ir<32;){if(Yt===0)break e;Yt--,Wt|=hr[vt++]<<ir,ir+=8}if(Dr-=Rt,Ut.total_out+=Dr,Lt.total+=Dr,Dr&&(Ut.adler=Lt.check=Lt.flags?h(Lt.check,yr,Dr,Qt-Dr):a(Lt.check,yr,Dr,Qt-Dr)),Dr=Rt,(Lt.flags?Wt:xr(Wt))!==Lt.check){Ut.msg="incorrect data check",Lt.mode=tr;break}Wt=0,ir=0}Lt.mode=nr;case nr:if(Lt.wrap&&Lt.flags){for(;ir<32;){if(Yt===0)break e;Yt--,Wt+=hr[vt++]<<ir,ir+=8}if(Wt!==(Lt.total&4294967295)){Ut.msg="incorrect length check",Lt.mode=tr;break}Wt=0,ir=0}Lt.mode=Vt;case Vt:Ur=$;break e;case tr:Ur=j;break e;case mr:return et;case wr:default:return d}return Ut.next_out=Qt,Ut.avail_out=Rt,Ut.next_in=vt,Ut.avail_in=Yt,Lt.hold=Wt,Lt.bits=ir,(Lt.wsize||Dr!==Ut.avail_out&&Lt.mode<tr&&(Lt.mode<_r||sr!==at))&&dr(Ut,Ut.output,Ut.next_out,Dr-Ut.avail_out),Lr-=Ut.avail_in,Dr-=Ut.avail_out,Ut.total_in+=Lr,Ut.total_out+=Dr,Lt.total+=Dr,Lt.wrap&&Dr&&(Ut.adler=Lt.check=Lt.flags?h(Lt.check,yr,Dr,Ut.next_out-Dr):a(Lt.check,yr,Dr,Ut.next_out-Dr)),Ut.data_type=Lt.bits+(Lt.last?64:0)+(Lt.mode===wt?128:0)+(Lt.mode===Ht||Lt.mode===St?256:0),(Lr===0&&Dr===0||sr===at)&&Ur===ct&&(Ur=nt),Ur}function Gt(Ut){if(!Ut||!Ut.state)return d;var sr=Ut.state;return sr.window&&(sr.window=null),Ut.state=null,ct}function er(Ut,sr){var Lt;return!Ut||!Ut.state||(Lt=Ut.state,!(Lt.wrap&2))?d:(Lt.head=sr,sr.done=!1,ct)}function fr(Ut,sr){var Lt=sr.length,hr,yr,vt;return!Ut||!Ut.state||(hr=Ut.state,hr.wrap!==0&&hr.mode!==Mt)?d:hr.mode===Mt&&(yr=1,yr=a(yr,sr,Lt,0),yr!==hr.check)?j:(vt=dr(Ut,sr,Lt,Lt),vt?(hr.mode=mr,et):(hr.havedict=1,ct))}i.inflateReset=Tr,i.inflateReset2=Cr,i.inflateResetKeep=pr,i.inflateInit=Ot,i.inflateInit2=Pt,i.inflate=Dt,i.inflateEnd=Gt,i.inflateGetHeader=er,i.inflateSetDictionary=fr,i.inflateInfo="pako inflate (from Nodeca project)"},"./node_modules/upng-js/node_modules/pako/lib/zlib/inftrees.js"(e,i,s){var o=s("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),a=15,h=852,_=592,g=0,_e=1,st=2,tt=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],at=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],ot=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],lt=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function($,c,d,j,et,nt,ut,b){var it=b.bits,rt=0,dt=0,ft=0,mt=0,yt=0,gt=0,_t=0,xt=0,Mt=0,wt=0,Et,At,St,bt,Ct,Nt=null,kt=0,Ht,jt=new o.Buf16(a+1),Zt=new o.Buf16(a+1),Xt=null,Kt=0,ar,or,_r;for(rt=0;rt<=a;rt++)jt[rt]=0;for(dt=0;dt<j;dt++)jt[c[d+dt]]++;for(yt=it,mt=a;mt>=1&&jt[mt]===0;mt--);if(yt>mt&&(yt=mt),mt===0)return et[nt++]=20971520,et[nt++]=20971520,b.bits=1,0;for(ft=1;ft<mt&&jt[ft]===0;ft++);for(yt<ft&&(yt=ft),xt=1,rt=1;rt<=a;rt++)if(xt<<=1,xt-=jt[rt],xt<0)return-1;if(xt>0&&($===g||mt!==1))return-1;for(Zt[1]=0,rt=1;rt<a;rt++)Zt[rt+1]=Zt[rt]+jt[rt];for(dt=0;dt<j;dt++)c[d+dt]!==0&&(ut[Zt[c[d+dt]]++]=dt);if($===g?(Nt=Xt=ut,Ht=19):$===_e?(Nt=tt,kt-=257,Xt=at,Kt-=257,Ht=256):(Nt=ot,Xt=lt,Ht=-1),wt=0,dt=0,rt=ft,Ct=nt,gt=yt,_t=0,St=-1,Mt=1<<yt,bt=Mt-1,$===_e&&Mt>h||$===st&&Mt>_)return 1;for(;;){ar=rt-_t,ut[dt]<Ht?(or=0,_r=ut[dt]):ut[dt]>Ht?(or=Xt[Kt+ut[dt]],_r=Nt[kt+ut[dt]]):(or=96,_r=0),Et=1<<rt-_t,At=1<<gt,ft=At;do At-=Et,et[Ct+(wt>>_t)+At]=ar<<24|or<<16|_r|0;while(At!==0);for(Et=1<<rt-1;wt&Et;)Et>>=1;if(Et!==0?(wt&=Et-1,wt+=Et):wt=0,dt++,--jt[rt]===0){if(rt===mt)break;rt=c[d+ut[dt]]}if(rt>yt&&(wt&bt)!==St){for(_t===0&&(_t=yt),Ct+=ft,gt=rt-_t,xt=1<<gt;gt+_t<mt&&(xt-=jt[gt+_t],!(xt<=0));)gt++,xt<<=1;if(Mt+=1<<gt,$===_e&&Mt>h||$===st&&Mt>_)return 1;St=wt&bt,et[St]=yt<<24|gt<<16|Ct-nt|0}}return wt!==0&&(et[Ct+wt]=rt-_t<<24|4194304|0),b.bits=yt,0}},"./node_modules/upng-js/node_modules/pako/lib/zlib/messages.js"(e){e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},"./node_modules/upng-js/node_modules/pako/lib/zlib/trees.js"(e,i,s){var o=s("./node_modules/upng-js/node_modules/pako/lib/utils/common.js"),a=4,h=0,_=1,g=2;function _e(Dt){for(var Gt=Dt.length;--Gt>=0;)Dt[Gt]=0}var st=0,tt=1,at=2,ot=3,lt=258,ct=29,$=256,c=$+1+ct,d=30,j=19,et=2*c+1,nt=15,ut=16,b=7,it=256,rt=16,dt=17,ft=18,mt=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],yt=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],gt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],_t=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],xt=512,Mt=new Array((c+2)*2);_e(Mt);var wt=new Array(d*2);_e(wt);var Et=new Array(xt);_e(Et);var At=new Array(lt-ot+1);_e(At);var St=new Array(ct);_e(St);var bt=new Array(d);_e(bt);function Ct(Dt,Gt,er,fr,Ut){this.static_tree=Dt,this.extra_bits=Gt,this.extra_base=er,this.elems=fr,this.max_length=Ut,this.has_stree=Dt&&Dt.length}var Nt,kt,Ht;function jt(Dt,Gt){this.dyn_tree=Dt,this.max_code=0,this.stat_desc=Gt}function Zt(Dt){return Dt<256?Et[Dt]:Et[256+(Dt>>>7)]}function Xt(Dt,Gt){Dt.pending_buf[Dt.pending++]=Gt&255,Dt.pending_buf[Dt.pending++]=Gt>>>8&255}function Kt(Dt,Gt,er){Dt.bi_valid>ut-er?(Dt.bi_buf|=Gt<<Dt.bi_valid&65535,Xt(Dt,Dt.bi_buf),Dt.bi_buf=Gt>>ut-Dt.bi_valid,Dt.bi_valid+=er-ut):(Dt.bi_buf|=Gt<<Dt.bi_valid&65535,Dt.bi_valid+=er)}function ar(Dt,Gt,er){Kt(Dt,er[Gt*2],er[Gt*2+1])}function or(Dt,Gt){var er=0;do er|=Dt&1,Dt>>>=1,er<<=1;while(--Gt>0);return er>>>1}function _r(Dt){Dt.bi_valid===16?(Xt(Dt,Dt.bi_buf),Dt.bi_buf=0,Dt.bi_valid=0):Dt.bi_valid>=8&&(Dt.pending_buf[Dt.pending++]=Dt.bi_buf&255,Dt.bi_buf>>=8,Dt.bi_valid-=8)}function nr(Dt,Gt){var er=Gt.dyn_tree,fr=Gt.max_code,Ut=Gt.stat_desc.static_tree,sr=Gt.stat_desc.has_stree,Lt=Gt.stat_desc.extra_bits,hr=Gt.stat_desc.extra_base,yr=Gt.stat_desc.max_length,vt,Qt,Yt,Rt,Wt,ir,Lr=0;for(Rt=0;Rt<=nt;Rt++)Dt.bl_count[Rt]=0;for(er[Dt.heap[Dt.heap_max]*2+1]=0,vt=Dt.heap_max+1;vt<et;vt++)Qt=Dt.heap[vt],Rt=er[er[Qt*2+1]*2+1]+1,Rt>yr&&(Rt=yr,Lr++),er[Qt*2+1]=Rt,!(Qt>fr)&&(Dt.bl_count[Rt]++,Wt=0,Qt>=hr&&(Wt=Lt[Qt-hr]),ir=er[Qt*2],Dt.opt_len+=ir*(Rt+Wt),sr&&(Dt.static_len+=ir*(Ut[Qt*2+1]+Wt)));if(Lr!==0){do{for(Rt=yr-1;Dt.bl_count[Rt]===0;)Rt--;Dt.bl_count[Rt]--,Dt.bl_count[Rt+1]+=2,Dt.bl_count[yr]--,Lr-=2}while(Lr>0);for(Rt=yr;Rt!==0;Rt--)for(Qt=Dt.bl_count[Rt];Qt!==0;)Yt=Dt.heap[--vt],!(Yt>fr)&&(er[Yt*2+1]!==Rt&&(Dt.opt_len+=(Rt-er[Yt*2+1])*er[Yt*2],er[Yt*2+1]=Rt),Qt--)}}function Vt(Dt,Gt,er){var fr=new Array(nt+1),Ut=0,sr,Lt;for(sr=1;sr<=nt;sr++)fr[sr]=Ut=Ut+er[sr-1]<<1;for(Lt=0;Lt<=Gt;Lt++){var hr=Dt[Lt*2+1];hr!==0&&(Dt[Lt*2]=or(fr[hr]++,hr))}}function tr(){var Dt,Gt,er,fr,Ut,sr=new Array(nt+1);for(er=0,fr=0;fr<ct-1;fr++)for(St[fr]=er,Dt=0;Dt<1<<mt[fr];Dt++)At[er++]=fr;for(At[er-1]=fr,Ut=0,fr=0;fr<16;fr++)for(bt[fr]=Ut,Dt=0;Dt<1<<yt[fr];Dt++)Et[Ut++]=fr;for(Ut>>=7;fr<d;fr++)for(bt[fr]=Ut<<7,Dt=0;Dt<1<<yt[fr]-7;Dt++)Et[256+Ut++]=fr;for(Gt=0;Gt<=nt;Gt++)sr[Gt]=0;for(Dt=0;Dt<=143;)Mt[Dt*2+1]=8,Dt++,sr[8]++;for(;Dt<=255;)Mt[Dt*2+1]=9,Dt++,sr[9]++;for(;Dt<=279;)Mt[Dt*2+1]=7,Dt++,sr[7]++;for(;Dt<=287;)Mt[Dt*2+1]=8,Dt++,sr[8]++;for(Vt(Mt,c+1,sr),Dt=0;Dt<d;Dt++)wt[Dt*2+1]=5,wt[Dt*2]=or(Dt,5);Nt=new Ct(Mt,mt,$+1,c,nt),kt=new Ct(wt,yt,0,d,nt),Ht=new Ct(new Array(0),gt,0,j,b)}function mr(Dt){var Gt;for(Gt=0;Gt<c;Gt++)Dt.dyn_ltree[Gt*2]=0;for(Gt=0;Gt<d;Gt++)Dt.dyn_dtree[Gt*2]=0;for(Gt=0;Gt<j;Gt++)Dt.bl_tree[Gt*2]=0;Dt.dyn_ltree[it*2]=1,Dt.opt_len=Dt.static_len=0,Dt.last_lit=Dt.matches=0}function wr(Dt){Dt.bi_valid>8?Xt(Dt,Dt.bi_buf):Dt.bi_valid>0&&(Dt.pending_buf[Dt.pending++]=Dt.bi_buf),Dt.bi_buf=0,Dt.bi_valid=0}function Er(Dt,Gt,er,fr){wr(Dt),Xt(Dt,er),Xt(Dt,~er),o.arraySet(Dt.pending_buf,Dt.window,Gt,er,Dt.pending),Dt.pending+=er}function Sr(Dt,Gt,er,fr){var Ut=Gt*2,sr=er*2;return Dt[Ut]<Dt[sr]||Dt[Ut]===Dt[sr]&&fr[Gt]<=fr[er]}function br(Dt,Gt,er){for(var fr=Dt.heap[er],Ut=er<<1;Ut<=Dt.heap_len&&(Ut<Dt.heap_len&&Sr(Gt,Dt.heap[Ut+1],Dt.heap[Ut],Dt.depth)&&Ut++,!Sr(Gt,fr,Dt.heap[Ut],Dt.depth));)Dt.heap[er]=Dt.heap[Ut],er=Ut,Ut<<=1;Dt.heap[er]=fr}function gr(Dt,Gt,er){var fr,Ut,sr=0,Lt,hr;if(Dt.last_lit!==0)do fr=Dt.pending_buf[Dt.d_buf+sr*2]<<8|Dt.pending_buf[Dt.d_buf+sr*2+1],Ut=Dt.pending_buf[Dt.l_buf+sr],sr++,fr===0?ar(Dt,Ut,Gt):(Lt=At[Ut],ar(Dt,Lt+$+1,Gt),hr=mt[Lt],hr!==0&&(Ut-=St[Lt],Kt(Dt,Ut,hr)),fr--,Lt=Zt(fr),ar(Dt,Lt,er),hr=yt[Lt],hr!==0&&(fr-=bt[Lt],Kt(Dt,fr,hr)));while(sr<Dt.last_lit);ar(Dt,it,Gt)}function xr(Dt,Gt){var er=Gt.dyn_tree,fr=Gt.stat_desc.static_tree,Ut=Gt.stat_desc.has_stree,sr=Gt.stat_desc.elems,Lt,hr,yr=-1,vt;for(Dt.heap_len=0,Dt.heap_max=et,Lt=0;Lt<sr;Lt++)er[Lt*2]!==0?(Dt.heap[++Dt.heap_len]=yr=Lt,Dt.depth[Lt]=0):er[Lt*2+1]=0;for(;Dt.heap_len<2;)vt=Dt.heap[++Dt.heap_len]=yr<2?++yr:0,er[vt*2]=1,Dt.depth[vt]=0,Dt.opt_len--,Ut&&(Dt.static_len-=fr[vt*2+1]);for(Gt.max_code=yr,Lt=Dt.heap_len>>1;Lt>=1;Lt--)br(Dt,er,Lt);vt=sr;do Lt=Dt.heap[1],Dt.heap[1]=Dt.heap[Dt.heap_len--],br(Dt,er,1),hr=Dt.heap[1],Dt.heap[--Dt.heap_max]=Lt,Dt.heap[--Dt.heap_max]=hr,er[vt*2]=er[Lt*2]+er[hr*2],Dt.depth[vt]=(Dt.depth[Lt]>=Dt.depth[hr]?Dt.depth[Lt]:Dt.depth[hr])+1,er[Lt*2+1]=er[hr*2+1]=vt,Dt.heap[1]=vt++,br(Dt,er,1);while(Dt.heap_len>=2);Dt.heap[--Dt.heap_max]=Dt.heap[1],nr(Dt,Gt),Vt(er,yr,Dt.bl_count)}function vr(Dt,Gt,er){var fr,Ut=-1,sr,Lt=Gt[0*2+1],hr=0,yr=7,vt=4;for(Lt===0&&(yr=138,vt=3),Gt[(er+1)*2+1]=65535,fr=0;fr<=er;fr++)sr=Lt,Lt=Gt[(fr+1)*2+1],!(++hr<yr&&sr===Lt)&&(hr<vt?Dt.bl_tree[sr*2]+=hr:sr!==0?(sr!==Ut&&Dt.bl_tree[sr*2]++,Dt.bl_tree[rt*2]++):hr<=10?Dt.bl_tree[dt*2]++:Dt.bl_tree[ft*2]++,hr=0,Ut=sr,Lt===0?(yr=138,vt=3):sr===Lt?(yr=6,vt=3):(yr=7,vt=4))}function pr(Dt,Gt,er){var fr,Ut=-1,sr,Lt=Gt[0*2+1],hr=0,yr=7,vt=4;for(Lt===0&&(yr=138,vt=3),fr=0;fr<=er;fr++)if(sr=Lt,Lt=Gt[(fr+1)*2+1],!(++hr<yr&&sr===Lt)){if(hr<vt)do ar(Dt,sr,Dt.bl_tree);while(--hr!==0);else sr!==0?(sr!==Ut&&(ar(Dt,sr,Dt.bl_tree),hr--),ar(Dt,rt,Dt.bl_tree),Kt(Dt,hr-3,2)):hr<=10?(ar(Dt,dt,Dt.bl_tree),Kt(Dt,hr-3,3)):(ar(Dt,ft,Dt.bl_tree),Kt(Dt,hr-11,7));hr=0,Ut=sr,Lt===0?(yr=138,vt=3):sr===Lt?(yr=6,vt=3):(yr=7,vt=4)}}function Tr(Dt){var Gt;for(vr(Dt,Dt.dyn_ltree,Dt.l_desc.max_code),vr(Dt,Dt.dyn_dtree,Dt.d_desc.max_code),xr(Dt,Dt.bl_desc),Gt=j-1;Gt>=3&&Dt.bl_tree[_t[Gt]*2+1]===0;Gt--);return Dt.opt_len+=3*(Gt+1)+5+5+4,Gt}function Cr(Dt,Gt,er,fr){var Ut;for(Kt(Dt,Gt-257,5),Kt(Dt,er-1,5),Kt(Dt,fr-4,4),Ut=0;Ut<fr;Ut++)Kt(Dt,Dt.bl_tree[_t[Ut]*2+1],3);pr(Dt,Dt.dyn_ltree,Gt-1),pr(Dt,Dt.dyn_dtree,er-1)}function Pt(Dt){var Gt=4093624447,er;for(er=0;er<=31;er++,Gt>>>=1)if(Gt&1&&Dt.dyn_ltree[er*2]!==0)return h;if(Dt.dyn_ltree[18]!==0||Dt.dyn_ltree[20]!==0||Dt.dyn_ltree[26]!==0)return _;for(er=32;er<$;er++)if(Dt.dyn_ltree[er*2]!==0)return _;return h}var Ot=!1;function zt(Dt){Ot||(tr(),Ot=!0),Dt.l_desc=new jt(Dt.dyn_ltree,Nt),Dt.d_desc=new jt(Dt.dyn_dtree,kt),Dt.bl_desc=new jt(Dt.bl_tree,Ht),Dt.bi_buf=0,Dt.bi_valid=0,mr(Dt)}function rr(Dt,Gt,er,fr){Kt(Dt,(st<<1)+(fr?1:0),3),Er(Dt,Gt,er)}function Jt(Dt){Kt(Dt,tt<<1,3),ar(Dt,it,Mt),_r(Dt)}function cr(Dt,Gt,er,fr){var Ut,sr,Lt=0;Dt.level>0?(Dt.strm.data_type===g&&(Dt.strm.data_type=Pt(Dt)),xr(Dt,Dt.l_desc),xr(Dt,Dt.d_desc),Lt=Tr(Dt),Ut=Dt.opt_len+3+7>>>3,sr=Dt.static_len+3+7>>>3,sr<=Ut&&(Ut=sr)):Ut=sr=er+5,er+4<=Ut&&Gt!==-1?rr(Dt,Gt,er,fr):Dt.strategy===a||sr===Ut?(Kt(Dt,(tt<<1)+(fr?1:0),3),gr(Dt,Mt,wt)):(Kt(Dt,(at<<1)+(fr?1:0),3),Cr(Dt,Dt.l_desc.max_code+1,Dt.d_desc.max_code+1,Lt+1),gr(Dt,Dt.dyn_ltree,Dt.dyn_dtree)),mr(Dt),fr&&wr(Dt)}function dr(Dt,Gt,er){return Dt.pending_buf[Dt.d_buf+Dt.last_lit*2]=Gt>>>8&255,Dt.pending_buf[Dt.d_buf+Dt.last_lit*2+1]=Gt&255,Dt.pending_buf[Dt.l_buf+Dt.last_lit]=er&255,Dt.last_lit++,Gt===0?Dt.dyn_ltree[er*2]++:(Dt.matches++,Gt--,Dt.dyn_ltree[(At[er]+$+1)*2]++,Dt.dyn_dtree[Zt(Gt)*2]++),Dt.last_lit===Dt.lit_bufsize-1}i._tr_init=zt,i._tr_stored_block=rr,i._tr_flush_block=cr,i._tr_tally=dr,i._tr_align=Jt},"./node_modules/upng-js/node_modules/pako/lib/zlib/zstream.js"(e){function i(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}e.exports=i},"./src/3Dmol.ts"(e,i,s){s.r(i),s.d(i,{CAP:()=>_.CAP,CC:()=>a.CC,CONTEXTS_PER_VIEWPORT:()=>st.CONTEXTS_PER_VIEWPORT,Color:()=>a.Color,CustomLinear:()=>tt.CustomLinear,Cylinder:()=>et.Cylinder,GLDraw:()=>_.GLDraw,GLModel:()=>g.GLModel,GLShape:()=>_e.GLShape,GLViewer:()=>st.GLViewer,GLVolumetricRender:()=>d.GLVolumetricRender,Gradient:()=>tt.Gradient,GradientType:()=>tt.GradientType,Label:()=>at.Label,LabelCount:()=>at.LabelCount,MarchingCube:()=>ct.MarchingCube,MarchingCubeInitializer:()=>ct.MarchingCubeInitializer,Matrix3:()=>j.Matrix3,Matrix4:()=>j.Matrix4,Parsers:()=>ot.Parsers,PausableTimer:()=>$.PausableTimer,PointGrid:()=>ct.PointGrid,ProteinSurface:()=>ct.ProteinSurface,Quaternion:()=>j.Quaternion,ROYGB:()=>tt.ROYGB,RWB:()=>tt.RWB,Ray:()=>j.Ray,Sinebow:()=>tt.Sinebow,Sphere:()=>et.Sphere,SurfaceType:()=>ct.SurfaceType,Triangle:()=>et.Triangle,Vector2:()=>j.Vector2,Vector3:()=>j.Vector3,VolumeData:()=>c.VolumeData,adjustVolumeStyle:()=>$.adjustVolumeStyle,applyPartialCharges:()=>lt.applyPartialCharges,autoinit:()=>o.autoinit,autoload:()=>o.autoload,base64ToArray:()=>$.base64ToArray,bondLength:()=>ot.bondLength,builtinColorSchemes:()=>a.builtinColorSchemes,builtinGradients:()=>tt.builtinGradients,chains:()=>a.chains,clamp:()=>j.clamp,conversionMatrix3:()=>j.conversionMatrix3,createStereoViewer:()=>st.createStereoViewer,createViewer:()=>st.createViewer,createViewerGrid:()=>st.createViewerGrid,deepCopy:()=>$.deepCopy,degToRad:()=>j.degToRad,download:()=>$.download,drawCartoon:()=>h.drawCartoon,elementColors:()=>a.elementColors,extend:()=>$.extend,get:()=>$.get,getAtomProperty:()=>$.getAtomProperty,getColorFromStyle:()=>$.getColorFromStyle,getElement:()=>$.getElement,getExtent:()=>$.getExtent,getGradient:()=>tt.getGradient,getPropertyRange:()=>$.getPropertyRange,getbin:()=>$.getbin,htmlColors:()=>a.htmlColors,inflateString:()=>$.inflateString,isEmptyObject:()=>$.isEmptyObject,isNumeric:()=>$.isNumeric,makeFunction:()=>$.makeFunction,mergeGeos:()=>$.mergeGeos,normalizeValue:()=>tt.normalizeValue,partialCharges:()=>lt.partialCharges,processing_autoinit:()=>o.processing_autoinit,residues:()=>a.residues,setBondLength:()=>ot.setBondLength,setSyncSurface:()=>ct.setSyncSurface,specStringToObject:()=>$.specStringToObject,splitMesh:()=>_e.splitMesh,ssColors:()=>a.ssColors,subdivide_spline:()=>h.subdivide_spline,syncSurface:()=>ct.syncSurface,viewers:()=>o.viewers});var o=s("./src/autoload.ts"),a=s("./src/colors.ts"),h=s("./src/glcartoon.ts"),_=s("./src/GLDraw.ts"),g=s("./src/GLModel.ts"),_e=s("./src/GLShape.ts"),st=s("./src/GLViewer.ts"),tt=s("./src/Gradient.ts"),at=s("./src/Label.ts"),ot=s("./src/parsers/index.ts"),lt=s("./src/partialCharges.ts"),ct=s("./src/ProteinSurface4.ts");s("./src/specs.ts");var $=s("./src/utilities.ts"),c=s("./src/VolumeData.ts"),d=s("./src/VolumetricRender.ts"),j=s("./src/WebGL/math/index.ts"),et=s("./src/WebGL/shapes/index.ts")},"./src/GLDraw.ts"(e,i,s){s.r(i),s.d(i,{CAP:()=>a,GLDraw:()=>h});var o=s("./src/WebGL/math/index.ts"),a;(function(_){_[_.NONE=0]="NONE",_[_.FLAT=1]="FLAT",_[_.ROUND=2]="ROUND"})(a||(a={}));var h;(function(_){function g($,c,d){var j=Math.hypot($,c),et,nt,ut,b,it;j<1e-4?(nt=0,ut=1):(nt=-$/j,ut=c/j),c=-nt*$+ut*c,et=Math.hypot(c,d),et<1e-4?(b=0,it=1):(b=d/et,it=c/et);var rt=new Float32Array(9);return rt[0]=ut,rt[1]=nt,rt[2]=0,rt[3]=-nt*it,rt[4]=ut*it,rt[5]=b,rt[6]=nt*b,rt[7]=-ut*b,rt[8]=it,rt}class _e{constructor(){this.cache={};let c=[],d=4,j=Math.pow(2,d),et=2,nt=Math.pow(2,et),ut=j/nt,b;for(c[0]=new o.Vector3(-1,0,0),c[ut]=new o.Vector3(0,0,1),c[ut*2]=new o.Vector3(1,0,0),c[ut*3]=new o.Vector3(0,0,-1),et=3;et<=d;et++){for(nt=Math.pow(2,et-1),ut=j/nt,b=0;b<nt-1;b++)c[ut/2+b*ut]=c[b*ut].clone().add(c[(b+1)*ut]).normalize();b=nt-1,c[ut/2+b*ut]=c[b*ut].clone().add(c[0]).normalize()}this.basisVectors=c}getVerticesForRadius(c,d,j){if(typeof this.cache<"u"&&this.cache[c]!==void 0&&this.cache[c][d+j]!==void 0)return this.cache[c][d+j];for(var et=this.basisVectors.length,nt=[],ut=[],b,it=0;it<et;it++)nt.push(this.basisVectors[it].clone().multiplyScalar(c)),nt.push(this.basisVectors[it].clone().multiplyScalar(c)),b=this.basisVectors[it].clone().normalize(),ut.push(b),ut.push(b);var rt=[],dt=10,ft=et,mt=0,yt=Math.PI*2,gt=0,_t=Math.PI,xt,Mt,wt=!1,Et=!1;for(Mt=0;Mt<=dt;Mt++){wt=Mt===0||Mt===dt,Et=Mt===dt/2;var At=[],St=[];for(xt=0;xt<=ft;xt++){if(Et){var bt=xt<ft?2*xt:0;St.push(bt+1),At.push(bt);continue}var Ct=xt/ft,Nt=Mt/dt;if(!wt||xt===0)if(xt<ft){var kt=new o.Vector3;kt.x=-c*Math.cos(mt+Ct*yt)*Math.sin(gt+Nt*_t),d==1?kt.y=0:kt.y=c*Math.cos(gt+Nt*_t),kt.z=c*Math.sin(mt+Ct*yt)*Math.sin(gt+Nt*_t),Math.abs(kt.x)<1e-5&&(kt.x=0),Math.abs(kt.y)<1e-5&&(kt.y=0),Math.abs(kt.z)<1e-5&&(kt.z=0),d==a.FLAT?(b=new o.Vector3(0,Math.cos(gt+Nt*_t),0),b.normalize()):(b=new o.Vector3(kt.x,kt.y,kt.z),b.normalize()),nt.push(kt),ut.push(b),At.push(nt.length-1)}else At.push(nt.length-ft);else wt&&At.push(nt.length-1)}Et&&rt.push(St),rt.push(At)}var Ht={vertices:nt,normals:ut,verticesRows:rt,w:ft,h:dt};return c in this.cache||(this.cache[c]={}),this.cache[c][d+j]=Ht,Ht}}var st=new _e;function tt($,c,d,j,et,nt=0,ut=0){if(!c||!d)return;let b=function(ir){if(typeof ir=="string"){let Lr=ir;return Lr.toLowerCase()=="flat"?a.FLAT:Lr.toLowerCase()=="round"?a.ROUND:a.NONE}else return ir};nt=b(nt),ut=b(ut);var it=ut||nt;et=et||{r:0,g:0,b:0};var rt=g(d.x-c.x,d.y-c.y,d.z-c.z),dt=st.getVerticesForRadius(j,ut,"to"),ft=dt.w,mt=dt.h,yt=it?mt*ft+2:2*ft,gt=$.updateGeoGroup(yt),_t=dt.vertices,xt=dt.normals,Mt=dt.verticesRows,wt=Mt[mt/2],Et=Mt[mt/2+1],At=gt.vertices,St,bt,Ct,Nt,kt,Ht,jt=gt.vertexArray,Zt=gt.normalArray,Xt=gt.colorArray,Kt=gt.faceArray;for(Ct=0;Ct<ft;++Ct){var ar=2*Ct;Nt=rt[0]*_t[ar].x+rt[3]*_t[ar].y+rt[6]*_t[ar].z,kt=rt[1]*_t[ar].x+rt[4]*_t[ar].y+rt[7]*_t[ar].z,Ht=rt[5]*_t[ar].y+rt[8]*_t[ar].z,St=3*(At+ar),bt=gt.faceidx,jt[St]=Nt+c.x,jt[St+1]=kt+c.y,jt[St+2]=Ht+c.z,jt[St+3]=Nt+d.x,jt[St+4]=kt+d.y,jt[St+5]=Ht+d.z,Zt[St]=Nt,Zt[St+3]=Nt,Zt[St+1]=kt,Zt[St+4]=kt,Zt[St+2]=Ht,Zt[St+5]=Ht,Xt[St]=et.r,Xt[St+3]=et.r,Xt[St+1]=et.g,Xt[St+4]=et.g,Xt[St+2]=et.b,Xt[St+5]=et.b,Kt[bt]=Et[Ct]+At,Kt[bt+1]=Et[Ct+1]+At,Kt[bt+2]=wt[Ct]+At,Kt[bt+3]=wt[Ct]+At,Kt[bt+4]=Et[Ct+1]+At,Kt[bt+5]=wt[Ct+1]+At,gt.faceidx+=6}if(it){var or=ut?0:mt/2,_r=nt?mt+1:mt/2+1,nr,Vt,tr,mr,wr,Er,Sr,br,gr,xr,vr,pr,Tr,Cr,Pt,Ot,zt,rr,Jt,cr,dr,Dt,Gt,er,fr,Ut,sr,Lt,hr,yr,vt,Qt;for(kt=or;kt<_r;kt++)if(kt!==mt/2){var Yt=kt<=mt/2?d:c,Rt=st.getVerticesForRadius(j,ut,"to"),Wt=st.getVerticesForRadius(j,nt,"from");for(Yt===d?(_t=Rt.vertices,xt=Rt.normals,Mt=Rt.verticesRows):Yt==c&&(_t=Wt.vertices,xt=Wt.normals,Mt=Wt.verticesRows),Nt=0;Nt<ft;Nt++)bt=gt.faceidx,nr=Mt[kt][Nt+1],hr=(nr+At)*3,Vt=Mt[kt][Nt],yr=(Vt+At)*3,tr=Mt[kt+1][Nt],vt=(tr+At)*3,mr=Mt[kt+1][Nt+1],Qt=(mr+At)*3,wr=rt[0]*_t[nr].x+rt[3]*_t[nr].y+rt[6]*_t[nr].z,Er=rt[0]*_t[Vt].x+rt[3]*_t[Vt].y+rt[6]*_t[Vt].z,Sr=rt[0]*_t[tr].x+rt[3]*_t[tr].y+rt[6]*_t[tr].z,br=rt[0]*_t[mr].x+rt[3]*_t[mr].y+rt[6]*_t[mr].z,gr=rt[1]*_t[nr].x+rt[4]*_t[nr].y+rt[7]*_t[nr].z,xr=rt[1]*_t[Vt].x+rt[4]*_t[Vt].y+rt[7]*_t[Vt].z,vr=rt[1]*_t[tr].x+rt[4]*_t[tr].y+rt[7]*_t[tr].z,pr=rt[1]*_t[mr].x+rt[4]*_t[mr].y+rt[7]*_t[mr].z,Tr=rt[5]*_t[nr].y+rt[8]*_t[nr].z,Cr=rt[5]*_t[Vt].y+rt[8]*_t[Vt].z,Pt=rt[5]*_t[tr].y+rt[8]*_t[tr].z,Ot=rt[5]*_t[mr].y+rt[8]*_t[mr].z,jt[hr]=wr+Yt.x,jt[yr]=Er+Yt.x,jt[vt]=Sr+Yt.x,jt[Qt]=br+Yt.x,jt[hr+1]=gr+Yt.y,jt[yr+1]=xr+Yt.y,jt[vt+1]=vr+Yt.y,jt[Qt+1]=pr+Yt.y,jt[hr+2]=Tr+Yt.z,jt[yr+2]=Cr+Yt.z,jt[vt+2]=Pt+Yt.z,jt[Qt+2]=Ot+Yt.z,Xt[hr]=et.r,Xt[yr]=et.r,Xt[vt]=et.r,Xt[Qt]=et.r,Xt[hr+1]=et.g,Xt[yr+1]=et.g,Xt[vt+1]=et.g,Xt[Qt+1]=et.g,Xt[hr+2]=et.b,Xt[yr+2]=et.b,Xt[vt+2]=et.b,Xt[Qt+2]=et.b,zt=rt[0]*xt[nr].x+rt[3]*xt[nr].y+rt[6]*xt[nr].z,rr=rt[0]*xt[Vt].x+rt[3]*xt[Vt].y+rt[6]*xt[Vt].z,Jt=rt[0]*xt[tr].x+rt[3]*xt[tr].y+rt[6]*xt[tr].z,cr=rt[0]*xt[mr].x+rt[3]*xt[mr].y+rt[6]*xt[mr].z,dr=rt[1]*xt[nr].x+rt[4]*xt[nr].y+rt[7]*xt[nr].z,Dt=rt[1]*xt[Vt].x+rt[4]*xt[Vt].y+rt[7]*xt[Vt].z,Gt=rt[1]*xt[tr].x+rt[4]*xt[tr].y+rt[7]*xt[tr].z,er=rt[1]*xt[mr].x+rt[4]*xt[mr].y+rt[7]*xt[mr].z,fr=rt[5]*xt[nr].y+rt[8]*xt[nr].z,Ut=rt[5]*xt[Vt].y+rt[8]*xt[Vt].z,sr=rt[5]*xt[tr].y+rt[8]*xt[tr].z,Lt=rt[5]*xt[mr].y+rt[8]*xt[mr].z,kt===0?(Zt[hr]=zt,Zt[vt]=Jt,Zt[Qt]=cr,Zt[hr+1]=dr,Zt[vt+1]=Gt,Zt[Qt+1]=er,Zt[hr+2]=fr,Zt[vt+2]=sr,Zt[Qt+2]=Lt,Kt[bt]=nr+At,Kt[bt+1]=tr+At,Kt[bt+2]=mr+At,gt.faceidx+=3):kt===_r-1?(Zt[hr]=zt,Zt[yr]=rr,Zt[vt]=Jt,Zt[hr+1]=dr,Zt[yr+1]=Dt,Zt[vt+1]=Gt,Zt[hr+2]=fr,Zt[yr+2]=Ut,Zt[vt+2]=sr,Kt[bt]=nr+At,Kt[bt+1]=Vt+At,Kt[bt+2]=tr+At,gt.faceidx+=3):(Zt[hr]=zt,Zt[yr]=rr,Zt[Qt]=cr,Zt[hr+1]=dr,Zt[yr+1]=Dt,Zt[Qt+1]=er,Zt[hr+2]=fr,Zt[yr+2]=Ut,Zt[Qt+2]=Lt,Zt[yr]=rr,Zt[vt]=Jt,Zt[Qt]=cr,Zt[yr+1]=Dt,Zt[vt+1]=Gt,Zt[Qt+1]=er,Zt[yr+2]=Ut,Zt[vt+2]=sr,Zt[Qt+2]=Lt,Kt[bt]=nr+At,Kt[bt+1]=Vt+At,Kt[bt+2]=mr+At,Kt[bt+3]=Vt+At,Kt[bt+4]=tr+At,Kt[bt+5]=mr+At,gt.faceidx+=6)}}gt.vertices+=yt}_.drawCylinder=tt;function at($,c,d,j,et){if(!c||!d)return;et=et||{r:0,g:0,b:0};let nt=new o.Vector3(d.x-c.x,d.y-c.y,d.z-c.z);var ut=g(nt.x,nt.y,nt.z);nt=nt.normalize();var b=st.basisVectors.length,it=st.basisVectors,rt=b+2,dt=$.updateGeoGroup(rt),ft=dt.vertices,mt,yt,gt,_t,xt,Mt,wt=dt.vertexArray,Et=dt.normalArray,At=dt.colorArray,St=dt.faceArray;for(mt=ft*3,wt[mt]=c.x,wt[mt+1]=c.y,wt[mt+2]=c.z,Et[mt]=-nt.x,Et[mt+1]=-nt.y,Et[mt+2]=-nt.z,At[mt]=et.r,At[mt+1]=et.g,At[mt+2]=et.b,wt[mt+3]=d.x,wt[mt+4]=d.y,wt[mt+5]=d.z,Et[mt+3]=nt.x,Et[mt+4]=nt.y,Et[mt+5]=nt.z,At[mt+3]=et.r,At[mt+4]=et.g,At[mt+5]=et.b,mt+=6,gt=0;gt<b;++gt){var bt=it[gt].clone();bt.multiplyScalar(j),_t=ut[0]*bt.x+ut[3]*bt.y+ut[6]*bt.z,xt=ut[1]*bt.x+ut[4]*bt.y+ut[7]*bt.z,Mt=ut[5]*bt.y+ut[8]*bt.z,wt[mt]=_t+c.x,wt[mt+1]=xt+c.y,wt[mt+2]=Mt+c.z,Et[mt]=_t,Et[mt+1]=xt,Et[mt+2]=Mt,At[mt]=et.r,At[mt+1]=et.g,At[mt+2]=et.b,mt+=3}for(dt.vertices+=b+2,yt=dt.faceidx,gt=0;gt<b;gt++){var Ct=ft+2+gt,Nt=ft+2+(gt+1)%b;St[yt]=Ct,St[yt+1]=Nt,St[yt+2]=ft,yt+=3,St[yt]=Ct,St[yt+1]=Nt,St[yt+2]=ft+1,yt+=3}dt.faceidx+=6*b}_.drawCone=at;class ot{constructor(){this.cache=new Map}getVerticesForRadius(c,d){d=d||2,this.cache.has(d)||this.cache.set(d,new Map);let j=this.cache.get(d);if(j.has(c))return j.get(c);var et={vertices:[],verticesRows:[],normals:[]},nt=16*d,ut=10*d;c<1&&(nt=10*d,ut=8*d);var b=0,it=Math.PI*2,rt=0,dt=Math.PI,ft,mt;for(mt=0;mt<=ut;mt++){let gt=[];for(ft=0;ft<=nt;ft++){let _t=ft/nt,xt=mt/ut,Mt=-c*Math.cos(b+_t*it)*Math.sin(rt+xt*dt),wt=c*Math.cos(rt+xt*dt),Et=c*Math.sin(b+_t*it)*Math.sin(rt+xt*dt);var yt=new o.Vector3(Mt,wt,Et);yt.normalize(),et.vertices.push({x:Mt,y:wt,z:Et}),et.normals.push(yt),gt.push(et.vertices.length-1)}et.verticesRows.push(gt)}return j.set(c,et),et}}var lt=new ot;function ct($,c,d,j,et){var nt=lt.getVerticesForRadius(d,et),ut=nt.vertices,b=nt.normals,it=$.updateGeoGroup(ut.length),rt=it.vertices,dt=it.vertexArray,ft=it.colorArray,mt=it.faceArray,yt=it.lineArray,gt=it.normalArray;for(let Mt=0,wt=ut.length;Mt<wt;++Mt){let Et=3*(rt+Mt),At=ut[Mt];dt[Et]=At.x+c.x,dt[Et+1]=At.y+c.y,dt[Et+2]=At.z+c.z,ft[Et]=j.r,ft[Et+1]=j.g,ft[Et+2]=j.b}it.vertices+=ut.length;let _t=nt.verticesRows,xt=_t.length-1;for(let Mt=0;Mt<xt;Mt++){let wt=_t[Mt].length-1;for(let Et=0;Et<wt;Et++){let At=it.faceidx,St=it.lineidx,bt=_t[Mt][Et+1]+rt,Ct=bt*3,Nt=_t[Mt][Et]+rt,kt=Nt*3,Ht=_t[Mt+1][Et]+rt,jt=Ht*3,Zt=_t[Mt+1][Et+1]+rt,Xt=Zt*3,Kt=b[bt-rt],ar=b[Nt-rt],or=b[Ht-rt],_r=b[Zt-rt];Math.abs(ut[bt-rt].y)===d?(gt[Ct]=Kt.x,gt[jt]=or.x,gt[Xt]=_r.x,gt[Ct+1]=Kt.y,gt[jt+1]=or.y,gt[Xt+1]=_r.y,gt[Ct+2]=Kt.z,gt[jt+2]=or.z,gt[Xt+2]=_r.z,mt[At]=bt,mt[At+1]=Ht,mt[At+2]=Zt,yt[St]=bt,yt[St+1]=Ht,yt[St+2]=bt,yt[St+3]=Zt,yt[St+4]=Ht,yt[St+5]=Zt,it.faceidx+=3,it.lineidx+=6):Math.abs(ut[Ht-rt].y)===d?(gt[Ct]=Kt.x,gt[kt]=ar.x,gt[jt]=or.x,gt[Ct+1]=Kt.y,gt[kt+1]=ar.y,gt[jt+1]=or.y,gt[Ct+2]=Kt.z,gt[kt+2]=ar.z,gt[jt+2]=or.z,mt[At]=bt,mt[At+1]=Nt,mt[At+2]=Ht,yt[St]=bt,yt[St+1]=Nt,yt[St+2]=bt,yt[St+3]=Ht,yt[St+4]=Nt,yt[St+5]=Ht,it.faceidx+=3,it.lineidx+=6):(gt[Ct]=Kt.x,gt[kt]=ar.x,gt[Xt]=_r.x,gt[Ct+1]=Kt.y,gt[kt+1]=ar.y,gt[Xt+1]=_r.y,gt[Ct+2]=Kt.z,gt[kt+2]=ar.z,gt[Xt+2]=_r.z,gt[kt]=ar.x,gt[jt]=or.x,gt[Xt]=_r.x,gt[kt+1]=ar.y,gt[jt+1]=or.y,gt[Xt+1]=_r.y,gt[kt+2]=ar.z,gt[jt+2]=or.z,gt[Xt+2]=_r.z,mt[At]=bt,mt[At+1]=Nt,mt[At+2]=Zt,mt[At+3]=Nt,mt[At+4]=Ht,mt[At+5]=Zt,yt[St]=bt,yt[St+1]=Nt,yt[St+2]=bt,yt[St+3]=Zt,yt[St+4]=Nt,yt[St+5]=Ht,yt[St+6]=Ht,yt[St+7]=Zt,it.faceidx+=6,it.lineidx+=8)}}}_.drawSphere=ct})(h||(h={}))},"./src/GLModel.ts"(e,i,s){s.r(i),s.d(i,{GLModel:()=>ct});var o=s("./src/WebGL/index.ts"),a=s("./src/WebGL/shapes/index.ts"),h=s("./src/WebGL/math/index.ts"),_=s("./src/colors.ts"),g=s("./src/GLDraw.ts"),_e=s("./src/glcartoon.ts"),st=s("./src/utilities.ts"),tt=s("./src/Gradient.ts"),at=s("./src/parsers/index.ts"),ot=s("./node_modules/netcdfjs/lib-esm/index.js"),lt=s("./src/parsers/utils/assignBonds.ts");class ct{static sameObj(c,d){return c&&d?JSON.stringify(c)==JSON.stringify(d):c==d}constructor(c,d,j){this.atoms=[],this.frames=[],this.box=null,this.atomdfs=null,this.id=0,this.hidden=!1,this.molObj=null,this.renderedMolObj=null,this.lastColors=null,this.modelData={},this.modelDatas=null,this.idMatrix=new h.Matrix4,this.dontDuplicateAtoms=!0,this.defaultColor=_.elementColors.defaultColor,this.defaultStickRadius=.25,this.options=d||{},this.viewer=j,this.ElementColors=this.options.defaultcolors?this.options.defaultcolors:_.elementColors.defaultColors,this.defaultSphereRadius=this.options.defaultSphereRadius?this.options.defaultSphereRadius:1.5,this.defaultCartoonQuality=this.options.cartoonQuality?this.options.cartoonQuality:10,this.id=c}getRadiusFromStyle(c,d){var j=this.defaultSphereRadius;if(typeof d.radius<"u")j=d.radius;else if(ct.vdwRadii[c.elem])j=ct.vdwRadii[c.elem];else if(c.elem.length>1){let et=c.elem;et=et[0].toUpperCase()+et[1].toLowerCase(),ct.vdwRadii[et]&&(j=ct.vdwRadii[et])}return typeof d.scale<"u"&&(j*=d.scale),j}drawAtomCross(c,d){if(c.style.cross){var j=c.style.cross;if(!j.hidden){var et=j.linewidth||ct.defaultlineWidth;d[et]||(d[et]=new o.Geometry);var nt=d[et].updateGeoGroup(6),ut=this.getRadiusFromStyle(c,j),b=[[ut,0,0],[-ut,0,0],[0,ut,0],[0,-ut,0],[0,0,ut],[0,0,-ut]],it=c.clickable||c.hoverable;it&&c.intersectionShape===void 0&&(c.intersectionShape={sphere:[],cylinder:[],line:[]});for(var rt=(0,st.getColorFromStyle)(c,j),dt=nt.vertexArray,ft=nt.colorArray,mt=0;mt<6;mt++){var yt=nt.vertices*3;if(nt.vertices++,dt[yt]=c.x+b[mt][0],dt[yt+1]=c.y+b[mt][1],dt[yt+2]=c.z+b[mt][2],ft[yt]=rt.r,ft[yt+1]=rt.g,ft[yt+2]=rt.b,it){var gt=new h.Vector3(b[mt][0],b[mt][1],b[mt][2]);gt.multiplyScalar(.1),gt.set(gt.x+c.x,gt.y+c.y,gt.z+c.z),c.intersectionShape.line.push(gt)}}}}}getGoodCross(c,d,j,et){for(var nt=null,ut=-1,b=0,it=c.bonds.length;b<it;b++)if(c.bonds[b]!=d.index){let dt=c.bonds[b],ft=this.atoms[dt],yt=new h.Vector3(ft.x,ft.y,ft.z).clone();yt.sub(j);let gt=yt.clone();gt.cross(et);var rt=gt.lengthSq();if(rt>ut&&(ut=rt,nt=gt,ut>.1))return nt}return nt}getSideBondV(c,d,j){var et,nt,ut,b,it,rt=new h.Vector3(c.x,c.y,c.z),dt=new h.Vector3(d.x,d.y,d.z),ft=dt.clone(),mt=null;if(ft.sub(rt),c.bonds.length===1)if(d.bonds.length===1)mt=ft.clone(),Math.abs(mt.x)>1e-4?mt.y+=1:mt.x+=1;else{for(ut=null,et=0;et<d.bonds.length;et++)if(nt=d.bonds[et],nt!==c.index){ut=this.atoms[nt];break}ut?(b=new h.Vector3(ut.x,ut.y,ut.z),it=b.clone(),it.sub(rt),mt=it.clone(),mt.cross(ft)):(mt=ft.clone(),mt.x+=1)}else if(mt=this.getGoodCross(c,d,rt,ft),mt.lengthSq()<.01){var yt=this.getGoodCross(d,c,rt,ft);yt!=null&&(mt=yt)}return mt.lengthSq()<.01&&(mt=ft.clone(),Math.abs(mt.x)>1e-4?mt.y+=1:mt.x+=1),mt.cross(ft),mt.normalize(),mt}addLine(c,d,j,et,nt,ut){c[j]=et.x,c[j+1]=et.y,c[j+2]=et.z,d[j]=ut.r,d[j+1]=ut.g,d[j+2]=ut.b,c[j+3]=nt.x,c[j+4]=nt.y,c[j+5]=nt.z,d[j+3]=ut.r,d[j+4]=ut.g,d[j+5]=ut.b}drawBondLines(c,d,j){if(c.style.line){var et=c.style.line;if(!et.hidden){var nt,ut,b,it,rt=et.linewidth||ct.defaultlineWidth;j[rt]||(j[rt]=new o.Geometry);for(var dt=j[rt].updateGeoGroup(6*c.bonds.length),ft=dt.vertexArray,mt=dt.colorArray,yt=0;yt<c.bonds.length;yt++){var gt=c.bonds[yt],_t=d[gt];if(_t.style.line&&!(c.index>=_t.index)){var xt=new h.Vector3(c.x,c.y,c.z),Mt=new h.Vector3(_t.x,_t.y,_t.z),wt=xt.clone().add(Mt).multiplyScalar(.5),Et=!1,At=c.clickable||c.hoverable,St=_t.clickable||_t.hoverable;(At||St)&&(At&&(c.intersectionShape===void 0&&(c.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),c.intersectionShape.line.push(xt),c.intersectionShape.line.push(wt)),St&&(_t.intersectionShape===void 0&&(_t.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),_t.intersectionShape.line.push(wt),_t.intersectionShape.line.push(Mt)));var bt=(0,st.getColorFromStyle)(c,c.style.line),Ct=(0,st.getColorFromStyle)(_t,_t.style.line);if(c.bondStyles&&c.bondStyles[yt]){var Nt=c.bondStyles[yt];if(!Nt.iswire)continue;Nt.singleBond&&(Et=!0),typeof Nt.color1<"u"&&(bt=_.CC.color(Nt.color1)),typeof Nt.color2<"u"&&(Ct=_.CC.color(Nt.color2))}var kt=dt.vertices*3,Ht,jt;if(c.bondOrder[yt]>1&&c.bondOrder[yt]<4&&!Et){var Zt=this.getSideBondV(c,_t,yt),Xt=Mt.clone();Xt.sub(xt),c.bondOrder[yt]==2?(Zt.multiplyScalar(.1),nt=xt.clone(),nt.add(Zt),ut=xt.clone(),ut.sub(Zt),b=nt.clone(),b.add(Xt),it=ut.clone(),it.add(Xt),bt==Ct?(dt.vertices+=4,this.addLine(ft,mt,kt,nt,b,bt),this.addLine(ft,mt,kt+6,ut,it,bt)):(dt.vertices+=8,Xt.multiplyScalar(.5),Ht=nt.clone(),Ht.add(Xt),jt=ut.clone(),jt.add(Xt),this.addLine(ft,mt,kt,nt,Ht,bt),this.addLine(ft,mt,kt+6,Ht,b,Ct),this.addLine(ft,mt,kt+12,ut,jt,bt),this.addLine(ft,mt,kt+18,jt,it,Ct))):c.bondOrder[yt]==3&&(Zt.multiplyScalar(.1),nt=xt.clone(),nt.add(Zt),ut=xt.clone(),ut.sub(Zt),b=nt.clone(),b.add(Xt),it=ut.clone(),it.add(Xt),bt==Ct?(dt.vertices+=6,this.addLine(ft,mt,kt,xt,Mt,bt),this.addLine(ft,mt,kt+6,nt,b,bt),this.addLine(ft,mt,kt+12,ut,it,bt)):(dt.vertices+=12,Xt.multiplyScalar(.5),Ht=nt.clone(),Ht.add(Xt),jt=ut.clone(),jt.add(Xt),this.addLine(ft,mt,kt,xt,wt,bt),this.addLine(ft,mt,kt+6,wt,Mt,Ct),this.addLine(ft,mt,kt+12,nt,Ht,bt),this.addLine(ft,mt,kt+18,Ht,b,Ct),this.addLine(ft,mt,kt+24,ut,jt,bt),this.addLine(ft,mt,kt+30,jt,it,Ct)))}else bt==Ct?(dt.vertices+=2,this.addLine(ft,mt,kt,xt,Mt,bt)):(dt.vertices+=4,this.addLine(ft,mt,kt,xt,wt,bt),this.addLine(ft,mt,kt+6,wt,Mt,Ct))}}}}}drawAtomSphere(c,d){if(c.style.sphere){var j=c.style.sphere;if(!j.hidden){var et=(0,st.getColorFromStyle)(c,j),nt=this.getRadiusFromStyle(c,j);if((c.clickable===!0||c.hoverable)&&c.intersectionShape!==void 0){var ut=new h.Vector3(c.x,c.y,c.z);c.intersectionShape.sphere.push(new a.Sphere(ut,nt))}g.GLDraw.drawSphere(d,c,nt,et)}}}drawAtomClickSphere(c){if(c.style.clicksphere){var d=c.style.clicksphere;if(!d.hidden){var j=this.getRadiusFromStyle(c,d);if((c.clickable===!0||c.hoverable)&&c.intersectionShape!==void 0){var et=new h.Vector3(c.x,c.y,c.z);c.intersectionShape.sphere.push(new a.Sphere(et,j))}}}}drawAtomInstanced(c,d){if(c.style.sphere){var j=c.style.sphere;if(!j.hidden){var et=this.getRadiusFromStyle(c,j),nt=(0,st.getColorFromStyle)(c,j),ut=d.updateGeoGroup(1),b=ut.vertices,it=b*3,rt=ut.vertexArray,dt=ut.colorArray,ft=ut.radiusArray;if(rt[it]=c.x,rt[it+1]=c.y,rt[it+2]=c.z,dt[it]=nt.r,dt[it+1]=nt.g,dt[it+2]=nt.b,ft[b]=et,(c.clickable===!0||c.hoverable)&&c.intersectionShape!==void 0){var mt=new h.Vector3(c.x,c.y,c.z);c.intersectionShape.sphere.push(new a.Sphere(mt,et))}ut.vertices+=1}}}drawSphereImposter(c,d,j,et){var nt=c.updateGeoGroup(4),ut,b=nt.vertices,it=b*3,rt=nt.vertexArray,dt=nt.colorArray;for(ut=0;ut<4;ut++)rt[it+3*ut]=d.x,rt[it+3*ut+1]=d.y,rt[it+3*ut+2]=d.z;var ft=nt.normalArray;for(ut=0;ut<4;ut++)dt[it+3*ut]=et.r,dt[it+3*ut+1]=et.g,dt[it+3*ut+2]=et.b;ft[it+0]=-j,ft[it+1]=j,ft[it+2]=0,ft[it+3]=-j,ft[it+4]=-j,ft[it+5]=0,ft[it+6]=j,ft[it+7]=-j,ft[it+8]=0,ft[it+9]=j,ft[it+10]=j,ft[it+11]=0,nt.vertices+=4;var mt=nt.faceArray,yt=nt.faceidx;mt[yt+0]=b,mt[yt+1]=b+1,mt[yt+2]=b+2,mt[yt+3]=b+2,mt[yt+4]=b+3,mt[yt+5]=b,nt.faceidx+=6}drawAtomImposter(c,d){if(c.style.sphere){var j=c.style.sphere;if(!j.hidden){var et=this.getRadiusFromStyle(c,j),nt=(0,st.getColorFromStyle)(c,j);if((c.clickable===!0||c.hoverable)&&c.intersectionShape!==void 0){var ut=new h.Vector3(c.x,c.y,c.z);c.intersectionShape.sphere.push(new a.Sphere(ut,et))}this.drawSphereImposter(d,c,et,nt)}}}calculateDashes(c,d,j,et,nt,ut){var b=Math.sqrt(Math.pow(c.x-d.x,2)+Math.pow(c.y-d.y,2)+Math.pow(c.z-d.z,2));if(j=Math.max(j,0),nt=Math.max(nt,0)+2*j,et=Math.max(et,.001),et+nt>b){var it=ut&&ut.length>0?ut[0]:null;return[{from:new h.Vector3(c.x,c.y,c.z),to:new h.Vector3(d.x,d.y,d.z),color:it}]}var rt=Math.floor((b-et)/(et+nt))+1,dt=rt*et;nt=(b-dt)/rt;for(var ft,mt=new h.Vector3(c.x,c.y,c.z),yt=new h.Vector3((d.x-c.x)/(b/nt),(d.y-c.y)/(b/nt),(d.z-c.z)/(b/nt)),gt=new h.Vector3((d.x-c.x)/(b/et),(d.y-c.y)/(b/et),(d.z-c.z)/(b/et)),_t=[],xt=0;xt<rt;xt++){ft=new h.Vector3(mt.x+gt.x,mt.y+gt.y,mt.z+gt.z);var it=ut&&ut.length>1&&xt>=rt/2?ut[1]:ut?ut[0]:null;_t.push({from:mt,to:ft,color:it}),mt=new h.Vector3(ft.x+yt.x,ft.y+yt.y,ft.z+yt.z)}return _t}calculateTwoColorSegments(c,d,j){var et=[];if(j.length<=1)et.push({from:new h.Vector3(c.x,c.y,c.z),to:new h.Vector3(d.x,d.y,d.z),color:j[0]});else{var nt=new h.Vector3((c.x+d.x)/2,(c.y+d.y)/2,(c.z+d.z)/2);et.push({from:new h.Vector3(c.x,c.y,c.z),to:nt,color:j[0]}),et.push({from:nt,to:new h.Vector3(d.x,d.y,d.z),color:j[1]})}return et}chooseDashedPlusV(c,d,j,et,nt){for(var ut=new h.Vector3(0,0,0),b=0,it=!1,rt=0;rt<c.bonds.length;rt++)if(c.bonds[rt]!==d.index){var dt=this.atoms[c.bonds[rt]];if(dt&&dt.bonds&&dt.bonds.length>1){it=!0;break}}if(!it){for(var rt=0;rt<d.bonds.length;rt++)if(d.bonds[rt]!==c.index){var dt=this.atoms[d.bonds[rt]];if(dt&&dt.bonds&&dt.bonds.length>1){it=!0;break}}}var ft=(_t,xt)=>{for(var Mt=0;Mt<_t.bonds.length;Mt++)if(_t.bonds[Mt]!==xt){var wt=this.atoms[_t.bonds[Mt]];if(wt){var Et=!wt.bonds||wt.bonds.length<=1,At=it&&Et?.25:1;ut.x+=wt.x*At,ut.y+=wt.y*At,ut.z+=wt.z*At,b+=At}}};if(ft(c,d.index),ft(d,c.index),b<1e-8)return!1;ut.multiplyScalar(1/b);var mt=new h.Vector3().addVectors(j,et).multiplyScalar(.5),yt=mt.clone().add(nt),gt=mt.clone().sub(nt);return yt.distanceToSquared(ut)<gt.distanceToSquared(ut)}static drawStickImposter(c,d,j,et,nt,ut=0,b=0){for(var it=c.updateGeoGroup(4),rt=it.vertices,dt=rt*3,ft=it.vertexArray,mt=it.colorArray,yt=it.radiusArray,gt=it.normalArray,_t=nt.r,xt=nt.g,Mt=nt.b,wt=function(Ct){var Nt=-Ct;return Nt==0&&(Nt=-1e-4),Nt},Et=dt,At=0;At<4;At++)ft[Et]=d.x,gt[Et]=j.x,mt[Et]=_t,Et++,ft[Et]=d.y,gt[Et]=j.y,mt[Et]=xt,Et++,ft[Et]=d.z,gt[Et]=j.z,At<2?mt[Et]=Mt:mt[Et]=wt(Mt),Et++;it.vertices+=4,yt[rt]=-et,yt[rt+1]=et,yt[rt+2]=-et,yt[rt+3]=et;var St=it.faceArray,bt=it.faceidx;St[bt+0]=rt,St[bt+1]=rt+1,St[bt+2]=rt+2,St[bt+3]=rt+2,St[bt+4]=rt+3,St[bt+5]=rt,it.faceidx+=6}drawBondSticks(c,d,j){var et,nt,ut,b;if(c.style.stick){var it=c.style.stick;if(!it.hidden){var rt=it.radius||this.defaultStickRadius,dt=it.doubleBondScaling||.4,ft=it.tripleBondScaling||.25,mt=((et=it.dashedBondConfig)===null||et===void 0?void 0:et.dashLength)||.1,yt=((nt=it.dashedBondConfig)===null||nt===void 0?void 0:nt.gapLength)||.25,gt=rt,_t=it.singleBonds||!1,xt=it.dashedBonds||!1,Mt=0,wt=0,Et,At,St,bt,Ct,Nt,kt,Ht,jt,Zt,Xt,Kt=(0,st.getColorFromStyle)(c,it),ar,or,_r;!c.capDrawn&&c.bonds.length<4&&(Mt=2);var nr=!((ut=it.dashedBondConfig)===null||ut===void 0)&&ut.solidColor?_.CC.color(it.dashedBondConfig.solidColor):null,Vt=!((b=it.dashedBondConfig)===null||b===void 0)&&b.dashedColor?_.CC.color(it.dashedBondConfig.dashedColor):null,tr=this,mr=zr=>{var Kr=j.imposter?ct.drawStickImposter:g.GLDraw.drawCylinder;return!xt&&zr%1===0?(Gr,cn,en,jr,Ur,Nr,tn=0,sn=0)=>{if(!Nr||Ur===Nr)Kr(Gr,cn,en,jr,Ur,tn,sn);else for(var un=tr.calculateTwoColorSegments(cn,en,[Ur,Nr]),dn=0;dn<un.length;dn++){var fn=un[dn],_n=dn===0?tn:0,On=dn===un.length-1?sn:0;Kr(Gr,fn.from,fn.to,jr,fn.color,_n,On)}}:(Gr,cn,en,jr,Ur,Nr,tn=0,sn=0)=>{var un=Nr?[Ur,Nr]:[Ur],dn=tr.calculateDashes(cn,en,jr,mt,yt,un);dn.forEach(fn=>{Kr(Gr,fn.from,fn.to,jr,fn.color,tn,sn)})}};for(St=0;St<c.bonds.length;St++){var wr=c.bondOrder[St],Er=wr===4?1.5:wr,Sr=mr(Er),br=c.bonds[St],gr=d[br];if(ar=or=_r=null,c.index<gr.index){wt=0;var xr=gr.style;if(!xr.stick||xr.stick.hidden)continue;var vr=(0,st.getColorFromStyle)(gr,xr.stick);if(gt=rt,bt=_t,c.bondStyles&&c.bondStyles[St]){if(Ct=c.bondStyles[St],Ct.iswire)continue;Ct.radius&&(gt=Ct.radius),Ct.singleBond&&(bt=!0),typeof Ct.color1<"u"&&(Kt=_.CC.color(Ct.color1)),typeof Ct.color2<"u"&&(vr=_.CC.color(Ct.color2))}var pr=new h.Vector3(c.x,c.y,c.z),Tr=new h.Vector3(gr.x,gr.y,gr.z),Cr=nr||Kt,Pt=nr||vr,Ot=Vt||Kt,zt=Vt||vr;if(Er<=1||bt||Er>3){Er<1&&(gt*=Er),!gr.capDrawn&&gr.bonds.length<4&&(wt=2);const zr=xt||Er%1!==0;if(Sr(j,pr,Tr,gt,zr?Ot:Kt,zr?zt:vr,Mt,wt),Et=c.clickable||c.hoverable,At=gr.clickable||gr.hoverable,Et||At){if(ar||(ar=new h.Vector3().addVectors(pr,Tr).multiplyScalar(.5)),Et){var rr=new a.Cylinder(pr,ar,gt),Jt=new a.Sphere(pr,gt);c.intersectionShape.cylinder.push(rr),c.intersectionShape.sphere.push(Jt)}if(At){var cr=new a.Cylinder(Tr,ar,gt),dr=new a.Sphere(Tr,gt);gr.intersectionShape.cylinder.push(cr),gr.intersectionShape.sphere.push(dr)}}}else if(Er>1){var Dt=0,Gt=0;gt!=rt&&(Dt=2,Gt=2);var er=Tr.clone(),fr=null;er.sub(pr);var Ut,sr,Lt,hr,yr,vt;fr=this.getSideBondV(c,gr,St);var Qt=!1;if(Er%1!==0&&(Qt=this.chooseDashedPlusV(c,gr,pr,Tr,fr)),Er>1&&Er<=2){Ut=gt*dt,sr=Ut*(Er-1),fr.multiplyScalar(Ut*1.5),Lt=pr.clone(),Lt.add(fr),hr=pr.clone(),hr.sub(fr),yr=Lt.clone(),yr.add(er),vt=hr.clone(),vt.add(er);var Cr=nr||Kt,Pt=nr||vr,Ot=Vt||Kt,zt=Vt||vr,Yt=j.imposter?ct.drawStickImposter:g.GLDraw.drawCylinder,Rt=(en,jr,Ur,Nr,tn,sn,un)=>{if(Nr!=tn){var dn=new h.Vector3().addVectors(en,jr).multiplyScalar(.5);Yt(j,en,dn,Ur,Nr,sn,0),Yt(j,dn,jr,Ur,tn,0,un)}else Yt(j,en,jr,Ur,Nr,sn,un)},Wt=(en,jr,Ur,Nr,tn,sn,un)=>{var dn=Nr!=tn?[Nr,tn]:[Nr],fn=tr.calculateDashes(en,jr,Ur,mt,yt,dn);fn.forEach(_n=>{Yt(j,_n.from,_n.to,Ur,_n.color||Nr,sn,un)})};if(Er==2?(Rt(Lt,yr,Ut,Cr,Pt,Dt,Gt),Rt(hr,vt,Ut,Cr,Pt,Dt,Gt)):Qt?(Wt(Lt,yr,sr,Ot,zt,Dt,Gt),Rt(hr,vt,Ut,Cr,Pt,Dt,Gt)):(Rt(Lt,yr,Ut,Cr,Pt,Dt,Gt),Wt(hr,vt,sr,Ot,zt,Dt,Gt)),Et=c.clickable||c.hoverable,At=gr.clickable||gr.hoverable,Et||At){ar||(ar=new h.Vector3().addVectors(Lt,yr).multiplyScalar(.5)),or||(or=new h.Vector3().addVectors(hr,vt).multiplyScalar(.5));var ir=Er==2?Ut:Qt?sr:Ut,Lr=Er==2||Qt?Ut:sr;Et&&(Nt=new a.Cylinder(Lt,ar,ir),kt=new a.Cylinder(hr,or,Lr),c.intersectionShape.cylinder.push(Nt),c.intersectionShape.cylinder.push(kt)),At&&(jt=new a.Cylinder(yr,ar,ir),Zt=new a.Cylinder(vt,or,Lr),gr.intersectionShape.cylinder.push(jt),gr.intersectionShape.cylinder.push(Zt))}}else if(Er>2&&Er<=3){Ut=gt*ft;var Dr=Ut*(Er-2);fr.cross(er),fr.normalize(),fr.multiplyScalar(Ut*3),Lt=pr.clone(),Lt.add(fr),hr=pr.clone(),hr.sub(fr),yr=Lt.clone(),yr.add(er),vt=hr.clone(),vt.add(er);var Yt=j.imposter?ct.drawStickImposter:g.GLDraw.drawCylinder,Mr=(Kr,Gr,cn,en,jr,Ur,Nr)=>{if(en!=jr){var tn=new h.Vector3().addVectors(Kr,Gr).multiplyScalar(.5);Yt(j,Kr,tn,cn,en,Ur,0),Yt(j,tn,Gr,cn,jr,0,Nr)}else Yt(j,Kr,Gr,cn,en,Ur,Nr)},kr=(Kr,Gr,cn,en,jr,Ur,Nr)=>{var tn=en!=jr?[en,jr]:[en],sn=tr.calculateDashes(Kr,Gr,cn,mt,yt,tn);sn.forEach(un=>{Yt(j,un.from,un.to,cn,un.color||en,Ur,Nr)})};if(Er==3?(Mr(Lt,yr,Ut,Cr,Pt,Dt,Gt),Mr(pr,Tr,Ut,Cr,Pt,Mt,wt),Mr(hr,vt,Ut,Cr,Pt,Dt,Gt)):Qt?(kr(Lt,yr,Dr,Ot,zt,Dt,Gt),Mr(pr,Tr,Ut,Cr,Pt,Mt,wt),Mr(hr,vt,Ut,Cr,Pt,Dt,Gt)):(Mr(Lt,yr,Ut,Cr,Pt,Dt,Gt),Mr(pr,Tr,Ut,Cr,Pt,Mt,wt),kr(hr,vt,Dr,Ot,zt,Dt,Gt)),Et=c.clickable||c.hoverable,At=gr.clickable||gr.hoverable,Et||At){ar||(ar=new h.Vector3().addVectors(Lt,yr).multiplyScalar(.5)),or||(or=new h.Vector3().addVectors(hr,vt).multiplyScalar(.5)),_r||(_r=new h.Vector3().addVectors(pr,Tr).multiplyScalar(.5));var ir=Er==3?Ut:Qt?Dr:Ut,Lr=Er==3||Qt?Ut:Dr;Et&&(Nt=new a.Cylinder(Lt.clone(),ar.clone(),ir),kt=new a.Cylinder(hr.clone(),or.clone(),Lr),Ht=new a.Cylinder(pr.clone(),_r.clone(),Ut),c.intersectionShape.cylinder.push(Nt),c.intersectionShape.cylinder.push(kt),c.intersectionShape.cylinder.push(Ht)),At&&(jt=new a.Cylinder(yr.clone(),ar.clone(),ir),Zt=new a.Cylinder(vt.clone(),or.clone(),Lr),Xt=new a.Cylinder(Tr.clone(),_r.clone(),Ut),gr.intersectionShape.cylinder.push(jt),gr.intersectionShape.cylinder.push(Zt),gr.intersectionShape.cylinder.push(Xt))}}}}}var nn=!1,Vr=0,Ir=!1;for(St=0;St<c.bonds.length;St++)bt=_t,c.bondStyles&&c.bondStyles[St]&&(Ct=c.bondStyles[St],Ct.singleBond&&(bt=!0),Ct.radius&&Ct.radius!=rt&&(Ir=!0)),(bt||c.bondOrder[St]==1)&&Vr++;Ir?Vr>0&&(nn=!0):Vr==0&&(c.bonds.length>0||it.showNonBonded)&&(nn=!0),nn&&(gt=rt,j.imposter?this.drawSphereImposter(j.sphereGeometry,c,gt,Kt):g.GLDraw.drawSphere(j,c,gt,Kt))}}}createMolObj(c,d){d=d||{};var j=new o.Object3D,et=[],nt={},ut={},b=this.drawAtomSphere,it=null,rt=null;d.supportsImposters?(b=this.drawAtomImposter,it=new o.Geometry(!0),it.imposter=!0,rt=new o.Geometry(!0,!0),rt.imposter=!0,rt.sphereGeometry=new o.Geometry(!0),rt.sphereGeometry.imposter=!0,rt.drawnCaps={}):d.supportsAIA?(b=this.drawAtomInstanced,it=new o.Geometry(!1,!0,!0),it.instanced=!0,rt=new o.Geometry(!0)):(it=new o.Geometry(!0),rt=new o.Geometry(!0));var dt,ft,mt,yt,gt={},_t=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(dt=0,mt=c.length;dt<mt;dt++){var xt=c[dt];if(xt&&xt.style){(xt.clickable||xt.hoverable)&&xt.intersectionShape===void 0&&(xt.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),yt={line:void 0,cross:void 0,stick:void 0,sphere:void 0};for(ft in yt)xt.style[ft]?xt.style[ft].opacity?yt[ft]=parseFloat(xt.style[ft].opacity):yt[ft]=1:yt[ft]=void 0,gt[ft]?yt[ft]!=null&&gt[ft]!=yt[ft]&&(console.log("Warning: "+ft+" opacity is ambiguous"),gt[ft]=1):gt[ft]=yt[ft];b.call(this,xt,it),this.drawAtomClickSphere(xt),this.drawAtomCross(xt,ut),this.drawBondLines(xt,c,nt),this.drawBondSticks(xt,c,rt),typeof xt.style.cartoon<"u"&&!xt.style.cartoon.hidden&&(xt.style.cartoon.color==="spectrum"&&typeof xt.resi=="number"&&!xt.hetflag&&(xt.resi<_t[0]&&(_t[0]=xt.resi),xt.resi>_t[1]&&(_t[1]=xt.resi)),et.push(xt))}}if(et.length>0&&(0,_e.drawCartoon)(j,et,_t,this.defaultCartoonQuality),it&&it.vertices>0){it.initTypedArrays();var Mt=null,wt=null;it.imposter?Mt=new o.SphereImposterMaterial({ambient:0,vertexColors:!0,reflectivity:0}):it.instanced?(wt=new o.Geometry(!0),g.GLDraw.drawSphere(wt,{x:0,y:0,z:0},1,new _.Color(.5,.5,.5)),wt.initTypedArrays(),Mt=new o.InstancedMaterial({sphereMaterial:new o.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),sphere:wt})):Mt=new o.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),gt.sphere<1&&gt.sphere>=0&&(Mt.transparent=!0,Mt.opacity=gt.sphere),wt=new o.Mesh(it,Mt),j.add(wt)}if(rt.vertices>0){var Et=null,At=null,St=rt.sphereGeometry;(!St||typeof St.vertices>"u"||St.vertices==0)&&(St=null),rt.initTypedArrays(),St&&St.initTypedArrays();var bt={ambient:0,vertexColors:!0,reflectivity:0};rt.imposter?(Et=new o.StickImposterMaterial(bt),At=new o.SphereImposterMaterial(bt)):(Et=new o.MeshLambertMaterial(bt),At=new o.MeshLambertMaterial(bt),Et.wireframe&&(rt.setUpWireframe(),St&&St.setUpWireframe())),gt.stick<1&&gt.stick>=0&&(Et.transparent=!0,Et.opacity=gt.stick,At.transparent=!0,At.opacity=gt.stick);var Ct=new o.Mesh(rt,Et);if(j.add(Ct),St){var Nt=new o.Mesh(St,At);j.add(Nt)}}var kt;for(dt in nt)if(nt.hasOwnProperty(dt)){kt=dt;var Ht=new o.LineBasicMaterial({linewidth:kt,vertexColors:!0});gt.line<1&&gt.line>=0&&(Ht.transparent=!0,Ht.opacity=gt.line),nt[dt].initTypedArrays();var jt=new o.Line(nt[dt],Ht,o.LineStyle.LinePieces);j.add(jt)}for(dt in ut)if(ut.hasOwnProperty(dt)){kt=dt;var Zt=new o.LineBasicMaterial({linewidth:kt,vertexColors:!0});gt.cross<1&&gt.cross>=0&&(Zt.transparent=!0,Zt.opacity=gt.cross),ut[dt].initTypedArrays();var Xt=new o.Line(ut[dt],Zt,o.LineStyle.LinePieces);j.add(Xt)}if(this.dontDuplicateAtoms&&this.modelData.symmetries&&this.modelData.symmetries.length>0){var Kt=new o.Object3D,ar;for(ar=0;ar<this.modelData.symmetries.length;ar++){var or=new o.Object3D;or=j.clone(),or.matrix.copy(this.modelData.symmetries[ar]),or.matrixAutoUpdate=!1,Kt.add(or)}return Kt}return j}getViewer(){return this.viewer}getInternalState(){return{atoms:this.atoms,frames:this.frames}}setInternalState(c){this.atoms=c.atoms,this.frames=c.frames,this.molObj=null}getCrystData(){if(this.modelData.cryst){if(!this.modelData.cryst.matrix){const c=this.modelData.cryst;this.modelData.cryst.matrix=(0,h.conversionMatrix3)(c.a,c.b,c.c,c.alpha,c.beta,c.gamma)}return this.modelData.cryst}else return null}setCrystData(c,d,j,et,nt,ut){c=c||1,d=d||1,j=j||1,et=et||90,nt=nt||90,ut=ut||90;const b=(0,h.conversionMatrix3)(c,d,j,et,nt,ut);this.modelData.cryst={a:c,b:d,c:j,alpha:et,beta:nt,gamma:ut,matrix:b}}setCrystMatrix(c){c=c||new h.Matrix3(1,0,0,0,1,0,0,0,1),this.modelData.cryst={matrix:c}}getSymmetries(){return typeof this.modelData.symmetries>"u"&&(this.modelData.symmetries=[this.idMatrix]),this.modelData.symmetries}setSymmetries(c){typeof c>"u"?this.modelData.symmetries=[this.idMatrix]:(this.modelData.symmetries=c,this.molObj=null)}getID(){return this.id}getNumFrames(){return this.frames.numFrames!=null?this.frames.numFrames:this.frames.length}adjustCoord(c,d,j,et){var nt=d-c;return nt<-j?d+et:nt>j?d-et:d}adjustCoordinatesToBox(){if(this.box&&this.atomdfs)for(var c=this.box[0],d=this.box[1],j=this.box[2],et=c*.9,nt=d*.9,ut=j*.9,b=0;b<this.atomdfs.length;b++)for(var it=this.atomdfs[b],rt=1;rt<it.length;rt++){var dt=this.atoms[it[rt][0]],ft=this.atoms[it[rt][1]];dt.x=this.adjustCoord(ft.x,dt.x,et,c),dt.y=this.adjustCoord(ft.y,dt.y,nt,d),dt.z=this.adjustCoord(ft.z,dt.z,ut,j)}}setFrame(c){var d=this.getNumFrames();let j=this,et=this.viewer;return new Promise(function(nt,ut){if(d==0&&nt(),(c<0||c>=d)&&(c=d-1),j.frames.url!=null){var b=j.frames.url;(0,st.getbin)(b+"/traj/frame/"+c+"/"+j.frames.path,void 0,"POST",void 0).then(function(it){for(var rt=new Float32Array(it,44),dt=0,ft=0;ft<j.atoms.length;ft++)j.atoms[ft].x=rt[dt++],j.atoms[ft].y=rt[dt++],j.atoms[ft].z=rt[dt++];j.box&&j.atomdfs&&j.adjustCoordinatesToBox(),nt()}).catch(ut)}else j.atoms=j.frames[c],nt();j.molObj=null,j.modelDatas&&c<j.modelDatas.length&&(j.modelData=j.modelDatas[c],j.unitCellObjects&&et&&(et.removeUnitCell(j),et.addUnitCell(j)))})}addFrame(c){this.frames.push(c)}vibrate(c=10,d=1,j=!1,et){var nt=0,ut=c;let b=this.viewer;j&&(nt=-c,ut=c),this.frames!==void 0&&this.frames.origIndex!==void 0?this.setFrame(this.frames.origIndex):this.setFrame(0),nt<ut&&(this.frames=[]),j&&(this.frames.origIndex=c);for(var it=nt;it<ut;it++){var rt=[],dt=this.frames.length;if(it==0&&!et){this.frames.push(this.atoms);continue}for(var ft=0;ft<this.atoms.length;ft++){var mt=(0,st.getAtomProperty)(this.atoms[ft],"dx"),yt=(0,st.getAtomProperty)(this.atoms[ft],"dy"),gt=(0,st.getAtomProperty)(this.atoms[ft],"dz"),_t=new h.Vector3(mt,yt,gt),xt=new h.Vector3(this.atoms[ft].x,this.atoms[ft].y,this.atoms[ft].z),Mt=it*d/c;_t.multiplyScalar(Mt),xt.add(_t);var wt={};for(var Et in this.atoms[ft])wt[Et]=this.atoms[ft][Et];if(wt.x=xt.x,wt.y=xt.y,wt.z=xt.z,rt.push(wt),b&&et){var At=(0,st.extend)({},et),St=new h.Vector3(mt,yt,gt);if(St.multiplyScalar(d),St.add(xt),At.start=xt,At.end=St,At.frame=dt,!At.color){var bt=wt.style.sphere;bt||(bt=wt.style.stick),bt||(bt=wt.style.line),At.color=(0,st.getColorFromStyle)(wt,bt)}b.addArrow(At)}}this.frames.push(rt)}}setAtomDefaults(c){for(let d=0;d<c.length;d++){let j=c[d];j&&(j.style=j.style||(0,st.deepCopy)(ct.defaultAtomStyle),j.color=j.color||this.ElementColors[j.elem]||this.defaultColor,j.model=this.id,(j.clickable||j.hoverable)&&(j.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}))}}addMolData(c,d,j={}){var et=ct.parseMolData(c,d,j);this.dontDuplicateAtoms=!j.duplicateAssemblyAtoms;var nt=et.modelData;if(nt&&(Array.isArray(nt)?(this.modelData=nt[0],j.frames&&(this.modelDatas=nt)):this.modelData=nt),et.box?this.box=et.box:this.box=null,this.frames.length==0){for(let b=0;b<et.length;b++)et[b].length!=0&&this.frames.push(et[b]);this.frames[0]&&(this.atoms=this.frames[0])}else if(j.frames)for(let b=0;b<et.length;b++)this.frames.push(et[b]);else for(var ut=0;ut<et.length;ut++)this.addAtoms(et[ut]);for(let b=0;b<this.frames.length;b++)this.setAtomDefaults(this.frames[b]);j.vibrate&&j.vibrate.frames&&j.vibrate.amplitude&&this.vibrate(j.vibrate.frames,j.vibrate.amplitude),j.style&&this.setStyle({},j.style)}setDontDuplicateAtoms(c){this.dontDuplicateAtoms=c}setModelData(c){this.modelData=c}propertyMatches(c,d){if(c==d)return!0;if(typeof d=="string"&&typeof c=="number"){var j=d.match(/(-?\d+)\s*-\s*(-?\d+)/);if(j){var et=parseInt(j[1]),nt=parseInt(j[2]);if(j&&c>=et&&c<=nt)return!0}}return!1}static deepCopyAndCache(c,d){if(typeof c!="object"||c==null||c instanceof ct||c.__cache_created)return c;const j={};for(const et in c){const nt=c[et];if(Array.isArray(nt)){j[et]=[];for(let ut=0;ut<nt.length;ut++)j[et].push(ct.deepCopyAndCache(nt[ut],d))}else typeof nt=="object"&&et!="properties"&&et!="model"?j[et]=ct.deepCopyAndCache(nt,d):j[et]=nt;if(et=="and"||et=="or"){const ut=[];for(const b of j[et]){const it=new Set;for(const rt of d.selectedAtoms(b))it.add(rt.index);ut.push(it)}if(et=="and"){const b=function(rt,dt){const ft=new Set;for(const mt of dt)rt.has(mt)&&ft.add(mt);return ft};let it=new Set(ut[0]);for(const rt of ut.splice(1))it=b(it,rt);j[et].__cached_results=it}else if(et=="or"){const b=new Set;for(const it of ut)for(const rt of it)b.add(rt);j[et].__cached_results=b}}}return j.__cache_created=!0,j}atomIsSelected(c,d){if(typeof d>"u")return!0;var j=!!d.invert,et=!0;for(var nt in d)if(nt=="and"||nt=="or"||nt=="not"){if(nt=="not"){if(this.atomIsSelected(c,d[nt])){et=!1;break}}else if(d[nt].__cached_results===void 0&&(d=ct.deepCopyAndCache(d,this)),et=d[nt].__cached_results.has(c.index),!et)break}else if(nt==="predicate"){if(!d.predicate(c)){et=!1;break}}else if(nt=="properties"&&c[nt]){for(var ut in d.properties)if(!ut.startsWith("__cache")){if(typeof c.properties[ut]>"u"){et=!1;break}if(c.properties[ut]!=d.properties[ut]){et=!1;break}}}else if(nt=="model"){let dt=d.model;if(typeof dt=="number"&&dt<0&&(dt=this.viewer.getNextModelId()+dt),Array.isArray(dt)){let ft=!1;for(let mt=0;mt<dt.length;mt++)if(dt[mt]==this||dt[mt]==this.id){ft=!0;break}if(!ft){et=!1;break}}else if(dt!=this&&dt!=this.id){et=!1;break}}else if(d.hasOwnProperty(nt)&&!ct.ignoredKeys.has(nt)&&!nt.startsWith("__cache")){if(typeof c[nt]>"u"){et=!1;break}let dt=!1;if(nt==="bonds"){var b=d[nt];if(b!=c.bonds.length){et=!1;break}}else if(Array.isArray(d[nt])){var it=d[nt],rt=c[nt];for(let ft=0;ft<it.length;ft++)if(this.propertyMatches(rt,it[ft])){dt=!0;break}if(!dt){et=!1;break}}else{let ft=d[nt];if(!this.propertyMatches(c[nt],ft)){et=!1;break}}}return j?!et:et}static squaredDistance(c,d){var j=d.x-c.x,et=d.y-c.y,nt=d.z-c.z;return j*j+et*et+nt*nt}expandAtomList(c,d){if(d<=0)return c;for(var j=(0,st.getExtent)(c,void 0),et=[[],[],[]],nt=0;nt<3;nt++)et[0][nt]=j[0][nt]-d,et[1][nt]=j[1][nt]+d,et[2][nt]=j[2][nt];var ut=[];for(let dt=0;dt<this.atoms.length;dt++){var b=this.atoms[dt].x,it=this.atoms[dt].y,rt=this.atoms[dt].z;b>=et[0][0]&&b<=et[1][0]&&it>=et[0][1]&&it<=et[1][1]&&rt>=et[0][2]&&rt<=et[1][2]&&(b>=j[0][0]&&b<=j[1][0]&&it>=j[0][1]&&it<=j[1][1]&&rt>=j[0][2]&&rt<=j[1][2]||ut.push(this.atoms[dt]))}return ut}static getFloat(c){return typeof c=="number"?c:parseFloat(c)}selectedAtoms(c,d){var j=[];c=ct.deepCopyAndCache(c||{},this),d||(d=this.atoms);for(var et=d.length,nt=0;nt<et;nt++){var ut=d[nt];ut&&this.atomIsSelected(ut,c)&&j.push(ut)}if(c.hasOwnProperty("expand")){const wt=ct.getFloat(c.expand);let Et=this.expandAtomList(j,wt),At=j.length;const St=wt*wt;for(let bt=0;bt<Et.length;bt++)for(let Ct=0;Ct<At;Ct++){var b=ct.squaredDistance(Et[bt],j[Ct]);b<St&&b>0&&j.push(Et[bt])}}if(c.hasOwnProperty("within")&&c.within.hasOwnProperty("sel")&&c.within.hasOwnProperty("distance")){var it=this.selectedAtoms(c.within.sel,this.atoms),rt={};const wt=ct.getFloat(c.within.distance),Et=wt*wt;for(let At=0;At<it.length;At++)for(let St=0;St<j.length;St++){let bt=ct.squaredDistance(it[At],j[St]);bt<Et&&bt>0&&(rt[St]=1)}var dt=[];if(c.within.invert)for(let At=0;At<j.length;At++)rt[At]||dt.push(j[At]);else for(let At in rt)dt.push(j[At]);j=dt}if(c.hasOwnProperty("byres")){var ft={},mt=[],yt=[];for(let wt=0;wt<j.length;wt++){let Et=j[wt];var gt=Et.chain,_t=Et.resi;if(ft[gt]===void 0&&(ft[gt]={}),Et.hasOwnProperty("resi")&&ft[gt][_t]===void 0){for(ft[gt][_t]=!0,yt.push(Et);yt.length>0;)if(Et=yt.pop(),gt=Et.chain,_t=Et.resi,mt[Et.index]===void 0){mt[Et.index]=!0;for(var xt=0;xt<Et.bonds.length;xt++){var Mt=this.atoms[Et.bonds[xt]];mt[Mt.index]===void 0&&Mt.hasOwnProperty("resi")&&Mt.chain==gt&&Mt.resi==_t&&(yt.push(Mt),j.push(Mt))}}}}}return j}addAtoms(c){this.molObj=null;var d=this.atoms.length,j=[],et;for(et=0;et<c.length;et++)typeof c[et].index>"u"&&(c[et].index=et),typeof c[et].serial>"u"&&(c[et].serial=et),j[c[et].index]=d+et;for(et=0;et<c.length;et++){var nt=c[et],ut=j[nt.index],b=(0,st.extend)({},nt);b.index=ut,b.bonds=[],b.bondOrder=[],b.model=this.id,b.style=b.style||(0,st.deepCopy)(ct.defaultAtomStyle),typeof b.color>"u"&&(b.color=this.ElementColors[b.elem]||this.defaultColor);for(var it=nt.bonds?nt.bonds.length:0,rt=0;rt<it;rt++){var dt=j[nt.bonds[rt]];typeof dt<"u"&&(b.bonds.push(dt),b.bondOrder.push(nt.bondOrder?nt.bondOrder[rt]:1))}this.atoms.push(b)}}assignBonds(){(0,lt.assignBonds)(this.atoms,{assignBonds:!0})}removeAtoms(c){this.molObj=null;var d=[],j;for(j=0;j<c.length;j++)d[c[j].index]=!0;var et=[];for(j=0;j<this.atoms.length;j++){var nt=this.atoms[j];d[nt.index]||et.push(nt)}this.atoms=[],this.addAtoms(et)}setStyle(c,d,j){typeof d>"u"&&typeof j>"u"&&(d=c,c={}),c=c,typeof d=="string"&&(d=(0,st.specStringToObject)(d));var et=!1,nt=this,ut=function(it){var rt=nt.selectedAtoms(c,it);for(let dt=0;dt<it.length;dt++)it[dt]&&(it[dt].capDrawn=!1);for(let dt=0;dt<rt.length;dt++){et=!0,(rt[dt].clickable||rt[dt].hoverable)&&(rt[dt].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]}),j||(rt[dt].style={});for(let ft in d)d.hasOwnProperty(ft)&&(rt[dt].style[ft]=rt[dt].style[ft]||{},Object.assign(rt[dt].style[ft],d[ft]))}};if(c.frame!==void 0&&c.frame<this.frames.length){let it=c.frame;it<0&&(it=this.frames.length+it),ut(this.frames[it])}else{ut(this.atoms);for(var b=0;b<this.frames.length;b++)this.frames[b]!==this.atoms&&ut(this.frames[b])}et&&(this.molObj=null)}setClickable(c,d,j){if(d=!!d,j=(0,st.makeFunction)(j),j===null){console.log("Callback is not a function");return}var et=this.selectedAtoms(c,this.atoms),nt=et.length;for(let ut=0;ut<nt;ut++)et[ut].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},et[ut].clickable=d,j&&(et[ut].callback=j);nt>0&&(this.molObj=null)}setHoverable(c,d,j,et){if(d=!!d,j=(0,st.makeFunction)(j),et=(0,st.makeFunction)(et),j===null){console.log("Hover_callback is not a function");return}if(et===null){console.log("Unhover_callback is not a function");return}var nt=this.selectedAtoms(c,this.atoms),ut=nt.length;for(let b=0;b<ut;b++)nt[b].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},nt[b].hoverable=d,j&&(nt[b].hover_callback=j),et&&(nt[b].unhover_callback=et);ut>0&&(this.molObj=null)}enableContextMenu(c,d){d=!!d;var j,et=this.selectedAtoms(c,this.atoms),nt=et.length;for(j=0;j<nt;j++)et[j].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},et[j].contextMenuEnabled=d;nt>0&&(this.molObj=null)}setColorByElement(c,d){if(!(this.molObj!==null&&ct.sameObj(d,this.lastColors))){this.lastColors=d;var j=this.selectedAtoms(c,j);j.length>0&&(this.molObj=null);for(var et=0;et<j.length;et++){var nt=j[et];typeof d[nt.elem]<"u"&&(nt.color=d[nt.elem])}}}setColorByProperty(c,d,j,et){var nt,ut,b=this.selectedAtoms(c,b);for(this.lastColors=null,b.length>0&&(this.molObj=null),typeof j=="string"&&typeof tt.Gradient.builtinGradients[j]<"u"&&(j=new tt.Gradient.builtinGradients[j]),j=j,et||(et=j.range()),et||(et=(0,st.getPropertyRange)(b,d)),nt=0;nt<b.length;nt++){ut=b[nt];var it=(0,st.getAtomProperty)(ut,d);it!=null&&(ut.color=j.valueToHex(parseFloat(ut.properties[d]),et))}}setColorByFunction(c,d){var j=this.selectedAtoms(c,j);if(typeof d=="function"){this.lastColors=null,j.length>0&&(this.molObj=null);for(let et=0;et<j.length;et++){let nt=j[et];nt.color=d(nt)}}}toCDObject(c=!1){var d={a:[],b:[]};c&&(d.s=[]);for(let et=0;et<this.atoms.length;et++){let nt={},ut=this.atoms[et];if(nt.x=ut.x,nt.y=ut.y,nt.z=ut.z,ut.elem!="C"&&(nt.l=ut.elem),c){for(var j=0;j<d.s.length&&JSON.stringify(ut.style)!==JSON.stringify(d.s[j]);)j++;j===d.s.length&&d.s.push(ut.style),j!==0&&(nt.s=j)}d.a.push(nt);for(let b=0;b<ut.bonds.length;b++){let it=et,rt=ut.bonds[b];if(it>=rt)continue;let dt={b:it,e:rt},ft=ut.bondOrder[b];ft!=1&&(dt.o=ft),d.b.push(dt)}}return d}globj(c,d){(this.molObj===null||d.regen)&&(this.molObj=this.createMolObj(this.atoms,d),this.renderedMolObj&&(c.remove(this.renderedMolObj),this.renderedMolObj=null),this.renderedMolObj=this.molObj.clone(),this.hidden&&(this.renderedMolObj.setVisible(!1),this.molObj.setVisible(!1)),c.add(this.renderedMolObj))}exportVRML(){var c=this.createMolObj(this.atoms,{supportsImposters:!1,supportsAIA:!1});return c.vrml()}removegl(c){this.renderedMolObj&&(this.renderedMolObj.geometry!==void 0&&this.renderedMolObj.geometry.dispose(),this.renderedMolObj.material!==void 0&&this.renderedMolObj.material.dispose(),c.remove(this.renderedMolObj),this.renderedMolObj=null),this.molObj=null}hide(){this.hidden=!0,this.renderedMolObj&&this.renderedMolObj.setVisible(!1),this.molObj&&this.molObj.setVisible(!1)}show(){this.hidden=!1,this.renderedMolObj&&this.renderedMolObj.setVisible(!0),this.molObj&&this.molObj.setVisible(!0)}addPropertyLabels(c,d,j){let et=this.selectedAtoms(d),nt=this.viewer,ut=(0,st.deepCopy)(j);for(let it=0;it<et.length;it++){let rt=et[it];var b=null;typeof rt[c]<"u"?b=String(rt[c]):typeof rt.properties[c]<"u"&&(b=String(rt.properties[c])),b!=null&&(ut.position=rt,nt.addLabel(b,ut))}}addResLabels(c,d,j=!1){let et=this.viewer;var nt=[],ut=function(it,rt){for(var dt=it.selectedAtoms(c,dt),ft={},mt=0;mt<dt.length;mt++){var yt=dt[mt],gt=yt.chain,_t=yt.resn,xt=yt.resi,Mt=_t+""+xt;ft[gt]||(ft[gt]={}),ft[gt][Mt]||(ft[gt][Mt]=[]),ft[gt][Mt].push(yt)}var wt=(0,st.deepCopy)(d);for(let At in ft)if(ft.hasOwnProperty(At)){var Et=ft[At];for(let St in Et)if(Et.hasOwnProperty(St)){let bt=Et[St],Ct=new h.Vector3(0,0,0);for(let kt=0;kt<bt.length;kt++){let Ht=bt[kt];Ct.x+=Ht.x,Ct.y+=Ht.y,Ct.z+=Ht.z}Ct.divideScalar(bt.length),wt.position=Ct,wt.frame=rt;let Nt=et.addLabel(St,wt,void 0,!0);nt.push(Nt)}}};if(j){var b=this.getNumFrames();let it=this.atoms;for(let rt=0;rt<b;rt++)this.frames[rt]&&(this.atoms=this.frames[rt],ut(this,rt));this.atoms=it}else ut(this);return nt}setupDFS(){this.atomdfs=[];var c=this,d=new Int8Array(this.atoms.length);d.fill(0);for(var j=function(b,it,rt){rt.push([b,it]);var dt=c.atoms[b];d[b]=1;for(var ft=0;ft<dt.bonds.length;ft++){var mt=dt.bonds[ft];c.atoms[mt]&&!d[mt]&&j(mt,b,rt)}},et=0;et<this.atoms.length;et++){var nt=this.atoms[et];if(nt&&!d[et]){var ut=[];j(et,-1,ut),this.atomdfs.push(ut)}}}setCoordinatesFromURL(c,d){this.frames=[];var j=this;return this.box&&this.setupDFS(),c.startsWith("http")||(c="http://"+c),(0,st.get)(c+"/traj/numframes/"+d,function(et){if(!isNaN(parseInt(et)))return j.frames.push(j.atoms),j.frames.numFrames=et,j.frames.url=c,j.frames.path=d,j.setFrame(0)})}setCoordinates(c,d){if(d=d||"",!c)return[];if(/\.gz$/.test(d)){d=d.replace(/\.gz$/,"");try{c=(0,st.inflateString)(c)}catch(ft){console.log(ft)}}var j={mdcrd:"",inpcrd:"",pdb:"",netcdf:"",array:""};if(j.hasOwnProperty(d)){this.frames=[];for(var et=this.atoms.length,nt=ct.parseCrd(c,d),ut=0;ut<nt.length;){for(var b=[],it=0;it<et;it++){var rt={};for(var dt in this.atoms[it])rt[dt]=this.atoms[it][dt];b[it]=rt,b[it].x=nt[ut++],b[it].y=nt[ut++],b[it].z=nt[ut++]}this.frames.push(b)}return this.atoms=this.frames[0],this.frames}return[]}addAtomSpecs(c){}static parseCrd(c,d){var j=[],et=0;if(d=="pdb")for(var nt=c.indexOf(`
ATOM`);nt!=-1;){for(;c.slice(nt,nt+5)==`
ATOM`||c.slice(nt,nt+7)==`
HETATM`;)j[et++]=parseFloat(c.slice(nt+31,nt+39)),j[et++]=parseFloat(c.slice(nt+39,nt+47)),j[et++]=parseFloat(c.slice(nt+47,nt+55)),nt=c.indexOf(`
`,nt+54),c.slice(nt,nt+4)==`
TER`&&(nt=c.indexOf(`
`,nt+5));nt=c.indexOf(`
ATOM`,nt)}else if(d=="netcdf"){var ut=new ot.NetCDFReader(c);j=[].concat.apply([],ut.getDataVariable("coordinates"))}else{if(d=="array"||Array.isArray(c))return c.flat(2);{let b=c.indexOf(`
`);d=="inpcrd"&&(b=c.indexOf(`
`,b+1)),c=c.slice(b+1),j=c.match(/\S+/g).map(parseFloat)}}return j}static parseMolData(c,d="",j){if(!c)return[];if(/\.gz$/.test(d)){d=d.replace(/\.gz$/,"");try{d.match(/bcif/i)?c=(0,st.inflateString)(c,!1):c=(0,st.inflateString)(c)}catch(ut){console.log(ut)}}typeof at.Parsers[d]>"u"&&(d=d.split(".").pop(),typeof at.Parsers[d]>"u"&&(console.log("Unknown format: "+d),c instanceof Uint8Array?d="bcif":c.match(/^@<TRIPOS>MOLECULE/gm)?d="mol2":c.match(/^data_/gm)&&c.match(/^loop_/gm)?d="cif":c.match(/^HETATM/gm)||c.match(/^ATOM/gm)?d="pdb":c.match(/ITEM: TIMESTEP/gm)?d="lammpstrj":c.match(/^.*\n.*\n.\s*(\d+)\s+(\d+)/gm)?d="sdf":c.match(/^%VERSION\s+VERSION_STAMP/gm)?d="prmtop":d="xyz",console.log("Best guess: "+d)));var et=at.Parsers[d],nt=et(c,j);return nt}}ct.defaultAtomStyle={line:{}},ct.defaultlineWidth=1,ct.vdwRadii={H:1.2,He:1.4,Li:1.82,Be:1.53,B:1.92,C:1.7,N:1.55,O:1.52,F:1.47,Ne:1.54,Na:2.27,Mg:1.73,Al:1.84,Si:2.1,P:1.8,S:1.8,Cl:1.75,Ar:1.88,K:2.75,Ca:2.31,Ni:1.63,Cu:1.4,Zn:1.39,Ga:1.87,Ge:2.11,As:1.85,Se:1.9,Br:1.85,Kr:2.02,Rb:3.03,Sr:2.49,Pd:1.63,Ag:1.72,Cd:1.58,In:1.93,Sn:2.17,Sb:2.06,Te:2.06,I:1.98,Xe:2.16,Cs:3.43,Ba:2.68,Pt:1.75,Au:1.66,Hg:1.55,Tl:1.96,Pb:2.02,Bi:2.07,Po:1.97,At:2.02,Rn:2.2,Fr:3.48,Ra:2.83,U:1.86},ct.ignoredKeys=new Set(["props","invert","model","frame","byres","expand","within","and","or","not"])},"./src/GLShape.ts"(e,i,s){s.r(i),s.d(i,{GLShape:()=>ot,splitMesh:()=>lt});var o=s("./src/WebGL/index.ts"),a=s("./src/WebGL/shapes/index.ts"),h=s("./src/WebGL/math/index.ts"),_=s("./src/colors.ts"),g=s("./src/ProteinSurface4.ts"),_e=s("./src/VolumeData.ts"),st=s("./src/GLDraw.ts"),tt=s("./src/glcartoon.ts"),at=s("./src/utilities.ts");class ot{static finalizeGeo($){var c=$.updateGeoGroup(0);c.vertices>0&&c.truncateArrayBuffers(!0,!0)}static updateColor($,c){c=c||_.CC.color(c),$.colorsNeedUpdate=!0;var d,j,et;c.constructor!==Array&&(d=c.r,j=c.g,et=c.b);for(let nt in $.geometryGroups){let ut=$.geometryGroups[nt],b=ut.colorArray;for(let it=0,rt=ut.vertices;it<rt;++it){if(c.constructor===Array){let dt=c[it];d=dt.r,j=dt.g,et=dt.b}b[it*3]=d,b[it*3+1]=j,b[it*3+2]=et}}}static drawArrow($,c,d){var j=d.start,et=d.end,nt=d.radius,ut=d.radiusRatio,b=d.mid,it=d.midpos;if(!(j&&et))return;var rt=c.updateGeoGroup(51),dt=new h.Vector3(et.x,et.y,et.z).sub(j);if(it){let Ut=dt.length();it>0?b=it/Ut:b=(Ut+it)/Ut}dt.multiplyScalar(b);var ft=new h.Vector3(j.x,j.y,j.z).add(dt),mt=dt.clone().negate();let yt=new h.Vector3(j.x,j.y,j.z);$.intersectionShape.cylinder.push(new a.Cylinder(yt,ft.clone(),nt)),$.intersectionShape.sphere.push(new a.Sphere(yt,nt));var gt=[];gt[0]=dt.clone(),Math.abs(gt[0].x)>1e-4?gt[0].y+=1:gt[0].x+=1,gt[0].cross(dt),gt[0].normalize(),gt[4]=gt[0].clone(),gt[4].crossVectors(gt[0],dt),gt[4].normalize(),gt[8]=gt[0].clone().negate(),gt[12]=gt[4].clone().negate(),gt[2]=gt[0].clone().add(gt[4]).normalize(),gt[6]=gt[4].clone().add(gt[8]).normalize(),gt[10]=gt[8].clone().add(gt[12]).normalize(),gt[14]=gt[12].clone().add(gt[0]).normalize(),gt[1]=gt[0].clone().add(gt[2]).normalize(),gt[3]=gt[2].clone().add(gt[4]).normalize(),gt[5]=gt[4].clone().add(gt[6]).normalize(),gt[7]=gt[6].clone().add(gt[8]).normalize(),gt[9]=gt[8].clone().add(gt[10]).normalize(),gt[11]=gt[10].clone().add(gt[12]).normalize(),gt[13]=gt[12].clone().add(gt[14]).normalize(),gt[15]=gt[14].clone().add(gt[0]).normalize();var _t=rt.vertices,xt=rt.vertexArray,Mt=rt.faceArray,wt=rt.normalArray,Et=rt.lineArray,At,St,bt;for(St=0,bt=gt.length;St<bt;++St){At=3*(_t+3*St);var Ct=gt[St].clone().multiplyScalar(nt).add(j),Nt=gt[St].clone().multiplyScalar(nt).add(ft),kt=gt[St].clone().multiplyScalar(nt*ut).add(ft);if(xt[At]=Ct.x,xt[At+1]=Ct.y,xt[At+2]=Ct.z,xt[At+3]=Nt.x,xt[At+4]=Nt.y,xt[At+5]=Nt.z,xt[At+6]=kt.x,xt[At+7]=kt.y,xt[At+8]=kt.z,St>0){var Ht=xt[At-3],jt=xt[At-2],Zt=xt[At-1],Xt=new h.Vector3(Ht,jt,Zt),Kt=new h.Vector3(et.x,et.y,et.z),ar=ft.clone(),or=new h.Vector3(kt.x,kt.y,kt.z);$.intersectionShape.triangle.push(new a.Triangle(or,Kt,Xt)),$.intersectionShape.triangle.push(new a.Triangle(Xt.clone(),ar,or.clone()))}}rt.vertices+=48,At=rt.vertices*3,xt[At]=j.x,xt[At+1]=j.y,xt[At+2]=j.z,xt[At+3]=ft.x,xt[At+4]=ft.y,xt[At+5]=ft.z,xt[At+6]=et.x,xt[At+7]=et.y,xt[At+8]=et.z,rt.vertices+=3;var _r,nr,Vt,tr,mr,wr,Er,Sr,br,gr,xr,vr,pr,Tr,Cr,Pt,Ot,zt,rr,Jt=rt.vertices-3,cr=rt.vertices-2,dr=rt.vertices-1,Dt=Jt*3,Gt=cr*3,er=dr*3;for(St=0,bt=gt.length-1;St<bt;++St){var fr=_t+3*St;At=fr*3,nr=rt.faceidx,Vt=rt.lineidx,tr=fr,gr=tr*3,mr=fr+1,xr=mr*3,wr=fr+2,vr=wr*3,Er=fr+4,pr=Er*3,Sr=fr+5,Tr=Sr*3,br=fr+3,Cr=br*3,Pt=Ot=gt[St],zt=rr=gt[St+1],wt[gr]=Pt.x,wt[xr]=Ot.x,wt[Cr]=rr.x,wt[gr+1]=Pt.y,wt[xr+1]=Ot.y,wt[Cr+1]=rr.y,wt[gr+2]=Pt.z,wt[xr+2]=Ot.z,wt[Cr+2]=rr.z,wt[xr]=Ot.x,wt[pr]=zt.x,wt[Cr]=rr.x,wt[xr+1]=Ot.y,wt[pr+1]=zt.y,wt[Cr+1]=rr.y,wt[xr+2]=Ot.z,wt[pr+2]=zt.z,wt[Cr+2]=rr.z,wt[vr]=Ot.x,wt[Tr]=zt.x,wt[vr+1]=Ot.y,wt[Tr+1]=zt.y,wt[vr+2]=Ot.z,wt[Tr+2]=zt.z,Mt[nr]=tr,Mt[nr+1]=mr,Mt[nr+2]=br,Mt[nr+3]=mr,Mt[nr+4]=Er,Mt[nr+5]=br,Mt[nr+6]=tr,Mt[nr+7]=br,Mt[nr+8]=Jt,Mt[nr+9]=wr,Mt[nr+10]=cr,Mt[nr+11]=Sr,Mt[nr+12]=wr,Mt[nr+13]=dr,Mt[nr+14]=Sr,Et[Vt]=tr,Et[Vt+1]=mr,Et[Vt+2]=tr,Et[Vt+3]=br,Et[Vt+4]=Er,Et[Vt+5]=br,Et[Vt+6]=tr,Et[Vt+7]=br,Et[Vt+8]=wr,Et[Vt+9]=mr,Et[Vt+10]=wr,Et[Vt+11]=Sr,Et[Vt+12]=Er,Et[Vt+13]=Sr,Et[Vt+14]=wr,Et[Vt+15]=dr,Et[Vt+16]=wr,Et[Vt+17]=Sr,Et[Vt+18]=dr,Et[Vt+19]=Sr,rt.faceidx+=15,rt.lineidx+=20}_r=[_t+45,_t+46,_t+1,_t,_t+47,_t+2],nr=rt.faceidx,Vt=rt.lineidx,tr=_r[0],gr=tr*3,mr=_r[1],xr=mr*3,wr=_r[4],vr=wr*3,Er=_r[2],pr=Er*3,Sr=_r[5],Tr=Sr*3,br=_r[3],Cr=br*3,Pt=Ot=gt[15],zt=rr=gt[0],wt[gr]=Pt.x,wt[xr]=Ot.x,wt[Cr]=rr.x,wt[gr+1]=Pt.y,wt[xr+1]=Ot.y,wt[Cr+1]=rr.y,wt[gr+2]=Pt.z,wt[xr+2]=Ot.z,wt[Cr+2]=rr.z,wt[xr]=Ot.x,wt[pr]=zt.x,wt[Cr]=rr.x,wt[xr+1]=Ot.y,wt[pr+1]=zt.y,wt[Cr+1]=rr.y,wt[xr+2]=Ot.z,wt[pr+2]=zt.z,wt[Cr+2]=rr.z,wt[vr]=Ot.x,wt[Tr]=zt.x,wt[vr+1]=Ot.y,wt[Tr+1]=zt.y,wt[vr+2]=Ot.z,wt[Tr+2]=zt.z,dt.normalize(),mt.normalize(),wt[Dt]=mt.x,wt[Gt]=wt[er]=dt.x,wt[Dt+1]=mt.y,wt[Gt+1]=wt[er+1]=dt.y,wt[Dt+2]=mt.z,wt[Gt+2]=wt[er+2]=dt.z,Mt[nr]=tr,Mt[nr+1]=mr,Mt[nr+2]=br,Mt[nr+3]=mr,Mt[nr+4]=Er,Mt[nr+5]=br,Mt[nr+6]=tr,Mt[nr+7]=br,Mt[nr+8]=Jt,Mt[nr+9]=wr,Mt[nr+10]=cr,Mt[nr+11]=Sr,Mt[nr+12]=wr,Mt[nr+13]=dr,Mt[nr+14]=Sr,Et[Vt]=tr,Et[Vt+1]=mr,Et[Vt+2]=tr,Et[Vt+3]=br,Et[Vt+4]=Er,Et[Vt+5]=br,Et[Vt+6]=tr,Et[Vt+7]=br,Et[Vt+8]=wr,Et[Vt+9]=mr,Et[Vt+10]=wr,Et[Vt+11]=Sr,Et[Vt+12]=Er,Et[Vt+13]=Sr,Et[Vt+14]=wr,Et[Vt+15]=dr,Et[Vt+16]=wr,Et[Vt+17]=Sr,Et[Vt+18]=dr,Et[Vt+19]=Sr,rt.faceidx+=15,rt.lineidx+=20}static updateBoundingFromPoints($,c,d,j){$.center.set(0,0,0);let et=1/0,nt=1/0,ut=1/0,b=-1/0,it=-1/0,rt=-1/0;$.box&&(et=$.box.min.x,b=$.box.max.x,nt=$.box.min.y,it=$.box.max.y,ut=$.box.min.z,rt=$.box.max.z);for(let yt=0,gt=j;yt<gt;yt++){var dt=d[yt*3],ft=d[yt*3+1],mt=d[yt*3+2];dt<et&&(et=dt),ft<nt&&(nt=ft),mt<ut&&(ut=mt),dt>b&&(b=dt),ft>it&&(it=ft),mt>rt&&(rt=mt)}$.center.set((b+et)/2,(it+nt)/2,(rt+ut)/2),$.radius=$.center.distanceTo({x:b,y:it,z:rt}),$.box={min:{x:et,y:nt,z:ut},max:{x:b,y:it,z:rt}}}static addCustomGeo($,c,d,j,et){var nt=c.addGeoGroup(),ut=d.vertexArr,b=d.normalArr,it=d.faceArr;nt.vertices=ut.length,nt.faceidx=it.length;var rt,dt,ft,mt,yt,gt,_t,xt,Mt,wt=nt.vertexArray,Et=nt.colorArray;for(j.constructor!==Array&&(xt=j.r,Mt=j.g,mt=j.b),gt=0,_t=nt.vertices;gt<_t;++gt)rt=gt*3,dt=ut[gt],wt[rt]=dt.x,wt[rt+1]=dt.y,wt[rt+2]=dt.z,j.constructor===Array&&(yt=j[gt],xt=yt.r,Mt=yt.g,mt=yt.b),Et[rt]=xt,Et[rt+1]=Mt,Et[rt+2]=mt;if(et)for(gt=0,_t=nt.faceidx/3;gt<_t;++gt){rt=gt*3,ft=it[rt],mt=it[rt+1],yt=it[rt+2];var At=new h.Vector3,St=new h.Vector3,bt=new h.Vector3;$.intersectionShape.triangle.push(new a.Triangle(At.copy(ut[ft]),St.copy(ut[mt]),bt.copy(ut[yt])))}if(et){var Ct=new h.Vector3(0,0,0),Nt=0;for(let jt=0;jt<c.geometryGroups.length;jt++)Ct.add(c.geometryGroups[jt].getCentroid()),Nt++;Ct.divideScalar(Nt),ot.updateBoundingFromPoints($.boundingSphere,{centroid:Ct},wt,nt.vertices)}if(nt.faceArray=new Uint16Array(it),nt.truncateArrayBuffers(!0,!0),b.length<nt.vertices)nt.setNormals();else{var kt=nt.normalArray=new Float32Array(nt.vertices*3),Ht;for(gt=0,_t=nt.vertices;gt<_t;++gt)rt=gt*3,Ht=b[gt],kt[rt]=Ht.x,kt[rt+1]=Ht.y,kt[rt+2]=Ht.z}nt.setLineIndices(),nt.lineidx=nt.lineArray.length}static updateFromStyle($,c){typeof c.color<"u"?($.color=c.color||new _.Color,c.color instanceof _.Color||($.color=_.CC.color(c.color))):$.color=_.CC.color(0),$.wireframe=!!c.wireframe,$.opacity=c.alpha?(0,h.clamp)(c.alpha,0,1):1,typeof c.opacity<"u"&&($.opacity=(0,h.clamp)(c.opacity,0,1)),$.side=c.side!==void 0?c.side:o.DoubleSide,$.linewidth=typeof c.linewidth>"u"?1:c.linewidth,$.clickable=!!c.clickable,$.callback=(0,at.makeFunction)(c.callback),$.hoverable=!!c.hoverable,$.hover_callback=(0,at.makeFunction)(c.hover_callback),$.unhover_callback=(0,at.makeFunction)(c.unhover_callback),$.contextMenuEnabled=!!c.contextMenuEnabled,$.hidden=c.hidden,$.frame=c.frame}constructor($){this.color=16777215,this.hidden=!1,this.wireframe=!1,this.opacity=1,this.linewidth=1,this.clickable=!1,this.hoverable=!1,this.contextMenuEnabled=!1,this.side=o.DoubleSide,this.stylespec=$||{},this.boundingSphere=new a.Sphere,this.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]},ot.updateFromStyle(this,this.stylespec),this.components=[],this.shapeObj=null,this.renderedShapeObj=null,this.geo=new o.Geometry(!0),this.linegeo=new o.Geometry(!0)}updateStyle($){for(var c in $)this.stylespec[c]=$[c];if(ot.updateFromStyle(this,this.stylespec),$.voldata&&$.volscheme){(0,at.adjustVolumeStyle)($);const d=$.volscheme,j=$.voldata,et=_.CC,nt=d.range()||[-1,1];this.geo.setColors(function(ut,b,it){let rt=j.getVal(ut,b,it);return et.color(d.valueToHex(rt,nt))}),delete this.color}}addCustom($){$.vertexArr=$.vertexArr||[],$.faceArr=$.faceArr||[],$.normalArr=$.normalArr||[],ot.drawCustom(this,this.geo,$)}addSphere($){$.center||($.center=new h.Vector3(0,0,0)),$.radius=$.radius?(0,h.clamp)($.radius,0,1/0):1.5,$.color=_.CC.color($.color),this.intersectionShape.sphere.push(new a.Sphere($.center,$.radius)),st.GLDraw.drawSphere(this.geo,$.center,$.radius,$.color,$.quality),this.components.push({centroid:new h.Vector3($.center.x,$.center.y,$.center.z)});var c=this.geo.updateGeoGroup(0);ot.updateBoundingFromPoints(this.boundingSphere,this.components,c.vertexArray,c.vertices)}addBox($){var c=$.dimensions||{w:1,h:1,d:1},d;typeof c.w=="number"?d={x:c.w,y:0,z:0}:d=c.w;var j;typeof c.h=="number"?j={x:0,y:c.h,z:0}:j=c.h;var et;typeof c.d=="number"?et={x:0,y:0,z:c.d}:et=c.d;var nt=$.corner;nt==null&&($.center!==void 0?nt={x:$.center.x-.5*(d.x+j.x+et.x),y:$.center.y-.5*(d.y+j.y+et.y),z:$.center.z-.5*(d.z+j.z+et.z)}:nt={x:0,y:0,z:0});var ut=[{x:nt.x,y:nt.y,z:nt.z},{x:nt.x+d.x,y:nt.y+d.y,z:nt.z+d.z},{x:nt.x+j.x,y:nt.y+j.y,z:nt.z+j.z},{x:nt.x+d.x+j.x,y:nt.y+d.y+j.y,z:nt.z+d.z+j.z},{x:nt.x+et.x,y:nt.y+et.y,z:nt.z+et.z},{x:nt.x+d.x+et.x,y:nt.y+d.y+et.y,z:nt.z+d.z+et.z},{x:nt.x+j.x+et.x,y:nt.y+j.y+et.y,z:nt.z+j.z+et.z},{x:nt.x+d.x+j.x+et.x,y:nt.y+d.y+j.y+et.y,z:nt.z+d.z+j.z+et.z}],b=[],it=[];b.splice(b.length,0,ut[0],ut[1],ut[2],ut[3]),it.splice(it.length,0,0,2,1,1,2,3);var rt=4;b.splice(b.length,0,ut[2],ut[3],ut[6],ut[7]),it.splice(it.length,0,rt+0,rt+2,rt+1,rt+1,rt+2,rt+3),rt+=4,b.splice(b.length,0,ut[4],ut[5],ut[0],ut[1]),it.splice(it.length,0,rt+0,rt+2,rt+1,rt+1,rt+2,rt+3),rt+=4,b.splice(b.length,0,ut[6],ut[7],ut[4],ut[5]),it.splice(it.length,0,rt+0,rt+2,rt+1,rt+1,rt+2,rt+3),rt+=4,b.splice(b.length,0,ut[3],ut[1],ut[7],ut[5]),it.splice(it.length,0,rt+0,rt+2,rt+1,rt+1,rt+2,rt+3),rt+=4,b.splice(b.length,0,ut[2],ut[6],ut[0],ut[4]),it.splice(it.length,0,rt+0,rt+2,rt+1,rt+1,rt+2,rt+3),rt+=4;var dt=(0,at.extend)({},$);dt.vertexArr=b,dt.faceArr=it,dt.normalArr=[],ot.drawCustom(this,this.geo,dt);var ft=new h.Vector3;this.components.push({centroid:ft.addVectors(ut[0],ut[7]).multiplyScalar(.5)});var mt=this.geo.updateGeoGroup(0);ot.updateBoundingFromPoints(this.boundingSphere,this.components,mt.vertexArray,mt.vertices)}addCylinder($){var c,d;$.start?c=new h.Vector3($.start.x||0,$.start.y||0,$.start.z||0):c=new h.Vector3(0,0,0),$.end?(d=new h.Vector3($.end.x,$.end.y||0,$.end.z||0),typeof d.x>"u"&&(d.x=3)):d=new h.Vector3(0,0,0);var j=$.radius||.1,et=_.CC.color($.color);this.intersectionShape.cylinder.push(new a.Cylinder(c,d,j)),st.GLDraw.drawCylinder(this.geo,c,d,j,et,$.fromCap,$.toCap);var nt=new h.Vector3;this.components.push({centroid:nt.addVectors(c,d).multiplyScalar(.5)});var ut=this.geo.updateGeoGroup(0);ot.updateBoundingFromPoints(this.boundingSphere,this.components,ut.vertexArray,ut.vertices)}addDashedCylinder($){$.dashLength=$.dashLength||.25,$.gapLength=$.gapLength||.25;var c;$.start?c=new h.Vector3($.start.x||0,$.start.y||0,$.start.z||0):c=new h.Vector3(0,0,0);var d;$.end?(d=new h.Vector3($.end.x,$.end.y||0,$.end.z||0),typeof d.x>"u"&&(d.x=3)):d=new h.Vector3(3,0,0);for(var j=$.radius||.1,et=_.CC.color($.color),nt=Math.sqrt(Math.pow(c.x-d.x,2)+Math.pow(c.y-d.y,2)+Math.pow(c.z-d.z,2)),ut=nt/($.gapLength+$.dashLength),b=new h.Vector3($.start.x||0,$.start.y||0,$.start.z||0),it=new h.Vector3($.end.x,$.end.y||0,$.end.z||0),rt=new h.Vector3((d.x-c.x)/(nt/$.gapLength),(d.y-c.y)/(nt/$.gapLength),(d.z-c.z)/(nt/$.gapLength)),dt=new h.Vector3((d.x-c.x)/(nt/$.dashLength),(d.y-c.y)/(nt/$.dashLength),(d.z-c.z)/(nt/$.dashLength)),ft=0;ft<ut;ft++)it=new h.Vector3(b.x+dt.x,b.y+dt.y,b.z+dt.z),this.intersectionShape.cylinder.push(new a.Cylinder(b,it,j)),st.GLDraw.drawCylinder(this.geo,b,it,j,et,$.fromCap,$.toCap),b=new h.Vector3(it.x+rt.x,it.y+rt.y,it.z+rt.z);var mt=new h.Vector3;this.components.push({centroid:mt.addVectors(c,d).multiplyScalar(.5)});var yt=this.geo.updateGeoGroup(0);ot.updateBoundingFromPoints(this.boundingSphere,this.components,yt.vertexArray,yt.vertices)}addCurve($){$.points=$.points||[],$.smooth=$.smooth||10,typeof $.fromCap>"u"&&($.fromCap=2),typeof $.toCap>"u"&&($.toCap=2);var c=(0,tt.subdivide_spline)($.points,$.smooth);if(c.length<3){console.log("Too few points in addCurve");return}var d=$.radius||.1,j=_.CC.color($.color),et=0,nt=c.length-1,ut=c[0].distanceTo(c[1]),b=Math.ceil(2*d/ut);if($.toArrow){nt-=b;let ft={start:c[nt],end:c[c.length-1],radius:d,color:j,mid:1e-4};this.addArrow(ft)}if($.fromArrow){et+=b;let ft={start:c[et],end:c[0],radius:d,color:j,mid:1e-4};this.addArrow(ft)}for(var it=Math.ceil(c.length/2),rt={radius:d,color:j,fromCap:2,toCap:2},dt=et;dt<nt;dt++)rt.start=c[dt],rt.end=c[dt+1],rt.fromCap=2,rt.toCap=2,dt<it?(rt.fromCap=2,rt.toCap=0):dt>it?(rt.fromCap=0,rt.toCap=2):(rt.fromCap=2,rt.toCap=2),this.addCylinder(rt)}addLine($){var c,d;$.start?c=new h.Vector3($.start.x||0,$.start.y||0,$.start.z||0):c=new h.Vector3(0,0,0),$.end?(d=new h.Vector3($.end.x,$.end.y||0,$.end.z||0),typeof d.x>"u"&&(d.x=3)):d=new h.Vector3(3,0,0);var j=this.geo.updateGeoGroup(2),et=j.vertices,nt=et*3,ut=j.vertexArray;ut[nt]=c.x,ut[nt+1]=c.y,ut[nt+2]=c.z,ut[nt+3]=d.x,ut[nt+4]=d.y,ut[nt+5]=d.z,j.vertices+=2;var b=j.lineArray,it=j.lineidx;b[it]=et,b[it+1]=et+1,j.lineidx+=2;var rt=new h.Vector3;this.components.push({centroid:rt.addVectors(c,d).multiplyScalar(.5)}),j=this.geo.updateGeoGroup(0),ot.updateBoundingFromPoints(this.boundingSphere,this.components,j.vertexArray,j.vertices)}addArrow($){if($.start?$.start=new h.Vector3($.start.x||0,$.start.y||0,$.start.z||0):$.start=new h.Vector3(0,0,0),$.dir instanceof h.Vector3&&typeof $.length=="number"){var c=$.dir.clone().multiplyScalar($.length).add($.start);$.end=c}else $.end?($.end=new h.Vector3($.end.x,$.end.y||0,$.end.z||0),typeof $.end.x>"u"&&($.end.x=3)):$.end=new h.Vector3(3,0,0);$.radius=$.radius||.1,$.radiusRatio=$.radiusRatio||1.618034,$.mid=0<$.mid&&$.mid<1?$.mid:.618034,ot.drawArrow(this,this.geo,$);var d=new h.Vector3;this.components.push({centroid:d.addVectors($.start,$.end).multiplyScalar(.5)});var j=this.geo.updateGeoGroup(0);ot.updateBoundingFromPoints(this.boundingSphere,this.components,j.vertexArray,j.vertices)}static distance_from($,c){return Math.sqrt(Math.pow($.x-c.x,2)+Math.pow($.y-c.y,2)+Math.pow($.z-c.z,2))}static inSelectedRegion($,c,d){for(var j=0;j<c.length;j++)if(ot.distance_from(c[j],$)<=d)return!0;return!1}addIsosurface($,c,d,j){var et=c.isoval!==void 0&&typeof c.isoval=="number"?c.isoval:0,nt=!!c.voxel,ut=c.smoothness===void 0?1:c.smoothness,b=$.size.x,it=$.size.y,rt=$.size.z,dt=new Int16Array(b*it*rt),ft=$.data,mt,yt;for(mt=0,yt=dt.length;mt<yt;++mt)dt[mt]=-1;var gt=new Uint8Array(b*it*rt);for(mt=0,yt=ft.length;mt<yt;++mt){var _t=et>=0?ft[mt]-et:et-ft[mt];_t>0&&(gt[mt]|=ot.ISDONE)}var xt=[],Mt=[];g.MarchingCube.march(gt,xt,Mt,{fulltable:!0,voxel:nt,unitCube:$.unit,origin:$.origin,matrix:$.matrix,nX:b,nY:it,nZ:rt}),!nt&&ut>0&&g.MarchingCube.laplacianSmooth(ut,xt,Mt);var wt=[],Et=[],At=[];if(c.selectedRegion&&c.coords===void 0&&(c.coords=c.selectedRegion),c.coords===void 0&&c.selection!==void 0&&(j?c.coords=j.selectedAtoms(c.selection):console.log("addIsosurface needs viewer is selection provided.")),c.coords!==void 0){var St=c.coords[0].x,bt=c.coords[0].y,Ct=c.coords[0].z,Nt=c.coords[0].x,kt=c.coords[0].y,Ht=c.coords[0].z;for(let Vt=0;Vt<c.coords.length;Vt++)c.coords[Vt].x>St?St=c.coords[Vt].x:c.coords[Vt].x<Nt&&(Nt=c.coords[Vt].x),c.coords[Vt].y>bt?bt=c.coords[Vt].y:c.coords[Vt].y<kt&&(kt=c.coords[Vt].y),c.coords[Vt].z>Ct?Ct=c.coords[Vt].z:c.coords[Vt].z<Ht&&(Ht=c.coords[Vt].z);var jt=2;c.radius!==void 0&&(jt=c.radius),c.selectedOffset!==void 0&&(jt=c.selectedOffset),c.seldist!==void 0&&(jt=c.seldist),Nt-=jt,St+=jt,kt-=jt,bt+=jt,Ht-=jt,Ct+=jt;for(let Vt=0;Vt<xt.length;Vt++)xt[Vt].x>Nt&&xt[Vt].x<St&&xt[Vt].y>kt&&xt[Vt].y<bt&&xt[Vt].z>Ht&&xt[Vt].z<Ct&&ot.inSelectedRegion(xt[Vt],c.coords,jt)?(wt.push(Et.length),Et.push(xt[Vt])):wt.push(-1);for(let Vt=0;Vt+2<Mt.length;Vt+=3)wt[Mt[Vt]]!==-1&&wt[Mt[Vt+1]]!==-1&&wt[Mt[Vt+2]]!==-1&&(At.push(Mt[Vt]-(Mt[Vt]-wt[Mt[Vt]])),At.push(Mt[Vt+1]-(Mt[Vt+1]-wt[Mt[Vt+1]])),At.push(Mt[Vt+2]-(Mt[Vt+2]-wt[Mt[Vt+2]])));xt=Et,Mt=At}ot.drawCustom(this,this.geo,{vertexArr:xt,faceArr:Mt,normalArr:[],clickable:c.clickable,hoverable:c.hoverable}),this.updateStyle(c);var Zt=new h.Vector3($.origin.x,$.origin.y,$.origin.z),Xt=new h.Vector3($.size.x*$.unit.x,$.size.y*$.unit.y,$.size.z*$.unit.z),Kt=new h.Vector3(0,0,0),ar=Zt.clone(),or=Zt.clone().add(Xt);for(let Vt=0;Vt<xt.length;Vt++)Kt.add(xt[Vt]),ar.max(xt[Vt]),or.min(xt[Vt]);Kt.divideScalar(xt.length);var _r=Kt.distanceTo(or),nr=Kt.distanceTo(ar);this.boundingSphere.center=Kt,this.boundingSphere.radius=Math.max(_r,nr),typeof d=="function"&&d()}addVolumetricData($,c,d){$=new _e.VolumeData($,c),this.addIsosurface($,d)}finalize(){return ot.finalizeGeo(this.geo),this.geo.initTypedArrays(),this.geo}globj($){if(this.renderedShapeObj&&($.remove(this.renderedShapeObj),this.renderedShapeObj=null),!this.hidden){ot.finalizeGeo(this.geo),this.geo.initTypedArrays(),this.wireframe&&this.geo.setUpWireframe(),typeof this.color<"u"&&ot.updateColor(this.geo,this.color),this.shapeObj=new o.Object3D;var c=null;this.side==o.DoubleSide?c=new o.MeshDoubleLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:this.opacity<1,opacity:this.opacity,wireframeLinewidth:this.linewidth,vertexColors:o.Coloring.VertexColors}):c=new o.MeshLambertMaterial({wireframe:this.wireframe,side:this.side,transparent:this.opacity<1,opacity:this.opacity,wireframeLinewidth:this.linewidth,vertexColors:o.Coloring.VertexColors});var d=new o.Mesh(this.geo,c);if(this.shapeObj.add(d),this.linegeo&&this.linegeo.vertices>0){var j=new o.LineBasicMaterial({linewidth:this.linewidth,color:this.color}),et=new o.Line(this.linegeo,j,o.LineStyle.LinePieces);this.shapeObj.add(et)}this.renderedShapeObj=this.shapeObj.clone(),$.add(this.renderedShapeObj)}}removegl($){this.renderedShapeObj&&(this.renderedShapeObj.geometry!==void 0&&this.renderedShapeObj.geometry.dispose(),this.renderedShapeObj.material!==void 0&&this.renderedShapeObj.material.dispose(),$.remove(this.renderedShapeObj),this.renderedShapeObj=null),this.shapeObj=null}get position(){return this.boundingSphere.center}get x(){return this.boundingSphere.center.x}get y(){return this.boundingSphere.center.y}get z(){return this.boundingSphere.center.z}}ot.ISDONE=2,ot.drawCustom=function(ct,$,c){var d=c,j=d.vertexArr,et=d.faceArr;(j.length===0||et.length===0)&&console.warn("Error adding custom shape component: No vertices and/or face indices supplied!");var nt=c.color;typeof nt>"u"&&(nt=ct.color),nt=_.CC.color(nt);for(var ut=lt(d),b=0,it=ut.length;b<it;b++)ot.addCustomGeo(ct,$,ut[b],ut[b].colorArr?ut[b].colorArr:nt,c.clickable)};function lt(ct){var $=64e3;if(ct.vertexArr.length<$)return[ct];var c=[{vertexArr:[],normalArr:[],faceArr:[]}];ct.colorArr&&(c.colorArr=[]);var d=[],j=[],et=0,nt=ct.faceArr;for(let b=0,it=nt.length;b<it;b+=3){let rt=c[et];for(let dt=0;dt<3;dt++){var ut=nt[b+dt];d[ut]!==et&&(d[ut]=et,j[ut]=rt.vertexArr.length,rt.vertexArr.push(ct.vertexArr[ut]),ct.normalArr&&ct.normalArr[ut]&&rt.normalArr.push(ct.normalArr[ut]),ct.colorArr&&ct.colorArr[ut]&&rt.colorArr.push(ct.colorArr[ut])),rt.faceArr.push(j[ut])}rt.vertexArr.length>=$&&(c.push({vertexArr:[],normalArr:[],faceArr:[]}),ct.colorArr&&(c.colorArr=[]),et++)}return c}},"./src/GLViewer.ts"(e,i,s){s.r(i),s.d(i,{CONTEXTS_PER_VIEWPORT:()=>$,GLViewer:()=>d,createStereoViewer:()=>nt,createViewer:()=>j,createViewerGrid:()=>et});var o=s("./node_modules/upng-js/UPNG.js"),a=s("./src/GLModel.ts"),h=s("./src/GLShape.ts"),_=s("./src/Gradient.ts"),g=s("./src/Label.ts"),_e=s("./src/ProteinSurface4.ts"),st=s("./src/VolumeData.ts"),tt=s("./src/VolumetricRender.ts"),at=s("./src/WebGL/index.ts"),ot=s("./src/WebGL/math/index.ts"),lt=s("./src/colors.ts"),ct=s("./src/utilities.ts");const $=16;class c extends Array{constructor(b){super(...b)}getSymmetries(){if(this.length==0)return[];let b=this[0];return typeof b.symmetries>"u"&&this.setSymmetries([new ot.Matrix4]),b.symmetries}setSymmetries(b){typeof b>"u"&&(b=[new ot.Matrix4]);for(let it of this)it.symmetries=b,it.finished=!1}}class d{getWidth(){let b=this.container,it=b.offsetWidth;if(it==0&&b.style.display==="none"){let rt=b.style.position,dt=b.style.visibility;b.style.display="block",b.style.visibility="hidden",b.style.position="absolute",it=b.offsetWidth,b.style.display="none",b.style.visibility=dt,b.style.position=rt}return it}getHeight(){let b=this.container,it=b.offsetHeight;if(it==0&&b.style.display==="none"){let rt=b.style.position,dt=b.style.visibility;b.style.display="block",b.style.visibility="hidden",b.style.position="absolute",it=b.offsetHeight,b.style.display="none",b.style.visibility=dt,b.style.position=rt}return it}setupRenderer(){let b=Object.assign(Object.assign({},this.config),{preserveDrawingBuffer:!0,premultipliedAlpha:!1,containerWidth:this.WIDTH,containerHeight:this.HEIGHT});this.renderer=new at.Renderer(b),this.renderer.domElement.style.width="100%",this.renderer.domElement.style.height="100%",this.renderer.domElement.style.padding="0",this.renderer.domElement.style.position="absolute",this.renderer.domElement.style.top="0px",this.renderer.domElement.style.left="0px",this.renderer.domElement.style.zIndex="0"}initializeScene(){this.scene=new at.Scene,this.scene.fog=new at.Fog(this.bgColor,100,200),this.modelGroup=new at.Object3D,this.rotationGroup=new at.Object3D,this.rotationGroup.useQuaternion=!0,this.rotationGroup.quaternion=new ot.Quaternion(0,0,0,1),this.rotationGroup.add(this.modelGroup),this.scene.add(this.rotationGroup);var b=new at.Light(16777215);b.position=new ot.Vector3(.2,.2,1).normalize(),b.intensity=1,this.scene.add(b)}_handleLostContext(b){const it=function(rt){const dt=rt.getBoundingClientRect();return!(dt.right<0||dt.bottom<0||dt.top>(window.innerHeight||document.documentElement.clientHeight)||dt.left>(window.innerWidth||document.documentElement.clientWidth))};if(it(this.container)){let rt=0;for(let dt of document.getElementsByTagName("canvas"))if(it(dt)&&dt._3dmol_viewer!=null&&(dt._3dmol_viewer.resize(),rt+=1,rt>=$))break}}initContainer(b){this.container=b,this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight(),this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.renderer.setSize(this.WIDTH,this.HEIGHT),this.container.append(this.renderer.domElement),this.glDOM=this.renderer.domElement,this.glDOM._3dmol_viewer=this,this.glDOM.addEventListener("webglcontextlost",this._handleLostContext.bind(this)),this.nomouse||(this.glDOM.addEventListener("mousedown",this._handleMouseDown.bind(this),{passive:!1}),this.glDOM.addEventListener("touchstart",this._handleMouseDown.bind(this),{passive:!1}),this.glDOM.addEventListener("wheel",this._handleMouseScroll.bind(this),{passive:!1}),this.glDOM.addEventListener("mousemove",this._handleMouseMove.bind(this),{passive:!1}),this.glDOM.addEventListener("touchmove",this._handleMouseMove.bind(this),{passive:!1}),this.glDOM.addEventListener("contextmenu",this._handleContextMenu.bind(this),{passive:!1}))}decAnim(){this.animated--,this.animated<0&&(this.animated=0)}incAnim(){this.animated++}nextSurfID(){var b=0;for(let rt in this.surfaces)if(this.surfaces.hasOwnProperty(rt)){var it=parseInt(rt);isNaN(it)||it>b&&(b=it)}return b+1}setSlabAndFog(){let b=this.camera.position.z-this.rotationGroup.position.z;b<1&&(b=1),this.camera.near=b+this.slabNear,!this.camera.ortho&&this.camera.near<1&&(this.camera.near=1),this.camera.far=b+this.slabFar,this.camera.near+1>this.camera.far&&(this.camera.far=this.camera.near+1),this.camera.fov=this.fov,this.camera.right=b*Math.tan(Math.PI/180*this.fov),this.camera.left=-this.camera.right,this.camera.top=this.camera.right/this.ASPECT,this.camera.bottom=-this.camera.top,this.camera.updateProjectionMatrix(),this.scene.fog.near=this.camera.near+this.fogStart*(this.camera.far-this.camera.near),this.scene.fog.far=this.camera.near+this.fogEnd*(this.camera.far-this.camera.near),this.config.disableFog&&(this.scene.fog.near=this.scene.fog.far)}show(b){if(this.renderer.setViewport(),!!this.scene&&(this.setSlabAndFog(),this.renderer.render(this.scene,this.camera),this.viewChangeCallback&&this.viewChangeCallback(this._viewer.getView()),!b&&this.linkedViewers.length>0))for(var it=this._viewer.getView(),rt=0;rt<this.linkedViewers.length;rt++){var dt=this.linkedViewers[rt];dt.setView(it,!0)}}updateClickables(){this.clickables.splice(0,this.clickables.length),this.hoverables.splice(0,this.hoverables.length),this.contextMenuEnabledObjects.splice(0,this.contextMenuEnabledObjects.length);for(let b=0,it=this.models.length;b<it;b++){let rt=this.models[b];if(rt){let dt=rt.selectedAtoms({clickable:!0}),ft=rt.selectedAtoms({hoverable:!0}),mt=rt.selectedAtoms({contextMenuEnabled:!0});for(let yt=0;yt<ft.length;yt++)this.hoverables.push(ft[yt]);for(let yt=0;yt<dt.length;yt++)this.clickables.push(dt[yt]);for(let yt=0;yt<mt.length;yt++)this.contextMenuEnabledObjects.push(mt[yt])}}for(let b=0,it=this.shapes.length;b<it;b++){let rt=this.shapes[b];rt&&rt.clickable&&this.clickables.push(rt),rt&&rt.hoverable&&this.hoverables.push(rt),rt&&rt.contextMenuEnabled&&this.contextMenuEnabledObjects.push(rt)}}handleClickSelection(b,it,rt){let dt=this.targetedObjects(b,it,this.clickables);if(dt.length){var ft=dt[0].clickable;ft.callback!==void 0&&(typeof ft.callback!="function"&&(ft.callback=(0,ct.makeFunction)(ft.callback)),typeof ft.callback=="function"&&(this.mouseButton===3&&this.contextMenuEnabledObjects.includes(ft)&&this.userContextMenuHandler||ft.callback(ft,this._viewer,rt,this.container,dt)))}}canvasOffset(){let b=this.glDOM,it=b.getBoundingClientRect(),rt=b.ownerDocument,dt=rt.documentElement,ft=rt.defaultView;return{top:it.top+ft.pageYOffset-dt.clientTop,left:it.left+ft.pageXOffset-dt.clientLeft}}setHover(b,it,rt){this.current_hover!=b&&(this.current_hover&&(typeof this.current_hover.unhover_callback!="function"&&(this.current_hover.unhover_callback=(0,ct.makeFunction)(this.current_hover.unhover_callback)),this.current_hover.unhover_callback(this.current_hover,this._viewer,it,this.container,rt)),this.current_hover=b,b&&b.hover_callback!==void 0&&(typeof b.hover_callback!="function"&&(b.hover_callback=(0,ct.makeFunction)(b.hover_callback)),typeof b.hover_callback=="function"&&b.hover_callback(b,this._viewer,it,this.container,rt)))}handleHoverSelection(b,it,rt){if(this.hoverables.length==0)return;let dt=this.targetedObjects(b,it,this.hoverables);if(dt.length){var ft=dt[0].clickable;this.setHover(ft,rt,dt),this.current_hover=ft}else this.setHover(null)}handleHoverContinue(b,it){let rt=this.targetedObjects(b,it,this.hoverables);(rt.length==0||rt[0]===void 0)&&this.setHover(null),rt[0]!==void 0&&rt[0].clickable!==this.current_hover&&this.setHover(null)}closeEnoughForClick(b,{allowTolerance:it=b.targetTouches,tolerance:rt=5}={}){const dt=this.getX(b),ft=this.getY(b);if(it){const mt=Math.abs(dt-this.mouseStartX),yt=Math.abs(ft-this.mouseStartY);return mt<=rt&&yt<=rt}else return dt===this.mouseStartX&&ft===this.mouseStartY}calcTouchDistance(b){var it=b.targetTouches[0].pageX-b.targetTouches[1].pageX,rt=b.targetTouches[0].pageY-b.targetTouches[1].pageY;return Math.hypot(it,rt)}getX(b){var it=b.pageX;return it==null&&(it=b.pageX),b.targetTouches&&b.targetTouches[0]?it=b.targetTouches[0].pageX:b.changedTouches&&b.changedTouches[0]&&(it=b.changedTouches[0].pageX),it}getY(b){var it=b.pageY;return it==null&&(it=b.pageY),b.targetTouches&&b.targetTouches[0]?it=b.targetTouches[0].pageY:b.changedTouches&&b.changedTouches[0]&&(it=b.changedTouches[0].pageY),it}isInViewer(b,it){if(this.viewers!=null){var rt=this.WIDTH/this.cols,dt=this.HEIGHT/this.rows,ft=this.canvasOffset(),mt=b-ft.left,yt=it-ft.top,gt=this.rows-Math.floor(yt/dt)-1,_t=Math.floor(mt/rt);if(gt!=this.row||_t!=this.col)return!1}return!0}adjustZoomToLimits(b){if(this.config.lowerZoomLimit&&this.config.lowerZoomLimit>0){let it=this.CAMERA_Z-this.config.lowerZoomLimit;b>it&&(b=it)}if(this.config.upperZoomLimit&&this.config.upperZoomLimit>0){let it=this.CAMERA_Z-this.config.upperZoomLimit;b<it&&(b=it)}return b>this.CAMERA_Z-1&&(b=this.CAMERA_Z-1),b}static slerp(b,it,rt){if(rt==1)return it.clone();if(rt==0)return b.clone();let dt=b.x*it.x+b.y*it.y+b.z*it.z+b.w*it.w;if(dt>.9995){let Mt=new ot.Quaternion(b.x+rt*(it.x-b.x),b.y+rt*(it.y-b.y),b.z+rt*(it.z-b.z),b.w+rt*(it.w-b.w));return Mt.normalize(),Mt}dt<0&&(it=it.clone().multiplyScalar(-1),dt=-dt),dt>1?dt=1:dt<-1&&(dt=-1);var ft=Math.acos(dt),mt=ft*rt,yt=it.clone();yt.sub(b.clone().multiplyScalar(dt)),yt.normalize();var gt=Math.cos(mt),_t=Math.sin(mt),xt=new ot.Quaternion(b.x*gt+yt.x*_t,b.y*gt+yt.y*_t,b.z*gt+yt.z*_t,b.w*gt+yt.w*_t);return xt.normalize(),xt}constructor(b,it={}){if(this.nomouse=!1,this.glDOM=null,this.models=[],this.surfaces={},this.shapes=[],this.labels=[],this.clickables=[],this.hoverables=[],this.contextMenuEnabledObjects=[],this.current_hover=null,this.hoverDuration=500,this.longTouchDuration=1e3,this.viewer_frame=0,this.viewChangeCallback=null,this.stateChangeCallback=null,this.NEAR=1,this.FAR=800,this.CAMERA_Z=150,this.fov=20,this.linkedViewers=[],this.renderer=null,this.control_all=!1,this.scene=null,this.rotationGroup=null,this.modelGroup=null,this.fogStart=.4,this.fogEnd=1,this.slabNear=-50,this.slabFar=50,this.cq=new ot.Quaternion(0,0,0,1),this.dq=new ot.Quaternion(0,0,0,1),this.animated=0,this.animationTimers=new Set,this.isDragging=!1,this.mouseStartX=0,this.mouseStartY=0,this.touchDistanceStart=0,this.touchHold=!1,this.currentModelPos=0,this.cz=0,this.cslabNear=0,this.cslabFar=0,this.userContextMenuHandler=null,this.config=it,this.callback=this.config.callback,this.defaultcolors=this.config.defaultcolors,this.defaultcolors||(this.defaultcolors=lt.elementColors.defaultColors),this.nomouse=!!this.config.nomouse,this.bgColor=0,this.config.backgroundColor=this.config.backgroundColor||"#ffffff",typeof this.config.backgroundColor<"u"&&(this.bgColor=lt.CC.color(this.config.backgroundColor).getHex()),this.config.backgroundAlpha=this.config.backgroundAlpha==null?1:this.config.backgroundAlpha,this.camerax=0,typeof this.config.camerax<"u"&&(this.camerax=typeof this.config.camerax=="string"?parseFloat(this.config.camerax):this.config.camerax),this._viewer=this,this.container=b,this.config.hoverDuration!=null&&(this.hoverDuration=this.config.hoverDuration),this.config.antialias===void 0&&(this.config.antialias=!0),this.config.cartoonQuality===void 0&&(this.config.cartoonQuality=10),this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight(),this.setupRenderer(),this.row=this.config.row==null?0:this.config.row,this.col=this.config.col==null?0:this.config.col,this.cols=this.config.cols,this.rows=this.config.rows,this.viewers=this.config.viewers,this.control_all=this.config.control_all,this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.camera=new at.Camera(this.fov,this.ASPECT,this.NEAR,this.FAR,this.config.orthographic),this.camera.position=new ot.Vector3(this.camerax,0,this.CAMERA_Z),this.lookingAt=new ot.Vector3,this.camera.lookAt(this.lookingAt),this.raycaster=new at.Raycaster(new ot.Vector3(0,0,0),new ot.Vector3(0,0,0)),this.projector=new at.Projector,this.initializeScene(),this.renderer.setClearColorHex(this.bgColor,this.config.backgroundAlpha),this.scene.fog.color=lt.CC.color(this.bgColor),document.body.addEventListener("mouseup",this._handleMouseUp.bind(this)),document.body.addEventListener("touchend",this._handleMouseUp.bind(this)),this.initContainer(this.container),this.config.style&&this.setViewStyle(this.config),window.addEventListener("resize",this.resize.bind(this)),typeof window.ResizeObserver<"u"&&(this.divwatcher=new window.ResizeObserver(this.resize.bind(this)),this.divwatcher.observe(this.container)),typeof window.IntersectionObserver<"u"){let rt=(dt,ft)=>{dt.forEach(mt=>{mt.isIntersecting&&this.resize()})};this.intwatcher=new window.IntersectionObserver(rt),this.intwatcher.observe(this.container)}try{typeof this.callback=="function"&&this.callback(this)}catch(rt){console.log("error with glviewer callback: "+rt)}}targetedObjects(b,it,rt){var dt={x:b,y:it,z:-1};return Array.isArray(rt)||(rt=this.selectedAtoms(rt)),rt.length==0?[]:(this.raycaster.setFromCamera(dt,this.camera),this.raycaster.intersectObjects(this.modelGroup,rt))}modelToScreen(b){let it=!1;Array.isArray(b)||(b=[b],it=!0);let rt=this.renderer.getXRatio(),dt=this.renderer.getYRatio(),ft=this.col,mt=this.row,yt=ft*(this.WIDTH/rt),gt=(dt-mt-1)*(this.HEIGHT/dt),_t=[],xt=this.canvasOffset();return b.forEach(Mt=>{let wt=new ot.Vector3(Mt.x,Mt.y,Mt.z);wt.applyMatrix4(this.modelGroup.matrixWorld),this.projector.projectVector(wt,this.camera);let Et=this.WIDTH/rt*(wt.x+1)/2+xt.left+yt,At=-(this.HEIGHT/dt)*(wt.y-1)/2+xt.top+gt;_t.push({x:Et,y:At})}),it&&(_t=_t[0]),_t}screenOffsetToModel(b,it,rt){var dt=b/this.WIDTH,ft=it/this.HEIGHT,mt=rt===void 0?this.rotationGroup.position.z:rt,yt=this.rotationGroup.quaternion,gt=new ot.Vector3(0,0,mt);return this.projector.projectVector(gt,this.camera),gt.x+=dt*2,gt.y-=ft*2,this.projector.unprojectVector(gt,this.camera),gt.z=0,gt.applyQuaternion(yt),gt}screenToModelDistance(b,it){let rt=this.canvasOffset(),dt=new ot.Vector3(it.x,it.y,it.z);dt.applyMatrix4(this.modelGroup.matrixWorld);let ft=dt.clone();this.projector.projectVector(dt,this.camera);let mt=new ot.Vector3((b.x-rt.left)*2/this.WIDTH-1,(b.y-rt.top)*2/-this.HEIGHT+1,dt.z);return this.projector.unprojectVector(mt,this.camera),mt.distanceTo(ft)}setViewChangeCallback(b){(typeof b=="function"||b==null)&&(this.viewChangeCallback=b)}setStateChangeCallback(b){(typeof b=="function"||b==null)&&(this.stateChangeCallback=b)}getConfig(){return this.config}setConfig(b){this.config=b,b.ambientOcclusion&&this.renderer.enableAmbientOcclusion(b.ambientOcclusion)}getInternalState(){var b={models:[],surfaces:[],shapes:[],labels:[]};for(let it=0;it<this.models.length;it++)this.models[it]&&(b.models[it]=this.models[it].getInternalState());return b}setInternalState(b){this.clear();var it=b.models;for(let rt=0;rt<it.length;rt++)it[rt]&&(this.models[rt]=new a.GLModel(rt,void 0,this),this.models[rt].setInternalState(it[rt]));this.render()}setZoomLimits(b,it){typeof b<"u"&&(this.config.lowerZoomLimit=b),it&&(this.config.upperZoomLimit=it),this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z),this.show()}setCameraParameters(b){b.fov!==void 0&&(this.fov=b.fov,this.camera.fov=this.fov),b.z!==void 0&&(this.CAMERA_Z=b.z,this.camera.z=this.CAMERA_Z),b.orthographic!==void 0&&(this.camera.ortho=b.orthographic),this.setSlabAndFog()}_handleMouseDown(b){if(b.preventDefault(),!this.scene)return;var it=this.getX(b),rt=this.getY(b);if(it===void 0)return;this.isDragging=!0,this.mouseButton=b.which,this.mouseStartX=it,this.mouseStartY=rt,this.touchHold=!0,this.touchDistanceStart=0,b.targetTouches&&b.targetTouches.length==2&&(this.touchDistanceStart=this.calcTouchDistance(b)),this.cq=this.rotationGroup.quaternion.clone(),this.cz=this.rotationGroup.position.z,this.currentModelPos=this.modelGroup.position.clone(),this.cslabNear=this.slabNear,this.cslabFar=this.slabFar;let dt=this;b.targetTouches&&b.targetTouches.length===1&&(this.longTouchTimeout=setTimeout(function(){if(dt.touchHold==!0){dt.glDOM=dt.renderer.domElement;const ft=b.targetTouches[0],mt=new PointerEvent("contextmenu",Object.assign(Object.assign({},b),{pageX:ft.pageX,pageY:ft.pageY,screenX:ft.screenX,screenY:ft.screenY,clientX:ft.clientX,clientY:ft.clientY}));dt.glDOM.dispatchEvent(mt)}},this.longTouchDuration))}_handleMouseUp(b){if(this.touchHold=!1,this.isDragging&&this.scene){var it=this.getX(b),rt=this.getY(b);if(this.closeEnoughForClick(b)&&this.isInViewer(it,rt)){let dt=this.mouseXY(it,rt);this.handleClickSelection(dt.x,dt.y,b)}}this.isDragging=!1}_handleMouseScroll(b){if(b.preventDefault(),!!this.scene){var it=this.getX(b),rt=this.getY(b);if(it!==void 0&&!(!this.control_all&&!this.isInViewer(it,rt))){var dt=(this.CAMERA_Z-this.rotationGroup.position.z)*.85,ft=1;if(b.ctrlKey&&(ft=-1),b.detail)this.rotationGroup.position.z+=ft*dt*b.detail/10;else if(b.wheelDelta){let mt=b.wheelDelta*600/(b.wheelDelta+600);this.rotationGroup.position.z-=ft*dt*mt/400}this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z),this.show()}}}pngURI(){return this.getCanvas().toDataURL("image/png")}apngURI(b){let it=this;return b=b||1,new Promise(function(rt){let dt=0,ft=it.viewChangeCallback,mt=[],yt=[],gt=Date.now();it.viewChangeCallback=function(){yt.push(Date.now()-gt),gt=Date.now(),mt.push(new Promise(_t=>{it.getCanvas().toBlob(function(xt){xt.arrayBuffer().then(_t)},"image/png")})),dt+=1,dt==b&&(it.viewChangeCallback=ft,Promise.all(mt).then(_t=>{let xt=[];for(let bt=0;bt<_t.length;bt++){let Ct=(0,o.decode)(_t[bt]);xt.push((0,o.toRGBA8)(Ct)[0])}let Mt=it.getCanvas().width,wt=it.getCanvas().height,Et=(0,o.encode)(xt,Mt,wt,0,yt),At=new Blob([Et],{type:"image/png"}),St=new FileReader;St.onload=function(bt){rt(bt.target.result)},St.readAsDataURL(At)}))}})}getCanvas(){return this.glDOM}getRenderer(){return this.renderer}setHoverDuration(b){this.hoverDuration=b}mouseXY(b,it){let rt=this.canvasOffset(),dt=this.renderer.getXRatio(),ft=this.renderer.getYRatio(),mt=this.col,yt=this.row,gt=mt*(this.WIDTH/dt),_t=(ft-yt-1)*(this.HEIGHT/ft),xt=(b-rt.left-gt)/(this.WIDTH/dt)*2-1,Mt=-((it-rt.top-_t)/(this.HEIGHT/ft))*2+1;return{x:xt,y:Mt}}_handleMouseMove(b){clearTimeout(this.hoverTimeout),b.preventDefault();let it=this.getX(b),rt=this.getY(b);if(it===void 0)return;let dt=this.renderer.getXRatio(),ft=this.renderer.getYRatio(),mt=this.mouseXY(it,rt),yt=this;this.current_hover!==null&&this.handleHoverContinue(mt.x,mt.y);var gt=0;if(!(!this.control_all&&!this.isInViewer(it,rt))&&this.scene&&(this.hoverables.length>0&&(this.hoverTimeout=setTimeout(function(){yt.handleHoverSelection(mt.x,mt.y,b)},this.hoverDuration)),!!this.isDragging)){b.targetTouches&&(b.targetTouches.length>1||b.targetTouches.length===1&&!this.closeEnoughForClick(b))&&clearTimeout(this.longTouchTimeout);var _t=(it-this.mouseStartX)/this.WIDTH,xt=(rt-this.mouseStartY)/this.HEIGHT;if(this.touchDistanceStart!=0&&b.targetTouches&&b.targetTouches.length==2){var Mt=this.calcTouchDistance(b);gt=2,xt=(Mt-this.touchDistanceStart)*2/(this.WIDTH+this.HEIGHT)}else b.targetTouches&&b.targetTouches.length==3&&(gt=1);_t*=dt,xt*=ft;var wt=Math.hypot(_t,xt),Et;if(gt==3||this.mouseButton==3&&b.ctrlKey)this.slabNear=this.cslabNear+_t*100,this.slabFar=this.cslabFar-xt*100;else if(gt==2||this.mouseButton==3||b.shiftKey)Et=(this.CAMERA_Z-this.rotationGroup.position.z)*.85,Et<80&&(Et=80),this.rotationGroup.position.z=this.cz+xt*Et,this.rotationGroup.position.z=this.adjustZoomToLimits(this.rotationGroup.position.z);else if(gt==1||this.mouseButton==2||b.ctrlKey){var At=this.screenOffsetToModel(dt*(it-this.mouseStartX),ft*(rt-this.mouseStartY));this.modelGroup.position.addVectors(this.currentModelPos,At)}else if((gt===0||this.mouseButton==1)&&wt!==0){var St=Math.sin(wt*Math.PI)/wt;this.dq.x=Math.cos(wt*Math.PI),this.dq.y=0,this.dq.z=St*_t,this.dq.w=-St*xt,this.rotationGroup.quaternion.set(1,0,0,0),this.rotationGroup.quaternion.multiply(this.dq),this.rotationGroup.quaternion.multiply(this.cq)}this.show()}}_handleContextMenu(b){if(b.preventDefault(),this.closeEnoughForClick(b)){var dt=this.mouseStartX,ft=this.mouseStartY,rt=this.canvasOffset();let mt=this.mouseXY(dt,ft),yt=mt.x,gt=mt.y,_t=this.targetedObjects(yt,gt,this.contextMenuEnabledObjects);var it=null;_t.length&&(it=_t[0].clickable);var rt=this.canvasOffset(),dt=this.mouseStartX-rt.left,ft=this.mouseStartY-rt.top;this.userContextMenuHandler&&(this.userContextMenuHandler(it,dt,ft,_t,b),this.isDragging=!1)}}setContainer(b){let it=(0,ct.getElement)(b)||this.container;return this.initContainer(it),this}setBackgroundColor(b,it){(typeof it>"u"||it<0||it>1)&&(it=1);var rt=lt.CC.color(b);return this.scene.fog.color=rt,this.bgColor=rt.getHex(),this.renderer.setClearColorHex(rt.getHex(),it),this.show(),this}setProjection(b){this.camera.ortho=b==="orthographic",this.setSlabAndFog()}setViewStyle(b){if(b=b||{},b.style=b.style||"",b.style.includes("outline")?this.renderer.enableOutline(b):this.renderer.disableOutline(),b.style.includes("ambientOcclusion")){var it={};b.strength&&(it.strength=b.strength),b.radius&&(it.radius=b.radius),this.renderer.enableAmbientOcclusion(it)}else this.renderer.disableAmbientOcclusion();return this}updateSize(){this.renderer.setSize(this.WIDTH,this.HEIGHT),this.ASPECT=this.renderer.getAspect(this.WIDTH,this.HEIGHT),this.renderer.setSize(this.WIDTH,this.HEIGHT),this.camera.aspect=this.ASPECT,this.camera.updateProjectionMatrix()}setWidth(b){return this.WIDTH=b||this.WIDTH,this.updateSize(),this}setHeight(b){return this.HEIGHT=b||this.HEIGHT,this.updateSize(),this}resize(){this.WIDTH=this.getWidth(),this.HEIGHT=this.getHeight();let b=!1;if(this.renderer.isLost()&&this.WIDTH>0&&this.HEIGHT>0){let it=!1,rt=this.container.querySelector("canvas");rt&&rt!=this.renderer.getCanvas()?this.config.canvas=rt:(rt.remove(),this.config&&this.config.canvas!=null&&(delete this.config.canvas,it=!0)),this.setupRenderer(),this.initContainer(this.container),this.renderer.setClearColorHex(this.bgColor,this.config.backgroundAlpha),b=!0,it&&(this.config.canvas=this.renderer.getCanvas())}if(this.WIDTH==0||this.HEIGHT==0?this.animated&&this._viewer.pauseAnimate():this.animated&&this._viewer.resumeAnimate(),this.updateSize(),b){let it=this.renderer.supportedExtensions();if(it.regen=!0,this.viewers)for(let rt=0,dt=this.viewers.length;rt<dt;rt++)for(let ft=0,mt=this.viewers[rt].length;ft<mt;ft++)this.viewers[rt][ft].render(null,it);this._viewer.render(null,it)}else this.WIDTH>0&&this.HEIGHT>0&&this.show();return this}getModel(b){return b===void 0?this.models.length==0?null:this.models[this.models.length-1]:b instanceof a.GLModel?b:b in this.models?this.models[b]:this.models.length==0?null:this.models[this.models.length-1]}spin(b,it=1,rt=!1){if(clearInterval(this.spinInterval),typeof b>"u"&&(b="y"),typeof b=="boolean")if(b)b="y";else return;Array.isArray(b)&&(b={x:b[0],y:b[1],z:b[2]});var dt=this;this.spinInterval=setInterval(function(){!dt.getCanvas().isConnected&&dt.renderer.isLost()&&clearInterval(dt.spinInterval),(!rt||dt.container.checkVisibility&&dt.container.checkVisibility())&&dt.rotate(1*it,b)},25)}animateMotion(b,it,rt,dt,ft,mt){var yt=20,gt=Math.ceil(b/yt);gt<1&&(gt=1),this.incAnim();var _t={mpos:this.modelGroup.position.clone(),rz:this.rotationGroup.position.z,rot:this.rotationGroup.quaternion.clone(),cam:this.lookingAt.clone()};if(it){let wt=new Array(gt);for(let bt=0;bt<gt;bt++){let Ct=(bt+1)/gt,Nt={mpos:_t.mpos,rz:_t.rz,rot:_t.rot};Nt.mpos=rt.clone().sub(_t.mpos).multiplyScalar(Ct).add(_t.mpos),Nt.rz=_t.rz+Ct*(dt-_t.rz),Nt.rot=d.slerp(_t.rot,ft,Ct),Nt.cam=mt.clone().sub(_t.cam).multiplyScalar(Ct).add(_t.cam),wt[bt]=Nt}let Et=0,At=this,St=function(){var bt=wt[Et];Et+=1,At.modelGroup.position=bt.mpos,At.rotationGroup.position.z=bt.rz,At.rotationGroup.quaternion=bt.rot,At.camera.lookAt(bt.cam),Et<wt.length?setTimeout(St,yt):At.decAnim(),At.show()};setTimeout(St,yt)}else{var xt={};let wt=1/gt;if(rt&&(xt.mpos=rt.clone().sub(_t.mpos).multiplyScalar(wt)),typeof dt<"u"&&dt!=null&&(xt.rz=wt*(dt-_t.rz)),ft){var Mt=d.slerp(_t.rot,ft,wt);xt.rot=_t.rot.clone().inverse().multiply(Mt)}mt&&(xt.cam=mt.clone().sub(_t.cam).multiplyScalar(wt));let Et=0,At=this,St=function(){Et+=1,xt.mpos&&At.modelGroup.position.add(xt.mpos),xt.rz&&(At.rotationGroup.position.z+=xt.rz),xt.rot&&At.rotationGroup.quaternion.multiply(xt.rot),xt.cam&&(At.lookingAt.add(xt.cam),At.camera.lookAt(At.lookingAt)),Et<gt?setTimeout(St,yt):At.decAnim(),At.show()};setTimeout(St,yt)}}rotate(b,it="y",rt=0,dt=!1){if(it=="x"?it={x:1,y:0,z:0}:it=="y"?it={x:0,y:1,z:0}:it=="z"&&(it={x:0,y:0,z:1}),it=="vx"?it={vx:1,vy:0,vz:0}:it=="vy"?it={vx:0,vy:1,vz:0}:it=="vz"&&(it={vx:0,vy:0,vz:1}),typeof it.vx<"u"){var ft=new ot.Vector3(it.vx,it.vy,it.vz);ft.applyQuaternion(this.rotationGroup.quaternion),it={x:ft.x,y:ft.y,z:ft.z}}var mt=function(xt){var Mt=Math.sin(xt/2),wt=Math.cos(xt/2),Et=0,At=0,St=0;return Et=it.x*Mt,At=it.y*Mt,St=it.z*Mt,new ot.Quaternion(Et,At,St,wt).normalize()},yt=Math.PI*b/180,gt=mt(yt);if(rt){var _t=new ot.Quaternion().copy(this.rotationGroup.quaternion).multiply(gt);this.animateMotion(rt,dt,this.modelGroup.position,this.rotationGroup.position.z,_t,this.lookingAt)}else this.rotationGroup.quaternion.multiply(gt),this.show();return this}surfacesFinished(){for(var b in this.surfaces)if(!this.surfaces[b][0].done)return!1;return!0}getView(){if(!this.modelGroup)return[0,0,0,0,0,0,0,1];var b=this.modelGroup.position,it=this.rotationGroup.quaternion;return[b.x,b.y,b.z,this.rotationGroup.position.z,it.x,it.y,it.z,it.w]}setView(b,it){return b===void 0||!(b instanceof Array||b.length!==8)?this:!this.modelGroup||!this.rotationGroup?this:(this.modelGroup.position.x=b[0],this.modelGroup.position.y=b[1],this.modelGroup.position.z=b[2],this.rotationGroup.position.z=b[3],this.rotationGroup.quaternion.x=b[4],this.rotationGroup.quaternion.y=b[5],this.rotationGroup.quaternion.z=b[6],this.rotationGroup.quaternion.w=b[7],typeof b[8]<"u"&&(this.rotationGroup.position.x=b[8],this.rotationGroup.position.y=b[9]),this.show(it),this)}render(b,it){this.renderer.setViewport(),this.updateClickables();var rt=this.getView();this.stateChangeCallback&&this.stateChangeCallback(this.getInternalState());var dt,ft;for(it||(it=this.renderer.supportedExtensions()),dt=0;dt<this.models.length;dt++)this.models[dt]&&this.models[dt].globj(this.modelGroup,it);for(dt=0;dt<this.shapes.length;dt++)this.shapes[dt]&&(typeof this.shapes[dt].frame>"u"||this.viewer_frame<0||this.shapes[dt].frame<0||this.shapes[dt].frame==this.viewer_frame?this.shapes[dt].globj(this.modelGroup,it):this.shapes[dt].removegl(this.modelGroup));for(dt=0;dt<this.labels.length;dt++)it.regen&&(this.labels[dt].dispose(),this.modelGroup.remove(this.labels[dt].sprite),this.labels[dt].setContext(),this.modelGroup.add(this.labels[dt].sprite)),this.labels[dt]&&typeof this.labels[dt].frame<"u"&&this.labels[dt].frame>=0&&(this.modelGroup.remove(this.labels[dt].sprite),(this.viewer_frame<0||this.labels[dt].frame==this.viewer_frame)&&this.modelGroup.add(this.labels[dt].sprite));for(dt in this.surfaces)if(this.surfaces.hasOwnProperty(dt)){var mt=this.surfaces[dt];for(ft=0;ft<mt.length;ft++)if(mt.hasOwnProperty(ft)){var yt=mt[ft].geo;if(!mt[ft].finished||it.regen){yt.verticesNeedUpdate=!0,yt.elementsNeedUpdate=!0,yt.normalsNeedUpdate=!0,yt.colorsNeedUpdate=!0,yt.buffersNeedUpdate=!0,mt[ft].mat.needsUpdate=!0,mt[ft].done&&(mt[ft].finished=!0),mt[ft].lastGL&&this.modelGroup.remove(mt[ft].lastGL);var gt=null;if(mt[ft].mat instanceof at.LineBasicMaterial?gt=new at.Line(yt,mt[ft].mat):("wireframe"in mt.style&&mt.style.wireframe&&yt.setUpWireframe(),gt=new at.Mesh(yt,mt[ft].mat)),mt[ft].mat.transparent&&mt[ft].mat.opacity==0?gt.visible=!1:gt.visible=!0,mt[ft].symmetries.length>1||mt[ft].symmetries.length==1&&!mt[ft].symmetries[0].isIdentity()){var _t,xt=new at.Object3D;for(_t=0;_t<mt[ft].symmetries.length;_t++){var Mt=gt.clone();Mt.matrix=mt[ft].symmetries[_t],Mt.matrixAutoUpdate=!1,xt.add(Mt)}mt[ft].lastGL=xt,this.modelGroup.add(xt)}else mt[ft].lastGL=gt,this.modelGroup.add(gt)}}}return this.setView(rt),typeof b=="function"&&b(this),this}getModelList(b){let it=[];if(typeof b>"u"||typeof b.model>"u")for(let dt=0;dt<this.models.length;dt++)this.models[dt]&&it.push(this.models[dt]);else{let dt=b.model;Array.isArray(dt)||(dt=[dt]);for(let ft=0;ft<dt.length;ft++)if(typeof dt[ft]=="number"){var rt=dt[ft];rt<0&&(rt+=this.models.length),it.push(this.models[rt])}else it.push(dt[ft])}return it}getAtomsFromSel(b){var it=[];typeof b>"u"&&(b={});var rt=this.getModelList(b);for(let dt=0;dt<rt.length;dt++)it=it.concat(rt[dt].selectedAtoms(b));return it}atomIsSelected(b,it){typeof it>"u"&&(it={});for(var rt=this.getModelList(it),dt=0;dt<rt.length;dt++)if(rt[dt].atomIsSelected(b,it))return!0;return!1}selectedAtoms(b){return this.getAtomsFromSel(b)}getUniqueValues(b,it){typeof it>"u"&&(it={});var rt=this.getAtomsFromSel(it),dt={};for(var ft in rt)if(rt[ft].hasOwnProperty(b)){var mt=rt[ft][b];dt[mt]=!0}return Object.keys(dt)}pdbData(b){for(var it=this.getAtomsFromSel(b),rt="",dt=0,ft=it.length;dt<ft;++dt)rt+=it[dt].pdbline+`
`;return rt}zoom(b=2,it=0,rt=!1){var dt=(this.CAMERA_Z-this.rotationGroup.position.z)/b,ft=this.CAMERA_Z-dt;return it>0?this.animateMotion(it,rt,this.modelGroup.position,this.adjustZoomToLimits(ft),this.rotationGroup.quaternion,this.lookingAt):(this.rotationGroup.position.z=this.adjustZoomToLimits(ft),this.show()),this}translate(b,it,rt=0,dt=!1){var ft=b/this.WIDTH,mt=it/this.HEIGHT,yt=new ot.Vector3(0,0,-this.CAMERA_Z);this.projector.projectVector(yt,this.camera),yt.x-=ft,yt.y-=mt,this.projector.unprojectVector(yt,this.camera),yt.z=0;var gt=this.lookingAt.clone().add(yt);return rt>0?this.animateMotion(rt,dt,this.modelGroup.position,this.rotationGroup.position.z,this.rotationGroup.quaternion,gt):(this.lookingAt=gt,this.camera.lookAt(this.lookingAt),this.show()),this}translateScene(b,it,rt=0,dt=!1){var ft=this.screenOffsetToModel(b,it),mt=this.modelGroup.position.clone().add(ft);return rt>0?this.animateMotion(rt,dt,this.modelGroup.position,this.rotationGroup.position.z,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=mt,this.show()),this}fitSlab(b){b=b||{};var it=this.getAtomsFromSel(b),rt=(0,ct.getExtent)(it),dt=rt[1][0]-rt[0][0],ft=rt[1][1]-rt[0][1],mt=rt[1][2]-rt[0][2],yt=Math.hypot(dt,ft,mt);return yt<5&&(yt=5),this.slabNear=-yt/1.9,this.slabFar=yt/2,this}center(b={},it=0,rt=!1){var dt,ft,mt=this.getAtomsFromSel(b),yt=(0,ct.getExtent)(mt);(0,ct.isEmptyObject)(b)?(this.shapes.forEach(Ct=>{if(Ct&&Ct.boundingSphere&&Ct.boundingSphere.center){var Nt=Ct.boundingSphere.center,kt=Ct.boundingSphere.radius;kt>0?(mt.push(new ot.Vector3(Nt.x+kt,Nt.y,Nt.z)),mt.push(new ot.Vector3(Nt.x-kt,Nt.y,Nt.z)),mt.push(new ot.Vector3(Nt.x,Nt.y+kt,Nt.z)),mt.push(new ot.Vector3(Nt.x,Nt.y-kt,Nt.z)),mt.push(new ot.Vector3(Nt.x,Nt.y,Nt.z+kt)),mt.push(new ot.Vector3(Nt.x,Nt.y,Nt.z-kt))):mt.push(Nt)}}),yt=(0,ct.getExtent)(mt),dt=mt,ft=yt):(dt=this.getAtomsFromSel({}),ft=(0,ct.getExtent)(dt));var gt=new ot.Vector3(yt[2][0],yt[2][1],yt[2][2]),_t=ft[1][0]-ft[0][0],xt=ft[1][1]-ft[0][1],Mt=ft[1][2]-ft[0][2],wt=Math.hypot(_t,xt,Mt);wt<5&&(wt=5),this.slabNear=-wt/1.9,this.slabFar=wt/2,_t=yt[1][0]-yt[0][0],xt=yt[1][1]-yt[0][1],Mt=yt[1][2]-yt[0][2],wt=Math.hypot(_t,xt,Mt),wt<5&&(wt=5);for(var Et=25,At=0;At<mt.length;At++)if(mt[At]){var St=gt.distanceToSquared(mt[At]);St>Et&&(Et=St)}wt=Math.sqrt(Et)*2;var bt=gt.clone().multiplyScalar(-1);return it>0?this.animateMotion(it,rt,bt,this.rotationGroup.position.z,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=bt,this.show()),this}zoomTo(b={},it=0,rt=!1){let dt=this.getAtomsFromSel(b),ft=(0,ct.getExtent)(dt),mt=ft;if((0,ct.isEmptyObject)(b)){let Nt=dt&&dt.length;if(this.shapes.forEach(kt=>{if(kt&&kt.boundingSphere){if(kt.boundingSphere.box){let Zt=kt.boundingSphere.box;dt.push(new ot.Vector3(Zt.min.x,Zt.min.y,Zt.min.z)),dt.push(new ot.Vector3(Zt.max.x,Zt.max.y,Zt.max.z))}else if(kt.boundingSphere.center){var Ht=kt.boundingSphere.center,jt=kt.boundingSphere.radius;jt>0?(dt.push(new ot.Vector3(Ht.x+jt,Ht.y,Ht.z)),dt.push(new ot.Vector3(Ht.x-jt,Ht.y,Ht.z)),dt.push(new ot.Vector3(Ht.x,Ht.y+jt,Ht.z)),dt.push(new ot.Vector3(Ht.x,Ht.y-jt,Ht.z)),dt.push(new ot.Vector3(Ht.x,Ht.y,Ht.z+jt)),dt.push(new ot.Vector3(Ht.x,Ht.y,Ht.z-jt))):dt.push(Ht)}}}),mt=(0,ct.getExtent)(dt),!Nt)for(let kt=0;kt<3;kt++)ft[2][kt]=(mt[0][kt]+mt[1][kt])/2}else{let Nt=this.getAtomsFromSel({});mt=(0,ct.getExtent)(Nt)}var yt=new ot.Vector3(ft[2][0],ft[2][1],ft[2][2]),gt=mt[1][0]-mt[0][0],_t=mt[1][1]-mt[0][1],xt=mt[1][2]-mt[0][2],Mt=Math.hypot(gt,_t,xt);Mt<5&&(Mt=5),this.slabNear=-Mt/1.9,this.slabFar=Mt/2,Object.keys(b).length===0&&(this.slabNear=Math.min(-Mt*2,-50),this.slabFar=Math.max(Mt*2,50));var wt=this.config.minimumZoomToDistance||5;gt=ft[1][0]-ft[0][0],_t=ft[1][1]-ft[0][1],xt=ft[1][2]-ft[0][2],Mt=Math.hypot(gt,_t,xt),Mt<wt&&(Mt=wt);for(var Et=wt*wt,At=0;At<dt.length;At++)if(dt[At]){var St=yt.distanceToSquared(dt[At]);St>Et&&(Et=St)}Mt=Math.sqrt(Et)*2;var bt=yt.clone().multiplyScalar(-1),Ct=-(Mt*.5/Math.tan(Math.PI/180*this.camera.fov/2)-this.CAMERA_Z);return Ct=this.adjustZoomToLimits(Ct),it>0?this.animateMotion(it,rt,bt,Ct,this.rotationGroup.quaternion,this.lookingAt):(this.modelGroup.position=bt,this.rotationGroup.position.z=Ct,this.show()),this}setSlab(b,it){this.slabNear=b,this.slabFar=it}getSlab(){return{near:this.slabNear,far:this.slabFar}}addLabel(b,it={},rt,dt=!1){if(rt){var ft=(0,ct.getExtent)(this.getAtomsFromSel(rt));it.position={x:ft[2][0],y:ft[2][1],z:ft[2][2]}}var mt=new g.Label(b,it);return mt.setContext(),this.modelGroup.add(mt.sprite),this.labels.push(mt),dt||this.show(),mt}addResLabels(b,it,rt=!1){let dt=this.labels.length;return this.applyToModels("addResLabels",b,it,rt),this.show(),this.labels.slice(dt)}addPropertyLabels(b,it,rt){return this.applyToModels("addPropertyLabels",b,it,rt),this.show(),this}removeLabel(b){for(var it=0;it<this.labels.length;it++)if(this.labels[it]==b){this.labels.splice(it,1),b.dispose(),this.modelGroup.remove(b.sprite);break}return this.show(),this}removeAllLabels(){for(var b=0;b<this.labels.length;b++)this.labels[b]&&this.labels[b].sprite&&this.modelGroup.remove(this.labels[b].sprite);return this.labels.splice(0,this.labels.length),this.show(),this}hideAllLabels(){for(var b=0;b<this.labels.length;b++)this.labels[b]&&this.labels[b].hide();return this.show(),this}showAllLabels(){for(var b=0;b<this.labels.length;b++)this.labels[b]&&this.labels[b].show();return this.show(),this}setLabelStyle(b,it){return this.modelGroup.remove(b.sprite),b.dispose(),b.stylespec=it,b.setContext(),this.modelGroup.add(b.sprite),this.show(),b}setLabelText(b,it){return this.modelGroup.remove(b.sprite),b.dispose(),b.text=it,b.setContext(),this.modelGroup.add(b.sprite),this.show(),b}addShape(b){b=b||{};var it=new h.GLShape(b);return it.shapePosition=this.shapes.length,this.shapes.push(it),it}removeShape(b){if(!b)return this;for(b.removegl(this.modelGroup),delete this.shapes[b.shapePosition];this.shapes.length>0&&typeof this.shapes[this.shapes.length-1]>"u";)this.shapes.pop();return this}removeAllShapes(){for(var b=0;b<this.shapes.length;b++){var it=this.shapes[b];it&&it.removegl(this.modelGroup)}return this.shapes.splice(0,this.shapes.length),this}getSelectionCenter(b){if(b.hasOwnProperty("x")&&b.hasOwnProperty("y")&&b.hasOwnProperty("z"))return b;var it=this.getAtomsFromSel(b);if(it.length==0)return{x:0,y:0,z:0};var rt=(0,ct.getExtent)(it);return{x:rt[0][0]+(rt[1][0]-rt[0][0])/2,y:rt[0][1]+(rt[1][1]-rt[0][1])/2,z:rt[0][2]+(rt[1][2]-rt[0][2])/2}}addSphere(b){b=b||{},b.center=this.getSelectionCenter(b.center);var it=new h.GLShape(b);return it.shapePosition=this.shapes.length,it.addSphere(b),this.shapes.push(it),it.finalize(),it}addBox(b={}){b.corner!=null&&(b.corner=this.getSelectionCenter(b.corner)),b.center!=null&&(b.center=this.getSelectionCenter(b.center));var it=new h.GLShape(b);return it.shapePosition=this.shapes.length,it.addBox(b),this.shapes.push(it),it.finalize(),it}addArrow(b={}){b.start=this.getSelectionCenter(b.start),b.end=this.getSelectionCenter(b.end);var it=new h.GLShape(b);return it.shapePosition=this.shapes.length,it.addArrow(b),this.shapes.push(it),it.finalize(),it}addCylinder(b={}){b.start=this.getSelectionCenter(b.start),b.end=this.getSelectionCenter(b.end);var it=new h.GLShape(b);return it.shapePosition=this.shapes.length,b.dashed?it.addDashedCylinder(b):it.addCylinder(b),this.shapes.push(it),it.finalize(),it}addCurve(b={}){var it=new h.GLShape(b);return it.shapePosition=this.shapes.length,it.addCurve(b),this.shapes.push(it),it.finalize(),it}addLine(b={}){b.start=this.getSelectionCenter(b.start),b.end=this.getSelectionCenter(b.end),b.wireframe=!0;var it=new h.GLShape(b);return it.shapePosition=this.shapes.length,b.dashed?it=this.addLineDashed(b,it):it.addLine(b),this.shapes.push(it),it.finalize(),it}addUnitCell(b,it){b=this.getModel(b),it=it||{alabel:"a",blabel:"b",clabel:"c"},it.box=it.box||{},it.astyle=it.astyle||{color:"red",radius:.1,midpos:-1},it.bstyle=it.bstyle||{color:"green",radius:.1,midpos:-1},it.cstyle=it.cstyle||{color:"blue",radius:.1,midpos:-1},it.alabelstyle=it.alabelstyle||{fontColor:"red",showBackground:!1,alignment:"center",inFront:!1},it.blabelstyle=it.blabelstyle||{fontColor:"green",showBackground:!1,alignment:"center",inFront:!1},it.clabelstyle=it.clabelstyle||{fontColor:"blue",showBackground:!1,alignment:"center",inFront:!1},b.unitCellObjects&&this.removeUnitCell(b),b.unitCellObjects={shapes:[],labels:[]};var rt=b.getCrystData(),dt=null;if(rt){if(rt.matrix)dt=rt.matrix;else{var ft=rt.a,mt=rt.b,yt=rt.c,gt=rt.alpha,_t=rt.beta,xt=rt.gamma;gt=gt*Math.PI/180,_t=_t*Math.PI/180,xt=xt*Math.PI/180;var Mt,wt,Et;Mt=Math.cos(_t),wt=(Math.cos(gt)-Math.cos(_t)*Math.cos(xt))/Math.sin(xt),Et=Math.sqrt(Math.max(0,1-Mt*Mt-wt*wt)),dt=new ot.Matrix3(ft,mt*Math.cos(xt),yt*Mt,0,mt*Math.sin(xt),yt*wt,0,0,yt*Et)}var At=[new ot.Vector3(0,0,0),new ot.Vector3(1,0,0),new ot.Vector3(0,1,0),new ot.Vector3(0,0,1),new ot.Vector3(1,1,0),new ot.Vector3(0,1,1),new ot.Vector3(1,0,1),new ot.Vector3(1,1,1)];if(rt.matrix4)for(let bt=0;bt<At.length;bt++)rt.size&&At[bt].multiplyVectors(At[bt],rt.size),At[bt]=At[bt].applyMatrix4(rt.matrix4);else for(let bt=0;bt<At.length;bt++)At[bt]=At[bt].applyMatrix3(dt);if(it.box&&!it.box.hidden){it.box.wireframe=!0;var St=new h.GLShape(it.box);St.shapePosition=this.shapes.length,St.addLine({start:At[0],end:At[1]}),St.addLine({start:At[0],end:At[2]}),St.addLine({start:At[1],end:At[4]}),St.addLine({start:At[2],end:At[4]}),St.addLine({start:At[0],end:At[3]}),St.addLine({start:At[3],end:At[5]}),St.addLine({start:At[2],end:At[5]}),St.addLine({start:At[1],end:At[6]}),St.addLine({start:At[4],end:At[7]}),St.addLine({start:At[6],end:At[7]}),St.addLine({start:At[3],end:At[6]}),St.addLine({start:At[5],end:At[7]}),this.shapes.push(St),b.unitCellObjects.shapes.push(St),St.finalize()}if(!it.astyle.hidden){it.astyle.start=At[0],it.astyle.end=At[1];let bt=this.addArrow(it.astyle);b.unitCellObjects.shapes.push(bt)}if(!it.bstyle.hidden){it.bstyle.start=At[0],it.bstyle.end=At[2];let bt=this.addArrow(it.bstyle);b.unitCellObjects.shapes.push(bt)}if(!it.cstyle.hidden){it.cstyle.start=At[0],it.cstyle.end=At[3];let bt=this.addArrow(it.cstyle);b.unitCellObjects.shapes.push(bt)}if(it.alabel){it.alabelstyle.position=At[1];let bt=this.addLabel(it.alabel,it.alabelstyle);b.unitCellObjects.labels.push(bt)}if(it.blabel){it.blabelstyle.position=At[2];let bt=this.addLabel(it.blabel,it.blabelstyle);b.unitCellObjects.labels.push(bt)}if(it.clabel){it.clabelstyle.position=At[3];let bt=this.addLabel(it.clabel,it.clabelstyle);b.unitCellObjects.labels.push(bt)}}}removeUnitCell(b){if(b=this.getModel(b),b.unitCellObjects){let it=this;b.unitCellObjects.shapes.forEach(function(rt){it.removeShape(rt)}),b.unitCellObjects.labels.forEach(function(rt){it.removeLabel(rt)})}delete b.unitCellObjects}replicateUnitCell(b=3,it=b,rt=it,dt,ft,mt){dt=this.getModel(dt);let yt=dt.getCrystData();if(yt){const gt=dt.selectedAtoms({}),_t=yt.matrix;let xt=function(wt){return wt%2==0?-wt/2:Math.ceil(wt/2)};b<=1&&it<=1&&rt<=1&&(mt=!0,b=it=rt=3);let Mt=function(wt,Et,At){return!1};if(mt){const wt=new ot.Matrix3().getInverse3(_t);Mt=function(Et,At,St){let bt=new ot.Vector3(Et,At,St).applyMatrix3(wt);return!(bt.x>-1e-4&&bt.x<1.0001&&bt.y>-1e-4&&bt.y<1.0001&&bt.z>-1e-4&&bt.z<1.0001)}}for(let wt=0;wt<b;wt++)for(let Et=0;Et<it;Et++)for(let At=0;At<rt;At++){if(wt==0&&Et==0&&At==0)continue;let St=new ot.Vector3(xt(wt),xt(Et),xt(At));St.applyMatrix3(_t);let bt=[];for(let Ct=0;Ct<gt.length;Ct++){let Nt=gt[Ct].x+St.x,kt=gt[Ct].y+St.y,Ht=gt[Ct].z+St.z;if(Mt(Nt,kt,Ht))continue;let jt={};for(let Zt in gt[Ct])jt[Zt]=gt[Ct][Zt];jt.x=Nt,jt.y=kt,jt.z=Ht,bt.push(jt)}dt.addAtoms(bt)}ft&&dt.assignBonds()}}addLineDashed(b,it){b.dashLength=b.dashLength||.5,b.gapLength=b.gapLength||.5;var rt;b.start?rt=new ot.Vector3(b.start.x||0,b.start.y||0,b.start.z||0):rt=new ot.Vector3(0,0,0);var dt;b.end?dt=new ot.Vector3(b.end.x,b.end.y||0,b.end.z||0):dt=new ot.Vector3(0,0,0);var ft=new ot.Vector3,mt=new ot.Vector3,yt=new ot.Vector3,gt,_t,xt,Mt=rt.clone(),wt=0;for(ft.subVectors(dt,rt),gt=ft.length(),ft.normalize(),mt=ft.clone(),yt=ft.clone(),mt.multiplyScalar(b.dashLength),yt.multiplyScalar(b.gapLength),_t=mt.length(),xt=yt.length();wt<gt;){if(wt+_t>gt){b.start=rt,b.end=dt,it.addLine(b);break}Mt.addVectors(rt,mt),b.start=rt,b.end=Mt,it.addLine(b),rt=Mt.clone(),wt+=_t,Mt.addVectors(rt,yt),rt=Mt.clone(),wt+=xt}return it.finalize(),it}addCustom(b){b=b||{};var it=new h.GLShape(b);return it.shapePosition=this.shapes.length,it.addCustom(b),this.shapes.push(it),it.finalize(),it}addVolumetricData(b,it,rt={}){var dt=new st.VolumeData(b,it);return rt.hasOwnProperty("transferfn")?this.addVolumetricRender(dt,rt):this.addIsosurface(dt,rt)}addIsosurface(b,it={},rt){var dt=new h.GLShape(it);return dt.shapePosition=this.shapes.length,dt.addIsosurface(b,it,rt,this),this.shapes.push(dt),dt}addVolumetricRender(b,it){it=it||{};var rt=new tt.GLVolumetricRender(b,it,this);return rt.shapePosition=this.shapes.length,this.shapes.push(rt),rt}hasVolumetricRender(){return this.renderer.supportsVolumetric()}enableFog(b){if(b){this.scene.fog=new at.Fog(this.bgColor,100,200),this.config.disableFog=!1;const it=b;it.fogStart==null?this.fogStart=.4:this.fogStart=it.fogStart,it.fogEnd==null?this.fogEnd=1:this.fogEnd=it.fogEnd}else this.config.disableFog=!0,this.show()}setFrame(b){this.viewer_frame=b;let it=this;return new Promise(function(rt){var dt=it.models.map(function(ft){return ft.setFrame(b)});Promise.all(dt).then(function(){rt()})})}getFrame(){return this.viewer_frame}getNumFrames(){var b=0;for(let it=0;it<this.models.length;it++)this.models[it].getNumFrames()>b&&(b=this.models[it].getNumFrames());for(let it=0;it<this.shapes.length;it++)this.shapes[it].frame&&this.shapes[it].frame>=b&&(b=this.shapes[it].frame+1);for(let it=0;it<this.labels.length;it++)this.labels[it].frame&&this.labels[it].frame>=b&&(b=this.labels[it].frame+1);return b}getNextModelId(){return this.models.length}animate(b){this.incAnim();var it=100,rt="forward",dt=1/0;b=b||{},b.interval&&(it=b.interval),b.loop&&(rt=b.loop),b.reps&&(dt=b.reps);var ft=this.getNumFrames(),mt=this,yt=0;b.startFrame&&(yt=b.startFrame%ft);var gt=1;b.step&&(gt=b.step,dt/=gt);var _t=0,xt=ft*dt,Mt=new Date,wt,Et,At=function(St){Mt=new Date,St=="forward"?mt.setFrame(yt).then(function(){yt=(yt+gt)%ft,wt()}):St=="backward"?mt.setFrame(ft-1-yt).then(function(){yt=(yt+gt)%ft,wt()}):mt.setFrame(yt).then(function(){yt+=gt,gt*=yt%(ft-1)==0?-1:1,wt()})};return wt=function(){if(mt.render(),!mt.getCanvas().isConnected)mt.stopAnimate();else if(++_t>=xt||!mt.isAnimated())Et.cancel(),mt.animationTimers.delete(Et),mt.decAnim();else{var St=it-(new Date().getTime()-Mt.getTime());St=St>0?St:0,Et.cancel(),mt.animationTimers.delete(Et),Et=new ct.PausableTimer(At,St,rt),mt.animationTimers.add(Et)}},Et=new ct.PausableTimer(At,0,rt),this.animationTimers.add(Et),this}stopAnimate(){return this.animated=0,this.animationTimers.forEach(function(b){b.cancel()}),this.animationTimers=new Set,this}pauseAnimate(){return this.animationTimers.forEach(function(b){b.pause()}),this}resumeAnimate(){return this.animationTimers.forEach(function(b){b.resume()}),this}isAnimated(){return this.animated>0}getModelOpt(b){return b&&!b.defaultcolors?(b.defaultcolors=this.defaultcolors,b.cartoonQuality=b.cartoonQuality||this.config.cartoonQuality):typeof b>"u"&&(b={defaultcolors:this.defaultcolors,cartoonQuality:this.config.cartoonQuality}),b}addModel(b,it="",rt){rt=this.getModelOpt(rt);var dt=new a.GLModel(this.models.length,rt,this);return dt.addMolData(b,it,rt),this.models.push(dt),dt}addModels(b,it,rt){rt=this.getModelOpt(rt),rt.multimodel=!0,rt.frames=!0;for(var dt=a.GLModel.parseMolData(b,it,rt),ft=0;ft<dt.length;ft++){var mt=new a.GLModel(this.models.length,rt,this);mt.setAtomDefaults(dt[ft]),mt.addFrame(dt[ft]),mt.setFrame(0),dt.modelData&&mt.setModelData(dt.modelData[ft]),mt.setDontDuplicateAtoms(!rt.duplicateAssemblyAtoms),this.models.push(mt)}return this.models}addModelsAsFrames(b,it,rt){rt=this.getModelOpt(rt),rt.multimodel=!0,rt.frames=!0;var dt=new a.GLModel(this.models.length,rt,this);return dt.addMolData(b,it,rt),this.models.push(dt),dt}addAsOneMolecule(b,it,rt){rt=this.getModelOpt(rt),rt.multimodel=!0,rt.onemol=!0;var dt=new a.GLModel(this.models.length,rt,this);return dt.addMolData(b,it,rt),this.models.push(dt),dt}removeModel(b){if(b=this.getModel(b),!!b){for(b.removegl(this.modelGroup),delete this.models[b.getID()];this.models.length>0&&typeof this.models[this.models.length-1]>"u";)this.models.pop();return this}}removeAllModels(){for(var b=0;b<this.models.length;b++){var it=this.models[b];it&&it.removegl(this.modelGroup)}return this.models.splice(0,this.models.length),this}exportJSON(b,it){var rt={};return it===void 0?rt.m=this.models.map(function(dt){return dt.toCDObject(b)}):rt.m=[this.models[it].toCDObject()],JSON.stringify(rt)}exportVRML(){var b=this.modelGroup;this.applyToModels("removegl",this.modelGroup),this.modelGroup=new at.Object3D,this.render(null,{supportsImposters:!1,supportsAIA:!1,regen:!0});var it=`#VRML V2.0 utf8
`+this.modelGroup.vrml()+`
`;return this.applyToModels("removegl",this.modelGroup),this.modelGroup=b,it}createModelFrom(b,it=!1){for(var rt=new a.GLModel(this.models.length,this.defaultcolors,this),dt=0;dt<this.models.length;dt++)if(this.models[dt]){var ft=this.models[dt].selectedAtoms(b);rt.addAtoms(ft),it&&this.models[dt].removeAtoms(ft)}return this.models.push(rt),rt}applyToModels(b,it,rt,dt,ft,mt,yt){for(var gt=this.getModelList(it),_t=0;_t<gt.length;_t++)gt[_t][b](it,rt,dt,ft,mt,yt)}setStyle(b,it){return typeof it>"u"&&(it=b,b={}),this.applyToModels("setStyle",b,it,!1),this}addStyle(b,it){return typeof it>"u"&&(it=b,b={}),this.applyToModels("setStyle",b,it,!0),this}setClickable(b,it,rt){return this.applyToModels("setClickable",b,it,rt),this}setHoverable(b,it,rt,dt){return this.applyToModels("setHoverable",b,it,rt,dt),this}enableContextMenu(b,it){return this.applyToModels("enableContextMenu",b,it),this}vibrate(b,it,rt,dt){return this.applyToModels("vibrate",b,it,rt,dt),this}setColorByProperty(b,it,rt,dt){return this.applyToModels("setColorByProperty",b,it,rt,dt),this}setColorByElement(b,it){return this.applyToModels("setColorByElement",b,it),this}static getAtomsWithin(b,it){var rt=[];for(let ft=0;ft<b.length;ft++){var dt=b[ft];typeof dt>"u"||dt.x<it[0][0]||dt.x>it[1][0]||dt.y<it[0][1]||dt.y>it[1][1]||dt.z<it[0][2]||dt.z>it[1][2]||rt.push(dt)}return rt}static volume(b){var it=b[1][0]-b[0][0],rt=b[1][1]-b[0][1],dt=b[1][2]-b[0][2];return it*rt*dt}carveUpExtent(b,it,rt){let dt=[],ft={};for(let Mt=0,wt=it.length;Mt<wt;Mt++)ft[it[Mt].index]=Mt;let mt=function(Mt){let wt=[];for(let Et=0,At=Mt.length;Et<At;Et++)Mt[Et].index in ft&&wt.push(ft[Mt[Et].index]);return wt},yt=function(Mt){let wt=[];return wt[0]=[Mt[0][0],Mt[0][1],Mt[0][2]],wt[1]=[Mt[1][0],Mt[1][1],Mt[1][2]],wt},gt=function(Mt){if(d.volume(Mt)<d.maxVolume)return[Mt];var wt=Mt[1][0]-Mt[0][0],Et=Mt[1][1]-Mt[0][1],At=Mt[1][2]-Mt[0][2],St;wt>Et&&wt>At?St=0:Et>wt&&Et>At?St=1:St=2;var bt=yt(Mt),Ct=yt(Mt),Nt=(Mt[1][St]-Mt[0][St])/2+Mt[0][St];bt[1][St]=Nt,Ct[0][St]=Nt;var kt=gt(bt),Ht=gt(Ct);return kt.concat(Ht)},_t=gt(b),xt=6;for(let Mt=0,wt=_t.length;Mt<wt;Mt++){let Et=yt(_t[Mt]);Et[0][0]-=xt,Et[0][1]-=xt,Et[0][2]-=xt,Et[1][0]+=xt,Et[1][1]+=xt,Et[1][2]+=xt;let At=d.getAtomsWithin(it,Et),St=d.getAtomsWithin(rt,_t[Mt]);dt.push({extent:_t[Mt],atoms:mt(At),toshow:mt(St)})}return dt}static generateSurfaceMesh(b,it,rt){var dt=new at.Geometry(!0),ft=dt.updateGeoGroup(0),mt=[];for(let Vt=0,tr=b.length;Vt<tr;Vt++){var yt=b[Vt];yt&&(typeof yt.surfaceColor<"u"?mt[Vt]=yt.surfaceColor:yt.color&&(mt[Vt]=lt.CC.color(yt.color)))}var gt=ft.vertexArray,_t=it.vertices;for(let Vt=0,tr=_t.length;Vt<tr;Vt++){let mr=ft.vertices*3;gt[mr]=_t[Vt].x,gt[mr+1]=_t[Vt].y,gt[mr+2]=_t[Vt].z,ft.vertices++}var xt=ft.colorArray;let Mt=ft.atomArray;if(rt.voldata&&rt.volscheme){var wt=rt.volscheme,Et=rt.voldata,At=wt.range()||[-1,1];for(let Vt=0,tr=_t.length;Vt<tr;Vt++){let mr=_t[Vt].atomid,wr=Et.getVal(_t[Vt].x,_t[Vt].y,_t[Vt].z),Er=lt.CC.color(wt.valueToHex(wr,At)),Sr=Vt*3;xt[Sr]=Er.r,xt[Sr+1]=Er.g,xt[Sr+2]=Er.b,Mt[Vt]=b[mr]}}else if(mt.length>0)for(let Vt=0,tr=_t.length;Vt<tr;Vt++){let mr=_t[Vt].atomid,wr=Vt*3;xt[wr]=mt[mr].r,xt[wr+1]=mt[mr].g,xt[wr+2]=mt[mr].b,Mt[Vt]=b[mr]}var St=it.faces;ft.faceidx=St.length,dt.initTypedArrays();var bt=ft.vertexArray,Ct=ft.normalArray,Nt,kt,Ht,jt;for(let Vt=0,tr=St.length;Vt<tr;Vt+=3){var Zt=St[Vt],Xt=St[Vt+1],Kt=St[Vt+2],ar=Zt*3,or=Xt*3,_r=Kt*3;Nt=new ot.Vector3(bt[ar],bt[ar+1],bt[ar+2]),kt=new ot.Vector3(bt[or],bt[or+1],bt[or+2]),Ht=new ot.Vector3(bt[_r],bt[_r+1],bt[_r+2]),Ht.subVectors(Ht,kt),Nt.subVectors(Nt,kt),Ht.cross(Nt),jt=Ht,jt.normalize(),Ct[ar]+=jt.x,Ct[or]+=jt.x,Ct[_r]+=jt.x,Ct[ar+1]+=jt.y,Ct[or+1]+=jt.y,Ct[_r+1]+=jt.y,Ct[ar+2]+=jt.z,Ct[or+2]+=jt.z,Ct[_r+2]+=jt.z}ft.faceArray=new Uint16Array(St);var nr=new at.Mesh(dt,rt);return nr}static generateMeshSyncHelper(b,it,rt,dt,ft,mt){var yt=new _e.ProteinSurface;return yt.initparm(it,b!==1,mt),yt.fillvoxels(ft,rt),yt.buildboundary(),(b==_e.SurfaceType.SES||b==_e.SurfaceType.MS)&&(yt.fastdistancemap(),yt.boundingatom(!1),yt.fillvoxelswaals(ft,rt)),yt.marchingcube(b),yt.getFacesAndVertices(dt)}static getMatWithStyle(b){let it=null;b.onesided?it=new at.MeshLambertMaterial:it=new at.MeshDoubleLambertMaterial,it.vertexColors=at.Coloring.VertexColors;for(var rt in b)rt==="color"||rt==="map"||b.hasOwnProperty(rt)&&(it[rt]=b[rt]);return b.opacity!==void 0&&(b.opacity===1?it.transparent=!1:it.transparent=!0),b.wireframe!==void 0&&(it.wireframe=b.wireframe),it}addMesh(b){let it={geo:b.geometry,mat:b.material,done:!0,finished:!1};var rt=this.nextSurfID();return this.surfaces[rt]=new c([it]),rt}static shallowCopy(b){var it=[];let rt=b.length;for(let dt=0;dt<rt;dt++)it[dt]=(0,ct.extend)({},b[dt]);return it}addSurface(b,it={},rt={},dt,ft,mt){let yt=this.nextSurfID(),gt=null,_t=this,xt=_e.SurfaceType.VDW;typeof b=="string"?d.surfaceTypeMap[b.toUpperCase()]!==void 0?xt=d.surfaceTypeMap[b]:console.log("Surface type : "+b+" is not recognized"):typeof b=="number"&&(xt=b);var Mt=null,wt=null,Et=d.shallowCopy(this.getAtomsFromSel(rt));dt?Mt=d.shallowCopy(this.getAtomsFromSel(dt)):Mt=Et,(0,ct.adjustVolumeStyle)(it);var At=!1,St;for(St=0;St<this.models.length;St++)if(this.models[St]){var bt=this.models[St].getSymmetries();if(bt.length>1||bt.length==1&&!bt[0].isIdentity()){At=!0;break}}var Ct=function(Kt,ar,or){ft?wt=d.shallowCopy(_t.getAtomsFromSel(ft)):wt=or;var _r,nr=(0,ct.getExtent)(or,!0);if(it.map&&it.map.prop){var Vt=it.map.prop;let Tr=(0,_.getGradient)(it.map.scheme||it.map.gradient||new _.Gradient.RWB),Cr=Tr.range();Cr||(Cr=(0,ct.getPropertyRange)(or,Vt)),it.colorscheme={prop:Vt,gradient:Tr}}for(let Tr=0,Cr=ar.length;Tr<Cr;Tr++)_r=ar[Tr],_r.surfaceColor=(0,ct.getColorFromStyle)(_r,it);var tr=d.volume(nr),mr=_t.carveUpExtent(nr,ar,or);if(wt&&wt.length&&wt.length>0){var wr=(0,ct.getExtent)(wt,!0),Er=function(Tr,Cr){var Pt=function(rr,Jt){var cr=rr.extent,dr=cr[1][0]-cr[0][0],Dt=cr[1][1]-cr[0][1],Gt=cr[1][2]-cr[0][2],er=dr-Jt[2][0];er*=er;var fr=Dt-Jt[2][1];fr*=fr;var Ut=Gt-Jt[2][2];return Ut*=Ut,er+fr+Ut},Ot=Pt(Tr,wr),zt=Pt(Cr,wr);return Ot-zt};mr.sort(Er)}var Sr=[];for(let Tr=0,Cr=ar.length;Tr<Cr;Tr++)_r=ar[Tr],Sr[Tr]={x:_r.x,y:_r.y,z:_r.z,serial:Tr,elem:_r.elem};var br=!!_e.syncSurface;if((typeof $3Dmol>"u"||typeof $3Dmol.SurfaceWorker>"u")&&(console.log("$3Dmol.SurfaceWorker is not defined, using synchronous surface generation."),br=!0),br){var gr=function(Cr){return new Promise(function(Pt){for(var Ot=d.generateMeshSyncHelper(xt,mr[Cr].extent,mr[Cr].atoms,mr[Cr].toshow,Sr,tr),zt=(0,h.splitMesh)({vertexArr:Ot.vertices,faceArr:Ot.faces}),rr=0,Jt=zt.length;rr<Jt;rr++){Ot={vertices:zt[rr].vertexArr,faces:zt[rr].faceArr};var cr=d.generateSurfaceMesh(ar,Ot,gt);(0,ct.mergeGeos)(Kt.geo,cr)}_t.render(),Pt()})},xr=[];for(let Tr=0;Tr<mr.length;Tr++)xr.push(gr(Tr));return Promise.all(xr).then(function(){return Kt.done=!0,_t.render(),Promise.resolve(yt)})}else{var vr=[];xt<0&&(xt=0);for(let Tr=0,Cr=d.numWorkers;Tr<Cr;Tr++){var pr=new Worker($3Dmol.SurfaceWorker);vr.push(pr),pr.postMessage({type:-1,atoms:Sr,volume:tr})}return new Promise(function(Tr,Cr){var Pt=0,Ot=function(){!vr||!vr.length||vr.forEach(function(cr){cr&&cr.terminate&&cr.terminate()})},zt=function(cr){for(var dr=(0,h.splitMesh)({vertexArr:cr.data.vertices,faceArr:cr.data.faces}),Dt=0,Gt=dr.length;Dt<Gt;Dt++){var er={vertices:dr[Dt].vertexArr,faces:dr[Dt].faceArr},fr=d.generateSurfaceMesh(ar,er,gt);(0,ct.mergeGeos)(Kt.geo,fr)}_t.render(),Pt++,Pt==mr.length&&(Kt.done=!0,Ot(),Tr(yt))},rr=function(cr){Ot(),console.log(cr.message+" ("+cr.filename+":"+cr.lineno+")"),Cr(cr)};for(let cr=0;cr<mr.length;cr++){var Jt=vr[cr%vr.length];Jt.onmessage=zt,Jt.onerror=rr,Jt.postMessage({type:xt,expandedExtent:mr[cr].extent,extendedAtoms:mr[cr].atoms,atomsToShow:mr[cr].toshow})}})}};it=it||{},gt=d.getMatWithStyle(it);let Nt=new c([]);Nt.style=it,Nt.atomsel=rt,Nt.allsel=dt,Nt.focus=ft;var kt=null;if(At){var Ht={},jt={};for(St=0;St<this.models.length;St++)Ht[St]=[],jt[St]=[];for(St=0;St<Mt.length;St++)Ht[Mt[St].model].push(Mt[St]);for(St=0;St<Et.length;St++)jt[Et[St].model].push(Et[St]);var Zt=[];for(St=0;St<this.models.length;St++)jt[St].length>0&&(Nt.push({geo:new at.Geometry(!0),mat:gt,done:!1,finished:!1,symmetries:this.models[St].getSymmetries()}),Zt.push(Ct(Nt[Nt.length-1],Ht[St],jt[St])));kt=Promise.all(Zt)}else Nt.push({geo:new at.Geometry(!0),mat:gt,done:!1,finished:!1,symmetries:[new ot.Matrix4]}),kt=Ct(Nt[Nt.length-1],Mt,Et);return this.surfaces[yt]=Nt,kt.surfid=yt,mt&&typeof mt=="function"?(kt.then(function(Xt){mt(Xt)}),yt):kt}setSurfaceMaterialStyle(b,it){if((0,ct.adjustVolumeStyle)(it),this.surfaces[b]){var rt=this.surfaces[b];for(let ft=0;ft<rt.length;ft++){var dt=rt[ft].mat=d.getMatWithStyle(it);if(rt[ft].mat.side=at.FrontSide,it.wireframe&&rt[ft].geo.setUpWireframe(),it.color){rt[ft].mat.color=lt.CC.color(it.color),rt[ft].geo.colorsNeedUpdate=!0;const mt=lt.CC.color(it.color);rt[ft].geo.setColor(mt)}else if(dt.voldata&&dt.volscheme){const mt=dt.volscheme,yt=dt.voldata,gt=lt.CC,_t=mt.range()||[-1,1];rt[ft].geo.setColors(function(xt,Mt,wt){let Et=yt.getVal(xt,Mt,wt);return gt.color(mt.valueToHex(Et,_t))})}else{rt[ft].geo.colorsNeedUpdate=!0;for(let mt of rt[ft].geo.geometryGroups)for(let yt=0;yt<mt.vertices;yt++){let gt=(0,ct.getColorFromStyle)(mt.atomArray[yt],it),_t=3*yt;mt.colorArray[_t]=gt.r,mt.colorArray[_t+1]=gt.g,mt.colorArray[_t+2]=gt.b}}rt[ft].finished=!1}}return this}getSurface(b){return this.surfaces[b]}removeSurface(b){for(var it=this.surfaces[b],rt=0;rt<it.length;rt++)it[rt]&&it[rt].lastGL&&(it[rt].geo!==void 0&&it[rt].geo.dispose(),it[rt].mat!==void 0&&it[rt].mat.dispose(),this.modelGroup.remove(it[rt].lastGL));return delete this.surfaces[b],this.show(),this}removeAllSurfaces(){for(var b in this.surfaces)if(this.surfaces.hasOwnProperty(b)){for(var it=this.surfaces[b],rt=0;rt<it.length;rt++)it[rt]&&it[rt].lastGL&&(it[rt].geo!==void 0&&it[rt].geo.dispose(),it[rt].mat!==void 0&&it[rt].mat.dispose(),this.modelGroup.remove(it[rt].lastGL));delete this.surfaces[b]}return this.show(),this}jmolMoveTo(){var b=this.modelGroup.position,it="center { "+-b.x+" "+-b.y+" "+-b.z+" }; ",rt=this.rotationGroup.quaternion;return it+="moveto .5 quaternion { "+rt.x+" "+rt.y+" "+rt.z+" "+rt.w+" };",it}clear(){return this.removeAllSurfaces(),this.removeAllModels(),this.removeAllLabels(),this.removeAllShapes(),this.show(),this}mapAtomProperties(b,it){it=it||{};var rt=this.getAtomsFromSel(it);if(typeof b=="function")for(let mt=0,yt=rt.length;mt<yt;mt++){let gt=rt[mt];b(gt)}else for(let mt=0,yt=rt.length;mt<yt;mt++){var dt=rt[mt];for(let gt=0,_t=b.length;gt<_t;gt++){let xt=b[gt];if(xt.props)for(var ft in xt.props)xt.props.hasOwnProperty(ft)&&this.atomIsSelected(dt,xt)&&(dt.properties||(dt.properties={}),dt.properties[ft]=xt.props[ft])}}return this}linkViewer(b){return this.linkedViewers.push(b),this}getPerceivedDistance(){return this.CAMERA_Z-this.rotationGroup.position.z}setPerceivedDistance(b){this.rotationGroup.position.z=this.CAMERA_Z-b}setAutoEyeSeparation(b,it){var rt=this.getPerceivedDistance();return it||(it=5),b||this.camera.position.x>0?this.camera.position.x=rt*Math.tan(Math.PI/180*it):this.camera.position.x=-rt*Math.tan(Math.PI/180*it),this.camera.lookAt(new ot.Vector3(0,0,this.rotationGroup.position.z)),this.camera.position.x}setDefaultCartoonQuality(b){this.config.cartoonQuality=b}}d.numWorkers=4,d.maxVolume=64e3,d.surfaceTypeMap={VDW:_e.SurfaceType.VDW,MS:_e.SurfaceType.MS,SAS:_e.SurfaceType.SAS,SES:_e.SurfaceType.SES};function j(ut,b){if(ut=(0,ct.getElement)(ut),!!ut){b=b||{};try{var it=new d(ut,b);return it}catch(rt){throw"error creating viewer: "+rt}}}function et(ut,b={},it={}){if(ut=(0,ct.getElement)(ut),!!ut){var rt=[],dt=document.createElement("canvas");it.rows=b.rows,it.cols=b.cols,it.control_all=b.control_all!=null?b.control_all:!1,ut.appendChild(dt);try{for(var ft=0;ft<b.rows;ft++){for(var mt=[],yt=0;yt<b.cols;yt++){it.row=ft,it.col=yt,it.canvas=dt,it.viewers=rt,it.control_all=b.control_all;var gt=j(ut,(0,ct.extend)({},it));mt.push(gt)}rt.unshift(mt)}}catch(_t){throw"error creating viewer grid: "+_t}return rt}}function nt(ut){var b=this;if(ut=(0,ct.getElement)(ut),!!ut){var it=et(ut,{rows:1,cols:2,control_all:!0});this.glviewer1=it[0][0],this.glviewer2=it[0][1],this.glviewer1.setAutoEyeSeparation(!1),this.glviewer2.setAutoEyeSeparation(!0),this.glviewer1.linkViewer(this.glviewer2),this.glviewer2.linkViewer(this.glviewer1);for(var rt=Object.getOwnPropertyNames(this.glviewer1.__proto__).filter(function(ft){return typeof b.glviewer1[ft]=="function"}),dt=0;dt<rt.length;dt++)this[rt[dt]]=function(ft){return function(){var mt=this.glviewer1[ft].apply(this.glviewer1,arguments),yt=this.glviewer2[ft].apply(this.glviewer2,arguments);return[mt,yt]}}(rt[dt]);this.setCoordinates=function(ft,mt,yt){for(var gt=0;gt<ft.length;gt++)ft[gt].setCoordinates(mt,yt)},this.surfacesFinished=function(){return this.glviewer1.surfacesFinished()&&this.glviewer2.surfacesFinished()},this.isAnimated=function(){return this.glviewer1.isAnimated()||this.glviewer2.isAnimated()},this.render=function(ft){this.glviewer1.render(),this.glviewer2.render(),ft&&ft(this)},this.getCanvas=function(){return this.glviewer1.getCanvas()}}}},"./src/Gradient.ts"(e,i,s){s.r(i),s.d(i,{CustomLinear:()=>tt,Gradient:()=>ot,GradientType:()=>a,ROYGB:()=>_e,RWB:()=>g,Sinebow:()=>st,builtinGradients:()=>at,getGradient:()=>_,normalizeValue:()=>h});var o=s("./src/colors.ts");class a{}function h(lt,ct,$){return ct>=lt?($<lt&&($=lt),$>ct&&($=ct),{lo:lt,hi:ct,val:$}):($>lt&&($=lt),$<ct&&($=ct),$=lt-$+ct,{lo:ct,hi:lt,val:$})}function _(lt){if(lt instanceof a)return lt;if(lt.gradient!==void 0&&at[lt.gradient]){let ct=lt.min===void 0?-1:lt.min,$=lt.max===void 0?1:lt.max;return lt.mid===void 0?lt.colors===void 0?new at[lt.gradient](ct,$):new at[lt.gradient](ct,$,lt.colors):new at[lt.gradient](ct,$,lt.mid)}else if(typeof lt.gradient=="string"&&lt.gradient.startsWith("linear_")){let ct=lt.gradient.split("_");ct.shift();let $=lt.min===void 0?-1:lt.min,c=lt.max===void 0?1:lt.max;return new tt($,c,ct)}return lt}class g extends a{constructor(ct,$,c){super(),this.gradient="RWB",this.mult=1,this.mid=c,this.min=ct,this.max=$,typeof $>"u"&&Array.isArray(ct)&&ct.length>=2?(this.max=ct[1],this.min=ct[0]):ct&&$&&!Array.isArray(ct)&&(this.min=ct,this.max=$)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}valueToHex(ct,$){var c,d;if(ct=this.mult*ct,$?(c=$[0],d=$[1]):(c=this.min,d=this.max),ct===void 0)return 16777215;var j=h(c,d,ct);c=j.lo,d=j.hi,ct=j.val;var et=(d+c)/2;$&&typeof $[2]<"u"?et=$[2]:typeof this.mid<"u"?et=this.mid:et=(c+d)/2;var nt,ut;return ct<et?(nt=Math.floor(255*Math.sqrt((ct-c)/(et-c))),ut=16711680+256*nt+nt,ut):ct>et?(nt=Math.floor(255*Math.sqrt(1-(ct-et)/(d-et))),ut=65536*nt+256*nt+255,ut):16777215}}class _e extends a{constructor(ct,$){super(),this.gradient="ROYGB",this.mult=1,this.min=ct,this.max=$,typeof $>"u"&&Array.isArray(ct)&&ct.length>=2?(this.max=ct[1],this.min=ct[0]):ct&&$&&!Array.isArray(ct)&&(this.min=ct,this.max=$)}valueToHex(ct,$){var c,d;if(ct=this.mult*ct,$?(c=$[0],d=$[1]):(c=this.min,d=this.max),typeof ct>"u")return 16777215;var j=h(c,d,ct);c=j.lo,d=j.hi,ct=j.val;var et=(c+d)/2,nt=(c+et)/2,ut=(et+d)/2,b,it;return ct<nt?(b=Math.floor(255*Math.sqrt((ct-c)/(nt-c))),it=16711680+256*b+0,it):ct<et?(b=Math.floor(255*Math.sqrt(1-(ct-nt)/(et-nt))),it=65536*b+65280+0,it):ct<ut?(b=Math.floor(255*Math.sqrt((ct-et)/(ut-et))),it=65280+1*b,it):(b=Math.floor(255*Math.sqrt(1-(ct-ut)/(d-ut))),it=0+256*b+255,it)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}}class st extends a{constructor(ct,$){super(),this.gradient="Sinebow",this.mult=1,this.min=ct,this.max=$,typeof $>"u"&&Array.isArray(ct)&&ct.length>=2&&(this.max=ct[1],this.min=ct[0]),$<ct&&(this.mult=-1,this.min*=-1,this.max*=-1)}valueToHex(ct,$){var c,d;if(ct=this.mult*ct,$?(c=$[0],d=$[1]):(c=this.min,d=this.max),typeof ct>"u")return 16777215;var j=ot.normalizeValue(c,d,ct);c=j.lo,d=j.hi,ct=j.val;var et=(ct-c)/(d-c),nt=5*et/6+.5,ut=Math.sin(Math.PI*nt);ut*=ut*255;var b=Math.sin(Math.PI*(nt+1/3));b*=b*255;var it=Math.sin(Math.PI*(nt+2/3));return it*=it*255,65536*Math.floor(ut)+256*Math.floor(it)+1*Math.floor(b)}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}}class tt extends a{constructor(ct,$,c){super(),this.gradient="linear",this.colors=new Array;var d;if(Array.isArray(ct)&&ct.length>=2?(this.max=ct[1],this.min=ct[0],d=$):(this.min=ct,this.max=$,d=c),d)for(let j of d)this.colors.push(o.CC.color(j));else this.colors.push(o.CC.color(0))}range(){return typeof this.min<"u"&&typeof this.max<"u"?[this.min,this.max]:null}valueToHex(ct,$){var c,d;if($?(c=$[0],d=$[1]):(c=this.min,d=this.max),ct===void 0)return 16777215;var j=h(c,d,ct);c=j.lo,d=j.hi,ct=j.val;let et=this.colors.length,nt=(d-c)/et,ut=Math.min(Math.floor((ct-c)/nt),et-1),b=Math.min(ut+1,et-1),it=(ct-c-ut*nt)/nt,rt=this.colors[ut],dt=this.colors[b];return new o.Color(rt.r+it*(dt.r-rt.r),rt.g+it*(dt.g-rt.g),rt.b+it*(dt.b-rt.b)).getHex()}}const at={rwb:g,RWB:g,roygb:_e,ROYGB:_e,sinebow:st,linear:tt};class ot extends a{valueToHex(ct,$){return 0}range(){return null}}ot.RWB=g,ot.ROYGB=_e,ot.Sinebow=st,ot.CustomLinear=tt,ot.builtinGradients=at,ot.normalizeValue=h,ot.getGradient=_},"./src/Label.ts"(e,i,s){s.r(i),s.d(i,{Label:()=>st,LabelCount:()=>_});var o=s("./src/WebGL/index.ts"),a=s("./src/Gradient.ts"),h=s("./src/colors.ts");let _=0;function g(tt,at,ot,lt,ct,$,c){tt.beginPath(),tt.moveTo(at+$,ot),tt.lineTo(at+lt-$,ot),tt.quadraticCurveTo(at+lt,ot,at+lt,ot+$),tt.lineTo(at+lt,ot+ct-$),tt.quadraticCurveTo(at+lt,ot+ct,at+lt-$,ot+ct),tt.lineTo(at+$,ot+ct),tt.quadraticCurveTo(at,ot+ct,at,ot+ct-$),tt.lineTo(at,ot+$),tt.quadraticCurveTo(at,ot,at+$,ot),tt.closePath(),tt.fill(),c&&tt.stroke()}function _e(tt,at,ot){var lt=ot;return typeof tt<"u"&&(tt instanceof h.Color?lt=tt.scaled():(lt=h.CC.color(tt),typeof lt.scaled<"u"&&(lt=lt.scaled()))),typeof at<"u"&&(lt.a=parseFloat(at)),lt}class st{constructor(at,ot){this.id=_++,this.stylespec=ot||{},this.canvas=document.createElement("canvas"),this.canvas.width=134,this.canvas.height=35,this.context=this.canvas.getContext("2d"),this.sprite=new o.Sprite,this.text=at,this.frame=this.stylespec.frame}getStyle(){return this.stylespec}hide(){this.sprite&&(this.sprite.visible=!1)}show(){this.sprite&&(this.sprite.visible=!0)}setContext(){var at=this.stylespec,ot=typeof at.useScreen>"u"?!1:at.useScreen,lt=at.showBackground;(lt==="0"||lt==="false")&&(lt=!1),typeof lt>"u"&&(lt=!0);var ct=at.font?at.font:"sans-serif",$=parseInt(at.fontSize)?parseInt(at.fontSize):18,c=_e(at.fontColor,at.fontOpacity,{r:255,g:255,b:255,a:1}),d=at.padding?at.padding:4,j=at.borderThickness?at.borderThickness:0,et=_e(at.backgroundColor,at.backgroundOpacity,{r:0,g:0,b:0,a:1}),nt=_e(at.borderColor,at.borderOpacity,et),ut=at.position?at.position:{x:-10,y:1,z:1},b=at.inFront!==void 0?at.inFront:!0;(b==="false"||b==="0")&&(b=!1);var it=at.alignment||o.SpriteAlignment.topLeft;typeof it=="string"&&it in o.SpriteAlignment&&(it=o.SpriteAlignment[it]);var rt="";at.bold&&(rt="bold "),this.context.font=rt+$+"px  "+ct;var dt=this.context.measureText(this.text),ft=dt.width;lt||(j=0);var mt=ft+2.5*j+2*d,yt=$*1.25+2*j+2*d;if(at.backgroundImage){var gt=at.backgroundImage,_t=at.backgroundWidth?at.backgroundWidth:gt.width,xt=at.backgroundHeight?at.backgroundHeight:gt.height;_t>mt&&(mt=_t),xt>yt&&(yt=xt)}if(this.canvas.width=mt,this.canvas.height=yt,this.context.clearRect(0,0,this.canvas.width,this.canvas.height),rt="",at.bold&&(rt="bold "),this.context.font=rt+$+"px  "+ct,this.context.fillStyle="rgba("+et.r+","+et.g+","+et.b+","+et.a+")",this.context.strokeStyle="rgba("+nt.r+","+nt.g+","+nt.b+","+nt.a+")",at.backgroundGradient){let wt=this.context.createLinearGradient(0,yt/2,mt,yt/2),Et=a.Gradient.getGradient(at.backgroundGradient),At=Et.range(),St=-1,bt=1;At&&(St=At[0],bt=At[1]);let Ct=bt-St;for(let Nt=0;Nt<1.01;Nt+=.1){let kt=_e(Et.valueToHex(St+Ct*Nt)),Ht="rgba("+kt.r+","+kt.g+","+kt.b+","+kt.a+")";wt.addColorStop(Nt,Ht)}this.context.fillStyle=wt}this.context.lineWidth=j,lt&&g(this.context,j,j,mt-2*j,yt-2*j,6,j>0),at.backgroundImage&&this.context.drawImage(gt,0,0,mt,yt),this.context.fillStyle="rgba("+c.r+","+c.g+","+c.b+","+c.a+")",this.context.fillText(this.text,j+d,$+j+d,ft);var Mt=new o.Texture(this.canvas);Mt.needsUpdate=!0,this.sprite.material=new o.SpriteMaterial({map:Mt,useScreenCoordinates:ot,alignment:it,depthTest:!b,screenOffset:at.screenOffset||null}),this.sprite.scale.set(1,1,1),this.sprite.position.set(ut.x,ut.y,ut.z)}dispose(){this.sprite.material.map!==void 0&&this.sprite.material.map.dispose(),this.sprite.material!==void 0&&this.sprite.material.dispose()}}},"./src/ProteinSurface4.ts"(e,i,s){s.r(i),s.d(i,{MarchingCube:()=>_e,MarchingCubeInitializer:()=>g,PointGrid:()=>st,ProteinSurface:()=>tt,SurfaceType:()=>a,setSyncSurface:()=>_,syncSurface:()=>h});var o=s("./src/WebGL/math/index.ts"),a;(function(at){at[at.VDW=1]="VDW",at[at.MS=2]="MS",at[at.SAS=3]="SAS",at[at.SES=4]="SES"})(a||(a={}));var h=!1;function _(at){h=at}(window.navigator.userAgent.indexOf("MSIE ")>=0||window.navigator.userAgent.indexOf("Trident/")>=0)&&(h=!0);class g{constructor(){this.ISDONE=2,this.edgeTable=new Uint32Array([0,0,0,0,0,0,0,2816,0,0,0,1792,0,3328,3584,3840,0,0,0,138,0,21,0,134,0,0,0,652,0,2067,3865,3600,0,0,0,42,0,0,0,294,0,0,21,28,0,3875,1049,3360,0,168,162,170,0,645,2475,2210,0,687,293,172,4010,3747,3497,3232,0,0,0,0,0,69,0,900,0,0,0,1792,138,131,1608,1920,0,81,0,2074,84,85,84,86,0,81,0,3676,330,1105,1881,1616,0,0,0,42,0,69,0,502,0,0,21,3580,138,2035,1273,1520,2816,104,2337,106,840,581,367,102,2816,3695,3429,3180,1898,1635,1385,1120,0,0,0,0,0,0,0,3910,0,0,69,588,42,2083,41,2880,0,0,0,1722,0,2293,4095,3830,0,255,757,764,2538,2291,3065,2800,0,0,81,338,0,3925,1119,3414,84,855,85,340,2130,2899,89,2384,1792,712,194,1162,4036,3781,3535,3270,708,719,197,204,3018,2755,2505,2240,0,0,0,0,168,420,168,1958,162,162,676,2988,170,163,680,928,3328,3096,3328,3642,52,53,1855,1590,2340,2111,2869,2620,298,51,825,560,3584,3584,3090,3482,1668,1941,1183,1430,146,2975,2069,2460,154,915,153,400,3840,3592,3329,3082,1796,1541,1295,1030,2818,2575,2309,2060,778,515,265,0]),this.triTable=[[],[],[],[],[],[],[],[11,9,8],[],[],[],[8,10,9],[],[10,8,11],[9,11,10],[8,10,9,8,11,10],[],[],[],[1,7,3],[],[4,2,0],[],[2,1,7],[],[],[],[2,7,3,2,9,7],[],[1,4,11,1,0,4],[3,8,0,11,9,4,11,10,9],[4,11,9,11,10,9],[],[],[],[5,3,1],[],[],[],[2,5,8,2,1,5],[],[],[2,4,0],[3,2,4],[],[0,9,1,8,10,5,8,11,10],[3,4,0,3,10,4],[5,8,10,8,11,10],[],[3,5,7],[7,1,5],[1,7,3,1,5,7],[],[9,2,0,9,7,2],[0,3,8,1,7,11,1,5,7],[11,1,7,1,5,7],[],[9,1,0,5,3,2,5,7,3],[8,2,5,8,0,2],[2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[],[],[],[],[],[0,6,2],[],[7,2,9,7,9,8],[],[],[],[8,10,9],[7,1,3],[7,1,0],[6,9,3,6,10,9],[7,10,8,10,9,8],[],[6,0,4],[],[11,1,4,11,3,1],[2,4,6],[2,0,4,2,4,6],[2,4,6],[1,4,2,4,6,2],[],[6,0,4],[],[2,11,3,6,9,4,6,10,9],[8,6,1,8,1,3],[10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[],[],[],[5,3,1],[],[0,6,2],[],[7,4,8,5,2,1,5,6,2],[],[],[2,4,0],[7,4,8,2,11,3,10,5,6],[7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[9,11,8],[3,5,6],[0,5,11,0,11,8],[6,3,5,3,1,5],[3,9,6,3,8,9],[9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[],[],[],[],[],[],[],[1,10,2,9,11,6,9,8,11],[],[],[6,0,2],[3,6,9,3,2,6],[3,5,1],[0,5,1,0,11,5],[0,3,5],[6,9,11,9,8,11],[],[],[],[4,5,9,7,1,10,7,3,1],[],[11,6,7,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[],[],[0,6,4],[8,6,4,8,1,6],[],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[4,2,6],[1,0,9,2,4,8,2,6,4],[2,4,0,2,6,4],[8,2,4,2,6,4],[11,4,1,11,6,4],[0,9,1,4,11,6,4,8,11],[3,6,0,6,4,0],[8,6,4,8,11,6],[10,8,9],[6,3,9,6,7,3],[6,7,1],[10,7,1,7,3,1],[7,11,6,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2],[1,0,9,3,6,7,3,2,6],[7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[],[],[],[],[5,3,7],[8,5,2,8,7,5],[5,3,7],[1,10,2,5,8,7,5,9,8],[1,7,5],[1,7,5],[9,2,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[0,7,1,7,5,1],[9,3,5,3,7,5],[9,7,5,9,8,7],[8,10,11],[3,4,10,3,10,11],[8,10,11],[5,9,4,1,11,3,1,10,11],[2,4,5],[5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[2,8,5,2,11,8],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[11,9,10],[11,9,10],[1,11,4,1,10,11],[8,7,4,11,1,10,11,3,1],[2,7,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[1,7,4],[3,2,11,4,8,7,9,1,0],[11,4,2,4,0,2],[2,11,3,7,4,8],[4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[3,9,11,9,10,11],[0,10,8,10,11,8],[10,3,1,10,11,3],[2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]],this.edgeTable2=[0,265,515,778,2060,2309,2575,2822,1030,1295,1541,1804,3082,3331,3593,3840,400,153,915,666,2460,2197,2975,2710,1430,1183,1941,1692,3482,3219,3993,3728,560,825,51,314,2620,2869,2111,2358,1590,1855,1077,1340,3642,3891,3129,3376,928,681,419,170,2988,2725,2479,2214,1958,1711,1445,1196,4010,3747,3497,3232,2240,2505,2755,3018,204,453,719,966,3270,3535,3781,4044,1226,1475,1737,1984,2384,2137,2899,2650,348,85,863,598,3414,3167,3925,3676,1370,1107,1881,1616,2800,3065,2291,2554,764,1013,255,502,3830,4095,3317,3580,1786,2035,1273,1520,2912,2665,2403,2154,876,613,367,102,3942,3695,3429,3180,1898,1635,1385,1120,1120,1385,1635,1898,3180,3429,3695,3942,102,367,613,876,2154,2403,2665,2912,1520,1273,2035,1786,3580,3317,4095,3830,502,255,1013,764,2554,2291,3065,2800,1616,1881,1107,1370,3676,3925,3167,3414,598,863,85,348,2650,2899,2137,2384,1984,1737,1475,1226,4044,3781,3535,3270,966,719,453,204,3018,2755,2505,2240,3232,3497,3747,4010,1196,1445,1711,1958,2214,2479,2725,2988,170,419,681,928,3376,3129,3891,3642,1340,1077,1855,1590,2358,2111,2869,2620,314,51,825,560,3728,3993,3219,3482,1692,1941,1183,1430,2710,2975,2197,2460,666,915,153,400,3840,3593,3331,3082,1804,1541,1295,1030,2822,2575,2309,2060,778,515,265,0],this.triTable2=[[],[8,3,0],[9,0,1],[8,3,1,8,1,9],[11,2,3],[11,2,0,11,0,8],[11,2,3,0,1,9],[2,1,11,1,9,11,11,9,8],[10,1,2],[8,3,0,1,2,10],[9,0,2,9,2,10],[3,2,8,2,10,8,8,10,9],[10,1,3,10,3,11],[1,0,10,0,8,10,10,8,11],[0,3,9,3,11,9,9,11,10],[8,10,9,8,11,10],[8,4,7],[3,0,4,3,4,7],[1,9,0,8,4,7],[9,4,1,4,7,1,1,7,3],[2,3,11,7,8,4],[7,11,4,11,2,4,4,2,0],[3,11,2,4,7,8,9,0,1],[2,7,11,2,1,7,1,4,7,1,9,4],[10,1,2,8,4,7],[2,10,1,0,4,7,0,7,3],[4,7,8,0,2,10,0,10,9],[2,7,3,2,9,7,7,9,4,2,10,9],[8,4,7,11,10,1,11,1,3],[11,4,7,1,4,11,1,11,10,1,0,4],[3,8,0,7,11,4,11,9,4,11,10,9],[7,11,4,4,11,9,11,10,9],[9,5,4],[3,0,8,4,9,5],[5,4,0,5,0,1],[4,8,5,8,3,5,5,3,1],[11,2,3,9,5,4],[9,5,4,8,11,2,8,2,0],[3,11,2,1,5,4,1,4,0],[8,5,4,2,5,8,2,8,11,2,1,5],[2,10,1,9,5,4],[0,8,3,5,4,9,10,1,2],[10,5,2,5,4,2,2,4,0],[3,4,8,3,2,4,2,5,4,2,10,5],[5,4,9,1,3,11,1,11,10],[0,9,1,4,8,5,8,10,5,8,11,10],[3,4,0,3,10,4,4,10,5,3,11,10],[4,8,5,5,8,10,8,11,10],[9,5,7,9,7,8],[0,9,3,9,5,3,3,5,7],[8,0,7,0,1,7,7,1,5],[1,7,3,1,5,7],[11,2,3,8,9,5,8,5,7],[9,2,0,9,7,2,2,7,11,9,5,7],[0,3,8,2,1,11,1,7,11,1,5,7],[2,1,11,11,1,7,1,5,7],[1,2,10,5,7,8,5,8,9],[9,1,0,10,5,2,5,3,2,5,7,3],[5,2,10,8,2,5,8,5,7,8,0,2],[10,5,2,2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[11,7,6],[0,8,3,11,7,6],[9,0,1,11,7,6],[7,6,11,3,1,9,3,9,8],[2,3,7,2,7,6],[8,7,0,7,6,0,0,6,2],[1,9,0,3,7,6,3,6,2],[7,6,2,7,2,9,2,1,9,7,9,8],[1,2,10,6,11,7],[2,10,1,7,6,11,8,3,0],[11,7,6,10,9,0,10,0,2],[7,6,11,3,2,8,8,2,10,8,10,9],[6,10,7,10,1,7,7,1,3],[6,10,1,6,1,7,7,1,0,7,0,8],[9,0,3,6,9,3,6,10,9,6,3,7],[6,10,7,7,10,8,10,9,8],[8,4,6,8,6,11],[11,3,6,3,0,6,6,0,4],[0,1,9,4,6,11,4,11,8],[1,9,4,11,1,4,11,3,1,11,4,6],[3,8,2,8,4,2,2,4,6],[2,0,4,2,4,6],[1,9,0,3,8,2,2,8,4,2,4,6],[9,4,1,1,4,2,4,6,2],[10,1,2,11,8,4,11,4,6],[10,1,2,11,3,6,6,3,0,6,0,4],[0,2,10,0,10,9,4,11,8,4,6,11],[2,11,3,6,9,4,6,10,9],[8,4,6,8,6,1,6,10,1,8,1,3],[1,0,10,10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[9,5,4,7,6,11],[4,9,5,3,0,8,11,7,6],[6,11,7,4,0,1,4,1,5],[6,11,7,4,8,5,5,8,3,5,3,1],[4,9,5,6,2,3,6,3,7],[9,5,4,8,7,0,0,7,6,0,6,2],[4,0,1,4,1,5,6,3,7,6,2,3],[7,4,8,5,2,1,5,6,2],[6,11,7,1,2,10,9,5,4],[11,7,6,8,3,0,1,2,10,9,5,4],[11,7,6,10,5,2,2,5,4,2,4,0],[7,4,8,2,11,3,10,5,6],[4,9,5,6,10,7,7,10,1,7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[5,6,9,6,11,9,9,11,8],[0,9,5,0,5,3,3,5,6,3,6,11],[0,1,5,0,5,11,5,6,11,0,11,8],[11,3,6,6,3,5,3,1,5],[9,5,6,3,9,6,3,8,9,3,6,2],[5,6,9,9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[1,2,10,5,6,9,9,6,11,9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[10,6,5],[8,3,0,10,6,5],[0,1,9,5,10,6],[10,6,5,9,8,3,9,3,1],[3,11,2,10,6,5],[6,5,10,2,0,8,2,8,11],[1,9,0,6,5,10,11,2,3],[1,10,2,5,9,6,9,11,6,9,8,11],[1,2,6,1,6,5],[0,8,3,2,6,5,2,5,1],[5,9,6,9,0,6,6,0,2],[9,6,5,3,6,9,3,9,8,3,2,6],[11,6,3,6,5,3,3,5,1],[0,5,1,0,11,5,5,11,6,0,8,11],[0,5,9,0,3,5,3,6,5,3,11,6],[5,9,6,6,9,11,9,8,11],[10,6,5,4,7,8],[5,10,6,7,3,0,7,0,4],[5,10,6,0,1,9,8,4,7],[4,5,9,6,7,10,7,1,10,7,3,1],[7,8,4,2,3,11,10,6,5],[11,6,7,10,2,5,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[7,8,4,5,1,2,5,2,6],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,8,0,7,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,4,5,8,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[10,6,4,10,4,9],[8,3,0,9,10,6,9,6,4],[1,10,0,10,6,0,0,6,4],[8,6,4,8,1,6,6,1,10,8,3,1],[2,3,11,6,4,9,6,9,10],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,11,6,3,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[9,1,4,1,2,4,4,2,6],[1,0,9,3,2,8,2,4,8,2,6,4],[2,4,0,2,6,4],[3,2,8,8,2,4,2,6,4],[1,4,9,11,4,1,11,1,3,11,6,4],[0,9,1,4,11,6,4,8,11],[11,6,3,3,6,0,6,4,0],[8,6,4,8,11,6],[6,7,10,7,8,10,10,8,9],[9,3,0,6,3,9,6,9,10,6,7,3],[6,1,10,6,7,1,7,0,1,7,8,0],[6,7,10,10,7,1,7,3,1],[7,11,6,3,8,2,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2,2,9,1,7,8,9],[1,0,9,3,6,7,3,2,6],[8,0,7,7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[11,7,5,11,5,10],[3,0,8,7,5,10,7,10,11],[9,0,1,10,11,7,10,7,5],[3,1,9,3,9,8,7,10,11,7,5,10],[10,2,5,2,3,5,5,3,7],[5,10,2,8,5,2,8,7,5,8,2,0],[9,0,1,10,2,5,5,2,3,5,3,7],[1,10,2,5,8,7,5,9,8],[2,11,1,11,7,1,1,7,5],[0,8,3,2,11,1,1,11,7,1,7,5],[9,0,2,9,2,7,2,11,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[8,7,0,0,7,1,7,5,1],[0,3,9,9,3,5,3,7,5],[9,7,5,9,8,7],[4,5,8,5,10,8,8,10,11],[3,0,4,3,4,10,4,5,10,3,10,11],[0,1,9,4,5,8,8,5,10,8,10,11],[5,9,4,1,11,3,1,10,11],[3,8,4,3,4,2,2,4,5,2,5,10],[10,2,5,5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[8,4,5,2,8,5,2,11,8,2,5,1],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[4,5,8,8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[7,4,11,4,9,11,11,9,10],[3,0,8,7,4,11,11,4,9,11,9,10],[11,7,4,1,11,4,1,10,11,1,4,0],[8,7,4,11,1,10,11,3,1],[2,3,7,2,7,9,7,4,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[2,11,7,2,7,1,1,7,4,1,4,9],[3,2,11,4,8,7,9,1,0],[7,4,11,11,4,2,4,0,2],[2,11,3,7,4,8],[9,1,4,4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[0,9,3,3,9,11,9,10,11],[1,10,0,0,10,8,10,11,8],[10,3,1,10,11,3],[3,8,2,2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[2,11,1,1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]]}march(ot,lt,ct,$){let c=!!$.fulltable,d=$.hasOwnProperty("origin")&&$.origin.hasOwnProperty("x")?$.origin:{x:0,y:0,z:0},j=!!$.voxel,et=$.matrix,nt=$.nX||0,ut=$.nY||0,b=$.nZ||0,it=$.scale||1,rt=null;$.unitCube?rt=$.unitCube:rt={x:it,y:it,z:it};let dt=new Int32Array(nt*ut*b),ft,mt;for(ft=0,mt=dt.length;ft<mt;++ft)dt[ft]=-1;let yt=function(Mt,wt,Et,At,St,bt){let Ct={x:0,y:0,z:0},Nt=!!(At&1<<St),kt=!!(At&1<<bt),Ht=St;if(!Nt&&kt&&(Ht=bt),Ht&1&&Et++,Ht&2&&wt++,Ht&4&&Mt++,et){let Zt=new o.Vector3(Mt,wt,Et);Zt=Zt.applyMatrix4(et),Ct={x:Zt.x,y:Zt.y,z:Zt.z}}else Ct.x=d.x+rt.x*Mt,Ct.y=d.y+rt.y*wt,Ct.z=d.z+rt.z*Et;let jt=(ut*Mt+wt)*b+Et;return j?(lt.push(Ct),lt.length-1):(dt[jt]<0&&(dt[jt]=lt.length,lt.push(Ct)),dt[jt])},gt=new Int32Array(12),_t=c?this.edgeTable2:this.edgeTable,xt=c?this.triTable2:this.triTable;for(ft=0;ft<nt-1;++ft)for(let Mt=0;Mt<ut-1;++Mt)for(let wt=0;wt<b-1;++wt){let Et=0;for(let bt=0;bt<8;++bt){let Ct=(ut*(ft+((bt&4)>>2))+Mt+((bt&2)>>1))*b+wt+(bt&1),Nt=!!(ot[Ct]&this.ISDONE);Et|=Nt<<bt}if(Et===0||Et===255)continue;let At=_t[Et];if(At===0)continue;let St=xt[Et];At&1&&(gt[0]=yt(ft,Mt,wt,Et,0,1)),At&2&&(gt[1]=yt(ft,Mt,wt,Et,1,3)),At&4&&(gt[2]=yt(ft,Mt,wt,Et,3,2)),At&8&&(gt[3]=yt(ft,Mt,wt,Et,2,0)),At&16&&(gt[4]=yt(ft,Mt,wt,Et,4,5)),At&32&&(gt[5]=yt(ft,Mt,wt,Et,5,7)),At&64&&(gt[6]=yt(ft,Mt,wt,Et,7,6)),At&128&&(gt[7]=yt(ft,Mt,wt,Et,6,4)),At&256&&(gt[8]=yt(ft,Mt,wt,Et,0,4)),At&512&&(gt[9]=yt(ft,Mt,wt,Et,1,5)),At&1024&&(gt[10]=yt(ft,Mt,wt,Et,3,7)),At&2048&&(gt[11]=yt(ft,Mt,wt,Et,2,6));for(let bt=0;bt<St.length;bt+=3){let Ct=gt[St[bt]],Nt=gt[St[bt+1]],kt=gt[St[bt+2]];j&&bt>=3&&(lt.push(lt[Ct]),Ct=lt.length-1,lt.push(lt[Nt]),Nt=lt.length-1,lt.push(lt[kt]),kt=lt.length-1),ct.push(Ct),ct.push(Nt),ct.push(kt)}}}laplacianSmooth(ot,lt,ct){let $=new Array(lt.length),c,d,j,et,nt;for(c=0,d=lt.length;c<d;c++)$[c]={x:0,y:0,z:0};let ut=new Array(20),b;for(c=0;c<20;c++)ut[c]=new Array(lt.length);for(c=0,d=lt.length;c<d;c++)ut[0][c]=0;for(c=0,d=ct.length/3;c<d;c++){let dt=c*3,ft=c*3+1,mt=c*3+2;for(b=!0,j=0,et=ut[0][ct[dt]];j<et;j++)if(ct[ft]==ut[j+1][ct[dt]]){b=!1;break}for(b&&(ut[0][ct[dt]]++,ut[ut[0][ct[dt]]][ct[dt]]=ct[ft]),b=!0,j=0,et=ut[0][ct[dt]];j<et;j++)if(ct[mt]==ut[j+1][ct[dt]]){b=!1;break}for(b&&(ut[0][ct[dt]]++,ut[ut[0][ct[dt]]][ct[dt]]=ct[mt]),b=!0,j=0,et=ut[0][ct[ft]];j<et;j++)if(ct[dt]==ut[j+1][ct[ft]]){b=!1;break}for(b&&(ut[0][ct[ft]]++,ut[ut[0][ct[ft]]][ct[ft]]=ct[dt]),b=!0,j=0,et=ut[0][ct[ft]];j<et;j++)if(ct[mt]==ut[j+1][ct[ft]]){b=!1;break}for(b&&(ut[0][ct[ft]]++,ut[ut[0][ct[ft]]][ct[ft]]=ct[mt]),b=!0,j=0;j<ut[0][ct[mt]];j++)if(ct[dt]==ut[j+1][ct[mt]]){b=!1;break}for(b&&(ut[0][ct[mt]]++,ut[ut[0][ct[mt]]][ct[mt]]=ct[dt]),b=!0,j=0,et=ut[0][ct[mt]];j<et;j++)if(ct[ft]==ut[j+1][ct[mt]]){b=!1;break}b&&(ut[0][ct[mt]]++,ut[ut[0][ct[mt]]][ct[mt]]=ct[ft])}let it=1,rt=.5;for(nt=0;nt<ot;nt++){for(c=0,d=lt.length;c<d;c++)if(ut[0][c]<3)$[c].x=lt[c].x,$[c].y=lt[c].y,$[c].z=lt[c].z;else if(ut[0][c]==3||ut[0][c]==4){for($[c].x=0,$[c].y=0,$[c].z=0,j=0,et=ut[0][c];j<et;j++)$[c].x+=lt[ut[j+1][c]].x,$[c].y+=lt[ut[j+1][c]].y,$[c].z+=lt[ut[j+1][c]].z;$[c].x+=rt*lt[c].x,$[c].y+=rt*lt[c].y,$[c].z+=rt*lt[c].z,$[c].x/=rt+ut[0][c],$[c].y/=rt+ut[0][c],$[c].z/=rt+ut[0][c]}else{for($[c].x=0,$[c].y=0,$[c].z=0,j=0,et=ut[0][c];j<et;j++)$[c].x+=lt[ut[j+1][c]].x,$[c].y+=lt[ut[j+1][c]].y,$[c].z+=lt[ut[j+1][c]].z;$[c].x+=it*lt[c].x,$[c].y+=it*lt[c].y,$[c].z+=it*lt[c].z,$[c].x/=it+ut[0][c],$[c].y/=it+ut[0][c],$[c].z/=it+ut[0][c]}for(c=0,d=lt.length;c<d;c++)lt[c].x=$[c].x,lt[c].y=$[c].y,lt[c].z=$[c].z}}}let _e=new g;class st{constructor(ot,lt,ct){this.data=new Int32Array(ot*lt*ct*3),this.width=lt,this.height=ct}set(ot,lt,ct,$){let c=((ot*this.width+lt)*this.height+ct)*3;this.data[c]=$.ix,this.data[c+1]=$.iy,this.data[c+2]=$.iz}get(ot,lt,ct){let $=((ot*this.width+lt)*this.height+ct)*3;return{ix:this.data[$],iy:this.data[$+1],iz:this.data[$+2]}}}class tt{constructor(){this.INOUT=1,this.ISDONE=2,this.ISBOUND=4,this.ptranx=0,this.ptrany=0,this.ptranz=0,this.probeRadius=1.4,this.defaultScaleFactor=2,this.scaleFactor=this.defaultScaleFactor,this.pHeight=0,this.pWidth=0,this.pLength=0,this.cutRadius=0,this.vpBits=null,this.vpDistance=null,this.vpAtomID=null,this.pminx=0,this.pminy=0,this.pminz=0,this.pmaxx=0,this.pmaxy=0,this.pmaxz=0,this.depty={},this.widxz={},this.faces=[],this.verts=[],this.vdwRadii={H:1.2,Li:1.82,Na:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63,X:2},this.nb=[new Int32Array([1,0,0]),new Int32Array([-1,0,0]),new Int32Array([0,1,0]),new Int32Array([0,-1,0]),new Int32Array([0,0,1]),new Int32Array([0,0,-1]),new Int32Array([1,1,0]),new Int32Array([1,-1,0]),new Int32Array([-1,1,0]),new Int32Array([-1,-1,0]),new Int32Array([1,0,1]),new Int32Array([1,0,-1]),new Int32Array([-1,0,1]),new Int32Array([-1,0,-1]),new Int32Array([0,1,1]),new Int32Array([0,1,-1]),new Int32Array([0,-1,1]),new Int32Array([0,-1,-1]),new Int32Array([1,1,1]),new Int32Array([1,1,-1]),new Int32Array([1,-1,1]),new Int32Array([-1,1,1]),new Int32Array([1,-1,-1]),new Int32Array([-1,-1,1]),new Int32Array([-1,1,-1]),new Int32Array([-1,-1,-1])],tt.MarchingCube||(tt.MarchingCube=new g)}getVDWIndex(ot){return!ot.elem||typeof this.vdwRadii[ot.elem]>"u"?"X":ot.elem}getFacesAndVertices(ot){let lt={};for(let c=0,d=ot.length;c<d;c++)lt[ot[c]]=!0;let ct=this.verts;for(let c=0,d=ct.length;c<d;c++)ct[c].x=ct[c].x/this.scaleFactor-this.ptranx,ct[c].y=ct[c].y/this.scaleFactor-this.ptrany,ct[c].z=ct[c].z/this.scaleFactor-this.ptranz;let $=[];for(let c=0,d=this.faces.length;c<d;c+=3){let j=this.faces[c],et=this.faces[c+1],nt=this.faces[c+2],ut=ct[j].atomid,b=ct[et].atomid,it=ct[nt].atomid,rt=ut;b<rt&&(rt=b),it<rt&&(rt=it),lt[rt]&&j!==et&&et!==nt&&j!==nt&&($.push(j),$.push(et),$.push(nt))}return this.vpBits=null,this.vpDistance=null,this.vpAtomID=null,{vertices:ct,faces:$}}initparm(ot,lt,ct){ct>1e6&&(this.scaleFactor=this.defaultScaleFactor/2);let $=1/this.scaleFactor*5.5;this.pminx=ot[0][0],this.pmaxx=ot[1][0],this.pminy=ot[0][1],this.pmaxy=ot[1][1],this.pminz=ot[0][2],this.pmaxz=ot[1][2],lt?(this.pminx-=this.probeRadius+$,this.pminy-=this.probeRadius+$,this.pminz-=this.probeRadius+$,this.pmaxx+=this.probeRadius+$,this.pmaxy+=this.probeRadius+$,this.pmaxz+=this.probeRadius+$):(this.pminx-=$,this.pminy-=$,this.pminz-=$,this.pmaxx+=$,this.pmaxy+=$,this.pmaxz+=$),this.pminx=Math.floor(this.pminx*this.scaleFactor)/this.scaleFactor,this.pminy=Math.floor(this.pminy*this.scaleFactor)/this.scaleFactor,this.pminz=Math.floor(this.pminz*this.scaleFactor)/this.scaleFactor,this.pmaxx=Math.ceil(this.pmaxx*this.scaleFactor)/this.scaleFactor,this.pmaxy=Math.ceil(this.pmaxy*this.scaleFactor)/this.scaleFactor,this.pmaxz=Math.ceil(this.pmaxz*this.scaleFactor)/this.scaleFactor,this.ptranx=-this.pminx,this.ptrany=-this.pminy,this.ptranz=-this.pminz,this.pLength=Math.ceil(this.scaleFactor*(this.pmaxx-this.pminx))+1,this.pWidth=Math.ceil(this.scaleFactor*(this.pmaxy-this.pminy))+1,this.pHeight=Math.ceil(this.scaleFactor*(this.pmaxz-this.pminz))+1,this.boundingatom(lt),this.cutRadius=this.probeRadius*this.scaleFactor,this.vpBits=new Uint8Array(this.pLength*this.pWidth*this.pHeight),this.vpDistance=new Float64Array(this.pLength*this.pWidth*this.pHeight),this.vpAtomID=new Int32Array(this.pLength*this.pWidth*this.pHeight)}boundingatom(ot){let lt={};for(const ct in this.vdwRadii){let $=this.vdwRadii[ct];ot?lt[ct]=($+this.probeRadius)*this.scaleFactor+.5:lt[ct]=$*this.scaleFactor+.5;let c=lt[ct]*lt[ct];this.widxz[ct]=Math.floor(lt[ct])+1,this.depty[ct]=new Int32Array(this.widxz[ct]*this.widxz[ct]);let d=0;for(let j=0;j<this.widxz[ct];j++)for(let et=0;et<this.widxz[ct];et++){let nt=j*j+et*et;if(nt>c)this.depty[ct][d]=-1;else{let ut=Math.sqrt(c-nt);this.depty[ct][d]=Math.floor(ut)}d++}}}fillvoxels(ot,lt){for(let ct=0,$=this.vpBits.length;ct<$;ct++)this.vpBits[ct]=0,this.vpDistance[ct]=-1,this.vpAtomID[ct]=-1;for(let ct in lt){let $=ot[lt[ct]];$!==void 0&&this.fillAtom($,ot)}for(let ct=0,$=this.vpBits.length;ct<$;ct++)this.vpBits[ct]&this.INOUT&&(this.vpBits[ct]|=this.ISDONE)}fillAtom(ot,lt){let ct=Math.floor(.5+this.scaleFactor*(ot.x+this.ptranx)),$=Math.floor(.5+this.scaleFactor*(ot.y+this.ptrany)),c=Math.floor(.5+this.scaleFactor*(ot.z+this.ptranz)),d=this.getVDWIndex(ot),j=0,et=this.pWidth*this.pHeight;for(let nt=0,ut=this.widxz[d];nt<ut;nt++)for(let b=0;b<ut;b++){if(this.depty[d][j]!=-1){for(let it=-1;it<2;it++)for(let rt=-1;rt<2;rt++)for(let dt=-1;dt<2;dt++)if(it!==0&&rt!==0&&dt!==0){let ft=it*nt,mt=dt*b;for(let yt=0;yt<=this.depty[d][j];yt++){let gt=yt*rt,_t=ct+ft,xt=$+gt,Mt=c+mt;if(_t<0||xt<0||Mt<0||_t>=this.pLength||xt>=this.pWidth||Mt>=this.pHeight)continue;let wt=_t*et+xt*this.pHeight+Mt;if(!(this.vpBits[wt]&this.INOUT))this.vpBits[wt]|=this.INOUT,this.vpAtomID[wt]=ot.serial;else{let Et=lt[this.vpAtomID[wt]];if(Et.serial!=ot.serial){let At=ct+ft-Math.floor(.5+this.scaleFactor*(Et.x+this.ptranx)),St=$+gt-Math.floor(.5+this.scaleFactor*(Et.y+this.ptrany)),bt=c+mt-Math.floor(.5+this.scaleFactor*(Et.z+this.ptranz));ft*ft+gt*gt+mt*mt<At*At+St*St+bt*bt&&(this.vpAtomID[wt]=ot.serial)}}}}}j++}}fillvoxelswaals(ot,lt){for(let ct=0,$=this.vpBits.length;ct<$;ct++)this.vpBits[ct]&=~this.ISDONE;for(let ct in lt){let $=ot[lt[ct]];$!==void 0&&this.fillAtomWaals($,ot)}}fillAtomWaals(ot,lt){let ct=0,$=Math.floor(.5+this.scaleFactor*(ot.x+this.ptranx)),c=Math.floor(.5+this.scaleFactor*(ot.y+this.ptrany)),d=Math.floor(.5+this.scaleFactor*(ot.z+this.ptranz)),j=this.getVDWIndex(ot),et=this.pWidth*this.pHeight;for(let nt=0,ut=this.widxz[j];nt<ut;nt++)for(let b=0;b<ut;b++){if(this.depty[j][ct]!=-1){for(let it=-1;it<2;it++)for(let rt=-1;rt<2;rt++)for(let dt=-1;dt<2;dt++)if(it!==0&&rt!==0&&dt!==0){let ft=it*nt,mt=dt*b;for(let yt=0;yt<=this.depty[j][ct];yt++){let gt=yt*rt,_t=$+ft,xt=c+gt,Mt=d+mt;if(_t<0||xt<0||Mt<0||_t>=this.pLength||xt>=this.pWidth||Mt>=this.pHeight)continue;let wt=_t*et+xt*this.pHeight+Mt;if(!(this.vpBits[wt]&this.ISDONE))this.vpBits[wt]|=this.ISDONE,this.vpAtomID[wt]=ot.serial;else{let Et=lt[this.vpAtomID[wt]];if(Et.serial!=ot.serial){let At=$+ft-Math.floor(.5+this.scaleFactor*(Et.x+this.ptranx)),St=c+gt-Math.floor(.5+this.scaleFactor*(Et.y+this.ptrany)),bt=d+mt-Math.floor(.5+this.scaleFactor*(Et.z+this.ptranz));ft*ft+gt*gt+mt*mt<At*At+St*St+bt*bt&&(this.vpAtomID[wt]=ot.serial)}}}}}ct++}}buildboundary(){let ot=this.pWidth*this.pHeight;for(let lt=0;lt<this.pLength;lt++)for(let ct=0;ct<this.pHeight;ct++)for(let $=0;$<this.pWidth;$++){let c=lt*ot+$*this.pHeight+ct;if(this.vpBits[c]&this.INOUT){let d=0;for(;d<26;){let j=lt+this.nb[d][0],et=ct+this.nb[d][2],nt=$+this.nb[d][1];if(j>-1&&j<this.pLength&&nt>-1&&nt<this.pWidth&&et>-1&&et<this.pHeight&&!(this.vpBits[j*ot+nt*this.pHeight+et]&this.INOUT)){this.vpBits[c]|=this.ISBOUND;break}else d++}}}}fastdistancemap(){let ot=new st(this.pLength,this.pWidth,this.pHeight),lt=this.pWidth*this.pHeight,ct=this.cutRadius*this.cutRadius,$=[],c=[],d;for(let nt=0;nt<this.pLength;nt++)for(let ut=0;ut<this.pWidth;ut++)for(let b=0;b<this.pHeight;b++)if(d=nt*lt+ut*this.pHeight+b,this.vpBits[d]&=~this.ISDONE,this.vpBits[d]&this.INOUT&&this.vpBits[d]&this.ISBOUND){let it={ix:nt,iy:ut,iz:b};ot.set(nt,ut,b,it),$.push(it),this.vpDistance[d]=0,this.vpBits[d]|=this.ISDONE,this.vpBits[d]&=~this.ISBOUND}do{c=this.fastoneshell($,ot),$=[];for(let nt=0,ut=c.length;nt<ut;nt++)d=lt*c[nt].ix+this.pHeight*c[nt].iy+c[nt].iz,this.vpBits[d]&=~this.ISBOUND,this.vpDistance[d]<=1.0404*ct&&$.push({ix:c[nt].ix,iy:c[nt].iy,iz:c[nt].iz})}while($.length!==0);$=[],c=[],ot=null;let j=this.scaleFactor-.5;j<0&&(j=0);let et=ct-.5/(.1+j);for(let nt=0;nt<this.pLength;nt++)for(let ut=0;ut<this.pWidth;ut++)for(let b=0;b<this.pHeight;b++)d=nt*lt+ut*this.pHeight+b,this.vpBits[d]&=~this.ISBOUND,this.vpBits[d]&this.INOUT&&(!(this.vpBits[d]&this.ISDONE)||this.vpBits[d]&this.ISDONE&&this.vpDistance[d]>=et)&&(this.vpBits[d]|=this.ISBOUND)}fastoneshell(ot,lt){let ct,$,c,d,j,et,nt,ut,b,it=[];if(ot.length===0)return it;let rt={ix:-1,iy:-1,iz:-1},dt=this.pWidth*this.pHeight;for(let ft=0,mt=ot.length;ft<mt;ft++){ct=ot[ft].ix,$=ot[ft].iy,c=ot[ft].iz,ut=lt.get(ct,$,c);for(let yt=0;yt<6;yt++)rt.ix=ct+this.nb[yt][0],rt.iy=$+this.nb[yt][1],rt.iz=c+this.nb[yt][2],rt.ix<this.pLength&&rt.ix>-1&&rt.iy<this.pWidth&&rt.iy>-1&&rt.iz<this.pHeight&&rt.iz>-1&&(b=rt.ix*dt+this.pHeight*rt.iy+rt.iz,this.vpBits[b]&this.INOUT&&!(this.vpBits[b]&this.ISDONE)?(lt.set(rt.ix,rt.iy,c+this.nb[yt][2],ut),d=rt.ix-ut.ix,j=rt.iy-ut.iy,et=rt.iz-ut.iz,nt=d*d+j*j+et*et,this.vpDistance[b]=nt,this.vpBits[b]|=this.ISDONE,this.vpBits[b]|=this.ISBOUND,it.push({ix:rt.ix,iy:rt.iy,iz:rt.iz})):this.vpBits[b]&this.INOUT&&this.vpBits[b]&this.ISDONE&&(d=rt.ix-ut.ix,j=rt.iy-ut.iy,et=rt.iz-ut.iz,nt=d*d+j*j+et*et,nt<this.vpDistance[b]&&(lt.set(rt.ix,rt.iy,rt.iz,ut),this.vpDistance[b]=nt,this.vpBits[b]&this.ISBOUND||(this.vpBits[b]|=this.ISBOUND,it.push({ix:rt.ix,iy:rt.iy,iz:rt.iz})))))}for(let ft=0,mt=ot.length;ft<mt;ft++){ct=ot[ft].ix,$=ot[ft].iy,c=ot[ft].iz,ut=lt.get(ct,$,c);for(let yt=6;yt<18;yt++)rt.ix=ct+this.nb[yt][0],rt.iy=$+this.nb[yt][1],rt.iz=c+this.nb[yt][2],rt.ix<this.pLength&&rt.ix>-1&&rt.iy<this.pWidth&&rt.iy>-1&&rt.iz<this.pHeight&&rt.iz>-1&&(b=rt.ix*dt+this.pHeight*rt.iy+rt.iz,this.vpBits[b]&this.INOUT&&!(this.vpBits[b]&this.ISDONE)?(lt.set(rt.ix,rt.iy,c+this.nb[yt][2],ut),d=rt.ix-ut.ix,j=rt.iy-ut.iy,et=rt.iz-ut.iz,nt=d*d+j*j+et*et,this.vpDistance[b]=nt,this.vpBits[b]|=this.ISDONE,this.vpBits[b]|=this.ISBOUND,it.push({ix:rt.ix,iy:rt.iy,iz:rt.iz})):this.vpBits[b]&this.INOUT&&this.vpBits[b]&this.ISDONE&&(d=rt.ix-ut.ix,j=rt.iy-ut.iy,et=rt.iz-ut.iz,nt=d*d+j*j+et*et,nt<this.vpDistance[b]&&(lt.set(rt.ix,rt.iy,rt.iz,ut),this.vpDistance[b]=nt,this.vpBits[b]&this.ISBOUND||(this.vpBits[b]|=this.ISBOUND,it.push({ix:rt.ix,iy:rt.iy,iz:rt.iz})))))}for(let ft=0,mt=ot.length;ft<mt;ft++){ct=ot[ft].ix,$=ot[ft].iy,c=ot[ft].iz,ut=lt.get(ct,$,c);for(let yt=18;yt<26;yt++)rt.ix=ct+this.nb[yt][0],rt.iy=$+this.nb[yt][1],rt.iz=c+this.nb[yt][2],rt.ix<this.pLength&&rt.ix>-1&&rt.iy<this.pWidth&&rt.iy>-1&&rt.iz<this.pHeight&&rt.iz>-1&&(b=rt.ix*dt+this.pHeight*rt.iy+rt.iz,this.vpBits[b]&this.INOUT&&!(this.vpBits[b]&this.ISDONE)?(lt.set(rt.ix,rt.iy,c+this.nb[yt][2],ut),d=rt.ix-ut.ix,j=rt.iy-ut.iy,et=rt.iz-ut.iz,nt=d*d+j*j+et*et,this.vpDistance[b]=nt,this.vpBits[b]|=this.ISDONE,this.vpBits[b]|=this.ISBOUND,it.push({ix:rt.ix,iy:rt.iy,iz:rt.iz})):this.vpBits[b]&this.INOUT&&this.vpBits[b]&this.ISDONE&&(d=rt.ix-ut.ix,j=rt.iy-ut.iy,et=rt.iz-ut.iz,nt=d*d+j*j+et*et,nt<this.vpDistance[b]&&(lt.set(rt.ix,rt.iy,rt.iz,ut),this.vpDistance[b]=nt,this.vpBits[b]&this.ISBOUND||(this.vpBits[b]|=this.ISBOUND,it.push({ix:rt.ix,iy:rt.iy,iz:rt.iz})))))}return it}marchingcubeinit(ot){for(let lt=0,ct=this.vpBits.length;lt<ct;lt++)ot==1?this.vpBits[lt]&=~this.ISBOUND:ot==4?(this.vpBits[lt]&=~this.ISDONE,this.vpBits[lt]&this.ISBOUND&&(this.vpBits[lt]|=this.ISDONE),this.vpBits[lt]&=~this.ISBOUND):ot==2?this.vpBits[lt]&this.ISBOUND&&this.vpBits[lt]&this.ISDONE?this.vpBits[lt]&=~this.ISBOUND:this.vpBits[lt]&this.ISBOUND&&!(this.vpBits[lt]&this.ISDONE)&&(this.vpBits[lt]|=this.ISDONE):ot==3&&(this.vpBits[lt]&=~this.ISBOUND)}marchingcube(ot){this.marchingcubeinit(ot),this.verts=[],this.faces=[],tt.MarchingCube.march(this.vpBits,this.verts,this.faces,{smooth:1,nX:this.pLength,nY:this.pWidth,nZ:this.pHeight});let lt=this.pWidth*this.pHeight;for(let ct=0,$=this.verts.length;ct<$;ct++)this.verts[ct].atomid=this.vpAtomID[this.verts[ct].x*lt+this.pHeight*this.verts[ct].y+this.verts[ct].z];tt.MarchingCube.laplacianSmooth(1,this.verts,this.faces)}}tt.MarchingCube=new g},"./src/SurfaceWorker.js"(){$3Dmol.workerString=(function(){self.onmessage=function(e){var i=e.data,s=i.type;if(s<0)self.atomData=i.atoms,self.volume=i.volume,self.ps=new ProteinSurface;else{var o=self.ps;o.initparm(i.expandedExtent,s!=1,self.volume),o.fillvoxels(self.atomData,i.extendedAtoms),o.buildboundary(),(s===4||s===2)&&(o.fastdistancemap(),o.boundingatom(!1),o.fillvoxelswaals(self.atomData,i.extendedAtoms)),o.marchingcube(s);var a=o.getFacesAndVertices(i.atomsToShow);self.postMessage(a)}}}).toString().replace(/(^.*?\{|\}$)/g,""),$3Dmol.workerString+=`;
function _classCallCheck() {};`,$3Dmol.workerString+=`;
`+$3Dmol.Vector3.toString(),$3Dmol.workerString+=`;
`+$3Dmol.MarchingCubeInitializer.toString()+`;

`,$3Dmol.workerString+=`;
`+$3Dmol.PointGrid.toString()+`;
`,$3Dmol.workerString+=`;
var ProteinSurface = `+$3Dmol.ProteinSurface.toString()+`;
`,$3Dmol.SurfaceWorker=window.URL?window.URL.createObjectURL(new Blob([$3Dmol.workerString],{type:"text/javascript"})):void 0},"./src/VolumeData.ts"(e,i,s){s.r(i),s.d(i,{VolumeData:()=>_e});var o=s("./src/utilities.ts"),a=s("./src/WebGL/math/index.ts"),h=s("./src/parsers/VASP.ts"),_=s("./src/parsers/CUBE.ts"),g=s("./node_modules/pako/dist/pako.esm.mjs");class _e{constructor(tt,at,ot){if(this.unit={x:1,y:1,z:1},this.origin={x:0,y:0,z:0},this.size={x:0,y:0,z:0},this.data=new Float32Array([]),this.matrix=null,this.inversematrix=null,this.isbinary=new Set(["ccp4","CCP4"]),this.getCoordinates=function(d){var j=d/(this.size.y*this.size.z),et=d%(this.size.y*this.size.z),nt=d%this.size.z;return j*=this.unit.x,et*=this.unit.y,nt*=this.unit.z,j+=this.origin.x,et+=this.origin.y,nt+=this.origin.z,{x:j,y:et,z:nt}},this.vasp=function(d){var j=d.replace(/^\s+/,"").split(/[\n\r]/),et=(0,h.VASP)(d)[0],nt=et.length;if(nt==0){console.warn("No good formating of CHG or CHGCAR file, not atomic information provided in the file."),this.data=[];return}var ut=1.889725992,b=.036749309,it=parseFloat(j[1]),rt;rt=j[2].replace(/^\s+/,"").split(/\s+/);var dt=new a.Vector3(parseFloat(rt[0]),parseFloat(rt[1]),parseFloat(rt[2])).multiplyScalar(it*ut);rt=j[3].replace(/^\s+/,"").split(/\s+/);var ft=new a.Vector3(parseFloat(rt[0]),parseFloat(rt[1]),parseFloat(rt[2])).multiplyScalar(it*ut);rt=j[4].replace(/^\s+/,"").split(/\s+/);var mt=new a.Vector3(parseFloat(rt[0]),parseFloat(rt[1]),parseFloat(rt[2])).multiplyScalar(it*ut),yt=dt.x*(ft.y*mt.z-mt.y*ft.z)-ft.x*(dt.y*mt.z-mt.y*dt.z)+mt.x*(dt.y*ft.z-ft.y*dt.z);yt=Math.abs(yt)/Math.pow(ut,3);var gt=1/yt;j.splice(0,8+nt+1);var _t=j[0].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),xt=Math.abs(parseFloat(_t[0])),Mt=Math.abs(parseFloat(_t[1])),wt=Math.abs(parseFloat(_t[2])),Et=this.origin=new a.Vector3(0,0,0);this.size={x:xt,y:Mt,z:wt},this.unit=new a.Vector3(dt.x,ft.y,mt.z),dt=dt.multiplyScalar(1/(ut*xt)),ft=ft.multiplyScalar(1/(ut*Mt)),mt=mt.multiplyScalar(1/(ut*wt)),(dt.y!=0||dt.z!=0||ft.x!=0||ft.z!=0||mt.x!=0||mt.y!=0)&&(this.matrix=new a.Matrix4(dt.x,ft.x,mt.x,0,dt.y,ft.y,mt.y,0,dt.z,ft.z,mt.z,0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,new a.Matrix4().makeTranslation(Et.x,Et.y,Et.z)),this.origin=new a.Vector3(0,0,0),this.unit=new a.Vector3(1,1,1)),j.splice(0,1);var At=j.join(" ");At=At.replace(/^\s+/,"");var St=At.split(/[\s\r]+/);St.splice(xt*Mt*wt+1);for(var bt=Float32Array.from(St,parseFloat),Ct=0;Ct<bt.length;Ct++)bt[Ct]=bt[Ct]*gt*b;this.data=bt},this.dx=function(d){var j=d.split(/[\n\r]+/),et,nt=/gridpositions\s+counts\s+(\d+)\s+(\d+)\s+(\d+)/,ut=/^origin\s+(\S+)\s+(\S+)\s+(\S+)/,b=/^delta\s+(\S+)\s+(\S+)\s+(\S+)/,it=/data follows/,rt=0;for(rt=0;rt<j.length;rt++){var dt=j[rt];if(et=nt.exec(dt)){var ft=parseInt(et[1]),mt=parseInt(et[2]),yt=parseInt(et[3]);this.size={x:ft,y:mt,z:yt}}else if(et=b.exec(dt)){var gt=parseFloat(et[1]);if((parseFloat(et[2])!=0||parseFloat(et[3])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),rt+=1,dt=j[rt],et=b.exec(dt),et==null){console.error("Parse error in dx delta matrix");return}var _t=parseFloat(et[2]);if((parseFloat(et[1])!=0||parseFloat(et[3])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),rt+=1,dt=j[rt],et=b.exec(dt),et==null){console.error("Parse error in dx delta matrix");return}var xt=parseFloat(et[3]);(parseFloat(et[1])!=0||parseFloat(et[2])!=0)&&console.warn("Non-orthogonal delta matrix not currently supported in dx format"),this.unit=new a.Vector3(gt,_t,xt)}else if(et=ut.exec(dt)){var Mt=parseFloat(et[1]),wt=parseFloat(et[2]),Et=parseFloat(et[3]);this.origin=new a.Vector3(Mt,wt,Et)}else if(et=it.exec(dt))break}if(rt+=1,!this.size||!this.origin||!this.unit||!this.size){console.error("Error parsing dx format");return}var At=j.splice(rt).join(" "),St=At.split(/[\s\r]+/);this.data=Float32Array.from(St,parseFloat)},at=at.toLowerCase(),/\.gz$/.test(at)){at=at.replace(/\.gz$/,"");try{this[at]&&this.isbinary.has(at)?(typeof tt=="string"&&(tt=(0,o.base64ToArray)(tt)),tt=(0,g.inflate)(tt)):tt=new TextDecoder("utf-8").decode((0,g.inflate)(tt))}catch(d){console.error(d)}}if(this[at]&&(this.isbinary.has(at)&&typeof tt=="string"&&(tt=(0,o.base64ToArray)(tt)),this[at](tt)),ot){if(ot.negate)for(let d=0,j=this.data.length;d<j;d++)this.data[d]=-this.data[d];if(ot.normalize){var lt=0;for(let d=0,j=this.data.length;d<j;d++)lt+=this.data[d];var ct=lt/this.data.length;lt=0;for(let d=0,j=this.data.length;d<j;d++){var $=this.data[d]-ct;lt+=$*$}var c=lt/this.data.length;for(let d=0,j=this.data.length;d<j;d++)this.data[d]=(this.data[d]-ct)/c}}}getIndex(tt,at,ot){if(this.matrix){this.inversematrix==null&&(this.inversematrix=new a.Matrix4().getInverse(this.matrix));var lt=new a.Vector3(tt,at,ot);lt=lt.applyMatrix4(this.inversematrix),tt=lt.x,at=lt.y,ot=lt.z}else tt-=this.origin.x,at-=this.origin.y,ot-=this.origin.z,tt/=this.unit.x,at/=this.unit.y,ot/=this.unit.z;return tt=Math.round(tt),at=Math.round(at),ot=Math.round(ot),tt<0||tt>=this.size.x||at<0||at>=this.size.y||ot<0||ot>=this.size.z?-1:tt*this.size.y*this.size.z+at*this.size.z+ot}getVal(tt,at,ot){let lt=this.getIndex(tt,at,ot);return lt<0?0:this.data[lt]}cube(tt){var at=tt.split(/\r?\n/);if(!(at.length<6)){var ot=(0,_.CUBE)(tt,{}).modelData[0].cryst,lt=at[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),ct=parseFloat(lt[0]),$=Math.abs(ct);this.origin=ot.origin,this.size=ot.size,this.unit=ot.unit,this.matrix=ot.matrix4;var c=6;ct<0&&c++;var d=at.splice($+c).join(" ");d=d.replace(/^\s+/,"");var j=d.split(/[\s\r]+/);this.data=Float32Array.from(j,parseFloat)}}ccp4(tt){var at={};tt=new Int8Array(tt);var ot=new Int32Array(tt.buffer,0,56),lt=new Float32Array(tt.buffer,0,56),ct=new DataView(tt.buffer);if(at.MAP=String.fromCharCode(ct.getUint8(208),ct.getUint8(209),ct.getUint8(210),ct.getUint8(211)),at.MACHST=[ct.getUint8(212),ct.getUint8(213)],at.MACHST[0]===17&&at.MACHST[1]===17)for(var $=tt.byteLength,c=0;c<$;c+=4)ct.setFloat32(c,ct.getFloat32(c),!0);at.NX=ot[0],at.NY=ot[1],at.NZ=ot[2],at.MODE=ot[3],at.NXSTART=ot[4],at.NYSTART=ot[5],at.NZSTART=ot[6],at.MX=ot[7],at.MY=ot[8],at.MZ=ot[9],at.xlen=lt[10],at.ylen=lt[11],at.zlen=lt[12],at.alpha=lt[13],at.beta=lt[14],at.gamma=lt[15],at.MAPC=ot[16],at.MAPR=ot[17],at.MAPS=ot[18],at.DMIN=lt[19],at.DMAX=lt[20],at.DMEAN=lt[21],at.ISPG=ot[22],at.NSYMBT=ot[23],at.LSKFLG=ot[24],at.originX=lt[49],at.originY=lt[50],at.originZ=lt[51],at.ARMS=lt[54];var d=at,j=[d.xlen,0,0],et=[d.ylen*Math.cos(Math.PI/180*d.gamma),d.ylen*Math.sin(Math.PI/180*d.gamma),0],nt=[d.zlen*Math.cos(Math.PI/180*d.beta),d.zlen*(Math.cos(Math.PI/180*d.alpha)-Math.cos(Math.PI/180*d.gamma)*Math.cos(Math.PI/180*d.beta))/Math.sin(Math.PI/180*d.gamma),0];nt[2]=Math.sqrt(d.zlen*d.zlen*Math.sin(Math.PI/180*d.beta)*Math.sin(Math.PI/180*d.beta)-nt[1]*nt[1]);var ut=[0,j,et,nt],b=[0,d.MX,d.MY,d.MZ],it=[0,d.MAPC,d.MAPR,d.MAPS];this.matrix=new a.Matrix4,this.matrix.set(ut[it[1]][0]/b[it[1]],ut[it[2]][0]/b[it[2]],ut[it[3]][0]/b[it[3]],0,ut[it[1]][1]/b[it[1]],ut[it[2]][1]/b[it[2]],ut[it[3]][1]/b[it[3]],0,ut[it[1]][2]/b[it[1]],ut[it[2]][2]/b[it[2]],ut[it[3]][2]/b[it[3]],0,0,0,0,1),this.matrix=this.matrix.multiplyMatrices(this.matrix,new a.Matrix4().makeTranslation(d.NXSTART+d.originX,d.NYSTART+d.originY,d.NZSTART+d.originZ)),this.origin=new a.Vector3(0,0,0),this.unit=new a.Vector3(1,1,1),this.size={x:at.NX,y:at.NY,z:at.NZ},this.dimensionorder=[at.MAPC,at.MAPR,at.MAPS];var rt=new Float32Array(tt.buffer,1024+at.NSYMBT),dt=at.NX,ft=at.NY,mt=at.NZ;this.data=new Float32Array(dt*ft*mt);for(let yt=0;yt<dt;yt++)for(let gt=0;gt<ft;gt++)for(let _t=0;_t<mt;_t++)this.data[(yt*ft+gt)*mt+_t]=rt[(_t*ft+gt)*dt+yt]}}},"./src/VolumetricRender.ts"(e,i,s){s.r(i),s.d(i,{GLVolumetricRender:()=>_e});var o=s("./src/WebGL/shapes/index.ts"),a=s("./src/WebGL/math/index.ts"),h=s("./src/WebGL/index.ts"),_=s("./src/colors.ts"),g=s("./src/GLShape.ts");class _e{static interpolateArray(tt,at){function ot(nt,ut,b){return nt+(ut-nt)*b}var lt=[],ct=(tt.length-1)/(at-1);lt[0]=tt[0];for(var $=1;$<at-1;$++){var c=$*ct,d=Math.floor(c),j=Math.ceil(c),et=c-d;lt[$]=ot(tt[d],tt[j],et)}return lt[at-1]=tt[tt.length-1],lt}constructor(tt,at,ot){this.hidden=!1,this.boundingSphere=new o.Sphere,this.renderedShapeObj=null,this.shapeObj=null,this.subsamples=5,this.data=null,this.transferfunctionbuffer=[],this.min=0,this.max=0,at=at||{};var lt=Object.assign([],at.transferfn);this.subsamples=at.subsamples||5;let ct=256;lt.forEach(function(ft){ft.value=parseFloat(ft.value)}),lt.sort(function(ft,mt){return ft.value-mt.value}),this.min=lt[0].value,lt.length==0&&lt.push(lt[0]),this.max=lt[lt.length-1].value;var $,c,d,j,et,nt,ut,b,it,rt;for(let ft=0;ft<lt.length-1;ft++)if(d=_.CC.color(lt[ft].color),j=_.CC.color(lt[ft+1].color),it=lt[ft].opacity,rt=lt[ft+1].opacity,$=Math.floor((lt[ft].value-this.min)*ct/(this.max-this.min)),c=Math.floor((lt[ft+1].value-this.min)*ct/(this.max-this.min)),$!=c){et=_e.interpolateArray([d.r*255,j.r*255],c-$),nt=_e.interpolateArray([d.g*255,j.g*255],c-$),ut=_e.interpolateArray([d.b*255,j.b*255],c-$),b=_e.interpolateArray([it*255,rt*255],c-$);for(let mt=0;mt<et.length;mt++)this.transferfunctionbuffer.push(et[mt]),this.transferfunctionbuffer.push(nt[mt]),this.transferfunctionbuffer.push(ut[mt]),this.transferfunctionbuffer.push(b[mt])}if(this.transferfunctionbuffer=new Uint8ClampedArray(this.transferfunctionbuffer),tt.matrix){let ft=new a.Vector3(0,0,0),mt=new a.Vector3(tt.size.x,tt.size.y,tt.size.z),yt=new a.Vector3(1,1,1);ft.applyMatrix4(tt.matrix),mt.applyMatrix4(tt.matrix),yt.applyMatrix4(tt.matrix).sub(ft),this.extent=[[ft.x,ft.y,ft.z],[mt.x,mt.y,mt.z]];for(let Mt=1;Mt<7;Mt++)mt.x=Mt&1?tt.size.x:0,mt.y=Mt&2?tt.size.y:0,mt.z=Mt&4?tt.size.z:0,mt.applyMatrix4(tt.matrix),this.extent[0][0]=Math.min(this.extent[0][0],mt.x),this.extent[0][1]=Math.min(this.extent[0][1],mt.y),this.extent[0][2]=Math.min(this.extent[0][2],mt.z),this.extent[1][0]=Math.max(this.extent[1][0],mt.x),this.extent[1][1]=Math.max(this.extent[1][1],mt.y),this.extent[1][2]=Math.max(this.extent[1][2],mt.z);let gt=mt.x-ft.x,_t=mt.y-ft.y,xt=mt.z-ft.z;this.maxdepth=Math.sqrt(gt*gt+_t*_t+xt*xt),this.minunit=Math.min(Math.min(yt.x,yt.y),yt.z),this.texmatrix=new a.Matrix4().identity().scale({x:tt.size.x,y:tt.size.y,z:tt.size.z}),this.texmatrix=this.texmatrix.multiplyMatrices(tt.matrix,this.texmatrix),this.texmatrix=this.texmatrix.getInverse(this.texmatrix)}else{this.texmatrix=new a.Matrix4().identity();let ft=tt.unit.x*tt.size.x,mt=tt.unit.y*tt.size.y,yt=tt.unit.z*tt.size.z;this.texmatrix.makeTranslation(-tt.origin.x/ft,-tt.origin.y/mt,-tt.origin.z/yt),this.texmatrix.scale({x:1/ft,y:1/mt,z:1/yt}),this.minunit=Math.min(Math.min(tt.unit.x,tt.unit.y),tt.unit.z),this.extent=[[tt.origin.x,tt.origin.y,tt.origin.z],[tt.origin.x+ft,tt.origin.y+mt,tt.origin.z+yt]],this.maxdepth=Math.sqrt(ft*ft+mt*mt+yt*yt)}var dt=new g.GLShape({});if(dt.addBox({corner:{x:this.extent[0][0],y:this.extent[0][1],z:this.extent[0][2]},dimensions:{w:this.extent[1][0]-this.extent[0][0],h:this.extent[1][1]-this.extent[0][1],d:this.extent[1][2]-this.extent[0][2]}}),this.geo=dt.finalize(),this.boundingSphere.center=new a.Vector3((this.extent[0][0]+this.extent[1][0])/2,(this.extent[0][1]+this.extent[1][1])/2,(this.extent[0][2]+this.extent[1][2])/2),this.boundingSphere.radius=this.maxdepth/2,at.coords===void 0&&at.selection!==void 0&&(ot?at.coords=ot.selectedAtoms(at.selection):console.log("Need to provide viewer to volumetric renderer if selection specified.")),at.coords!==void 0&&at.seldist!==void 0){let ft=new Uint8Array(tt.data.length),mt=at.seldist,yt=mt*mt;for(let gt=0,_t=at.coords.length;gt<_t;gt++){let xt=at.coords[gt],Mt=xt.x-mt,wt=xt.y-mt,Et=xt.z-mt,At=xt.x+mt,St=xt.y+mt,bt=xt.z+mt;if(tt.getIndex(Mt,wt,Et)>=0||tt.getIndex(At,St,bt)>=0)for(let Ct=Mt;Ct<At;Ct+=this.minunit)for(let Nt=wt;Nt<St;Nt+=this.minunit)for(let kt=Et;kt<bt;kt+=this.minunit){let Ht=tt.getIndex(Ct,Nt,kt);Ht>=0&&!ft[Ht]&&(Ct-xt.x)*(Ct-xt.x)+(Nt-xt.y)*(Nt-xt.y)+(kt-xt.z)*(kt-xt.z)<yt&&(ft[Ht]=1)}}for(let gt=0,_t=tt.data.length;gt<_t;gt++)ft[gt]==0&&(tt.data[gt]=1/0)}this.data=tt}globj(tt){if(this.renderedShapeObj&&(tt.remove(this.renderedShapeObj),this.renderedShapeObj=null),!this.hidden){this.shapeObj=new h.Object3D;var at=null,ot=new h.Texture(this.data,!0),lt=new h.Texture(this.transferfunctionbuffer,!1);ot.needsUpdate=!0,lt.needsUpdate=!0,lt.flipY=!1,at=new h.VolumetricMaterial({transferfn:lt,transfermin:this.min,transfermax:this.max,map:ot,extent:this.extent,maxdepth:this.maxdepth,texmatrix:this.texmatrix,unit:this.minunit,subsamples:this.subsamples});var ct=new h.Mesh(this.geo,at);this.shapeObj.add(ct),this.renderedShapeObj=this.shapeObj.clone(),tt.add(this.renderedShapeObj)}}removegl(tt){this.renderedShapeObj&&(this.renderedShapeObj.geometry!==void 0&&this.renderedShapeObj.geometry.dispose(),this.renderedShapeObj.material!==void 0&&this.renderedShapeObj.material.dispose(),tt.remove(this.renderedShapeObj),this.renderedShapeObj=null),this.shapeObj=null}get position(){return this.boundingSphere.center}get x(){return this.boundingSphere.center.x}get y(){return this.boundingSphere.center.y}get z(){return this.boundingSphere.center.z}}},"./src/WebGL/Camera.ts"(e,i,s){s.r(i),s.d(i,{Camera:()=>h});var o=s("./src/WebGL/core/index.ts"),a=s("./src/WebGL/math/index.ts");class h extends o.Object3D{constructor(g=50,_e=1,st=.1,tt=2e3,at=!1){super(),this.projectionMatrix=new a.Matrix4,this.projectionMatrixInverse=new a.Matrix4,this.matrixWorldInverse=new a.Matrix4,this.fov=g,this.aspect=_e,this.near=st,this.far=tt;var ot=this.position.z;this.right=ot*Math.tan(Math.PI/180*g),this.left=-this.right,this.top=this.right/this.aspect,this.bottom=-this.top,this.ortho=!!at,this.updateProjectionMatrix()}lookAt(g){this.matrix.lookAt(this.position,g,this.up),this.rotationAutoUpdate&&(this.useQuaternion===!1&&this.rotation instanceof a.Vector3?this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder):console.error("Unimplemented math operation."))}updateProjectionMatrix(){this.ortho?this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far):this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)}}},"./src/WebGL/Fog.ts"(e,i,s){s.r(i),s.d(i,{Fog:()=>a});var o=s("./src/colors.ts");class a{constructor(_,g=1,_e=1e3){this.name="",this.color=new o.Color(_),this.near=g,this.far=_e}clone(){return new a(this.color.getHex(),this.near,this.far)}}},"./src/WebGL/Renderer.ts"(e,i,s){s.r(i),s.d(i,{Renderer:()=>$});var o=s("./src/WebGL/Camera.ts"),a=s("./src/WebGL/constants/Sides.ts"),h=s("./src/WebGL/constants/TextureConstants.ts"),_=s("./src/WebGL/core/index.ts"),g=s("./src/colors.ts"),_e=s("./src/WebGL/materials/index.ts"),st=s("./src/WebGL/math/index.ts"),tt=s("./src/WebGL/objects/index.ts"),at=s("./src/WebGL/shaders/index.ts"),ot=s("./src/WebGL/SpritePlugin.ts"),lt=null,ct=null;class ${constructor(d){this.context=null,this.devicePixelRatio=1,this.sortObjects=!0,this.autoUpdateObjects=!0,this.autoUpdateScene=!0,this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}},this._offscreen=null,this._bitmap=null,this._programs=[],this._programs_counter=0,this._webglversion=1,this._currentProgram=null,this._currentMaterialId=-1,this._currentGeometryGroupHash=null,this._currentCamera=null,this._geometryGroupCounter=0,this._oldDoubleSided=-1,this._oldFlipSided=-1,this._oldDepthTest=-1,this._oldDepthWrite=-1,this._oldPolygonOffset=null,this._oldLineWidth=null,this._viewportWidth=0,this._viewportHeight=0,this._currentWidth=0,this._currentHeight=0,this._enabledAttributes={},this._vector3=new st.Vector3,this._worldInverse=new st.Matrix4,this._projInverse=new st.Matrix4,this._textureMatrix=new st.Matrix4,this._fullProjModelMatrix=new st.Matrix4,this._fullProjModelMatrixInv=new st.Matrix4,this._direction=new st.Vector3,this._lightsNeedUpdate=!0,this._lights={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},this.sprites=new ot.SpritePlugin,this._screenshader=null,this._AOshader=null,this._blurshader=null,this._vertexattribpos=null,this._aovertexattribpos=null,this._blurvertexattribpos=null,this._screenQuadVBO=null,this._fb=null,this._targetTexture=null,this._depthTexture=null,this._shadingTexture=null,this._scratchTexture=null,this._upscale=null,this._AOstrength=1,this._AOradius=5,this.SHADE_TEXTURE=3,d=d||{},this.row=d.row,this.col=d.col,this.rows=d.rows,this.cols=d.cols,this._canvas=d.canvas!==void 0?d.canvas:document.createElement("canvas"),this._precision=d.precision!==void 0?d.precision:"highp",this._alpha=d.alpha!==void 0?d.alpha:!0,this._premultipliedAlpha=d.premultipliedAlpha!==void 0?d.premultipliedAlpha:!0,this._antialias=d.antialias!==void 0?d.antialias:!1,this._upscale=d.upscale!==void 0?d.upscale:this._antialias,this._preserveDrawingBuffer=d.preserveDrawingBuffer!==void 0?d.preserveDrawingBuffer:!1,this._clearColor=d.clearColor!==void 0?new g.Color(d.clearColor):new g.Color(0),this._clearAlpha=d.clearAlpha!==void 0?d.clearAlpha:0,this._outlineMaterial=new _e.MeshOutlineMaterial(d.outline),this._outlineSphereImposterMaterial=new _e.SphereImposterOutlineMaterial(d.outline),this._outlineStickImposterMaterial=new _e.StickImposterOutlineMaterial(d.outline),this._outlineEnabled=!!d.outline,this._AOEnabled=!!d.ambientOcclusion,d.ambientOcclusion&&typeof d.ambientOcclusion.strength<"u"&&(this._AOstrength=parseFloat(d.ambientOcclusion.strength)),this._AOstrength==0&&(this._AOEnabled=!1),d.ambientOcclusion&&typeof d.ambientOcclusion.radius<"u"&&(this._AOradius=parseFloat(d.ambientOcclusion.radius)),this.domElement=this._canvas,this._canvas.id=d.id,!(d.containerWidth==0||d.containerHeight==0)&&(this.initGL(),this.setDefaultGLState(),this.context=this._gl,this.isWebGL1()?this._extInstanced=this._gl.getExtension("ANGLE_instanced_arrays"):this._extInstanced={vertexAttribDivisorANGLE:this._gl.vertexAttribDivisor.bind(this._gl),drawElementsInstancedANGLE:this._gl.drawElementsInstanced.bind(this._gl)},this._extFragDepth=this._gl.getExtension("EXT_frag_depth"),this._extFloatLinear=this._gl.getExtension("OES_texture_float_linear"),this._extColorBufferFloat=this._gl.getExtension("EXT_color_buffer_float"),this.sprites.init(this))}supportedExtensions(){return{supportsAIA:!!this._extInstanced,supportsImposters:!!this._extFragDepth||!this.isWebGL1(),regen:!1}}getContext(){return this._gl}getCanvas(){return this._canvas}isLost(){return this._gl==null||this._gl.isContextLost()}getPrecision(){return this._precision}setClearColorHex(d,j){this._clearColor.setHex(d),this._clearAlpha=j,this.isLost()||this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha)}enableOutline(d){this._outlineMaterial=new _e.MeshOutlineMaterial(d),this._outlineSphereImposterMaterial=new _e.SphereImposterOutlineMaterial(d),this._outlineStickImposterMaterial=new _e.StickImposterOutlineMaterial(d),this._outlineEnabled=!0}disableOutline(){this._outlineEnabled=!1}enableAmbientOcclusion(d){d&&(d.strength&&(this._AOstrength=d.strength),d.scale&&(this._AOradius=d.scale)),this._AOEnabled=this._AOstrength>0}disableAmbientOcclusion(){this._AOEnabled=!1}setViewport(){if(this._offscreen&&(this._offscreen.width=this._canvas.width,this._offscreen.height=this._canvas.height),this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null&&!this.isLost()){var d=this._gl.drawingBufferWidth/this.cols,j=this._gl.drawingBufferHeight/this.rows;this._viewportWidth=d,this._viewportHeight=j,this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(d*this.col,j*this.row,d,j),this._gl.viewport(d*this.col,j*this.row,d,j)}}setSize(d,j){this.devicePixelRatio=window.devicePixelRatio!==void 0?window.devicePixelRatio:1,this._upscale&&this.devicePixelRatio<2&&(this.devicePixelRatio=2),this._canvas.width=d*this.devicePixelRatio,this._canvas.height=j*this.devicePixelRatio,this._canvas.style.width=d+"px",this._canvas.style.height=j+"px",this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null?(this.isLost()||(this._viewportWidth=this._gl.drawingBufferWidth/this.cols,this._viewportHeight=this._gl.drawingBufferHeight/this.rows),this.setViewport()):(this._viewportWidth=this._canvas.width,this._viewportHeight=this._canvas.height,this.isLost()||this._gl.viewport(0,0,this._gl.drawingBufferWidth,this._gl.drawingBufferHeight)),this.initFrameBuffer()}clear(d,j,et){var nt=0;(d===void 0||d)&&(nt|=this._gl.COLOR_BUFFER_BIT),(j===void 0||j)&&(nt|=this._gl.DEPTH_BUFFER_BIT),(et===void 0||et)&&(nt|=this._gl.STENCIL_BUFFER_BIT),this._gl.clear(nt)}setMaterialFaces(d,j){var et=d.side===a.DoubleSide,nt=d.side===a.BackSide;d.imposter||(nt=j?!nt:nt),this._oldDoubleSided!==et&&(et?this._gl.disable(this._gl.CULL_FACE):this._gl.enable(this._gl.CULL_FACE),this._oldDoubleSided=et),this._oldFlipSided!==nt&&(nt?this._gl.frontFace(this._gl.CW):this._gl.frontFace(this._gl.CCW),this._oldFlipSided=nt),this._gl.cullFace(this._gl.BACK)}setDepthTest(d){this._oldDepthTest!==d&&(d?this._gl.enable(this._gl.DEPTH_TEST):this._gl.disable(this._gl.DEPTH_TEST),this._oldDepthTest=d)}setDepthWrite(d){this._oldDepthWrite!==d&&(this._gl.depthMask(d),this._oldDepthWrite=d)}setBlending(d){d?(this._gl.enable(this._gl.BLEND),this._gl.blendEquationSeparate(this._gl.FUNC_ADD,this._gl.FUNC_ADD),this._gl.blendFuncSeparate(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA)):this._gl.disable(this._gl.BLEND)}initMaterial(d,j,et,nt){d.addEventListener("dispose",this.onMaterialDispose.bind(this));var ut,b;if(b=d.shaderID,b){var it=at.ShaderLib[b];d.vertexShader=it.vertexShader,d.fragmentShader=it.fragmentShader,d.uniforms=at.ShaderUtils.clone(it.uniforms),d.shaded&&d.makeShaded(this.SHADE_TEXTURE)}ut={wireframe:d.wireframe,fragdepth:d.imposter,volumetric:d.volumetric,shaded:d.shaded},d.program=this.buildProgram(d.fragmentShader,d.vertexShader,d.uniforms,ut)}renderBuffer(d,j,et,nt,ut,b){if(nt.visible){var it,rt;if(it=this.setProgram(d,j,et,nt,b,this),!!it){rt=it.attributes;var dt=!1,ft=nt.wireframe?1:0,mt=ut.id*16777215+it.id*2+ft;mt!==this._currentGeometryGroupHash&&(this._currentGeometryGroupHash=mt,dt=!0),dt&&(this.disableAttributes(),rt.position>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,ut.__webglVertexBuffer),this.enableAttribute(rt.position),this._gl.vertexAttribPointer(rt.position,3,this._gl.FLOAT,!1,0,0)),rt.color>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,ut.__webglColorBuffer),this.enableAttribute(rt.color),this._gl.vertexAttribPointer(rt.color,3,this._gl.FLOAT,!1,0,0)),rt.normal>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,ut.__webglNormalBuffer),this.enableAttribute(rt.normal),this._gl.vertexAttribPointer(rt.normal,3,this._gl.FLOAT,!1,0,0)),rt.offset>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,ut.__webglOffsetBuffer),this.enableAttribute(rt.offset),this._gl.vertexAttribPointer(rt.offset,3,this._gl.FLOAT,!1,0,0)),rt.radius>=0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,ut.__webglRadiusBuffer),this.enableAttribute(rt.radius),this._gl.vertexAttribPointer(rt.radius,1,this._gl.FLOAT,!1,0,0)));var yt,gt;if(b instanceof tt.Mesh){if(nt.shaderID==="instanced"){var _t=nt.sphere.geometryGroups[0];dt&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,ut.__webglVertexBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,_t.vertexArray,this._gl.STATIC_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,ut.__webglNormalBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,_t.normalArray,this._gl.STATIC_DRAW),this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,ut.__webglFaceBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,_t.faceArray,this._gl.STATIC_DRAW)),yt=_t.faceidx,this._extInstanced.vertexAttribDivisorANGLE(rt.offset,1),this._extInstanced.vertexAttribDivisorANGLE(rt.radius,1),this._extInstanced.vertexAttribDivisorANGLE(rt.color,1),this._extInstanced.drawElementsInstancedANGLE(this._gl.TRIANGLES,yt,this._gl.UNSIGNED_SHORT,0,ut.radiusArray.length),this._extInstanced.vertexAttribDivisorANGLE(rt.offset,0),this._extInstanced.vertexAttribDivisorANGLE(rt.radius,0),this._extInstanced.vertexAttribDivisorANGLE(rt.color,0)}else nt.wireframe?(gt=ut.lineidx,this.setLineWidth(nt.wireframeLinewidth),dt&&this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,ut.__webglLineBuffer),this._gl.drawElements(this._gl.LINES,gt,this._gl.UNSIGNED_SHORT,0)):(yt=ut.faceidx,dt&&this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,ut.__webglFaceBuffer),this._gl.drawElements(this._gl.TRIANGLES,yt,this._gl.UNSIGNED_SHORT,0));this.info.render.calls++,this.info.render.vertices+=yt,this.info.render.faces+=yt/3}else b instanceof tt.Line&&(gt=ut.vertices,this.setLineWidth(nt.linewidth),this._gl.drawArrays(this._gl.LINES,0,gt),this.info.render.calls++)}}}clearShading(){this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this.clear(!1,!0,!1),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}setShading(d,j,et){let nt=d.__lights,ut=d.fog,b=[];for(let dt=0,ft=d.__webglObjects.length;dt<ft;dt++){let mt=d.__webglObjects[dt];mt.render&&mt[et]&&b.push(mt)}if(b.length==0)return;this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,null,0),this.renderObjects(d.__webglObjects,!0,et+"Depth",j,nt,ut,!1),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._scratchTexture,0),this.clear(!1,!0,!1),this._gl.useProgram(this._AOshader),this._currentProgram=this._AOshader,this.setDepthTest(-1),this.setDepthWrite(-1);let it=this._AOshader.uniforms;this._gl.uniform1f(it.total_strength,this._AOstrength),this._gl.uniform1f(it.radius,this._AOradius),this._fullProjModelMatrix=new st.Matrix4,this._fullProjModelMatrixInv=new st.Matrix4;let rt=b[0].object;this._fullProjModelMatrix.multiplyMatrices(j.projectionMatrix,rt._modelViewMatrix),this._fullProjModelMatrixInv.getInverse(this._fullProjModelMatrix),this._gl.uniformMatrix4fv(it.projectionMatrix,!1,this._fullProjModelMatrix.elements),this._gl.uniformMatrix4fv(it.projinv,!1,this._fullProjModelMatrixInv.elements),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._aovertexattribpos),this._gl.vertexAttribPointer(this._aovertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this.clear(!1,!0,!1),this._gl.useProgram(this._blurshader),this._currentProgram=this._blurshader,this.setDepthTest(-1),this.setDepthWrite(-1),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._blurvertexattribpos),this._gl.vertexAttribPointer(this._blurvertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._scratchTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._targetTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}render(d,j){if(!(j instanceof o.Camera)){console.error("Renderer.render: camera is not an instance of Camera.");return}var et,nt,ut,b,it,rt=d.__lights,dt=d.fog;if(this._currentMaterialId=-1,this._lightsNeedUpdate=!0,this.autoUpdateScene&&d.updateMatrixWorld(),j.parent===void 0&&j.updateMatrixWorld(),j.matrixWorldInverse.getInverse(j.matrixWorld),this.isLost())return;this.autoUpdateObjects&&this.initWebGLObjects(d),this.info.render.calls=0,this.info.render.vertices=0,this.info.render.faces=0,this.info.render.points=0,this._currentWidth=this._viewportWidth,this._currentHeight=this._viewportHeight,this.setViewport(),this.setFrameBuffer(),this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha),this.clear(!0,!0,!0),it=d.__webglObjects;let ft=!1,mt=this._AOEnabled;for(et=0,nt=it.length;et<nt;et++)ut=it[et],b=ut.object,ut.render=!1,b.visible&&(this.setupMatrices(b,j),this.unrollBufferMaterial(ut),ut.render=!0,ut.volumetric&&(ft=!0),ut.hasAO&&(mt=!0));if(this.setBlending(!1),mt&&this.setShading(d,j,"opaque"),this.renderObjects(d.__webglObjects,!0,"opaque",j,rt,dt,!1),mt&&this.clearShading(),this.renderSprites(d,j,!1),this.renderObjects(d.__webglObjects,!0,"transparentDepth",j,rt,dt,!0),this.renderObjects(d.__webglObjects,!1,"transparent",j,rt,dt,!0),ft&&this._fb&&(this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,null,0),this.renderObjects(d.__webglObjects,!1,"volumetric",j,rt,dt,!0)),this.renderFrameBuffertoScreen(),this.setDepthTest(!0),this.setDepthWrite(!0),this.renderSprites(d,j,!0),this._bitmap){const yt=this._offscreen.transferToImageBitmap();this._bitmap.transferFromImageBitmap(yt),yt.close()}}setFrameBuffer(){if(this.isWebGL1()||!this._fb)return;let d=this._viewportWidth,j=this._viewportHeight;this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(0,0,d,j),this._gl.viewport(0,0,d,j),this._gl.bindTexture(this._gl.TEXTURE_2D,this._targetTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.RGBA,d,j,0,this._gl.RGBA,this._gl.UNSIGNED_BYTE,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.bindTexture(this._gl.TEXTURE_2D,this._depthTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,d,j,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._shadingTexture&&(this._gl.deleteTexture(this._shadingTexture),this._shadingTexture=this._gl.createTexture(),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,d,j,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.deleteTexture(this._scratchTexture),this._scratchTexture=this._gl.createTexture(),this._gl.bindTexture(this._gl.TEXTURE_2D,this._scratchTexture),this._gl.texImage2D(this._gl.TEXTURE_2D,0,this._gl.DEPTH_COMPONENT32F,d,j,0,this._gl.DEPTH_COMPONENT,this._gl.FLOAT,null),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE)),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._fb),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,this._targetTexture,0),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._shadingTexture,0),this._gl.clearDepth(1),this._gl.clear(this._gl.DEPTH_BUFFER_BIT),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.TEXTURE_2D,this._depthTexture,0)}initFrameBuffer(){if(this.isWebGL1())return;let d=this._viewportWidth,j=this._viewportHeight;this._gl.enable(this._gl.SCISSOR_TEST),this._gl.scissor(0,0,d,j),this._gl.viewport(0,0,d,j),this._targetTexture=this._gl.createTexture(),this._depthTexture=this._gl.createTexture(),this._shadingTexture=this._gl.createTexture(),this._scratchTexture=this._gl.createTexture(),this._fb=this._gl.createFramebuffer();var et=this._antialias?at.ShaderLib.screenaa:at.ShaderLib.screen;this._screenshader=this.buildProgram(et.fragmentShader,et.vertexShader,et.uniforms,{}),this._vertexattribpos=this._gl.getAttribLocation(this._screenshader,"vertexPosition");var nt=[1,1,-1,1,-1,-1,-1,-1,1,-1,1,1];this._screenQuadVBO=this._gl.createBuffer(),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(nt),this._gl.STATIC_DRAW);let ut=at.ShaderLib.ssao;this._AOshader=this.buildProgram(ut.fragmentShader,ut.vertexShader,ut.uniforms,{}),this._aovertexattribpos=this._gl.getAttribLocation(this._AOshader,"vertexPosition");let b=at.ShaderLib.blur;this._blurshader=this.buildProgram(b.fragmentShader,b.vertexShader,b.uniforms,{}),this._blurvertexattribpos=this._gl.getAttribLocation(this._blurshader,"vertexPosition")}renderFrameBuffertoScreen(){this.isWebGL1()||this._fb===null||(this.setViewport(),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null),this._gl.clear(this._gl.COLOR_BUFFER_BIT|this._gl.DEPTH_BUFFER_BIT),this._gl.frontFace(this._gl.CCW),this._gl.cullFace(this._gl.BACK),this._gl.useProgram(this._screenshader),this._currentProgram=this._screenshader,this.setDepthTest(-1),this.setDepthWrite(-1),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._screenQuadVBO),this._gl.enableVertexAttribArray(this._vertexattribpos),this._gl.vertexAttribPointer(this._vertexattribpos,2,this._gl.FLOAT,!1,0,0),this._gl.activeTexture(this._gl.TEXTURE0),this._gl.bindTexture(this._gl.TEXTURE_2D,this._targetTexture),this._gl.drawArrays(this._gl.TRIANGLES,0,6))}initWebGLObjects(d){if(d.__webglObjects||(d.__webglObjects=[],d.__webglObjectsImmediate=[],d.__webglSprites=[],d.__webglFlares=[]),d.__objectsAdded.length){for(;d.__objectsAdded.length;)this.addObject(d.__objectsAdded[0],d),d.__objectsAdded.splice(0,1);this._currentGeometryGroupHash=-1}for(;d.__objectsRemoved.length;)this.removeObject(d.__objectsRemoved[0],d),d.__objectsRemoved.splice(0,1);for(var j=0,et=d.__webglObjects.length;j<et;j++)this.updateObject(d.__webglObjects[j].object)}getYRatio(){return this.rows!==void 0&&this.row!==void 0?this.rows:1}getXRatio(){return this.cols!==void 0&&this.col!==void 0?this.cols:1}getAspect(d,j){(d==null||j==null)&&(d=this._canvas.width,j=this._canvas.height);var et=d/j;if(this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null){var nt=d/this.cols,ut=j/this.rows;et=nt/ut}return et}setTexture(d,j,et){if(d.needsUpdate){d.__webglInit||(d.__webglInit=!0,d.addEventListener("dispose",this.onTextureDispose.bind(this)),d.__webglTexture=this._gl.createTexture(),this.info.memory.textures++),this._gl.activeTexture(this._gl.TEXTURE0+j);var nt=et?this._gl.TEXTURE_3D:this._gl.TEXTURE_2D;this._gl.bindTexture(nt,d.__webglTexture),this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,d.flipY),this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,d.premultiplyAlpha),this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,d.unpackAlignment),this._gl.pixelStorei(this._gl.PACK_ALIGNMENT,d.unpackAlignment);var ut=this.paramToGL(d.format),b=this.paramToGL(d.type);if(et)this.setTextureParameters(this._gl.TEXTURE_3D,d),this._gl.texImage3D(this._gl.TEXTURE_3D,0,this._gl.R32F,d.image.size.z,d.image.size.y,d.image.size.x,0,this._gl.RED,this._gl.FLOAT,d.image.data);else{var it=d.image,rt=it.width,dt=it.height;typeof rt>"u"&&(rt=it.length,ut==this._gl.RGBA&&(rt/=4),dt=1),this.setTextureParameters(this._gl.TEXTURE_2D,d),this.isWebGL1()?this._gl.texImage2D(this._gl.TEXTURE_2D,0,ut,ut,b,d.image):this._gl.texImage2D(this._gl.TEXTURE_2D,0,ut,rt,dt,0,ut,b,d.image)}d.needsUpdate=!1,d.onUpdate&&d.onUpdate()}else this._gl.activeTexture(this._gl.TEXTURE0+j),et?this._gl.bindTexture(this._gl.TEXTURE_3D,d.__webglTexture):this._gl.bindTexture(this._gl.TEXTURE_2D,d.__webglTexture)}supportsVolumetric(){return!this.isWebGL1()}enableAttribute(d){this._enabledAttributes[d]||(this._gl.enableVertexAttribArray(d),this._enabledAttributes[d]=!0)}disableAttributes(){for(let d in this._enabledAttributes)this._enabledAttributes[d]&&(this._gl.disableVertexAttribArray(d),this._enabledAttributes[d]=!1)}setPolygonOffset(d,j,et){this._oldPolygonOffset!==d&&(d?this._gl.enable(this._gl.POLYGON_OFFSET_FILL):this._gl.disable(this._gl.POLYGON_OFFSET_FILL))}setLineWidth(d){d!==this._oldLineWidth&&(this._gl.lineWidth(d),this._oldLineWidth=d)}deallocateGeometry(d){if(d.__webglInit=void 0,d.__webglVertexBuffer!==void 0&&this._gl.deleteBuffer(d.__webglVertexBuffer),d.__webglColorBuffer!==void 0&&this._gl.deleteBuffer(d.__webglColorBuffer),d.geometryGroups!==void 0)for(var j=0,et=d.groups;j<et;j++){var nt=d.geometryGroups[j];nt.__webglVertexBuffer!==void 0&&this._gl.deleteBuffer(nt.__webglVertexBuffer),nt.__webglColorBuffer!==void 0&&this._gl.deleteBuffer(nt.__webglColorBuffer),nt.__webglNormalBuffer!==void 0&&this._gl.deleteBuffer(nt.__webglNormalBuffer),nt.__webglFaceBuffer!==void 0&&this._gl.deleteBuffer(nt.__webglFaceBuffer),nt.__webglLineBuffer!==void 0&&this._gl.deleteBuffer(nt.__webglLineBuffer)}}deallocateMaterial(d){var j=d.program;if(j!==void 0){d.program=void 0;var et,nt,ut,b=!1;for(et=0,nt=this._programs.length;et<nt;et++)if(ut=this._programs[et],ut.program===j){ut.usedTimes--,ut.usedTimes===0&&(b=!0);break}if(b===!0){var it=[];for(et=0,nt=this._programs.length;et<nt;et++)ut=this._programs[et],ut.program!==j&&it.push(ut);this._programs=it,this._gl.deleteProgram(j),this.info.memory.programs--}}}deallocateTexture(d){if(d.image&&d.image.__webglTextureCube)this._gl.deleteTexture(d.image.__webglTextureCube);else{if(!d.__webglInit)return;d.__webglInit=!1,this._gl.deleteTexture(d.__webglTexture)}}onGeometryDispose(d){var j=d.target;j.removeEventListener("dispose",this.onGeometryDispose),this.deallocateGeometry(j),this.info.memory.geometries--}onTextureDispose(d){var j=d.target;j.removeEventListener("dispose",this.onTextureDispose),this.deallocateTexture(j),this.info.memory.textures--}onMaterialDispose(d){var j=d.target;j.removeEventListener("dispose",this.onMaterialDispose),this.deallocateMaterial(j)}getShader(d,j){var et;return!this.isWebGL1()&&!j.startsWith("#version")&&(j=j.replace(/gl_FragDepthEXT/g,"gl_FragDepth"),d=="fragment"?j=j.replace(/varying/g,"in"):j=j.replace(/varying/g,"out"),j=j.replace(/attribute/g,"in"),j=j.replace(/texture2D/g,"texture"),j=j.replace(/\/\/DEFINEFRAGCOLOR/g,"out vec4 glFragColor;"),j=j.replace(/gl_FragColor/g,"glFragColor"),j=`#version 300 es
`+j),d==="fragment"?et=this._gl.createShader(this._gl.FRAGMENT_SHADER):d==="vertex"&&(et=this._gl.createShader(this._gl.VERTEX_SHADER)),et==null?null:(this._gl.shaderSource(et,j),this._gl.compileShader(et),this._gl.getShaderParameter(et,this._gl.COMPILE_STATUS)?et:(console.error(this._gl.getShaderInfoLog(et)),console.error("could not initialize shader"),null))}buildProgram(d,j,et,nt){var ut,b,it,rt,dt=[];dt.push(d),dt.push(j);for(ut in nt)dt.push(ut),dt.push(nt[ut]);for(rt=dt.join(),ut=0,b=this._programs.length;ut<b;ut++){var ft=this._programs[ut];if(ft.code===rt)return ft.usedTimes++,ft.program}if(this.isWebGL1()&&nt.volumetric)throw new Error("Volumetric rendering requires webgl2 which is not supported by your hardware.");if(it=this._gl.createProgram(),it==null)return null;var mt=this._precision,yt="precision "+mt+" float;",gt=[nt.volumetric?"#version 300 es":"",yt].join(`
`),_t=[nt.volumetric?"#version 300 es":"",nt.fragdepth&&this.isWebGL1()?"#extension GL_EXT_frag_depth: enable":"",nt.shaded?"#define SHADED 1":"",nt.wireframe?"#define WIREFRAME 1":"",yt].join(`
`),xt=this.getShader("fragment",_t+d),Mt=this.getShader("vertex",gt+j);Mt!=null&&this._gl.attachShader(it,Mt),xt!=null&&this._gl.attachShader(it,xt),this._gl.linkProgram(it),this._gl.getProgramParameter(it,this._gl.LINK_STATUS)||console.error("Could not initialize shader"),it.uniforms={},it.attributes={};var wt,Et,At;wt=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","vWidth","vHeight"];for(Et in et)wt.push(Et);for(At=0;At<wt.length;At++){var St=wt[At];it.uniforms[St]=this._gl.getUniformLocation(it,St)}for(wt=["position","normal","color","lineDistance","offset","radius"],At=0;At<wt.length;At++){var bt=wt[At];it.attributes[bt]=this._gl.getAttribLocation(it,bt)}return it.id=this._programs_counter++,this._programs.push({program:it,code:rt,usedTimes:1}),this.info.memory.programs=this._programs.length,it}setProgram(d,j,et,nt,ut,b){if(nt.needsUpdate&&(nt.program&&this.deallocateMaterial(nt),this.initMaterial(nt,j,et,ut),nt.needsUpdate=!1),nt.program==null)return null;var it=!1,rt=nt.program,dt=rt.uniforms,ft=nt.uniforms;if(rt!=this._currentProgram&&(this._gl.useProgram(rt),this._currentProgram=rt,it=!0),nt.id!=this._currentMaterialId&&(this._currentMaterialId=nt.id,it=!0),d!=this._currentCamera&&(this._currentCamera=d,it=!0),dt.projectionMatrix&&this._gl.uniformMatrix4fv(dt.projectionMatrix,!1,d.projectionMatrix.elements),dt.modelViewMatrix&&this._gl.uniformMatrix4fv(dt.modelViewMatrix,!1,ut._modelViewMatrix.elements),dt.normalMatrix&&this._gl.uniformMatrix3fv(dt.normalMatrix,!1,ut._normalMatrix.elements),dt.projinv&&(this._projInverse.getInverse(d.projectionMatrix),this._gl.uniformMatrix4fv(dt.projinv,!1,this._projInverse.elements)),dt.viewMatrix&&this._gl.uniformMatrix4fv(dt.viewMatrix,!1,d.matrixWorldInverse.elements),dt.vWidth&&this._gl.uniform1f(dt.vWidth,this._viewportWidth),dt.vHeight&&this._gl.uniform1f(dt.vHeight,this._viewportHeight),it){if(ft.fogColor.value=et.color,ft.fogNear.value=et.near,ft.fogFar.value=et.far,nt.shaderID.startsWith("lambert")||nt.shaderID==="instanced"||nt.shaderID.endsWith("imposter"))this._lightsNeedUpdate&&(this.setupLights(rt,j),this._lightsNeedUpdate=!1),ft.directionalLightColor.value=this._lights.directional.colors,ft.directionalLightDirection.value=this._lights.directional.positions;else if(nt.shaderID.endsWith("outline"))ft.outlineColor.value=nt.outlineColor,ft.outlineWidth.value=nt.outlineWidth,ft.outlinePushback.value=nt.outlinePushback,ft.outlineMaxPixels.value=nt.outlineMaxPixels*this.devicePixelRatio;else if(nt.shaderID==="volumetric"){ut._modelViewMatrix.getScale(this._direction),this._worldInverse.getInverse(ut._modelViewMatrix),this._projInverse.getInverse(d.projectionMatrix),this._textureMatrix.multiplyMatrices(ut.material.texmatrix,this._worldInverse),this._gl.uniformMatrix4fv(dt.textmat,!1,this._textureMatrix.elements),this._gl.uniformMatrix4fv(dt.projinv,!1,this._projInverse.elements);let mt=Math.min(Math.min(this._direction.x,this._direction.y),this._direction.z);ft.step.value=ut.material.unit*mt,ft.maxdepth.value=ut.material.maxdepth*mt,ft.transfermax.value=ut.material.transfermax,ft.transfermin.value=ut.material.transfermin,ft.subsamples.value=ut.material.subsamples,b.setTexture(ut.material.transferfn,4,!1),b.setTexture(ut.material.map,3,!0),this._gl.activeTexture(this._gl.TEXTURE5),this._gl.bindTexture(this._gl.TEXTURE_2D,this._depthTexture)}ft.opacity.value=nt.opacity,this.loadMaterialUniforms(dt,ft)}return ft.shading&&(ft.shading.value==3?(this._gl.activeTexture(this._gl.TEXTURE0+this.SHADE_TEXTURE),this._gl.bindTexture(this._gl.TEXTURE_2D,this._shadingTexture)):console.error("Invalid shading textures.")),rt}loadMaterialUniforms(d,j){var et,nt,ut,b;for(et in j)d[et]&&(nt=j[et].type,ut=j[et].value,b=d[et],nt==="f"?this._gl.uniform1f(b,ut):nt==="i"?this._gl.uniform1i(b,ut):nt==="fv"?this._gl.uniform3fv(b,ut):nt==="c"?this._gl.uniform3f(b,ut.r,ut.g,ut.b):nt==="f4"&&this._gl.uniform4f(b,ut[0],ut[1],ut[2],ut[3]))}addObject(d,j){var et,nt,ut,b;if(!d.__webglInit&&(d.__webglInit=!0,d._modelViewMatrix=new st.Matrix4,d._normalMatrix=new st.Matrix3,d.geometry!==void 0&&d.geometry.__webglInit===void 0&&(d.geometry.__webglInit=!0,d.geometry.addEventListener("dispose",this.onGeometryDispose.bind(this))),d instanceof tt.Mesh||d instanceof tt.Line))for(ut=d.geometry,et=0,nt=ut.geometryGroups.length;et<nt;et++)b=ut.geometryGroups[et],b.id=this._geometryGroupCounter++,b.__webglVertexBuffer||(d instanceof tt.Mesh?(this.createMeshBuffers(b),ut.elementsNeedUpdate=!0,ut.normalsNeedUpdate=!0):d instanceof tt.Line&&this.createLineBuffers(b),ut.verticesNeedUpdate=!0,ut.colorsNeedUpdate=!0);if(!d.__webglActive){if(d instanceof tt.Mesh||d instanceof tt.Line)for(ut=d.geometry,et=0,nt=ut.geometryGroups.length;et<nt;et++)b=ut.geometryGroups[et],this.addBuffer(j.__webglObjects,b,d);else d instanceof tt.Sprite&&j.__webglSprites.push(d);d.__webglActive=!0}}updateObject(d){var j=d.geometry,et;if(d instanceof tt.Mesh||d instanceof tt.Line){for(var nt=0,ut=j.geometryGroups.length;nt<ut;nt++)et=j.geometryGroups[nt],(j.verticesNeedUpdate||j.elementsNeedUpdate||j.colorsNeedUpdate||j.normalsNeedUpdate)&&this.setBuffers(et,this._gl.STATIC_DRAW);j.verticesNeedUpdate=!1,j.elementsNeedUpdate=!1,j.normalsNeedUpdate=!1,j.colorsNeedUpdate=!1,j.buffersNeedUpdate=!1}}removeObject(d,j){d instanceof tt.Mesh||d instanceof tt.Line?this.removeInstances(j.__webglObjects,d):d instanceof tt.Sprite&&this.removeInstancesDirect(j.__webglSprites,d),d.__webglActive=!1}removeInstances(d,j){for(var et=d.length-1;et>=0;--et)d[et].object===j&&d.splice(et,1)}removeInstancesDirect(d,j){for(var et=d.length-1;et>=0;--et)d[et]===j&&d.splice(et,1)}unrollBufferMaterial(d){var j=d.object,et=j.material;if(et.volumetric)d.opaque=null,d.transparent=null,d.volumetric=et;else if(et.transparent){if(d.opaque=null,d.volumetric=null,d.transparent=et,!et.wireframe){let nt=et.clone();nt.opacity=0,d.transparentDepth=nt}}else{if(d.opaque=et,d.transparent=null,d.volumetric=null,!et.wireframe){let nt=et.clone();nt.opacity=0,d.opaqueDepth=nt}et.hasAO&&(d.hasAO=!0),(this._AOEnabled||d.hasAO)&&(d.opaqueShaded=et.clone(),d.opaqueShaded.shaded=!0)}}setBuffers(d,j){var et=d.vertexArray,nt=d.colorArray;if(d.__webglOffsetBuffer!==void 0?(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,d.__webglOffsetBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,et,j)):(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,d.__webglVertexBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,et,j)),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,d.__webglColorBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,nt,j),d.normalArray&&d.__webglNormalBuffer!==void 0){var ut=d.normalArray;this._gl.bindBuffer(this._gl.ARRAY_BUFFER,d.__webglNormalBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,ut,j)}if(d.radiusArray&&d.__webglRadiusBuffer!==void 0&&(this._gl.bindBuffer(this._gl.ARRAY_BUFFER,d.__webglRadiusBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,d.radiusArray,j)),d.faceArray&&d.__webglFaceBuffer!==void 0){var b=d.faceArray;this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,d.__webglFaceBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,b,j)}if(d.lineArray&&d.__webglLineBuffer!==void 0){var it=d.lineArray;this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER,d.__webglLineBuffer),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,it,j)}}createMeshBuffers(d){d.radiusArray&&(d.__webglRadiusBuffer=this._gl.createBuffer()),d.useOffset&&(d.__webglOffsetBuffer=this._gl.createBuffer()),d.__webglVertexBuffer=this._gl.createBuffer(),d.__webglNormalBuffer=this._gl.createBuffer(),d.__webglColorBuffer=this._gl.createBuffer(),d.__webglFaceBuffer=this._gl.createBuffer(),d.__webglLineBuffer=this._gl.createBuffer(),this.info.memory.geometries++}createLineBuffers(d){d.__webglVertexBuffer=this._gl.createBuffer(),d.__webglColorBuffer=this._gl.createBuffer(),this.info.memory.geometries++}addBuffer(d,j,et){d.push({buffer:j,object:et,opaque:null,transparent:null})}setupMatrices(d,j){d._modelViewMatrix.multiplyMatrices(j.matrixWorldInverse,d.matrixWorld),d._normalMatrix.getInverse(d._modelViewMatrix),d._normalMatrix.transpose()}filterFallback(d){return this._gl.LINEAR}setTextureParameters(d,j){d==this._gl.TEXTURE_2D?(this._gl.texParameteri(d,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(d,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(d,this._gl.TEXTURE_MAG_FILTER,this.filterFallback(j.magFilter)),this._gl.texParameteri(d,this._gl.TEXTURE_MIN_FILTER,this.filterFallback(j.minFilter))):(this._gl.texParameteri(d,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(d,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(d,this._gl.TEXTURE_WRAP_R,this._gl.CLAMP_TO_EDGE),this._extColorBufferFloat&&this._extFloatLinear?(this._gl.texParameteri(d,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(d,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR)):(this._gl.texParameteri(d,this._gl.TEXTURE_MAG_FILTER,this._gl.NEAREST),this._gl.texParameteri(d,this._gl.TEXTURE_MIN_FILTER,this._gl.NEAREST)))}paramToGL(d){return d===h.UnsignedByteType?this._gl.UNSIGNED_BYTE:d===h.RGBAFormat?this._gl.RGBA:d===h.NearestFilter?this._gl.NEAREST:0}setupLights(d,j){var et,nt,ut,b=0,it=0,rt=0,dt,ft,mt=this._lights,yt=mt.directional.colors,gt=mt.directional.positions,_t=0,xt=0;for(et=0,nt=j.length;et<nt;et++)if(ut=j[et],dt=ut.color,ft=ut.intensity,ut instanceof _.Light){if(this._direction.getPositionFromMatrix(ut.matrixWorld),this._vector3.getPositionFromMatrix(ut.target.matrixWorld),this._direction.sub(this._vector3),this._direction.normalize(),this._direction.x===0&&this._direction.y===0&&this._direction.z===0)continue;gt[xt]=this._direction.x,gt[xt+1]=this._direction.y,gt[xt+2]=this._direction.z,yt[xt]=dt.r*ft,yt[xt+1]=dt.g*ft,yt[xt+2]=dt.b*ft,xt+=3,_t++}mt.ambient[0]=b,mt.ambient[1]=it,mt.ambient[2]=rt,mt.directional.length=_t}initGL(){try{if(OffscreenCanvas&&!(this.rows!=null&&this.cols!=null&&this.row!=null&&this.col!=null))(ct==null||ct.isContextLost())&&(lt=new OffscreenCanvas(this._canvas.width,this._canvas.height),ct=lt.getContext("webgl2",{alpha:!0,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer})),this._offscreen=lt,this._gl=ct,this._bitmap=this._canvas.getContext("bitmaprenderer",{alpha:!0});else if(!(this._gl=this._canvas.getContext("webgl2",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer}))&&!(this._gl=this._canvas.getContext("experimental-webgl",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer}))&&!(this._gl=this._canvas.getContext("webgl",{alpha:this._alpha,premultipliedAlpha:this._premultipliedAlpha,antialias:this._antialias,preserveDrawingBuffer:this._preserveDrawingBuffer})))throw"Error creating WebGL context.";var d=this._gl.getParameter(this._gl.VERSION);this._webglversion=parseInt(d[6])}catch(j){console.error(j)}}isWebGL1(){return this._webglversion==1}setDefaultGLState(){this._gl.clearDepth(1),this._gl.clearStencil(0),this._gl.enable(this._gl.DEPTH_TEST),this._gl.depthFunc(this._gl.LEQUAL),this._gl.frontFace(this._gl.CCW),this._gl.cullFace(this._gl.BACK),this._gl.enable(this._gl.CULL_FACE),this._gl.enable(this._gl.BLEND),this._gl.blendEquation(this._gl.FUNC_ADD),this._gl.blendFunc(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA),this._gl.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearAlpha)}renderObjects(d,j,et,nt,ut,b,it){var rt,dt,ft,mt,yt,gt,_t;j?(yt=d.length-1,gt=-1,_t=-1):(yt=0,gt=d.length,_t=1);for(var xt=yt;xt!==gt;xt+=_t)if(rt=d[xt],rt.render){if(dt=rt.object,ft=rt.buffer,mt=rt[et],(rt.hasAO||this._AOEnabled)&&rt[et+"Shaded"]&&(mt=rt[et+"Shaded"]),!mt)continue;this.setBlending(it),this.setDepthTest(mt.depthTest),this.setDepthWrite(mt.depthWrite),this.setPolygonOffset(mt.polygonOffset,mt.polygonOffsetFactor,mt.polygonOffsetUnits);var Mt=dt._modelViewMatrix.isReflected();if(this.setMaterialFaces(mt,Mt),this.renderBuffer(nt,ut,b,mt,ft,dt),(this._outlineEnabled||mt.outline)&&!mt.wireframe&&mt.shaderID!=="basic"&&mt.opacity!==0){let wt=this._outlineMaterial;mt.shaderID=="sphereimposter"?wt=this._outlineSphereImposterMaterial:mt.shaderID=="stickimposter"&&(wt=this._outlineStickImposterMaterial),this.renderBuffer(nt,ut,b,wt,ft,dt)}}}renderSprites(d,j,et){this._currentGeometryGroupHash=-1,this._currentProgram=null,this._currentCamera=null,this._oldDepthWrite=-1,this._oldDepthTest=-1,this._oldDoubleSided=-1,this._currentMaterialId=-1,this._oldFlipSided=-1,this._lightsNeedUpdate=!0,this.sprites.render(d,j,this._currentWidth,this._currentHeight,et),this._currentGeometryGroupHash=-1,this._currentProgram=null,this._currentCamera=null,this._oldDepthWrite=-1,this._oldDepthTest=-1,this._oldDoubleSided=-1,this._currentMaterialId=-1,this._oldFlipSided=-1}}},"./src/WebGL/SpritePlugin.ts"(e,i,s){s.r(i),s.d(i,{SpritePlugin:()=>a});var o=s("./src/WebGL/shaders/index.ts");class a{constructor(){this.sprite={vertices:null,faces:null,vertexBuffer:null,elementBuffer:null,program:null,attributes:{},uniforms:null}}init(g){this.gl=g.context,this.renderer=g,this.precision=g.getPrecision(),this.sprite.vertices=new Float32Array(16),this.sprite.faces=new Uint16Array(6);var _e=0;this.sprite.vertices[_e++]=-1,this.sprite.vertices[_e++]=-1,this.sprite.vertices[_e++]=0,this.sprite.vertices[_e++]=0,this.sprite.vertices[_e++]=1,this.sprite.vertices[_e++]=-1,this.sprite.vertices[_e++]=1,this.sprite.vertices[_e++]=0,this.sprite.vertices[_e++]=1,this.sprite.vertices[_e++]=1,this.sprite.vertices[_e++]=1,this.sprite.vertices[_e++]=1,this.sprite.vertices[_e++]=-1,this.sprite.vertices[_e++]=1,this.sprite.vertices[_e++]=0,this.sprite.vertices[_e++]=1,_e=0,this.sprite.faces[_e++]=0,this.sprite.faces[_e++]=1,this.sprite.faces[_e++]=2,this.sprite.faces[_e++]=0,this.sprite.faces[_e++]=2,this.sprite.faces[_e++]=3,this.sprite.vertexBuffer=this.gl.createBuffer(),this.sprite.elementBuffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sprite.vertexBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.sprite.vertices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.elementBuffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.faces,this.gl.STATIC_DRAW),this.sprite.program=this.createProgram(o.ShaderLib.sprite,this.precision||1),this.sprite.attributes={};const st={};this.sprite.attributes.position=this.gl.getAttribLocation(this.sprite.program,"position"),this.sprite.attributes.uv=this.gl.getAttribLocation(this.sprite.program,"uv"),st.uvOffset=this.gl.getUniformLocation(this.sprite.program,"uvOffset"),st.uvScale=this.gl.getUniformLocation(this.sprite.program,"uvScale"),st.rotation=this.gl.getUniformLocation(this.sprite.program,"rotation"),st.scale=this.gl.getUniformLocation(this.sprite.program,"scale"),st.alignment=this.gl.getUniformLocation(this.sprite.program,"alignment"),st.color=this.gl.getUniformLocation(this.sprite.program,"color"),st.map=this.gl.getUniformLocation(this.sprite.program,"map"),st.opacity=this.gl.getUniformLocation(this.sprite.program,"opacity"),st.useScreenCoordinates=this.gl.getUniformLocation(this.sprite.program,"useScreenCoordinates"),st.screenPosition=this.gl.getUniformLocation(this.sprite.program,"screenPosition"),st.modelViewMatrix=this.gl.getUniformLocation(this.sprite.program,"modelViewMatrix"),st.projectionMatrix=this.gl.getUniformLocation(this.sprite.program,"projectionMatrix"),st.fogNear=this.gl.getUniformLocation(this.sprite.program,"fogNear"),st.fogFar=this.gl.getUniformLocation(this.sprite.program,"fogFar"),st.fogColor=this.gl.getUniformLocation(this.sprite.program,"fogColor"),st.alphaTest=this.gl.getUniformLocation(this.sprite.program,"alphaTest"),this.sprite.uniforms=st}render(g,_e,st,tt,at){var ot,lt,ct,$,c,d,j,et,nt,ut;if(!this.gl)throw new Error("WebGLRenderer not initialized");let b=[];(ot=g==null?void 0:g.__webglSprites)===null||ot===void 0||ot.forEach(St=>{(at&&St.material.depthTest==!1||!at&&St.material.depthTest)&&b.push(St)});let it=b.length;if(!it)return;const rt=this.sprite.attributes,dt=this.sprite.uniforms;if(!dt)throw new Error("Uniforms not defined");var ft=st*.5,mt=tt*.5;this.gl.useProgram(this.sprite.program),this.gl.enableVertexAttribArray(rt.position),this.gl.enableVertexAttribArray(rt.uv),this.gl.disable(this.gl.CULL_FACE),this.gl.enable(this.gl.BLEND),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.sprite.vertexBuffer),this.gl.vertexAttribPointer(rt.position,2,this.gl.FLOAT,!1,16,0),this.gl.vertexAttribPointer(rt.uv,2,this.gl.FLOAT,!1,16,8),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.sprite.elementBuffer),this.gl.uniformMatrix4fv(dt.projectionMatrix,!1,_e.projectionMatrix.elements),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.uniform1i(dt.map,0);var yt=g.fog;yt?(this.gl.uniform3f(dt.fogColor,yt.color.r,yt.color.g,yt.color.b),this.gl.uniform1f(dt.fogNear,yt.near),this.gl.uniform1f(dt.fogFar,yt.far)):(this.gl.uniform1f(dt.fogNear,0),this.gl.uniform1f(dt.fogFar,0));var gt;let _t,xt,Mt,wt=[];for(gt=0;gt<it;gt++)_t=b[gt],xt=_t.material,xt&&(xt.depthTest==!1&&!at||!_t.visible||xt.opacity===0||(xt.useScreenCoordinates?_t.z=-_t.position.z:(_t._modelViewMatrix.multiplyMatrices(_e.matrixWorldInverse,_t.matrixWorld),_t.z=-_t._modelViewMatrix.elements[14])));for(b.sort(h),gt=0;gt<it;gt++)if(_t=b[gt],xt=_t.material,!!xt&&!(!_t.visible||xt.opacity===0)&&xt.map&&xt.map.image&&xt.map.image.width){this.gl.uniform1f((dt==null?void 0:dt.alphaTest)||null,xt.alphaTest);var Et=xt.map.image.width,At=xt.map.image.height;wt[0]=Et*this.renderer.devicePixelRatio/st,wt[1]=At*this.renderer.devicePixelRatio/tt,xt.useScreenCoordinates===!0?(this.gl.uniform1i(dt.useScreenCoordinates,1),this.gl.uniform3f(dt.screenPosition,(_t.position.x*this.renderer.devicePixelRatio-ft)/ft,(mt-_t.position.y*this.renderer.devicePixelRatio)/mt,Math.max(0,Math.min(1,_t.position.z)))):(this.gl.uniform1i(dt.useScreenCoordinates,0),this.gl.uniformMatrix4fv(dt.modelViewMatrix,!1,_t._modelViewMatrix.elements)),Mt=1/(xt.scaleByViewport?tt:1),wt[0]*=Mt*_t.scale.x,wt[1]*=Mt*_t.scale.y;let St=(lt=xt==null?void 0:xt.alignment)===null||lt===void 0?void 0:lt.x,bt=(ct=xt==null?void 0:xt.alignment)===null||ct===void 0?void 0:ct.y;xt.screenOffset&&(St=(St||0)+2*xt.screenOffset.x/Et,bt=(bt||0)+2*xt.screenOffset.y/At),this.gl.uniform2f(dt.uvScale,(($=xt==null?void 0:xt.uvScale)===null||$===void 0?void 0:$.x)||1,((c=xt==null?void 0:xt.uvScale)===null||c===void 0?void 0:c.y)||1),this.gl.uniform2f(dt.uvOffset,((d=xt==null?void 0:xt.uvOffset)===null||d===void 0?void 0:d.x)||0,((j=xt==null?void 0:xt.uvOffset)===null||j===void 0?void 0:j.y)||0),this.gl.uniform2f(dt.alignment,St||0,bt||0),this.gl.uniform1f(dt.opacity,xt.opacity),this.gl.uniform3f(dt.color,((et=xt==null?void 0:xt.color)===null||et===void 0?void 0:et.r)||0,((nt=xt==null?void 0:xt.color)===null||nt===void 0?void 0:nt.g)||0,((ut=xt==null?void 0:xt.color)===null||ut===void 0?void 0:ut.b)||0),this.gl.uniform1f(dt.rotation,_t.rotation),this.gl.uniform2fv(dt.scale,wt),this.renderer.setDepthTest(xt.depthTest),this.renderer.setDepthWrite(xt.depthWrite),this.renderer.setTexture(xt.map,0),this.gl.drawElements(this.gl.TRIANGLES,6,this.gl.UNSIGNED_SHORT,0)}this.gl.enable(this.gl.CULL_FACE)}createProgram(g,_e){if(!this.gl)throw new Error("WebGL Rendering context not found");var st=this.gl.createProgram();if(!st)throw new Error("Error creating webgl program");var tt=this.gl.createShader(this.gl.FRAGMENT_SHADER),at=this.gl.createShader(this.gl.VERTEX_SHADER);if(!tt)throw new Error("Unable to create fragment shader SpritePlugin.createProgram");if(!at)throw new Error("Unable to create vertex shader SpritePlugin.createProgram");var ot="precision "+_e+` float;
`;if(this.gl.shaderSource(tt,ot+g.fragmentShader),this.gl.shaderSource(at,ot+g.vertexShader),this.gl.compileShader(tt),this.gl.compileShader(at),!this.gl.getShaderParameter(tt,this.gl.COMPILE_STATUS)||!this.gl.getShaderParameter(at,this.gl.COMPILE_STATUS))throw new Error(`Error compiling shader: 
      ${this.gl.getShaderInfoLog(tt)} 
      ${this.gl.getShaderInfoLog(at)}`);return this.gl.attachShader(st,tt),this.gl.attachShader(st,at),this.gl.linkProgram(st),this.gl.getProgramParameter(st,this.gl.LINK_STATUS)||console.error("Could not initialize shader"),st}}function h(_,g){return _.z!==g.z?g.z-_.z:g.id-_.id}},"./src/WebGL/constants/Coloring.ts"(e,i,s){s.r(i),s.d(i,{Coloring:()=>o});var o;(function(a){a[a.NoColors=0]="NoColors",a[a.FaceColors=1]="FaceColors",a[a.VertexColors=2]="VertexColors"})(o||(o={}))},"./src/WebGL/constants/Shading.ts"(e,i,s){s.r(i),s.d(i,{Shading:()=>o});var o;(function(a){a[a.NoShading=0]="NoShading",a[a.FlatShading=1]="FlatShading",a[a.SmoothShading=2]="SmoothShading"})(o||(o={}))},"./src/WebGL/constants/Sides.ts"(e,i,s){s.r(i),s.d(i,{BackSide:()=>a,DoubleSide:()=>h,FrontSide:()=>o});const o=0,a=1,h=2},"./src/WebGL/constants/SpriteAlignment.ts"(e,i,s){s.r(i),s.d(i,{SpriteAlignment:()=>a});var o=s("./src/WebGL/math/index.ts");const a={topLeft:new o.Vector2(1,-1),topCenter:new o.Vector2(0,-1),topRight:new o.Vector2(-1,-1),centerLeft:new o.Vector2(1,0),center:new o.Vector2(0,0),centerRight:new o.Vector2(-1,0),bottomLeft:new o.Vector2(1,1),bottomCenter:new o.Vector2(0,1),bottomRight:new o.Vector2(-1,1)}},"./src/WebGL/constants/TextureConstants.ts"(e,i,s){s.r(i),s.d(i,{ClampToEdgeWrapping:()=>o,FloatType:()=>_e,LinearFilter:()=>a,LinearMipMapLinearFilter:()=>_,NearestFilter:()=>h,R32Format:()=>at,RFormat:()=>tt,RGBAFormat:()=>st,UnsignedByteType:()=>g});const o=1001,a=1006,h=1007,_=1008,g=1009,_e=1010,st=1021,tt=1022,at=1023},"./src/WebGL/constants/TextureOperations.ts"(e,i,s){s.r(i),s.d(i,{TextureOperations:()=>o});var o;(function(a){a[a.MultiplyOperation=0]="MultiplyOperation",a[a.MixOperation=1]="MixOperation",a[a.AddOperation=2]="AddOperation"})(o||(o={}))},"./src/WebGL/constants/index.ts"(e,i,s){s.r(i),s.d(i,{BackSide:()=>a.BackSide,ClampToEdgeWrapping:()=>g.ClampToEdgeWrapping,Coloring:()=>o.Coloring,DoubleSide:()=>a.DoubleSide,FloatType:()=>g.FloatType,FrontSide:()=>a.FrontSide,LinearFilter:()=>g.LinearFilter,LinearMipMapLinearFilter:()=>g.LinearMipMapLinearFilter,NearestFilter:()=>g.NearestFilter,R32Format:()=>g.R32Format,RFormat:()=>g.RFormat,RGBAFormat:()=>g.RGBAFormat,Shading:()=>h.Shading,SpriteAlignment:()=>_.SpriteAlignment,TextureOperations:()=>_e.TextureOperations,UnsignedByteType:()=>g.UnsignedByteType});var o=s("./src/WebGL/constants/Coloring.ts"),a=s("./src/WebGL/constants/Sides.ts"),h=s("./src/WebGL/constants/Shading.ts"),_=s("./src/WebGL/constants/SpriteAlignment.ts"),g=s("./src/WebGL/constants/TextureConstants.ts"),_e=s("./src/WebGL/constants/TextureOperations.ts")},"./src/WebGL/core/EventDispatcher.ts"(e,i,s){s.r(i),s.d(i,{EventDispatcher:()=>o});class o{constructor(){this.listeners={}}dispatchEvent(h){var _=this.listeners[h.type];if(_!==void 0){h.target=this;for(var g=0,_e=_.length;g<_e;g++)_[g].call(this,h)}}removeEventListener(h,_){if(!_)this.listeners[h]=[];else{var g=this.listeners[h].indexOf(_);g!==-1&&this.listeners[h].splice(g,1)}}addEventListener(h,_){this.listeners[h]===void 0&&(this.listeners[h]=[]),this.listeners[h].indexOf(_)===-1&&this.listeners[h].push(_)}}},"./src/WebGL/core/Geometry.ts"(e,i,s){s.r(i),s.d(i,{Geometry:()=>st,GeometryGroup:()=>_e,GeometryIDCount:()=>tt});var o=s("./src/WebGL/materials/LineBasicMaterial.ts"),a=s("./src/WebGL/core/EventDispatcher.ts"),h=s("./src/WebGL/math/index.ts"),_=s("./src/colors.ts");const g=65535;class _e{constructor(ot=0){this.vertexArray=null,this.colorArray=null,this.normalArray=null,this.radiusArray=null,this.faceArray=null,this.lineArray=null,this.atomArray=Array(),this.vertices=0,this.faceidx=0,this.lineidx=0,this.__inittedArrays=!1,this.id=ot}setColor(ot){var lt=this.vertexArray,ct=this.colorArray;if(!lt)throw new Error("vertex array not initialized");if(!ct)throw new Error("color array not initialized");let $=_.CC.color(ot);for(var c=0;c<lt.length;c+=3)ct[c]=$.r,ct[c+1]=$.g,ct[c+2]=$.b}setColors(ot){var lt=this.vertexArray,ct=this.colorArray;if(!lt)throw new Error("vertex array not initialized");if(!ct)throw new Error("color array not initialized");if(lt.length!=ct.length){console.log("Cannot re-color geometry group due to mismatched lengths.");return}for(var $=0;$<lt.length;$+=3){var c=ot(lt[$],lt[$+1],lt[$+2]);c instanceof _.Color||(c=_.CC.color(c)),ct[$]=c.r,ct[$+1]=c.g,ct[$+2]=c.b}}getNumVertices(){return this.vertices}getVertices(){return this.vertexArray}getCentroid(){if(!this.vertexArray)throw new Error("vertex array not initialized");for(var ot=new h.Vector3,lt,ct,$,c,d=0;d<this.vertices;++d)lt=d*3,ct=this.vertexArray[lt],$=this.vertexArray[lt+1],c=this.vertexArray[lt+2],ot.x+=ct,ot.y+=$,ot.z+=c;return ot.divideScalar(this.vertices),ot}setNormals(){var ot=this.faceArray,lt=this.vertexArray,ct=this.normalArray;if(!(!this.vertices||!this.faceidx)){if(!ot)throw new Error("face array not initialized");if(!lt)throw new Error("vertex array not initialized");if(!ct)throw new Error("normal array not initialized");for(var $,c,d,j,et,nt,ut,b=0;b<ot.length/3;++b)$=ot[b*3]*3,c=ot[b*3+1]*3,d=ot[b*3+2]*3,j=new h.Vector3(lt[$],lt[$+1],lt[$+2]),et=new h.Vector3(lt[c],lt[c+1],lt[c+2]),nt=new h.Vector3(lt[d],lt[d+1],lt[d+2]),j.subVectors(j,et),nt.subVectors(nt,et),nt.cross(j),ut=nt,ut.normalize(),ct[$]+=ut.x,ct[c]+=ut.x,ct[d]+=ut.x,ct[$+1]+=ut.y,ct[c+1]+=ut.y,ct[d+1]+=ut.y,ct[$+2]+=ut.z,ct[c+2]+=ut.z,ct[d+2]+=ut.z}}setLineIndices(){if(this.faceidx&&!(this.lineArray&&this.lineArray.length==this.faceidx*2&&this.lineidx==this.faceidx*2)){var ot=this.faceArray,lt=this.lineArray=new Uint16Array(this.faceidx*2);if(this.lineidx=this.faceidx*2,!ot)throw new Error("face array not initialized");for(var ct=0;ct<this.faceidx/3;++ct){var $=ct*3,c=$*2,d=ot[$],j=ot[$+1],et=ot[$+2];lt[c]=d,lt[c+1]=j,lt[c+2]=d,lt[c+3]=et,lt[c+4]=j,lt[c+5]=et}}}vrml(ot,lt){var ct,$,c,d,j,et,nt,ut,b,it,rt,dt,ft,mt,yt,gt,_t,xt,Mt="";if(Mt+=ot+`Shape {
`+ot+` appearance Appearance {
`+ot+`  material Material {
`+ot+"   diffuseColor "+((ct=lt==null?void 0:lt.color)===null||ct===void 0?void 0:ct.r)+" "+(($=lt==null?void 0:lt.color)===null||$===void 0?void 0:$.g)+" "+((c=lt==null?void 0:lt.color)===null||c===void 0?void 0:c.b)+`
`,lt.wireframe&&this.colorArray){let Et=this.colorArray;Mt+=ot+"    emissiveColor "+Et[0]+" "+Et[1]+" "+Et[2]+`
`}lt!=null&&lt.transparent&&(Mt+=ot+"   transparency "+(1-lt.opacity)+`
`),Mt+=ot+`  }
`,Mt+=ot+` }
`;var wt=ot;if(ot+=" ",lt instanceof o.LineBasicMaterial||lt.wireframe){Mt+=ot+`geometry IndexedLineSet {
`+ot+` colorPerVertex TRUE
`+ot+` coord Coordinate {
`+ot+`  point [
`;let Et,At,St;for(let bt=0;bt<this.vertices;++bt){let Ct=bt*3;Et=(d=this.vertexArray)===null||d===void 0?void 0:d[Ct],At=(j=this.vertexArray)===null||j===void 0?void 0:j[Ct+1],St=(et=this.vertexArray)===null||et===void 0?void 0:et[Ct+2],Mt+=ot+"   "+Et+" "+At+" "+St+`,
`}if(Mt+=ot+`  ]
`,Mt+=ot+` }
`,this.colorArray&&!lt.wireframe){Mt+=ot+` color Color {
`+ot+`  color [
`;for(let bt=0;bt<this.vertices;++bt){let Ct=bt*3;Et=this.colorArray[Ct],At=this.colorArray[Ct+1],St=this.colorArray[Ct+2],Mt+=ot+"   "+Et+" "+At+" "+St+`,
`}Mt+=ot+`  ]
`,Mt+=ot+` }
`}if(Mt+=ot+` coordIndex [
`,lt.wireframe&&this.faceArray)for(let bt=0;bt<this.faceidx;bt+=3)Et=(nt=this.faceArray)===null||nt===void 0?void 0:nt[bt],At=(ut=this.faceArray)===null||ut===void 0?void 0:ut[bt+1],St=(b=this.faceArray)===null||b===void 0?void 0:b[bt+2],Mt+=ot+"  "+Et+", "+At+", "+St+`, -1,
`;else for(let bt=0;bt<this.vertices-1;bt+=2)Mt+=ot+"  "+bt+", "+(bt+1)+`, -1,
`;Mt+=ot+` ]
`,Mt+=ot+`}
`}else{Mt+=ot+`geometry IndexedFaceSet {
`+ot+` colorPerVertex TRUE
`+ot+` normalPerVertex TRUE
`+ot+` solid FALSE
`,Mt+=ot+` coord Coordinate {
`+ot+`  point [
`;let Et,At,St;for(let bt=0;bt<this.vertices;++bt){let Ct=bt*3;Et=(it=this.vertexArray)===null||it===void 0?void 0:it[Ct],At=(rt=this.vertexArray)===null||rt===void 0?void 0:rt[Ct+1],St=(dt=this.vertexArray)===null||dt===void 0?void 0:dt[Ct+2],Mt+=ot+"   "+Et+" "+At+" "+St+`,
`}Mt+=ot+`  ]
`,Mt+=ot+` }
`,Mt+=ot+` normal Normal {
`+ot+`  vector [
`;for(let bt=0;bt<this.vertices;++bt){let Ct=bt*3;Et=(ft=this.normalArray)===null||ft===void 0?void 0:ft[Ct],At=(mt=this.normalArray)===null||mt===void 0?void 0:mt[Ct+1],St=(yt=this.normalArray)===null||yt===void 0?void 0:yt[Ct+2],Mt+=ot+"   "+Et+" "+At+" "+St+`,
`}if(Mt+=ot+`  ]
`,Mt+=ot+` }
`,this.colorArray){Mt+=ot+` color Color {
`+ot+`  color [
`;for(let bt=0;bt<this.vertices;++bt){let Ct=bt*3;Et=this.colorArray[Ct],At=this.colorArray[Ct+1],St=this.colorArray[Ct+2],Mt+=ot+"   "+Et+" "+At+" "+St+`,
`}Mt+=ot+`  ]
`,Mt+=ot+` }
`}Mt+=ot+` coordIndex [
`;for(let bt=0;bt<this.faceidx;bt+=3)Et=(gt=this.faceArray)===null||gt===void 0?void 0:gt[bt],At=(_t=this.faceArray)===null||_t===void 0?void 0:_t[bt+1],St=(xt=this.faceArray)===null||xt===void 0?void 0:xt[bt+2],Mt+=ot+"  "+Et+", "+At+", "+St+`, -1,
`;Mt+=ot+` ]
`,Mt+=ot+`}
`}return Mt+=wt+"}",Mt}truncateArrayBuffers(ot=!0,lt=!1){var ct=this.vertexArray,$=this.colorArray,c=this.normalArray,d=this.faceArray,j=this.lineArray,et=this.radiusArray;this.vertexArray=(ct==null?void 0:ct.subarray(0,this.vertices*3))||null,this.colorArray=($==null?void 0:$.subarray(0,this.vertices*3))||null,ot?(this.normalArray=(c==null?void 0:c.subarray(0,this.vertices*3))||null,this.faceArray=(d==null?void 0:d.subarray(0,this.faceidx))||null,this.lineidx>0?this.lineArray=(j==null?void 0:j.subarray(0,this.lineidx))||null:this.lineArray=new Uint16Array(0)):(this.normalArray=new Float32Array(0),this.faceArray=new Uint16Array(0),this.lineArray=new Uint16Array(0)),et&&(this.radiusArray=et.subarray(0,this.vertices)),lt&&(this.normalArray&&(this.normalArray=new Float32Array(this.normalArray)),this.faceArray&&(this.faceArray=new Uint16Array(this.faceArray)),this.lineArray&&(this.lineArray=new Uint16Array(this.lineArray)),this.vertexArray&&(this.vertexArray=new Float32Array(this.vertexArray)),this.colorArray&&(this.colorArray=new Float32Array(this.colorArray)),this.radiusArray&&(this.radiusArray=new Float32Array(this.radiusArray))),this.__inittedArrays=!0}}class st extends a.EventDispatcher{constructor(ot=!1,lt=!1,ct=!1){super(),this.name="",this.hasTangents=!1,this.dynamic=!0,this.verticesNeedUpdate=!1,this.elementsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.buffersNeedUpdate=!1,this.imposter=!1,this.instanced=!1,this.geometryGroups=[],this.groups=0,this.id=tt++,this.mesh=ot,this.radii=lt,this.offset=ct}updateGeoGroup(ot=0){var lt,ct=this.groups>0?this.geometryGroups[this.groups-1]:null;return(!ct||ct.vertices+ot>(((lt=ct==null?void 0:ct.vertexArray)===null||lt===void 0?void 0:lt.length)||0)/3)&&(ct=this.addGeoGroup()),ct}vrml(ot,lt){for(var ct="",$=this.geometryGroups.length,c=0;c<$;c++){var d=this.geometryGroups[c];ct+=d.vrml(ot,lt)+`,
`}return ct}addGeoGroup(){var ot=new _e(this.geometryGroups.length);return this.geometryGroups.push(ot),this.groups=this.geometryGroups.length,ot.vertexArray=new Float32Array(g*3),ot.colorArray=new Float32Array(g*3),this.mesh&&(ot.normalArray=new Float32Array(g*3),ot.faceArray=new Uint16Array(g*6),ot.lineArray=new Uint16Array(g*6)),this.radii&&(ot.radiusArray=new Float32Array(g)),ot.useOffset=this.offset,ot}setUpNormals(...ot){for(var lt=0;lt<this.groups;lt++){var ct=this.geometryGroups[lt];ct.setNormals(...ot)}}setColors(...ot){for(var lt=this.geometryGroups.length,ct=0;ct<lt;ct++){var $=this.geometryGroups[ct];$.setColors(...ot)}}setColor(...ot){let lt=this.geometryGroups.length;for(var ct=0;ct<lt;ct++){var $=this.geometryGroups[ct];$.setColor(...ot)}}setUpWireframe(...ot){let lt=this.geometryGroups.length;for(var ct=0;ct<lt;ct++){var $=this.geometryGroups[ct];$.setLineIndices(...ot)}}initTypedArrays(){for(var ot=0;ot<this.groups;ot++){var lt=this.geometryGroups[ot];lt.__inittedArrays!==!0&&lt.truncateArrayBuffers(this.mesh,!1)}}dispose(){this.dispatchEvent({type:"dispose"})}get vertices(){for(var ot=0,lt=0;lt<this.groups;lt++)ot+=this.geometryGroups[lt].vertices;return ot}}let tt=0},"./src/WebGL/core/Object3D.ts"(e,i,s){s.r(i),s.d(i,{Light:()=>_e,Object3D:()=>_,Object3DIDCount:()=>h,Scene:()=>g});var o=s("./src/WebGL/math/index.ts"),a=s("./src/colors.ts");let h=0;class _{constructor(){this.id=h++,this.name="",this.children=[],this.position=new o.Vector3,this.rotation=new o.Vector3,this.matrix=new o.Matrix4,this.matrixWorld=new o.Matrix4,this.quaternion=new o.Quaternion,this.eulerOrder="XYZ",this.up=new o.Vector3(0,1,0),this.scale=new o.Vector3(1,1,1),this.matrixAutoUpdate=!0,this.matrixWorldNeedsUpdate=!0,this.rotationAutoUpdate=!0,this.useQuaternion=!1,this.visible=!0}lookAt(tt){this.matrix.lookAt(tt,this.position,this.up),this.rotationAutoUpdate&&(this.useQuaternion===!0?console.error("Unimplemented math operation."):this.rotation instanceof o.Vector3&&this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder))}add(tt){if(tt===this){console.error("Can't add $3Dmol.Object3D to itself");return}tt.parent=this,this.children.push(tt);for(var at=this;at.parent!==void 0;)at=at.parent;at!==void 0&&at instanceof g&&at.__addObject(tt)}remove(tt){var at=this.children.indexOf(tt);if(at!==-1){tt.parent=void 0,this.children.splice(at,1);for(var ot=this;ot.parent!==void 0;)ot=ot.parent;ot!==void 0&&ot instanceof g&&ot.__removeObject(tt)}}vrml(tt){tt||(tt=" ");var at=2*Math.atan2(this.quaternion.lengthxyz(),this.quaternion.w),ot=0,lt=0,ct=0;if(at!=0){let d=Math.sin(at/2);ot=this.quaternion.x/d,lt=this.quaternion.y/d,ct=this.quaternion.z/d}var $=tt+`Transform {
`+tt+" center "+this.position.x+" "+this.position.y+" "+this.position.z+`
`+tt+" rotation "+ot+" "+lt+" "+ct+" "+at+`
`+tt+` children [
`;this.geometry&&($+=this.geometry.vrml(tt,this.material));for(var c=0;c<this.children.length;c++)$+=this.children[c].vrml(tt+" ")+`,
`;return $+=` ]
`,$+="}",$}updateMatrix(){this.matrix.setPosition(this.position),this.useQuaternion===!1&&this.rotation instanceof o.Vector3?this.matrix.setRotationFromEuler(this.rotation,this.eulerOrder):this.matrix.setRotationFromQuaternion(this.quaternion),(this.scale.x!==1||this.scale.y!==1||this.scale.z!==1)&&this.matrix.scale(this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(tt){this.matrixAutoUpdate===!0&&this.updateMatrix(),(this.matrixWorldNeedsUpdate===!0||tt===!0)&&(this.parent===void 0?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1;for(var at=0;at<this.children.length;at++)this.children[at].updateMatrixWorld(!0)}clone(tt){tt===void 0&&(tt=new _),tt.name=this.name,tt.up.copy(this.up),tt.position.copy(this.position),tt.rotation instanceof o.Vector3&&this.rotation instanceof o.Vector3?tt.rotation.copy(this.rotation):tt.rotation=this.rotation,tt.eulerOrder=this.eulerOrder,tt.scale.copy(this.scale),tt.rotationAutoUpdate=this.rotationAutoUpdate,tt.matrix.copy(this.matrix),tt.matrixWorld.copy(this.matrixWorld),tt.quaternion.copy(this.quaternion),tt.matrixAutoUpdate=this.matrixAutoUpdate,tt.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,tt.useQuaternion=this.useQuaternion,tt.visible=this.visible;for(var at=0;at<this.children.length;at++){var ot=this.children[at];tt.add(ot.clone())}return tt}setVisible(tt){this.visible=tt;for(var at=0;at<this.children.length;at++){var ot=this.children[at];ot.setVisible(tt)}}}class g extends _{constructor(){super(...arguments),this.fog=null,this.overrideMaterial=null,this.matrixAutoUpdate=!1,this.__objects=[],this.__lights=[],this.__objectsAdded=[],this.__objectsRemoved=[]}__addObject(tt){if(tt instanceof _e)this.__lights.indexOf(tt)===-1&&this.__lights.push(tt),tt.target&&tt.target.parent===void 0&&this.add(tt.target);else if(this.__objects.indexOf(tt)===-1){this.__objects.push(tt),this.__objectsAdded.push(tt);var at=this.__objectsRemoved.indexOf(tt);at!==-1&&this.__objectsRemoved.splice(at,1)}for(var ot=0;ot<tt.children.length;ot++)this.__addObject(tt.children[ot])}__removeObject(tt){var at;if(tt instanceof _e)at=this.__lights.indexOf(tt),at!==-1&&this.__lights.splice(at,1);else if(at=this.__objects.indexOf(tt),at!==-1){this.__objects.splice(at,1),this.__objectsRemoved.push(tt);var ot=this.__objectsAdded.indexOf(tt);ot!==-1&&this.__objectsAdded.splice(at,1)}for(var lt=0;lt<tt.children.length;lt++)this.__removeObject(tt.children[lt])}}class _e extends _{constructor(tt,at=1){super(),this.position=new o.Vector3(0,1,0),this.target=new _,this.castShadow=!1,this.onlyShadow=!1,this.color=new a.Color(tt),this.intensity=at}}},"./src/WebGL/core/Projector.ts"(e,i,s){s.r(i),s.d(i,{Projector:()=>h});var o=s("./src/WebGL/math/index.ts");const a=new o.Matrix4;class h{static unprojectVector(g,_e){return _e.projectionMatrixInverse.getInverse(_e.projectionMatrix),a.multiplyMatrices(_e.matrixWorld,_e.projectionMatrixInverse),g.applyProjection(a)}static projectVector(g,_e){return _e.matrixWorldInverse.getInverse(_e.matrixWorld),a.multiplyMatrices(_e.projectionMatrix,_e.matrixWorldInverse),g.applyProjection(a)}projectVector(g,_e){return h.projectVector(g,_e)}unprojectVector(g,_e){return h.unprojectVector(g,_e)}}},"./src/WebGL/core/Raycaster.ts"(e,i,s){s.r(i),s.d(i,{Raycaster:()=>g,intersectObject:()=>d});var o=s("./src/WebGL/math/index.ts"),a=s("./src/WebGL/shapes/index.ts");const h=(j,et)=>j.distance-et.distance,_=new o.Matrix4;class g{constructor(et,nt,ut,b){this.precision=1e-4,this.linePrecision=.2,this.ray=new o.Ray(et,nt),this.ray.direction.lengthSq()>0&&this.ray.direction.normalize(),this.near=b||0,this.far=ut||1/0}set(et,nt){this.ray.set(et,nt)}setFromCamera(et,nt){nt.ortho?(this.ray.origin.set(et.x,et.y,(nt.near+nt.far)/(nt.near-nt.far)).unproject(nt),this.ray.direction.set(0,0,-1).transformDirection(nt.matrixWorld)):(this.ray.origin.setFromMatrixPosition(nt.matrixWorld),this.ray.direction.set(et.x,et.y,et.z),nt.projectionMatrixInverse.getInverse(nt.projectionMatrix),_.multiplyMatrices(nt.matrixWorld,nt.projectionMatrixInverse),this.ray.direction.applyProjection(_),this.ray.direction.sub(this.ray.origin).normalize())}intersectObjects(et,nt){for(var ut=[],b=0,it=nt.length;b<it;b++)d(et,nt[b],this,ut);return ut.sort(h),ut}}const _e=j=>Math.min(Math.max(j,-1),1);var st=new a.Sphere,tt=new a.Cylinder,at=new a.Triangle,ot=new o.Vector3,lt=new o.Vector3,ct=new o.Vector3,$=new o.Vector3,c=new o.Vector3;function d(j,et,nt,ut){if(c.getPositionFromMatrix(j.matrixWorld),et.intersectionShape===void 0||et.hidden)return ut;var b=et.intersectionShape,it=nt.linePrecision;it*=j.matrixWorld.getMaxScaleOnAxis();var rt=it*it;if(et.boundingSphere!==void 0&&et.boundingSphere instanceof a.Sphere&&(st.copy(et.boundingSphere),st.applyMatrix4(j.matrixWorld),!nt.ray.isIntersectionSphere(st)))return ut;var dt,ft,mt,yt,gt,_t,xt,Mt,wt,Et,At,St,bt,Ct;for(dt=0,ft=b.triangle.length;dt<ft;dt++)if(b.triangle[dt]instanceof a.Triangle){if(at.copy(b.triangle[dt]),at.applyMatrix4(j.matrixWorld),mt=at.getNormal(),yt=nt.ray.direction.dot(mt),yt>=0||(ot.subVectors(at.a,nt.ray.origin),xt=mt.dot(ot)/yt,xt<0))continue;lt.copy(nt.ray.direction).multiplyScalar(xt).add(nt.ray.origin),lt.sub(at.a),ct.copy(at.b).sub(at.a),$.copy(at.c).sub(at.a);var Nt=ct.dot($),kt=ct.lengthSq(),Ht=$.lengthSq();if(St=(kt*lt.dot($)-Nt*lt.dot(ct))/(kt*Ht-Nt*Nt),St<0||St>1||(At=(lt.dot(ct)-St*Nt)/kt,At<0||At>1||At+St>1))continue;ut.push({clickable:et,distance:xt})}for(dt=0,ft=b.cylinder.length;dt<ft;dt++)if(b.cylinder[dt]instanceof a.Cylinder){if(tt.copy(b.cylinder[dt]),tt.applyMatrix4(j.matrixWorld),ot.subVectors(tt.c1,nt.ray.origin),gt=ot.dot(tt.direction),_t=ot.dot(nt.ray.direction),yt=_e(nt.ray.direction.dot(tt.direction)),wt=1-yt*yt,wt===0)continue;bt=(yt*_t-gt)/wt,Ct=(_t-yt*gt)/wt,lt.copy(tt.direction).multiplyScalar(bt).add(tt.c1),ct.copy(nt.ray.direction).multiplyScalar(Ct).add(nt.ray.origin),Mt=$.subVectors(lt,ct).lengthSq();var jt=tt.radius*tt.radius;if(Mt<=jt){if(Et=(yt*gt-_t)*(yt*gt-_t)-wt*(ot.lengthSq()-gt*gt-jt),Et<=0?St=xt=Math.sqrt(Mt):St=xt=(_t-yt*gt-Math.sqrt(Et))/wt,At=yt*St-gt,At<0||At*At>tt.lengthSq()||St<0)continue;ut.push({clickable:et,distance:xt})}}for(dt=0,ft=b.line.length;dt<ft;dt+=2){lt.copy(b.line[dt]),lt.applyMatrix4(j.matrixWorld),ct.copy(b.line[dt+1]),ct.applyMatrix4(j.matrixWorld),$.subVectors(ct,lt);var Zt=$.lengthSq();$.normalize(),ot.subVectors(lt,nt.ray.origin);var Xt=ot.dot($);_t=ot.dot(nt.ray.direction),yt=_e(nt.ray.direction.dot($)),wt=1-yt*yt,wt!==0&&(bt=(yt*_t-Xt)/wt,Ct=(_t-yt*Xt)/wt,lt.add($.multiplyScalar(bt)),ct.copy(nt.ray.direction).multiplyScalar(Ct).add(nt.ray.origin),Mt=$.subVectors(ct,lt).lengthSq(),Mt<rt&&bt*bt<Zt&&ut.push({clickable:et,distance:Ct}))}for(dt=0,ft=b.sphere.length;dt<ft;dt++)if(b.sphere[dt]instanceof a.Sphere&&(st.copy(b.sphere[dt]),st.applyMatrix4(j.matrixWorld),nt.ray.isIntersectionSphere(st))){lt.subVectors(st.center,nt.ray.origin);var Kt=lt.dot(nt.ray.direction);if(Et=Kt*Kt-(lt.lengthSq()-st.radius*st.radius),Kt<0)return ut;Et<=0?xt=Kt:xt=Kt-Math.sqrt(Et),ut.push({clickable:et,distance:xt})}return ut}},"./src/WebGL/core/Texture.ts"(e,i,s){s.r(i),s.d(i,{Texture:()=>g,TextureIdCount:()=>_e});var o=s("./src/WebGL/constants/TextureConstants.ts"),a=s("./src/WebGL/math/index.ts"),h=s("./src/WebGL/core/EventDispatcher.ts"),_=s("./src/WebGL/core/UVMapping.ts");class g extends h.EventDispatcher{constructor(tt,at){super(),this.id=_e++,this.name="",this.image=tt,this.mapping=new _.UVMapping,this.wrapS=o.ClampToEdgeWrapping,this.wrapT=o.ClampToEdgeWrapping,this.anisotropy=1,at?(this.format=o.RFormat,this.type=o.FloatType,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.magFilter=o.NearestFilter,this.minFilter=o.NearestFilter):(this.format=o.RGBAFormat,this.type=o.UnsignedByteType,this.offset=new a.Vector2(0,0),this.repeat=new a.Vector2(1,1),this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.magFilter=o.LinearFilter,this.minFilter=o.LinearMipMapLinearFilter),this.needsUpdate=!1,this.onUpdate=null}clone(tt=new g){return tt.image=this.image,tt.mapping=this.mapping,tt.wrapS=this.wrapS,tt.wrapT=this.wrapT,tt.magFilter=this.magFilter,tt.minFilter=this.minFilter,tt.anisotropy=this.anisotropy,tt.format=this.format,tt.type=this.type,tt.offset.copy(this.offset),tt.repeat.copy(this.repeat),tt.premultiplyAlpha=this.premultiplyAlpha,tt.flipY=this.flipY,tt.unpackAlignment=this.unpackAlignment,tt}dispose(){this.dispatchEvent({type:"dispose"})}}let _e=0},"./src/WebGL/core/UVMapping.ts"(e,i,s){s.r(i),s.d(i,{UVMapping:()=>o});class o{}},"./src/WebGL/core/index.ts"(e,i,s){s.r(i),s.d(i,{EventDispatcher:()=>o.EventDispatcher,Geometry:()=>a.Geometry,GeometryGroup:()=>a.GeometryGroup,GeometryIDCount:()=>a.GeometryIDCount,Light:()=>h.Light,Object3D:()=>h.Object3D,Object3DIDCount:()=>h.Object3DIDCount,Projector:()=>_.Projector,Raycaster:()=>g.Raycaster,Scene:()=>h.Scene,Texture:()=>_e.Texture,TextureIdCount:()=>_e.TextureIdCount,UVMapping:()=>st.UVMapping,intersectObject:()=>g.intersectObject});var o=s("./src/WebGL/core/EventDispatcher.ts"),a=s("./src/WebGL/core/Geometry.ts"),h=s("./src/WebGL/core/Object3D.ts"),_=s("./src/WebGL/core/Projector.ts"),g=s("./src/WebGL/core/Raycaster.ts"),_e=s("./src/WebGL/core/Texture.ts"),st=s("./src/WebGL/core/UVMapping.ts")},"./src/WebGL/index.ts"(e,i,s){s.r(i),s.d(i,{BackSide:()=>o.BackSide,Camera:()=>tt.Camera,ClampToEdgeWrapping:()=>o.ClampToEdgeWrapping,Coloring:()=>o.Coloring,Cylinder:()=>st.Cylinder,DoubleSide:()=>o.DoubleSide,EventDispatcher:()=>a.EventDispatcher,FloatType:()=>o.FloatType,Fog:()=>at.Fog,FrontSide:()=>o.FrontSide,Geometry:()=>a.Geometry,GeometryGroup:()=>a.GeometryGroup,GeometryIDCount:()=>a.GeometryIDCount,ImposterMaterial:()=>h.ImposterMaterial,InstancedMaterial:()=>h.InstancedMaterial,Light:()=>a.Light,Line:()=>g.Line,LineBasicMaterial:()=>h.LineBasicMaterial,LineStyle:()=>g.LineStyle,LinearFilter:()=>o.LinearFilter,LinearMipMapLinearFilter:()=>o.LinearMipMapLinearFilter,Material:()=>h.Material,MaterialIdCount:()=>h.MaterialIdCount,Matrix3:()=>_.Matrix3,Matrix4:()=>_.Matrix4,Mesh:()=>g.Mesh,MeshDoubleLambertMaterial:()=>h.MeshDoubleLambertMaterial,MeshLambertMaterial:()=>h.MeshLambertMaterial,MeshOutlineMaterial:()=>h.MeshOutlineMaterial,NearestFilter:()=>o.NearestFilter,Object3D:()=>a.Object3D,Object3DIDCount:()=>a.Object3DIDCount,Projector:()=>a.Projector,Quaternion:()=>_.Quaternion,R32Format:()=>o.R32Format,RFormat:()=>o.RFormat,RGBAFormat:()=>o.RGBAFormat,Ray:()=>_.Ray,Raycaster:()=>a.Raycaster,Renderer:()=>ot.Renderer,Scene:()=>a.Scene,ShaderLib:()=>_e.ShaderLib,ShaderUtils:()=>_e.ShaderUtils,Shading:()=>o.Shading,Sphere:()=>st.Sphere,SphereImposterMaterial:()=>h.SphereImposterMaterial,SphereImposterOutlineMaterial:()=>h.SphereImposterOutlineMaterial,Sprite:()=>g.Sprite,SpriteAlignment:()=>o.SpriteAlignment,SpriteMaterial:()=>h.SpriteMaterial,SpritePlugin:()=>lt.SpritePlugin,StickImposterMaterial:()=>h.StickImposterMaterial,StickImposterOutlineMaterial:()=>h.StickImposterOutlineMaterial,Texture:()=>a.Texture,TextureIdCount:()=>a.TextureIdCount,TextureOperations:()=>o.TextureOperations,Triangle:()=>st.Triangle,UVMapping:()=>a.UVMapping,UnsignedByteType:()=>o.UnsignedByteType,Vector2:()=>_.Vector2,Vector3:()=>_.Vector3,VolumetricMaterial:()=>h.VolumetricMaterial,basic:()=>_e.basic,clamp:()=>_.clamp,clone:()=>_e.clone,conversionMatrix3:()=>_.conversionMatrix3,degToRad:()=>_.degToRad,instanced:()=>_e.instanced,intersectObject:()=>a.intersectObject,lambert:()=>_e.lambert,lambertdouble:()=>_e.lambertdouble,outline:()=>_e.outline,screen:()=>_e.screen,screenaa:()=>_e.screenaa,sphereimposter:()=>_e.sphereimposter,sphereimposteroutline:()=>_e.sphereimposteroutline,sprite:()=>_e.sprite,stickimposter:()=>_e.stickimposter,stickimposteroutline:()=>_e.stickimposteroutline,volumetric:()=>_e.volumetric});var o=s("./src/WebGL/constants/index.ts"),a=s("./src/WebGL/core/index.ts"),h=s("./src/WebGL/materials/index.ts"),_=s("./src/WebGL/math/index.ts"),g=s("./src/WebGL/objects/index.ts"),_e=s("./src/WebGL/shaders/index.ts"),st=s("./src/WebGL/shapes/index.ts"),tt=s("./src/WebGL/Camera.ts"),at=s("./src/WebGL/Fog.ts"),ot=s("./src/WebGL/Renderer.ts"),lt=s("./src/WebGL/SpritePlugin.ts")},"./src/WebGL/materials/ImposterMaterial.ts"(e,i,s){s.r(i),s.d(i,{ImposterMaterial:()=>_e});var o=s("./src/WebGL/constants/Coloring.ts"),a=s("./src/WebGL/constants/Shading.ts"),h=s("./src/colors.ts"),_=s("./src/WebGL/math/index.ts"),g=s("./src/WebGL/materials/Material.ts");class _e extends g.Material{constructor(tt){super(),this.color=new h.Color(16777215),this.ambient=new h.Color(1048575),this.emissive=new h.Color(0),this.imposter=!0,this.wrapAround=!1,this.wrapRGB=new _.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=a.Shading.SmoothShading,this.shaderID=null,this.vertexColors=o.Coloring.NoColors,this.skinning=!1,this.setValues(tt)}clone(tt=new _e){return super.clone.call(this,tt),tt.color.copy(this.color),tt.ambient.copy(this.ambient),tt.emissive.copy(this.emissive),tt.wrapAround=this.wrapAround,tt.wrapRGB.copy(this.wrapRGB),tt.map=this.map,tt.lightMap=this.lightMap,tt.specularMap=this.specularMap,tt.envMap=this.envMap,tt.combine=this.combine,tt.reflectivity=this.reflectivity,tt.refractionRatio=this.refractionRatio,tt.fog=this.fog,tt.shading=this.shading,tt.shaderID=this.shaderID,tt.vertexColors=this.vertexColors,tt.skinning=this.skinning,tt.morphTargets=this.morphTargets,tt.morphNormals=this.morphNormals,tt}}},"./src/WebGL/materials/InstancedMaterial.ts"(e,i,s){s.r(i),s.d(i,{InstancedMaterial:()=>_e});var o=s("./src/WebGL/constants/Coloring.ts"),a=s("./src/WebGL/constants/Shading.ts"),h=s("./src/colors.ts"),_=s("./src/WebGL/math/index.ts"),g=s("./src/WebGL/materials/Material.ts");class _e extends g.Material{constructor(tt){super(),this.color=new h.Color(16777215),this.ambient=new h.Color(1048575),this.emissive=new h.Color(0),this.wrapAround=!1,this.wrapRGB=new _.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=a.Shading.SmoothShading,this.shaderID="instanced",this.vertexColors=o.Coloring.NoColors,this.skinning=!1,this.sphere=null,this.setValues(tt)}clone(tt=new _e){return super.clone.call(this,tt),tt.color.copy(this.color),tt.ambient.copy(this.ambient),tt.emissive.copy(this.emissive),tt.wrapAround=this.wrapAround,tt.wrapRGB.copy(this.wrapRGB),tt.map=this.map,tt.lightMap=this.lightMap,tt.specularMap=this.specularMap,tt.envMap=this.envMap,tt.combine=this.combine,tt.reflectivity=this.reflectivity,tt.refractionRatio=this.refractionRatio,tt.fog=this.fog,tt.shading=this.shading,tt.shaderID=this.shaderID,tt.vertexColors=this.vertexColors,tt.skinning=this.skinning,tt.morphTargets=this.morphTargets,tt.morphNormals=this.morphNormals,tt.sphere=this.sphere,tt}}},"./src/WebGL/materials/LineBasicMaterial.ts"(e,i,s){s.r(i),s.d(i,{LineBasicMaterial:()=>h});var o=s("./src/colors.ts"),a=s("./src/WebGL/materials/Material.ts");class h extends a.Material{constructor(g){super(),this.color=new o.Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.vertexColors=!1,this.fog=!0,this.shaderID="basic",this.setValues(g)}clone(g=new h){return super.clone.call(this,g),g.color.copy(this.color),g}}},"./src/WebGL/materials/Material.ts"(e,i,s){s.r(i),s.d(i,{Material:()=>g,MaterialIdCount:()=>_e});var o=s("./src/WebGL/constants/Sides.ts"),a=s("./src/WebGL/core/index.ts"),h=s("./src/WebGL/math/index.ts"),_=s("./src/colors.ts");class g extends a.EventDispatcher{constructor(){super(...arguments),this.id=_e++,this.name="",this.side=o.FrontSide,this.opacity=1,this.transparent=!1,this.depthTest=!0,this.depthWrite=!0,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.alphaTest=0,this.visible=!0,this.needsUpdate=!0,this.outline=!1,this.wireframe=!1,this.shaded=!1}setValues(tt={}){if(tt!==void 0)for(var at in tt){var ot=tt[at];if(ot===void 0){console.warn("$3Dmol.Material: '"+at+"' parameter is undefined.");continue}if(at in this){var lt=this[at];lt instanceof _.Color&&ot instanceof _.Color?lt.copy(ot):lt instanceof _.Color?lt.set(ot):lt instanceof h.Vector3&&ot instanceof h.Vector3?lt.copy(ot):this[at]=ot}}}clone(tt=new g){return tt.name=this.name,tt.side=this.side,tt.opacity=this.opacity,tt.transparent=this.transparent,tt.depthTest=this.depthTest,tt.depthWrite=this.depthWrite,tt.polygonOffset=this.polygonOffset,tt.polygonOffsetFactor=this.polygonOffsetFactor,tt.polygonOffsetUnits=this.polygonOffsetUnits,tt.alphaTest=this.alphaTest,tt.overdraw=this.overdraw,tt.visible=this.visible,tt}makeShaded(tt){this.shaded=!0,this.uniforms&&(this.uniforms.shading={type:"i",value:tt},this.uniforms.vWidth={type:"f",value:1},this.uniforms.vHeight={type:"f",value:1})}dispose(){this.dispatchEvent({type:"dispose"})}}let _e=0},"./src/WebGL/materials/MeshDoubleLambertMaterial.ts"(e,i,s){s.r(i),s.d(i,{MeshDoubleLambertMaterial:()=>h});var o=s("./src/WebGL/constants/Sides.ts"),a=s("./src/WebGL/materials/MeshLambertMaterial.ts");class h extends a.MeshLambertMaterial{constructor(g){super(g),this.shaderID="lambertdouble",this.side=o.DoubleSide,this.outline=!1}clone(g=new h){return super.clone.call(this,g),g}}},"./src/WebGL/materials/MeshLambertMaterial.ts"(e,i,s){s.r(i),s.d(i,{MeshLambertMaterial:()=>_e});var o=s("./src/WebGL/constants/Coloring.ts"),a=s("./src/WebGL/constants/Shading.ts"),h=s("./src/WebGL/materials/Material.ts"),_=s("./src/colors.ts"),g=s("./src/WebGL/math/index.ts");class _e extends h.Material{constructor(tt){super(),this.color=new _.Color(16777215),this.ambient=new _.Color(1048575),this.emissive=new _.Color(0),this.wrapAround=!1,this.wrapRGB=new g.Vector3(1,1,1),this.map=void 0,this.lightMap=null,this.specularMap=null,this.envMap=null,this.reflectivity=1,this.refractionRatio=.98,this.fog=!0,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.shading=a.Shading.SmoothShading,this.shaderID="lambert",this.vertexColors=o.Coloring.NoColors,this.skinning=!1,this.setValues(tt)}clone(tt=new _e){return super.clone.call(this,tt),tt.color.copy(this.color),tt.ambient.copy(this.ambient),tt.emissive.copy(this.emissive),tt.wrapAround=this.wrapAround,tt.wrapRGB.copy(this.wrapRGB),tt.map=this.map,tt.lightMap=this.lightMap,tt.specularMap=this.specularMap,tt.envMap=this.envMap,tt.combine=this.combine,tt.reflectivity=this.reflectivity,tt.refractionRatio=this.refractionRatio,tt.fog=this.fog,tt.shading=this.shading,tt.shaderID=this.shaderID,tt.vertexColors=this.vertexColors,tt.skinning=this.skinning,tt.morphTargets=this.morphTargets,tt.morphNormals=this.morphNormals,tt}}},"./src/WebGL/materials/MeshOutlineMaterial.ts"(e,i,s){s.r(i),s.d(i,{MeshOutlineMaterial:()=>h});var o=s("./src/colors.ts"),a=s("./src/WebGL/materials/Material.ts");class h extends a.Material{constructor(g){super(),g=g||{},this.fog=!0,this.shaderID="outline",this.wireframe=!1,this.outlineColor=o.CC.color(g.color||new o.Color(0,0,0)),this.outlineWidth=g.width||.1,this.outlinePushback=g.pushback||1,this.outlineMaxPixels=g.maxpixels||0}clone(g=new h){return super.clone.call(this,g),g.fog=this.fog,g.shaderID=this.shaderID,g.wireframe=this.wireframe,g.outlineColor=this.outlineColor,g.outlineWidth=this.outlineWidth,g.outlinePushback=this.outlinePushback,g.outlineMaxPixels=this.outlineMaxPixels,g}}},"./src/WebGL/materials/SphereImposterMaterial.ts"(e,i,s){s.r(i),s.d(i,{SphereImposterMaterial:()=>a});var o=s("./src/WebGL/materials/ImposterMaterial.ts");class a extends o.ImposterMaterial{constructor(_){super(_),this.shaderID="sphereimposter",this.setValues(_)}clone(_=new a){return super.clone.call(this,_),_}}},"./src/WebGL/materials/SphereImposterOutlineMaterial.ts"(e,i,s){s.r(i),s.d(i,{SphereImposterOutlineMaterial:()=>h});var o=s("./src/colors.ts"),a=s("./src/WebGL/materials/ImposterMaterial.ts");class h extends a.ImposterMaterial{constructor(g){super(g),g=g||{},this.shaderID="sphereimposteroutline",this.outlineColor=o.CC.color(g.color||new o.Color(0,0,0)),this.outlineWidth=g.width||.1,this.outlinePushback=g.pushback||1,this.outlineMaxPixels=g.maxpixels||0,this.setValues(g)}clone(g=new h){return super.clone.call(this,g),g.outlineColor=this.outlineColor,g.outlineWidth=this.outlineWidth,g.outlinePushback=this.outlinePushback,g.outlineMaxPixels=this.outlineMaxPixels,g}}},"./src/WebGL/materials/SpriteMaterial.ts"(e,i,s){s.r(i),s.d(i,{SpriteMaterial:()=>_e});var o=s("./src/WebGL/constants/SpriteAlignment.ts"),a=s("./src/WebGL/core/Texture.ts"),h=s("./src/colors.ts"),_=s("./src/WebGL/math/index.ts"),g=s("./src/WebGL/materials/Material.ts");class _e extends g.Material{constructor(tt){super(),this.color=new h.Color(16777215),this.map=new a.Texture,this.useScreenCoordinates=!0,this.fog=!1,this.uvOffset=new _.Vector2(0,0),this.uvScale=new _.Vector2(1,1),this.depthTest=!this.useScreenCoordinates,this.sizeAttenuation=!this.useScreenCoordinates,this.screenOffset=this.screenOffset,this.scaleByViewPort=!this.sizeAttenuation,this.alignment=o.SpriteAlignment.center.clone(),this.setValues(tt),tt=tt||{},tt.depthTest===void 0&&(this.depthTest=!this.useScreenCoordinates),tt.sizeAttenuation===void 0&&(this.sizeAttenuation=!this.useScreenCoordinates),tt.scaleByViewPort===void 0&&(this.scaleByViewPort=!this.sizeAttenuation)}clone(tt=new _e){return super.clone.call(this,tt),tt.color.copy(this.color),tt.map=this.map,tt.useScreenCoordinates=this.useScreenCoordinates,tt.screenOffset=this.screenOffset,tt.sizeAttenuation=this.sizeAttenuation,tt.scaleByViewport=this.scaleByViewPort,tt.alignment.copy(this.alignment),tt.uvOffset.copy(this.uvOffset),tt}}},"./src/WebGL/materials/StickImposterMaterial.ts"(e,i,s){s.r(i),s.d(i,{StickImposterMaterial:()=>a});var o=s("./src/WebGL/materials/ImposterMaterial.ts");class a extends o.ImposterMaterial{constructor(_){super(_),this.shaderID="stickimposter",this.setValues(_)}clone(_=new a){return super.clone.call(this,_),_}}},"./src/WebGL/materials/StickImposterOutlineMaterial.ts"(e,i,s){s.r(i),s.d(i,{StickImposterOutlineMaterial:()=>h});var o=s("./src/colors.ts"),a=s("./src/WebGL/materials/ImposterMaterial.ts");class h extends a.ImposterMaterial{constructor(g={}){super(g),this.shaderID="stickimposteroutline",this.outlineColor=new o.Color(0,0,0),this.outlineWidth=.1,this.outlinePushback=1,this.outlineMaxPixels=0,g.color&&(this.outlineColor=o.CC.color(g.color)),g.width&&(this.outlineWidth=g.width),g.pushback&&(this.outlinePushback=g.pushback),g.maxpixels&&(this.outlineMaxPixels=g.maxpixels),this.setValues(g)}clone(g=new h){return super.clone.call(this,g),g.outlineColor=this.outlineColor,g.outlineWidth=this.outlineWidth,g.outlinePushback=this.outlinePushback,g.outlineMaxPixels=this.outlineMaxPixels,g}}},"./src/WebGL/materials/VolumetricMaterial.ts"(e,i,s){s.r(i),s.d(i,{VolumetricMaterial:()=>_});var o=s("./src/WebGL/constants/Sides.ts"),a=s("./src/colors.ts"),h=s("./src/WebGL/materials/Material.ts");class _ extends h.Material{constructor(_e){super(),this.transparent=!1,this.volumetric=!0,this.color=new a.Color(16777215),this.transferfn=null,this.map=void 0,this.extent=[],this.maxdepth=100,this.unit=0,this.texmatrix=null,this.transfermin=-1,this.transfermax=1,this.subsamples=5,this.shaderID="volumetric",this.side=o.FrontSide,this.setValues(_e)}clone(_e=new _){return super.clone.call(this,_e),_e.transparent=this.transparent,_e.volumetric=this.volumetric,_e.color=this.color,_e.transferfn=this.transferfn,_e.map=this.map,_e.extent=this.extent,_e.maxdepth=this.maxdepth,_e.unit=this.unit,_e.texmatrix=this.texmatrix,_e.transfermin=this.transfermin,_e.transfermax=this.transfermax,_e.subsamples=this.subsamples,_e.shaderID=this.shaderID,_e.side=this.side,_e}}},"./src/WebGL/materials/index.ts"(e,i,s){s.r(i),s.d(i,{ImposterMaterial:()=>o.ImposterMaterial,InstancedMaterial:()=>a.InstancedMaterial,LineBasicMaterial:()=>h.LineBasicMaterial,Material:()=>_.Material,MaterialIdCount:()=>_.MaterialIdCount,MeshDoubleLambertMaterial:()=>g.MeshDoubleLambertMaterial,MeshLambertMaterial:()=>_e.MeshLambertMaterial,MeshOutlineMaterial:()=>st.MeshOutlineMaterial,SphereImposterMaterial:()=>tt.SphereImposterMaterial,SphereImposterOutlineMaterial:()=>at.SphereImposterOutlineMaterial,SpriteMaterial:()=>ot.SpriteMaterial,StickImposterMaterial:()=>lt.StickImposterMaterial,StickImposterOutlineMaterial:()=>ct.StickImposterOutlineMaterial,VolumetricMaterial:()=>$.VolumetricMaterial});var o=s("./src/WebGL/materials/ImposterMaterial.ts"),a=s("./src/WebGL/materials/InstancedMaterial.ts"),h=s("./src/WebGL/materials/LineBasicMaterial.ts"),_=s("./src/WebGL/materials/Material.ts"),g=s("./src/WebGL/materials/MeshDoubleLambertMaterial.ts"),_e=s("./src/WebGL/materials/MeshLambertMaterial.ts"),st=s("./src/WebGL/materials/MeshOutlineMaterial.ts"),tt=s("./src/WebGL/materials/SphereImposterMaterial.ts"),at=s("./src/WebGL/materials/SphereImposterOutlineMaterial.ts"),ot=s("./src/WebGL/materials/SpriteMaterial.ts"),lt=s("./src/WebGL/materials/StickImposterMaterial.ts"),ct=s("./src/WebGL/materials/StickImposterOutlineMaterial.ts"),$=s("./src/WebGL/materials/VolumetricMaterial.ts")},"./src/WebGL/math/Quaternion.ts"(e,i,s){s.r(i),s.d(i,{Quaternion:()=>o});class o{constructor(h,_,g,_e){this.x=h||0,this.y=_||0,this.z=g||0,this.w=_e!==void 0?_e:1}set(h,_,g,_e){return this.x=h,this.y=_,this.z=g,this.w=_e,this}copy(h){return this.x=h.x,this.y=h.y,this.z=h.z,this.w=h.w,this}conjugate(){return this.x*=-1,this.y*=-1,this.z*=-1,this}inverse(){return this.conjugate().normalize()}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}lengthxyz(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){let h=this.length();return h===0?(this.x=0,this.y=0,this.z=0,this.w=1):(h=1/h,this.x*=h,this.y*=h,this.z*=h,this.w*=h),this}multiply(h){return this.multiplyQuaternions(this,h)}multiplyScalar(h){return this.x*=h,this.y*=h,this.z*=h,this.w*=h,this}multiplyQuaternions(h,_){const g=h.x,_e=h.y,st=h.z,tt=h.w,at=_.x,ot=_.y,lt=_.z,ct=_.w;return this.x=g*ct+tt*at+_e*lt-st*ot,this.y=_e*ct+tt*ot+st*at-g*lt,this.z=st*ct+tt*lt+g*ot-_e*at,this.w=tt*ct-g*at-_e*ot-st*lt,this}sub(h){return this.x-=h.x,this.y-=h.y,this.z-=h.z,this.w-=h.w,this}clone(){return new o(this.x,this.y,this.z,this.w)}setFromEuler(h){const _=Math.cos(h.x/2),g=Math.cos(h.y/2),_e=Math.cos(h.z/2),st=Math.sin(h.x/2),tt=Math.sin(h.y/2),at=Math.sin(h.z/2);return this.x=st*g*_e+_*tt*at,this.y=_*tt*_e-st*g*at,this.z=_*g*at+st*tt*_e,this.w=_*g*_e-st*tt*at,this}}},"./src/WebGL/math/Vector2.ts"(e,i,s){s.r(i),s.d(i,{Vector2:()=>o});class o{constructor(h,_){this.x=h||0,this.y=_||0}set(h,_){return this.x=h,this.y=_,this}subVectors(h,_){return this.x=h.x-_.x,this.y=h.y-_.y,this}copy(h){return this.x=h.x,this.y=h.y,this}clone(){return new o(this.x,this.y)}}},"./src/WebGL/math/index.ts"(e,i,s){s.r(i),s.d(i,{Matrix3:()=>_e.Matrix3,Matrix4:()=>_e.Matrix4,Quaternion:()=>o.Quaternion,Ray:()=>_e.Ray,Vector2:()=>a.Vector2,Vector3:()=>_e.Vector3,clamp:()=>h.clamp,conversionMatrix3:()=>_.conversionMatrix3,degToRad:()=>g.degToRad});var o=s("./src/WebGL/math/Quaternion.ts"),a=s("./src/WebGL/math/Vector2.ts"),h=s("./src/WebGL/math/utils/clamp.ts"),_=s("./src/WebGL/math/utils/conversionMatrix3.ts"),g=s("./src/WebGL/math/utils/degToRad.ts"),_e=s("./src/WebGL/math/math.ts")},"./src/WebGL/math/math.ts"(e,i,s){s.r(i),s.d(i,{Matrix3:()=>ot,Matrix4:()=>tt,Ray:()=>lt,Vector3:()=>at});var o=s("./src/WebGL/math/utils/degToRad.ts"),a=s("./src/WebGL/math/utils/clamp.ts"),h,_,g,_e,st;class tt{constructor($=1,c=0,d=0,j=0,et=0,nt=1,ut=0,b=0,it=0,rt=0,dt=1,ft=0,mt=0,yt=0,gt=0,_t=1){typeof $<"u"&&typeof $!="number"?this.elements=new Float32Array($):(this.elements=new Float32Array(16),this.elements[0]=$,this.elements[4]=c,this.elements[8]=d,this.elements[12]=j,this.elements[1]=et,this.elements[5]=nt,this.elements[9]=ut,this.elements[13]=b,this.elements[2]=it,this.elements[6]=rt,this.elements[10]=dt,this.elements[14]=ft,this.elements[3]=mt,this.elements[7]=yt,this.elements[11]=gt,this.elements[15]=_t)}makeScale($,c,d){throw new Error("Method not implemented.")}set($,c,d,j,et,nt,ut,b,it,rt,dt,ft,mt,yt,gt,_t){const xt=this.elements;return xt[0]=$,xt[4]=c,xt[8]=d,xt[12]=j,xt[1]=et,xt[5]=nt,xt[9]=ut,xt[13]=b,xt[2]=it,xt[6]=rt,xt[10]=dt,xt[14]=ft,xt[3]=mt,xt[7]=yt,xt[11]=gt,xt[15]=_t,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}copy($){const c=$.elements;return this.set(c[0],c[4],c[8],c[12],c[1],c[5],c[9],c[13],c[2],c[6],c[10],c[14],c[3],c[7],c[11],c[15]),this}matrix3FromTopLeft(){const $=this.elements;return new ot($[0],$[4],$[8],$[1],$[5],$[9],$[2],$[6],$[10])}setRotationFromEuler($,c){const d=this.elements,{x:j,y:et,z:nt}=$,ut=Math.cos(j),b=Math.sin(j),it=Math.cos(et),rt=Math.sin(et),dt=Math.cos(nt),ft=Math.sin(nt);if(c===void 0||c==="XYZ"){const mt=ut*dt,yt=ut*ft,gt=b*dt,_t=b*ft;d[0]=it*dt,d[4]=-it*ft,d[8]=rt,d[1]=yt+gt*rt,d[5]=mt-_t*rt,d[9]=-b*it,d[2]=_t-mt*rt,d[6]=gt+yt*rt,d[10]=ut*it}else console.error(`Error with matrix4 setRotationFromEuler. Order: ${c}`);return this}setRotationFromQuaternion($){const c=this.elements,{x:d,y:j,z:et,w:nt}=$,ut=d+d,b=j+j,it=et+et,rt=d*ut,dt=d*b,ft=d*it,mt=j*b,yt=j*it,gt=et*it,_t=nt*ut,xt=nt*b,Mt=nt*it;return c[0]=1-(mt+gt),c[4]=dt-Mt,c[8]=ft+xt,c[1]=dt+Mt,c[5]=1-(rt+gt),c[9]=yt-_t,c[2]=ft-xt,c[6]=yt+_t,c[10]=1-(rt+mt),this}multiplyMatrices($,c){const d=$.elements,j=c.elements,et=this.elements,nt=d[0],ut=d[4],b=d[8],it=d[12],rt=d[1],dt=d[5],ft=d[9],mt=d[13],yt=d[2],gt=d[6],_t=d[10],xt=d[14],Mt=d[3],wt=d[7],Et=d[11],At=d[15],St=j[0],bt=j[4],Ct=j[8],Nt=j[12],kt=j[1],Ht=j[5],jt=j[9],Zt=j[13],Xt=j[2],Kt=j[6],ar=j[10],or=j[14],_r=j[3],nr=j[7],Vt=j[11],tr=j[15];return et[0]=nt*St+ut*kt+b*Xt+it*_r,et[4]=nt*bt+ut*Ht+b*Kt+it*nr,et[8]=nt*Ct+ut*jt+b*ar+it*Vt,et[12]=nt*Nt+ut*Zt+b*or+it*tr,et[1]=rt*St+dt*kt+ft*Xt+mt*_r,et[5]=rt*bt+dt*Ht+ft*Kt+mt*nr,et[9]=rt*Ct+dt*jt+ft*ar+mt*Vt,et[13]=rt*Nt+dt*Zt+ft*or+mt*tr,et[2]=yt*St+gt*kt+_t*Xt+xt*_r,et[6]=yt*bt+gt*Ht+_t*Kt+xt*nr,et[10]=yt*Ct+gt*jt+_t*ar+xt*Vt,et[14]=yt*Nt+gt*Zt+_t*or+xt*tr,et[3]=Mt*St+wt*kt+Et*Xt+At*_r,et[7]=Mt*bt+wt*Ht+Et*Kt+At*nr,et[11]=Mt*Ct+wt*jt+Et*ar+At*Vt,et[15]=Mt*Nt+wt*Zt+Et*or+At*tr,this}multiplyScalar($){const c=this.elements;return c[0]*=$,c[4]*=$,c[8]*=$,c[12]*=$,c[1]*=$,c[5]*=$,c[9]*=$,c[13]*=$,c[2]*=$,c[6]*=$,c[10]*=$,c[14]*=$,c[3]*=$,c[7]*=$,c[11]*=$,c[15]*=$,this}makeTranslation($,c,d){return this.set(1,0,0,$,0,1,0,c,0,0,1,d,0,0,0,1),this}snap($){const c=Math.pow(10,4),d=this.elements;for(let j=0;j<16;j++){const et=Math.round(d[j]);et===Math.round(d[j]*c)/c&&(d[j]=et)}return this}transpose(){const $=this.elements;let c;return c=$[1],$[1]=$[4],$[4]=c,c=$[2],$[2]=$[8],$[8]=c,c=$[6],$[6]=$[9],$[9]=c,c=$[3],$[3]=$[12],$[12]=c,c=$[7],$[7]=$[13],$[13]=c,c=$[11],$[11]=$[14],$[14]=c,this}setPosition($){const c=this.elements;return c[12]=$.x,c[13]=$.y,c[14]=$.z,this}translate($){const c=this.elements;return c[12]+=$.x,c[13]+=$.y,c[14]+=$.z,this}getInverse($,c){const d=this.elements,j=$.elements,et=j[0],nt=j[4],ut=j[8],b=j[12],it=j[1],rt=j[5],dt=j[9],ft=j[13],mt=j[2],yt=j[6],gt=j[10],_t=j[14],xt=j[3],Mt=j[7],wt=j[11],Et=j[15];d[0]=dt*_t*Mt-ft*gt*Mt+ft*yt*wt-rt*_t*wt-dt*yt*Et+rt*gt*Et,d[4]=b*gt*Mt-ut*_t*Mt-b*yt*wt+nt*_t*wt+ut*yt*Et-nt*gt*Et,d[8]=ut*ft*Mt-b*dt*Mt+b*rt*wt-nt*ft*wt-ut*rt*Et+nt*dt*Et,d[12]=b*dt*yt-ut*ft*yt-b*rt*gt+nt*ft*gt+ut*rt*_t-nt*dt*_t,d[1]=ft*gt*xt-dt*_t*xt-ft*mt*wt+it*_t*wt+dt*mt*Et-it*gt*Et,d[5]=ut*_t*xt-b*gt*xt+b*mt*wt-et*_t*wt-ut*mt*Et+et*gt*Et,d[9]=b*dt*xt-ut*ft*xt-b*it*wt+et*ft*wt+ut*it*Et-et*dt*Et,d[13]=ut*ft*mt-b*dt*mt+b*it*gt-et*ft*gt-ut*it*_t+et*dt*_t,d[2]=rt*_t*xt-ft*yt*xt+ft*mt*Mt-it*_t*Mt-rt*mt*Et+it*yt*Et,d[6]=b*yt*xt-nt*_t*xt-b*mt*Mt+et*_t*Mt+nt*mt*Et-et*yt*Et,d[10]=nt*ft*xt-b*rt*xt+b*it*Mt-et*ft*Mt-nt*it*Et+et*rt*Et,d[14]=b*rt*mt-nt*ft*mt-b*it*yt+et*ft*yt+nt*it*_t-et*rt*_t,d[3]=dt*yt*xt-rt*gt*xt-dt*mt*Mt+it*gt*Mt+rt*mt*wt-it*yt*wt,d[7]=nt*gt*xt-ut*yt*xt+ut*mt*Mt-et*gt*Mt-nt*mt*wt+et*yt*wt,d[11]=ut*rt*xt-nt*dt*xt-ut*it*Mt+et*dt*Mt+nt*it*wt-et*rt*wt,d[15]=nt*dt*mt-ut*rt*mt+ut*it*yt-et*dt*yt-nt*it*gt+et*rt*gt;const At=et*d[0]+it*d[4]+mt*d[8]+xt*d[12];if(At===0){const St="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(c)throw new Error(St);return console.warn(St),this.identity(),this}return this.multiplyScalar(1/At),this}isReflected(){const $=this.elements,c=$[0],d=$[4],j=$[8],et=$[1],nt=$[5],ut=$[9],b=$[2],it=$[6],rt=$[10];return c*nt*rt+et*it*j+b*d*ut-b*nt*j-et*d*rt-c*it*ut<0}scale($){const c=this.elements,{x:d}=$,{y:j}=$,{z:et}=$;return c[0]*=d,c[4]*=j,c[8]*=et,c[1]*=d,c[5]*=j,c[9]*=et,c[2]*=d,c[6]*=j,c[10]*=et,c[3]*=d,c[7]*=j,c[11]*=et,this}getMaxScaleOnAxis(){const $=this.elements,c=$[0]*$[0]+$[1]*$[1]+$[2]*$[2],d=$[4]*$[4]+$[5]*$[5]+$[6]*$[6],j=$[8]*$[8]+$[9]*$[9]+$[10]*$[10];return Math.sqrt(Math.max(c,Math.max(d,j)))}makeFrustum($,c,d,j,et,nt){const ut=this.elements,b=2*et/(c-$),it=2*et/(j-d),rt=(c+$)/(c-$),dt=(j+d)/(j-d),ft=-(nt+et)/(nt-et),mt=-2*nt*et/(nt-et);return ut[0]=b,ut[4]=0,ut[8]=rt,ut[12]=0,ut[1]=0,ut[5]=it,ut[9]=dt,ut[13]=0,ut[2]=0,ut[6]=0,ut[10]=ft,ut[14]=mt,ut[3]=0,ut[7]=0,ut[11]=-1,ut[15]=0,this}makePerspective($,c,d,j){const et=d*Math.tan((0,o.degToRad)($*.5)),nt=-et,ut=nt*c,b=et*c;return this.makeFrustum(ut,b,nt,et,d,j)}makeOrthographic($,c,d,j,et,nt){const ut=this.elements,b=1/(c-$),it=1/(d-j),rt=1/(nt-et),dt=(c+$)*b,ft=(d+j)*it,mt=(nt+et)*rt;return ut[0]=2*b,ut[4]=0,ut[8]=0,ut[12]=-dt,ut[1]=0,ut[5]=2*it,ut[9]=0,ut[13]=-ft,ut[2]=0,ut[6]=0,ut[10]=-2*rt,ut[14]=-mt,ut[3]=0,ut[7]=0,ut[11]=0,ut[15]=1,this}isEqual($){const c=$.elements,d=this.elements;return d[0]===c[0]&&d[4]===c[4]&&d[8]===c[8]&&d[12]===c[12]&&d[1]===c[1]&&d[5]===c[5]&&d[9]===c[9]&&d[13]===c[13]&&d[2]===c[2]&&d[6]===c[6]&&d[10]===c[10]&&d[14]===c[14]&&d[3]===c[3]&&d[7]===c[7]&&d[11]===c[11]&&d[15]===c[15]}clone(){const $=this.elements;return new tt($[0],$[4],$[8],$[12],$[1],$[5],$[9],$[13],$[2],$[6],$[10],$[14],$[3],$[7],$[11],$[15])}isIdentity(){const $=this.elements;return $[0]===1&&$[4]===0&&$[8]===0&&$[12]===0&&$[1]===0&&$[5]===1&&$[9]===0&&$[13]===0&&$[2]===0&&$[6]===0&&$[10]===1&&$[14]===0&&$[3]===0&&$[7]===0&&$[11]===0&&$[15]===1}isNearlyIdentity($){return this.clone().snap($).isIdentity()}getScale($){const c=this.elements;return $=$||new at,g.set(c[0],c[1],c[2]),_e.set(c[4],c[5],c[6]),st.set(c[8],c[9],c[10]),$.x=g.length(),$.y=_e.length(),$.z=st.length(),$}lookAt($,c,d){const j=this.elements;return st.subVectors($,c).normalize(),st.length()===0&&(st.z=1),g.crossVectors(d,st).normalize(),g.length()===0&&(st.x+=1e-4,g.crossVectors(d,st).normalize()),_e.crossVectors(st,g),j[0]=g.x,j[4]=_e.x,j[8]=st.x,j[1]=g.y,j[5]=_e.y,j[9]=st.y,j[2]=g.z,j[6]=_e.z,j[10]=st.z,this}compose($,c,d){const j=this.elements;return h.identity(),h.setRotationFromQuaternion(c),_.makeScale(d.x,d.y,d.z),this.multiplyMatrices(h,_),j[12]=$.x,j[13]=$.y,j[14]=$.z,this}}h=new tt,_=new tt;class at{constructor($,c,d){this.x=$||0,this.y=c||0,this.z=d||0,this.atomid=void 0}set($,c,d){return this.x=$,this.y=c,this.z=d,this}copy($){return this.x=$.x,this.y=$.y,this.z=$.z,this}add($){return this.x+=$.x,this.y+=$.y,this.z+=$.z,this}addVectors($,c){return this.x=$.x+c.x,this.y=$.y+c.y,this.z=$.z+c.z,this}multiplyVectors($,c){return this.x=$.x*c.x,this.y=$.y*c.y,this.z=$.z*c.z,this}sub($){return this.x-=$.x,this.y-=$.y,this.z-=$.z,this}subVectors($,c){return this.x=$.x-c.x,this.y=$.y-c.y,this.z=$.z-c.z,this}multiplyScalar($){return this.x*=$,this.y*=$,this.z*=$,this}divideScalar($){return $!==0?(this.x/=$,this.y/=$,this.z/=$):(this.x=0,this.y=0,this.z=0),this}max($){return this.x=Math.max(this.x,$.x),this.y=Math.max(this.y,$.y),this.z=Math.max(this.z,$.z),this}min($){return this.x=Math.min(this.x,$.x),this.y=Math.min(this.y,$.y),this.z=Math.min(this.z,$.z),this}distanceTo($){return Math.sqrt(this.distanceToSquared($))}distanceToSquared($){const c=this.x-$.x,d=this.y-$.y,j=this.z-$.z;return c*c+d*d+j*j}applyMatrix3($){const{x:c}=this,{y:d}=this,{z:j}=this,et=$.elements;return this.x=et[0]*c+et[3]*d+et[6]*j,this.y=et[1]*c+et[4]*d+et[7]*j,this.z=et[2]*c+et[5]*d+et[8]*j,this}applyMatrix4($){const{x:c}=this,{y:d}=this,{z:j}=this,et=$.elements;return this.x=et[0]*c+et[4]*d+et[8]*j+et[12],this.y=et[1]*c+et[5]*d+et[9]*j+et[13],this.z=et[2]*c+et[6]*d+et[10]*j+et[14],this}applyProjection($){const{x:c}=this,{y:d}=this,{z:j}=this,et=$.elements,nt=et[3]*c+et[7]*d+et[11]*j+et[15];return this.x=(et[0]*c+et[4]*d+et[8]*j+et[12])/nt,this.y=(et[1]*c+et[5]*d+et[9]*j+et[13])/nt,this.z=(et[2]*c+et[6]*d+et[10]*j+et[14])/nt,this}applyQuaternion($){const{x:c}=this,{y:d}=this,{z:j}=this,et=$.x,nt=$.y,ut=$.z,b=$.w,it={};it.x=2*(d*ut-j*nt),it.y=2*(j*et-c*ut),it.z=2*(c*nt-d*et);const rt={};return rt.x=it.y*ut-it.z*nt,rt.y=it.z*et-it.x*ut,rt.z=it.x*nt-it.y*et,this.x=c+b*it.x+rt.x,this.y=d+b*it.y+rt.y,this.z=j+b*it.z+rt.z,this}negate(){return this.multiplyScalar(-1)}dot($){return this.x*$.x+this.y*$.y+this.z*$.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}normalize(){return this.divideScalar(this.length())}cross($){const{x:c}=this,{y:d}=this,{z:j}=this;return this.x=d*$.z-j*$.y,this.y=j*$.x-c*$.z,this.z=c*$.y-d*$.x,this}crossVectors($,c){return this.x=$.y*c.z-$.z*c.y,this.y=$.z*c.x-$.x*c.z,this.z=$.x*c.y-$.y*c.x,this}equals($){return this.x==$.x&&this.y==$.y&&this.z==$.z}getPositionFromMatrix($){return this.x=$.elements[12],this.y=$.elements[13],this.z=$.elements[14],this}setEulerFromRotationMatrix($,c){const d=$.elements,j=d[0],et=d[4],nt=d[8],ut=d[5],b=d[9],it=d[6],rt=d[10];return c===void 0||c==="XYZ"?(this.y=Math.asin((0,a.clamp)(nt,-1,1)),Math.abs(nt)<.99999?(this.x=Math.atan2(-b,rt),this.z=Math.atan2(-et,j)):(this.x=Math.atan2(it,ut),this.z=0)):console.error(`Error with vector's setEulerFromRotationMatrix: Unknown order: ${c}`),this}rotateAboutVector($,c){$.normalize();const d=Math.cos(c),j=Math.sin(c),et=this.clone().multiplyScalar(d),nt=$.clone().cross(this).multiplyScalar(j),ut=$.clone().multiplyScalar($.clone().dot(this)).multiplyScalar(1-d),b=et.add(nt).add(ut);return this.x=b.x,this.y=b.y,this.z=b.z,this}setFromMatrixPosition($){const c=$.elements;return this.x=c[12],this.y=c[13],this.z=c[14],this}transformDirection($){const{x:c}=this,{y:d}=this,{z:j}=this,et=$.elements;return this.x=et[0]*c+et[4]*d+et[8]*j,this.y=et[1]*c+et[5]*d+et[9]*j,this.z=et[2]*c+et[6]*d+et[10]*j,this.normalize()}clone(){return new at(this.x,this.y,this.z)}unproject($){const c=h;return c.multiplyMatrices($.matrixWorld,c.getInverse($.projectionMatrix)),this.applyMatrix4(c)}}g=new at,_e=new at,st=new at;class ot{constructor($=1,c=0,d=0,j=0,et=1,nt=0,ut=0,b=0,it=1){this.elements=new Float32Array(9),this.set($,c,d,j,et,nt,ut,b,it)}set($,c,d,j,et,nt,ut,b,it){const rt=this.elements;return rt[0]=$,rt[3]=c,rt[6]=d,rt[1]=j,rt[4]=et,rt[7]=nt,rt[2]=ut,rt[5]=b,rt[8]=it,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy($){const c=$.elements;this.set(c[0],c[3],c[6],c[1],c[4],c[7],c[2],c[5],c[8])}multiplyScalar($){const c=this.elements;return c[0]*=$,c[3]*=$,c[6]*=$,c[1]*=$,c[4]*=$,c[7]*=$,c[2]*=$,c[5]*=$,c[8]*=$,this}getInverse3($){const c=$.elements,d=this.elements;d[0]=c[4]*c[8]-c[5]*c[7],d[3]=c[6]*c[5]-c[3]*c[8],d[6]=c[3]*c[7]-c[6]*c[4],d[1]=c[7]*c[2]-c[1]*c[8],d[4]=c[0]*c[8]-c[6]*c[2],d[7]=c[1]*c[6]-c[0]*c[7],d[2]=c[1]*c[5]-c[2]*c[4],d[5]=c[2]*c[3]-c[0]*c[5],d[8]=c[0]*c[4]-c[1]*c[3];const j=c[0]*d[0]+c[3]*d[1]+c[6]*d[2];return this.multiplyScalar(1/j),this}getInverse($,c){const d=$.elements,j=this.elements;j[0]=d[10]*d[5]-d[6]*d[9],j[1]=-d[10]*d[1]+d[2]*d[9],j[2]=d[6]*d[1]-d[2]*d[5],j[3]=-d[10]*d[4]+d[6]*d[8],j[4]=d[10]*d[0]-d[2]*d[8],j[5]=-d[6]*d[0]+d[2]*d[4],j[6]=d[9]*d[4]-d[5]*d[8],j[7]=-d[9]*d[0]+d[1]*d[8],j[8]=d[5]*d[0]-d[1]*d[4];const et=d[0]*j[0]+d[1]*j[3]+d[2]*j[6];if(et===0){const nt="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(c)throw new Error(nt);return console.warn(nt),this.identity(),this}return this.multiplyScalar(1/et),this}getDeterminant(){const $=this.elements;return $[0]*$[4]*$[8]+$[1]*$[5]*$[6]+$[2]*$[3]*$[7]-$[2]*$[4]*$[6]-$[1]*$[3]*$[8]-$[0]*$[5]*$[7]}transpose(){let $;const c=this.elements;return $=c[1],c[1]=c[3],c[3]=$,$=c[2],c[2]=c[6],c[6]=$,$=c[5],c[5]=c[7],c[7]=$,this}clone(){const $=this.elements;return new ot($[0],$[3],$[6],$[1],$[4],$[7],$[2],$[5],$[8])}getMatrix4(){const $=this.elements;return new tt($[0],$[3],$[6],0,$[1],$[4],$[7],0,$[2],$[5],$[8],0)}}class lt{constructor($,c){this.origin=$!==void 0?$:new at,this.direction=c!==void 0?c:new at}set($,c){return this.origin.copy($),this.direction.copy(c),this}copy($){return this.origin.copy($.origin),this.direction.copy($.direction),this}at($,c){return(c||new at).copy(this.direction).multiplyScalar($).add(this.origin)}recast($){const c=g;return this.origin.copy(this.at($,c)),this}closestPointToPoint($,c){const d=c||new at;d.subVectors($,this.origin);const j=d.dot(this.direction);return d.copy(this.direction).multiplyScalar(j).add(this.origin)}distanceToPoint($){const c=g,d=c.subVectors($,this.origin).dot(this.direction);return c.copy(this.direction).multiplyScalar(d).add(this.origin),c.distanceTo($)}isIntersectionCylinder(){}isIntersectionSphere($){return this.distanceToPoint($.center)<=$.radius}isIntersectionPlane($){return $.normal.dot(this.direction)!==0||$.distanceToPoint(this.origin)===0}distanceToPlane($){const c=$.normal.dot(this.direction);return c===0?$.distanceToPoint(this.origin)===0?0:void 0:-(this.origin.dot($.normal)+$.constant)/c}intersectPlane($,c){const d=this.distanceToPlane($);if(d!==void 0)return this.at(d,c)}applyMatrix4($){return this.direction.add(this.origin).applyMatrix4($),this.origin.applyMatrix4($),this.direction.sub(this.origin),this}clone(){return new lt().copy(this)}}},"./src/WebGL/math/utils/clamp.ts"(e,i,s){s.r(i),s.d(i,{clamp:()=>o});function o(a,h,_){return Math.min(Math.max(a,h),_)}},"./src/WebGL/math/utils/conversionMatrix3.ts"(e,i,s){s.r(i),s.d(i,{conversionMatrix3:()=>a});var o=s("./src/WebGL/math/math.ts");function a(h,_,g,_e,st,tt){_e=_e*Math.PI/180,st=st*Math.PI/180,tt=tt*Math.PI/180;const at=d=>d*d,ot=Math.cos(_e),lt=Math.cos(st),ct=Math.cos(tt),$=Math.sin(tt);return new o.Matrix3(h,_*ct,g*lt,0,_*$,g*(ot-lt*ct)/$,0,0,g*Math.sqrt(1-at(ot)-at(lt)-at(ct)+2*ot*lt*ct)/$)}},"./src/WebGL/math/utils/degToRad.ts"(e,i,s){s.r(i),s.d(i,{degToRad:()=>a});const o=Math.PI/180;function a(h){return h*o}},"./src/WebGL/objects/Line.ts"(e,i,s){s.r(i),s.d(i,{Line:()=>_,LineStyle:()=>h});var o=s("./src/WebGL/materials/index.ts"),a=s("./src/WebGL/core/index.ts"),h;(function(g){g[g.LineStrip=0]="LineStrip",g[g.LinePieces=1]="LinePieces"})(h||(h={}));class _ extends a.Object3D{constructor(_e,st=new o.LineBasicMaterial({color:Math.random()*16777215}),tt=h.LineStrip){super(),this.geometry=_e,this.material=st,this.type=tt}clone(_e=new _(this.geometry,this.material,this.type)){return super.clone.call(this,_e),_e}}},"./src/WebGL/objects/Mesh.ts"(e,i,s){s.r(i),s.d(i,{Mesh:()=>a});var o=s("./src/WebGL/core/index.ts");class a extends o.Object3D{constructor(_,g){super(),this.geometry=_,this.material=g}clone(_){return _===void 0&&(_=new a(this.geometry,this.material)),super.clone.call(this,_),_}}},"./src/WebGL/objects/Sprite.ts"(e,i,s){s.r(i),s.d(i,{Sprite:()=>h});var o=s("./src/WebGL/materials/index.ts"),a=s("./src/WebGL/core/index.ts");class h extends a.Object3D{constructor(g=new o.SpriteMaterial){super(),this.material=g,this.rotation3d=this.rotation,this.rotation=0}updateMatrix(){this.matrix.setPosition(this.position),this.rotation3d.set(0,0,this.rotation),this.matrix.setRotationFromEuler(this.rotation3d),(this.scale.x!==1||this.scale.y!==1)&&this.matrix.scale(this.scale),this.matrixWorldNeedsUpdate=!0}clone(g=new h(this.material)){return a.Object3D.prototype.clone.call(this,g),g}}},"./src/WebGL/objects/index.ts"(e,i,s){s.r(i),s.d(i,{Line:()=>o.Line,LineStyle:()=>o.LineStyle,Mesh:()=>a.Mesh,Sprite:()=>h.Sprite});var o=s("./src/WebGL/objects/Line.ts"),a=s("./src/WebGL/objects/Mesh.ts"),h=s("./src/WebGL/objects/Sprite.ts")},"./src/WebGL/shaders/ShaderType.ts"(e,i,s){s.r(i)},"./src/WebGL/shaders/index.ts"(e,i,s){s.r(i),s.d(i,{ShaderLib:()=>o.ShaderLib,ShaderUtils:()=>a.ShaderUtils,basic:()=>o.basic,clone:()=>a.clone,instanced:()=>o.instanced,lambert:()=>o.lambert,lambertdouble:()=>o.lambertdouble,outline:()=>o.outline,screen:()=>o.screen,screenaa:()=>o.screenaa,sphereimposter:()=>o.sphereimposter,sphereimposteroutline:()=>o.sphereimposteroutline,sprite:()=>o.sprite,stickimposter:()=>o.stickimposter,stickimposteroutline:()=>o.stickimposteroutline,volumetric:()=>o.volumetric});var o=s("./src/WebGL/shaders/lib/index.ts"),a=s("./src/WebGL/shaders/utils/index.ts");s("./src/WebGL/shaders/ShaderType.ts")},"./src/WebGL/shaders/lib/basic/basic.frag"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`uniform mat4 viewMatrix;
uniform float opacity;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
varying vec3 vColor;
varying vec4 mvPosition;

//DEFINEFRAGCOLOR
void main() {
    gl_FragColor = vec4( vColor, opacity );
    if(fogNear != fogFar) {
        float depth = -mvPosition.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}`},"./src/WebGL/shaders/lib/basic/basic.vert"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;

attribute vec3 position;
attribute vec3 color;

varying vec3 vColor;
varying vec4 mvPosition;

void main() {

    vColor = color;
    mvPosition = modelViewMatrix * vec4( position, 1.0 );
    gl_Position = projectionMatrix * mvPosition;

}`},"./src/WebGL/shaders/lib/basic/index.ts"(e,i,s){s.r(i),s.d(i,{basic:()=>_});var o=s("./src/WebGL/shaders/lib/basic/uniforms.ts"),a=s("./src/WebGL/shaders/lib/basic/basic.frag"),h=s("./src/WebGL/shaders/lib/basic/basic.vert");const _={vertexShader:h.default.replace("#define GLSLIFY 1",""),fragmentShader:a.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}},"./src/WebGL/shaders/lib/basic/uniforms.ts"(e,i,s){s.r(i),s.d(i,{uniforms:()=>a});var o=s("./src/colors.ts");const a={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3}}},"./src/WebGL/shaders/lib/blur/blur.frag"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`const float INV_TOTAL_SAMPLES_FACTOR = 1.0 / 9.0;
uniform highp sampler2D inTex;
varying highp vec2 vTexCoords;
    
void main() {
 
 vec2 texelSize = 1.0 / vec2(textureSize(inTex,0));
 float blurred_visibility_factor = 0.0f;
 for (int t = -1; t <= 1; ++t) {
  for (int s = -1; s <= 1; ++s) {
   vec2 offset = vec2(float(s), float(t)) * texelSize;
   blurred_visibility_factor += texture2D(inTex, vTexCoords + offset).r;
  }
 }
    
 gl_FragDepthEXT = blurred_visibility_factor * INV_TOTAL_SAMPLES_FACTOR;
 
}`},"./src/WebGL/shaders/lib/blur/blur.vert"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `},"./src/WebGL/shaders/lib/blur/index.ts"(e,i,s){s.r(i),s.d(i,{blur:()=>_});var o=s("./src/WebGL/shaders/lib/blur/uniforms.ts"),a=s("./src/WebGL/shaders/lib/blur/blur.frag"),h=s("./src/WebGL/shaders/lib/blur/blur.vert");const _={fragmentShader:a.default,vertexShader:h.default,uniforms:o.uniforms}},"./src/WebGL/shaders/lib/blur/uniforms.ts"(e,i,s){s.r(i),s.d(i,{uniforms:()=>o});const o={}},"./src/WebGL/shaders/lib/index.ts"(e,i,s){s.r(i),s.d(i,{ShaderLib:()=>j,basic:()=>o.basic,instanced:()=>a.instanced,lambert:()=>h.lambert,lambertdouble:()=>_.lambertdouble,outline:()=>g.outline,screen:()=>_e.screen,screenaa:()=>st.screenaa,sphereimposter:()=>tt.sphereimposter,sphereimposteroutline:()=>at.sphereimposteroutline,sprite:()=>ot.sprite,stickimposter:()=>lt.stickimposter,stickimposteroutline:()=>ct.stickimposteroutline,volumetric:()=>$.volumetric});var o=s("./src/WebGL/shaders/lib/basic/index.ts"),a=s("./src/WebGL/shaders/lib/instanced/index.ts"),h=s("./src/WebGL/shaders/lib/lambert/index.ts"),_=s("./src/WebGL/shaders/lib/lambertdouble/index.ts"),g=s("./src/WebGL/shaders/lib/outline/index.ts"),_e=s("./src/WebGL/shaders/lib/screen/index.ts"),st=s("./src/WebGL/shaders/lib/screenaa/index.ts"),tt=s("./src/WebGL/shaders/lib/sphereimposter/index.ts"),at=s("./src/WebGL/shaders/lib/sphereimposteroutline/index.ts"),ot=s("./src/WebGL/shaders/lib/sprite/index.ts"),lt=s("./src/WebGL/shaders/lib/stickimposter/index.ts"),ct=s("./src/WebGL/shaders/lib/stickimposteroutline/index.ts"),$=s("./src/WebGL/shaders/lib/volumetric/index.ts"),c=s("./src/WebGL/shaders/lib/ssao/index.ts"),d=s("./src/WebGL/shaders/lib/blur/index.ts");const j={basic:o.basic,blur:d.blur,instanced:a.instanced,lambert:h.lambert,lambertdouble:_.lambertdouble,outline:g.outline,screen:_e.screen,screenaa:st.screenaa,ssao:c.ssao,sphereimposter:tt.sphereimposter,sphereimposteroutline:at.sphereimposteroutline,sprite:ot.sprite,stickimposter:lt.stickimposter,stickimposteroutline:ct.stickimposteroutline,volumetric:$.volumetric}},"./src/WebGL/shaders/lib/instanced/index.ts"(e,i,s){s.r(i),s.d(i,{instanced:()=>_});var o=s("./src/WebGL/shaders/lib/instanced/uniforms.ts"),a=s("./src/WebGL/shaders/lib/instanced/instanced.frag"),h=s("./src/WebGL/shaders/lib/instanced/instanced.vert");const _={fragmentShader:a.default.replace("#define GLSLIFY 1",""),vertexShader:h.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}},"./src/WebGL/shaders/lib/instanced/instanced.frag"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
#ifdef SHADED
uniform highp sampler2D shading;
#endif
varying vec3 vLightFront;
varying vec3 vColor;
//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    gl_FragColor.xyz *= vLightFront;
    #endif

#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    vColor *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( vColor, opacity );
    float depth = gl_FragCoord.z / gl_FragCoord.w;

    float fogFactor = smoothstep( fogNear, fogFar, depth );

    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );

}


`},"./src/WebGL/shaders/lib/instanced/instanced.vert"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 offset;
attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLightFront;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    vec4 mvPosition = modelViewMatrix * vec4( position * radius + offset, 1.0 );

    vLightFront = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;

    gl_Position = projectionMatrix * mvPosition;
}

`},"./src/WebGL/shaders/lib/instanced/uniforms.ts"(e,i,s){s.r(i),s.d(i,{uniforms:()=>a});var o=s("./src/colors.ts");const a={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},"./src/WebGL/shaders/lib/lambert/index.ts"(e,i,s){s.r(i),s.d(i,{lambert:()=>_});var o=s("./src/WebGL/shaders/lib/lambert/uniforms.ts"),a=s("./src/WebGL/shaders/lib/lambert/lambert.frag"),h=s("./src/WebGL/shaders/lib/lambert/lambert.vert");const _={fragmentShader:a.default.replace("#define GLSLIFY 1",""),vertexShader:h.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}},"./src/WebGL/shaders/lib/lambert/lambert.frag"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
#ifdef SHADED
uniform highp sampler2D shading;
#endif
varying vec3 vLightFront;
varying vec3 vColor;
varying vec4 mvPosition;


//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    gl_FragColor.xyz *= vLightFront;
    #endif
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    vColor *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( vColor, opacity );

    if(fogNear != fogFar) {
        float depth = -mvPosition.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }

}`},"./src/WebGL/shaders/lib/lambert/lambert.vert"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec3 vColor;
varying vec3 vLightFront;
varying vec4 mvPosition;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    mvPosition = modelViewMatrix * vec4( position, 1.0 );

    vLightFront = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;

    gl_Position = projectionMatrix * mvPosition;
}`},"./src/WebGL/shaders/lib/lambert/uniforms.ts"(e,i,s){s.r(i),s.d(i,{uniforms:()=>a});var o=s("./src/colors.ts");const a={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},"./src/WebGL/shaders/lib/lambertdouble/index.ts"(e,i,s){s.r(i),s.d(i,{lambertdouble:()=>_});var o=s("./src/WebGL/shaders/lib/lambertdouble/uniforms.ts"),a=s("./src/WebGL/shaders/lib/lambertdouble/lambertdouble.frag"),h=s("./src/WebGL/shaders/lib/lambertdouble/lambertdouble.vert");const _={fragmentShader:a.default.replace("#define GLSLIFY 1",""),vertexShader:h.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}},"./src/WebGL/shaders/lib/lambertdouble/lambertdouble.frag"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`
#ifdef SHADED
uniform highp sampler2D shading;
#endif

uniform mat4 viewMatrix;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec3 vLightFront;
varying vec3 vLightBack;

varying vec3 vColor;
varying vec4 mvPosition;

//DEFINEFRAGCOLOR

void main() {

    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );

    #ifndef WIREFRAME
    if ( gl_FrontFacing )
       gl_FragColor.xyz *= vLightFront;
    else
       gl_FragColor.xyz *= vLightBack;
    #endif

    vec3 color = vColor;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif
    gl_FragColor = gl_FragColor * vec4( color, opacity );

    if(fogNear != fogFar) {
        float depth = -mvPosition.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }

}


`},"./src/WebGL/shaders/lib/lambertdouble/lambertdouble.vert"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec3 vColor;
varying vec3 vLightFront;
varying vec3 vLightBack;
varying vec4 mvPosition;

void main() {

    vColor = color;

    vec3 objectNormal = normal;
    vec3 transformedNormal = normalMatrix * objectNormal;
    mvPosition = modelViewMatrix * vec4( position, 1.0 );

    vLightFront = vec3( 0.0 );
    vLightBack = vec3( 0.0 );

    transformedNormal = normalize( transformedNormal );

    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vec3 dirVector = normalize( lDirection.xyz );
    float dotProduct = dot( transformedNormal, dirVector );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );
    vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );

    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;
    vLightBack += directionalLightColor[ 0 ] * directionalLightWeightingBack;

    gl_Position = projectionMatrix * mvPosition;
}

`},"./src/WebGL/shaders/lib/lambertdouble/uniforms.ts"(e,i,s){s.r(i),s.d(i,{uniforms:()=>a});var o=s("./src/colors.ts");const a={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},"./src/WebGL/shaders/lib/outline/index.ts"(e,i,s){s.r(i),s.d(i,{outline:()=>_});var o=s("./src/WebGL/shaders/lib/outline/uniforms.ts"),a=s("./src/WebGL/shaders/lib/outline/outline.frag"),h=s("./src/WebGL/shaders/lib/outline/outline.vert");const _={fragmentShader:a.default.replace("#define GLSLIFY 1",""),vertexShader:h.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}},"./src/WebGL/shaders/lib/outline/outline.frag"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`

uniform float opacity;
uniform vec3 outlineColor;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec4 mvPosition;
//DEFINEFRAGCOLOR

void main() {
    gl_FragColor = vec4( outlineColor, 1 );

    if(fogNear != fogFar) {
        float depth = -mvPosition.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}


`},"./src/WebGL/shaders/lib/outline/outline.vert"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float outlineWidth;
uniform float outlinePushback;
uniform float vWidth;
uniform float vHeight;
uniform float outlineMaxPixels;

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec4 mvPosition;

void main() {

    vec4 norm = modelViewMatrix*vec4(normalize(normal),0.0);
    mvPosition = modelViewMatrix * vec4( position, 1.0 );
    mvPosition.xy += norm.xy*outlineWidth;
    vec4 outpos = projectionMatrix * mvPosition;

    if(outlineMaxPixels > 0.0) {
        vec4 unadjusted = projectionMatrix*modelViewMatrix * vec4( position, 1.0 );
        float w = outpos.w;
        //normalize homogeneous coords
        unadjusted /= unadjusted.w;
        outpos /= outpos.w;
        vec2 diff = outpos.xy-unadjusted.xy;
        //put into pixels
        diff.x *= vWidth;
        diff.y *= vHeight;
        if ( length(diff) > outlineMaxPixels) {
            vec2 ndiff = normalize(diff)*outlineMaxPixels;
            ndiff.x /= vWidth;
            ndiff.y /= vHeight;
            outpos.xy = unadjusted.xy;
            outpos.xy += ndiff;
        }
        outpos *= w; //if I don't do this things blow up
    }
    gl_Position = outpos;
    mvPosition.z -= outlinePushback; //go backwards in model space
    vec4 pushpos = projectionMatrix*mvPosition; //project to get z in projection space, I'm probably missing some simple math to do the same thing..
    gl_Position.z = gl_Position.w*pushpos.z/pushpos.w;
}

`},"./src/WebGL/shaders/lib/outline/uniforms.ts"(e,i,s){s.r(i),s.d(i,{uniforms:()=>a});var o=s("./src/colors.ts");const a={opacity:{type:"f",value:1},outlineColor:{type:"c",value:new o.Color(0,0,0)},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1},outlineMaxPixels:{type:"f",value:0}}},"./src/WebGL/shaders/lib/screen/index.ts"(e,i,s){s.r(i),s.d(i,{screen:()=>_});var o=s("./src/WebGL/shaders/lib/screen/uniforms.ts"),a=s("./src/WebGL/shaders/lib/screen/screen.frag"),h=s("./src/WebGL/shaders/lib/screen/screen.vert");const _={fragmentShader:a.default.replace("#define GLSLIFY 1",""),vertexShader:h.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}},"./src/WebGL/shaders/lib/screen/screen.frag"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`uniform sampler2D colormap;
varying highp vec2 vTexCoords;
uniform vec2 dimensions;
//DEFINEFRAGCOLOR
void main (void) {
   gl_FragColor = texture2D(colormap, vTexCoords);

   //gl_FragColor.g = gl_FragColor.b =  gl_FragColor.r; //debug shading 
}
        `},"./src/WebGL/shaders/lib/screen/screen.vert"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `},"./src/WebGL/shaders/lib/screen/uniforms.ts"(e,i,s){s.r(i),s.d(i,{uniforms:()=>o});const o={}},"./src/WebGL/shaders/lib/screenaa/index.ts"(e,i,s){s.r(i),s.d(i,{screenaa:()=>_});var o=s("./src/WebGL/shaders/lib/screenaa/uniforms.ts"),a=s("./src/WebGL/shaders/lib/screenaa/screenaa.frag"),h=s("./src/WebGL/shaders/lib/screenaa/screenaa.vert");const _={fragmentShader:a.default.replace("#define GLSLIFY 1",""),vertexShader:h.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}},"./src/WebGL/shaders/lib/screenaa/screenaa.frag"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`
        
precision highp float;
precision highp int;
precision highp sampler2D;

uniform sampler2D tColor;
varying highp vec2 vTexCoords;

// adapted from https://github.com/kosua20/Rendu
// MIT License Copyright (c) 2017 Simon Rodriguez
// by way of molstar (https://github.com/molstar/molstar/blob/master/src/mol-gl/shader/fxaa.frag.ts)

#define QUALITY(q) ((q) < 5 ? 1.0 : ((q) > 5 ? ((q) < 10 ? 2.0 : ((q) < 11 ? 4.0 : 8.0)) : 1.5))

float rgb2luma(vec3 rgb){
    return sqrt(dot(rgb, vec3(0.299, 0.587, 0.114)));
}

float sampleLuma(vec2 uv) {
    return rgb2luma(texture2D(tColor, uv).rgb);
}

float sampleLuma(vec2 uv, float uOffset, float vOffset) {
    uv += vec2(uOffset, vOffset);
    return sampleLuma(uv);
}

//DEFINEFRAGCOLOR
void main(void) {
    ivec2 dim = textureSize(tColor,0);
    vec2 dimensions = vec2(float(dim.x),float(dim.y));
    vec2 inverseScreenSize = vec2(1.0 / dimensions.x, 1.0 / dimensions.y);
    vec2 coords = vTexCoords;

    vec4 colorCenter = texture2D(tColor, coords);
    float dEdgeThresholdMin = 0.0312;
    float dEdgeThresholdMax = 0.125;
    int dIterations = 12;
    float dSubpixelQuality = 0.3;

    // Luma at the current fragment
    float lumaCenter = rgb2luma(colorCenter.rgb);

    // Luma at the four direct neighbours of the current fragment.
    float lumaDown = sampleLuma(coords, 0.0, -inverseScreenSize.y);
    float lumaUp = sampleLuma(coords, 0.0, inverseScreenSize.y);
    float lumaLeft = sampleLuma(coords, -inverseScreenSize.x, 0.0);
    float lumaRight = sampleLuma(coords, inverseScreenSize.x, 0.0);

    // Find the maximum and minimum luma around the current fragment.
    float lumaMin = min(lumaCenter, min(min(lumaDown, lumaUp), min(lumaLeft, lumaRight)));
    float lumaMax = max(lumaCenter, max(max(lumaDown, lumaUp), max(lumaLeft, lumaRight)));

    // Compute the delta.
    float lumaRange = lumaMax - lumaMin;

    // If the luma variation is lower that a threshold (or if we are in a really dark area),
    // we are not on an edge, don't perform any AA.
    if (lumaRange < max(dEdgeThresholdMin, lumaMax * dEdgeThresholdMax)) {
        gl_FragColor = colorCenter;
        return;
    }

    // Query the 4 remaining corners lumas.
    float lumaDownLeft = sampleLuma(coords, -inverseScreenSize.x, -inverseScreenSize.y);
    float lumaUpRight = sampleLuma(coords, inverseScreenSize.x, inverseScreenSize.y);
    float lumaUpLeft = sampleLuma(coords, -inverseScreenSize.x, inverseScreenSize.y);
    float lumaDownRight = sampleLuma(coords, inverseScreenSize.x, -inverseScreenSize.y);

    // Combine the four edges lumas (using intermediary variables for future computations
    // with the same values).
    float lumaDownUp = lumaDown + lumaUp;
    float lumaLeftRight = lumaLeft + lumaRight;

    // Same for corners
    float lumaLeftCorners = lumaDownLeft + lumaUpLeft;
    float lumaDownCorners = lumaDownLeft + lumaDownRight;
    float lumaRightCorners = lumaDownRight + lumaUpRight;
    float lumaUpCorners = lumaUpRight + lumaUpLeft;

    // Compute an estimation of the gradient along the horizontal and vertical axis.
    float edgeHorizontal = abs(-2.0 * lumaLeft + lumaLeftCorners) + abs(-2.0 * lumaCenter + lumaDownUp) * 2.0 + abs(-2.0 * lumaRight + lumaRightCorners);
    float edgeVertical = abs(-2.0 * lumaUp + lumaUpCorners) + abs(-2.0 * lumaCenter + lumaLeftRight) * 2.0 + abs(-2.0 * lumaDown + lumaDownCorners);

    // Is the local edge horizontal or vertical ?
    bool isHorizontal = (edgeHorizontal >= edgeVertical);

    // Choose the step size (one pixel) accordingly.
    float stepLength = isHorizontal ? inverseScreenSize.y : inverseScreenSize.x;

    // Select the two neighboring texels lumas in the opposite direction to the local edge.
    float luma1 = isHorizontal ? lumaDown : lumaLeft;
    float luma2 = isHorizontal ? lumaUp : lumaRight;
    // Compute gradients in this direction.
    float gradient1 = luma1 - lumaCenter;
    float gradient2 = luma2 - lumaCenter;

    // Which direction is the steepest ?
    bool is1Steepest = abs(gradient1) >= abs(gradient2);

    // Gradient in the corresponding direction, normalized.
    float gradientScaled = 0.25 * max(abs(gradient1), abs(gradient2));

    // Average luma in the correct direction.
    float lumaLocalAverage = 0.0;
    if(is1Steepest){
        // Switch the direction
        stepLength = -stepLength;
        lumaLocalAverage = 0.5 * (luma1 + lumaCenter);
    } else {
        lumaLocalAverage = 0.5 * (luma2 + lumaCenter);
    }

    // Shift UV in the correct direction by half a pixel.
    vec2 currentUv = coords;
    if(isHorizontal){
        currentUv.y += stepLength * 0.5;
    } else {
        currentUv.x += stepLength * 0.5;
    }

    // Compute offset (for each iteration step) in the right direction.
    vec2 offset = isHorizontal ? vec2(inverseScreenSize.x, 0.0) : vec2(0.0, inverseScreenSize.y);
    // Compute UVs to explore on each side of the edge, orthogonally.
    // The QUALITY allows us to step faster.
    vec2 uv1 = currentUv - offset * QUALITY(0);
    vec2 uv2 = currentUv + offset * QUALITY(0);

    // Read the lumas at both current extremities of the exploration segment,
    // and compute the delta wrt to the local average luma.
    float lumaEnd1 = sampleLuma(uv1);
    float lumaEnd2 = sampleLuma(uv2);
    lumaEnd1 -= lumaLocalAverage;
    lumaEnd2 -= lumaLocalAverage;

    // If the luma deltas at the current extremities is larger than the local gradient,
    // we have reached the side of the edge.
    bool reached1 = abs(lumaEnd1) >= gradientScaled;
    bool reached2 = abs(lumaEnd2) >= gradientScaled;
    bool reachedBoth = reached1 && reached2;

    // If the side is not reached, we continue to explore in this direction.
    if(!reached1){
        uv1 -= offset * QUALITY(1);
    }
    if(!reached2){
        uv2 += offset * QUALITY(1);
    }

    // If both sides have not been reached, continue to explore.
    if(!reachedBoth){
        for(int i = 2; i < dIterations; i++){
            // If needed, read luma in 1st direction, compute delta.
            if(!reached1){
                lumaEnd1 = sampleLuma(uv1);
                lumaEnd1 = lumaEnd1 - lumaLocalAverage;
            }
            // If needed, read luma in opposite direction, compute delta.
            if(!reached2){
                lumaEnd2 = sampleLuma(uv2);
                lumaEnd2 = lumaEnd2 - lumaLocalAverage;
            }
            // If the luma deltas at the current extremities is larger than the local gradient,
            // we have reached the side of the edge.
            reached1 = abs(lumaEnd1) >= gradientScaled;
            reached2 = abs(lumaEnd2) >= gradientScaled;
            reachedBoth = reached1 && reached2;

            // If the side is not reached, we continue to explore in this direction,
            // with a variable quality.
            if(!reached1){
                uv1 -= offset * QUALITY(i);
            }
            if(!reached2){
                uv2 += offset * QUALITY(i);
            }

            // If both sides have been reached, stop the exploration.
            if(reachedBoth){
                break;
            }
        }
    }

    // Compute the distances to each side edge of the edge (!).
    float distance1 = isHorizontal ? (coords.x - uv1.x) : (coords.y - uv1.y);
    float distance2 = isHorizontal ? (uv2.x - coords.x) : (uv2.y - coords.y);

    // In which direction is the side of the edge closer ?
    bool isDirection1 = distance1 < distance2;
    float distanceFinal = min(distance1, distance2);

    // Thickness of the edge.
    float edgeThickness = (distance1 + distance2);

    // Is the luma at center smaller than the local average ?
    bool isLumaCenterSmaller = lumaCenter < lumaLocalAverage;

    // If the luma at center is smaller than at its neighbour,
    // the delta luma at each end should be positive (same variation).
    bool correctVariation1 = (lumaEnd1 < 0.0) != isLumaCenterSmaller;
    bool correctVariation2 = (lumaEnd2 < 0.0) != isLumaCenterSmaller;

    // Only keep the result in the direction of the closer side of the edge.
    bool correctVariation = isDirection1 ? correctVariation1 : correctVariation2;

    // UV offset: read in the direction of the closest side of the edge.
    float pixelOffset = - distanceFinal / edgeThickness + 0.5;

    // If the luma variation is incorrect, do not offset.
    float finalOffset = correctVariation ? pixelOffset : 0.0;

    // Sub-pixel shifting
    // Full weighted average of the luma over the 3x3 neighborhood.
    float lumaAverage = (1.0 / 12.0) * (2.0 * (lumaDownUp + lumaLeftRight) + lumaLeftCorners + lumaRightCorners);
    // Ratio of the delta between the global average and the center luma,
    // over the luma range in the 3x3 neighborhood.
    float subPixelOffset1 = clamp(abs(lumaAverage - lumaCenter) / lumaRange, 0.0, 1.0);
    float subPixelOffset2 = (-2.0 * subPixelOffset1 + 3.0) * subPixelOffset1 * subPixelOffset1;
    // Compute a sub-pixel offset based on this delta.
    float subPixelOffsetFinal = subPixelOffset2 * subPixelOffset2 * float(dSubpixelQuality);

    // Pick the biggest of the two offsets.
    finalOffset = max(finalOffset, subPixelOffsetFinal);

    // Compute the final UV coordinates.
    vec2 finalUv = coords;
    if(isHorizontal){
        finalUv.y += finalOffset * stepLength;
    } else {
        finalUv.x += finalOffset * stepLength;
    }

    // Read the color at the new UV coordinates, and use it.
    gl_FragColor = texture2D(tColor, finalUv);
}        

/* old fxaa implementation
uniform highp sampler2D colormap;
varying highp vec2 vTexCoords;


// Basic FXAA implementation based on the code on geeks3d.com 
#define FXAA_REDUCE_MIN (1.0/ 128.0)
#define FXAA_REDUCE_MUL (1.0 / 8.0)
#define FXAA_SPAN_MAX 8.0


vec4 applyFXAA(vec2 fragCoord, highp sampler2D tex)
{
    vec4 color;
    ivec2 dim = textureSize(tex,0);
    vec2 dimensions = vec2(float(dim.x),float(dim.y));
    vec2 inverseVP = vec2(1.0 / dimensions.x, 1.0 / dimensions.y);
    vec4 rgbNW = texture2D(tex, fragCoord + vec2(-1.0, -1.0) * inverseVP);
    vec4 rgbNE = texture2D(tex, fragCoord + vec2(1.0, -1.0) * inverseVP);
    vec4 rgbSW = texture2D(tex, fragCoord + vec2(-1.0, 1.0) * inverseVP);
    vec4 rgbSE = texture2D(tex, fragCoord + vec2(1.0, 1.0) * inverseVP);
    vec4 rgbM  = texture2D(tex, fragCoord );
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW.xyz, luma);
    float lumaNE = dot(rgbNE.xyz, luma);
    float lumaSW = dot(rgbSW.xyz, luma);
    float lumaSE = dot(rgbSE.xyz, luma);
    float lumaM  = dot(rgbM.xyz,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                        (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
            max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
            dir * rcpDirMin)) * inverseVP;

    vec4 rgbA = 0.5 * (
        texture2D(tex, fragCoord + dir * (1.0 / 3.0 - 0.5)) +
        texture2D(tex, fragCoord  + dir * (2.0 / 3.0 - 0.5)));
    vec4 rgbB = rgbA * 0.5 + 0.25 * (
        texture2D(tex, fragCoord  + dir * -0.5) +
        texture2D(tex, fragCoord  + dir * 0.5));

    float lumaB = dot(rgbB.xyz, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = rgbA;
    else
        color = rgbB;

    return color;
}


//DEFINEFRAGCOLOR
void main (void) {
    ivec2 dim = textureSize(colormap,0);

  gl_FragColor = applyFXAA(vTexCoords, colormap);
}
        
*/`},"./src/WebGL/shaders/lib/screenaa/screenaa.vert"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `},"./src/WebGL/shaders/lib/screenaa/uniforms.ts"(e,i,s){s.r(i),s.d(i,{uniforms:()=>o});const o={}},"./src/WebGL/shaders/lib/sphereimposter/index.ts"(e,i,s){s.r(i),s.d(i,{sphereimposter:()=>_});var o=s("./src/WebGL/shaders/lib/sphereimposter/uniforms.ts"),a=s("./src/WebGL/shaders/lib/sphereimposter/sphereimposter.frag"),h=s("./src/WebGL/shaders/lib/sphereimposter/sphereimposter.vert");const _={vertexShader:h.default.replace("#define GLSLIFY 1",""),fragmentShader:a.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}},"./src/WebGL/shaders/lib/sphereimposter/sphereimposter.frag"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`
uniform mat4 viewMatrix;
uniform float opacity;
uniform mat4 projectionMatrix;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform float uDepth;
uniform vec3 directionalLightColor[ 1 ];

varying vec3 vColor;
varying vec2 mapping;
varying float rval;
varying vec3 vLight;
varying vec3 center;

#ifdef SHADED
uniform highp sampler2D shading;
#endif

//DEFINEFRAGCOLOR

void main() {
    float lensqr = dot(mapping,mapping);
    float rsqr = rval*rval;
    if(lensqr > rsqr)
       discard;
    float z = sqrt(rsqr-lensqr);
    vec3 cameraPos = center+ vec3(mapping.x,mapping.y,z);
    vec4 clipPos = projectionMatrix * vec4(cameraPos, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    gl_FragDepthEXT = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    vec3 norm = normalize(vec3(mapping.x,mapping.y,z));
    float dotProduct = dot( norm, vLight );
    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );
    vec3 vLight = directionalLightColor[ 0 ] * directionalLightWeighting;
    vec3 color = vLight*vColor;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif    
    gl_FragColor = vec4(color, opacity*opacity );

    if(fogNear != fogFar) {
        float depth = -cameraPos.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
     
}

`},"./src/WebGL/shaders/lib/sphereimposter/sphereimposter.vert"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec2 mapping;
varying vec3 vColor;
varying float rval;
varying vec3 vLight;
varying vec3 center;

void main() {

    vColor = color;
    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    center = mvPosition.xyz;
    vec4 projPosition = projectionMatrix * mvPosition;
    vec4 adjust = projectionMatrix* vec4(normal,0.0); adjust.z = 0.0; adjust.w = 0.0;
    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vLight = normalize( lDirection.xyz );
    mapping = normal.xy;
    rval = abs(normal.x);
    gl_Position = projPosition+adjust;

}
`},"./src/WebGL/shaders/lib/sphereimposter/uniforms.ts"(e,i,s){s.r(i),s.d(i,{uniforms:()=>a});var o=s("./src/colors.ts");const a={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},"./src/WebGL/shaders/lib/sphereimposteroutline/index.ts"(e,i,s){s.r(i),s.d(i,{sphereimposteroutline:()=>_});var o=s("./src/WebGL/shaders/lib/sphereimposteroutline/uniforms.ts"),a=s("./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.frag"),h=s("./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.vert");const _={fragmentShader:a.default.replace("#define GLSLIFY 1",""),vertexShader:h.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}},"./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.frag"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`

uniform float opacity;
uniform vec3 outlineColor;
uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform mat4 projectionMatrix;
varying vec2 mapping;
varying float rval;
varying vec3 center;

uniform float outlinePushback;

//DEFINEFRAGCOLOR

void main() {
    float lensqr = dot(mapping,mapping);
    float rsqr = rval*rval;
    if(lensqr > rsqr)
       discard;
    float z = sqrt(rsqr-lensqr);
    vec3 cameraPos = center+ vec3(mapping.x,mapping.y,z-outlinePushback);
    vec4 clipPos = projectionMatrix * vec4(cameraPos, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    gl_FragDepthEXT = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    gl_FragColor = vec4(outlineColor, 1 );

    if(fogNear != fogFar) {
        float depth = -cameraPos.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}


`},"./src/WebGL/shaders/lib/sphereimposteroutline/sphereimposteroutline.vert"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float outlineWidth;
uniform float outlinePushback;
uniform float outlineMaxPixels;
uniform float vWidth;
uniform float vHeight;

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;

varying vec2 mapping;
varying float rval;
varying vec3 center;

void main() {

    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
    center = mvPosition.xyz;
    vec4 projPosition = projectionMatrix * mvPosition;
    vec2 norm = normal.xy + vec2(sign(normal.x)*outlineWidth,sign(normal.y)*outlineWidth);

    vec4 adjust = projectionMatrix* vec4(norm,normal.z,1.0); 
    mapping = norm.xy;
    rval = abs(norm.x);
    gl_Position = projPosition+vec4(adjust.xy,0.0,0.0);

    if(outlineMaxPixels > 0.0) {
        vec4 unadjusted = projectionMatrix*vec4(center.x+normal.x, center.y,center.z,1.0); 
        vec4 ccoord = projectionMatrix*vec4(center.xyz,1.0);
        adjust = projectionMatrix* vec4(center.x+norm.x,center.y,center.z,1.0); 
        //subtract center 
        unadjusted.xyz -= ccoord.xyz;
        adjust.xyz -= ccoord.xyz;
        unadjusted /= unadjusted.w;
        adjust /= adjust.w;
        float diff = abs(adjust.x-unadjusted.x);
        diff *= vWidth;
        if(diff > outlineMaxPixels) {
            
            float fixlen = abs(unadjusted.x) + outlineMaxPixels/vWidth;
            //adjsut reval by ratio of lengths
            rval *= fixlen/abs(adjust.x);
        }

    }
}

`},"./src/WebGL/shaders/lib/sphereimposteroutline/uniforms.ts"(e,i,s){s.r(i),s.d(i,{uniforms:()=>a});var o=s("./src/colors.ts");const a={opacity:{type:"f",value:1},outlineColor:{type:"c",value:new o.Color(0,0,0)},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1},outlineMaxPixels:{type:"f",value:0}}},"./src/WebGL/shaders/lib/sprite/index.ts"(e,i,s){s.r(i),s.d(i,{sprite:()=>_});var o=s("./src/WebGL/shaders/lib/sprite/uniforms.ts"),a=s("./src/WebGL/shaders/lib/sprite/sprite.frag"),h=s("./src/WebGL/shaders/lib/sprite/sprite.vert");const _={fragmentShader:a.default.replace("#define GLSLIFY 1",""),vertexShader:h.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}},"./src/WebGL/shaders/lib/sprite/sprite.frag"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`

uniform vec3 color;
uniform sampler2D map;
uniform float opacity;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;
uniform float alphaTest;

varying vec2 vUV;
//DEFINEFRAGCOLOR

void main() {

    vec4 texture = texture2D(map, vUV);

    if (texture.a <= alphaTest) discard;

    gl_FragColor = vec4(color * texture.xyz, texture.a * opacity);

    if (fogNear != fogFar) {

        float depth = gl_FragCoord.z / gl_FragCoord.w; //probably wrong
        float fogFactor = smoothstep(fogNear, fogFar, depth);        
        gl_FragColor = mix(gl_FragColor, vec4(fogColor, gl_FragColor.w), fogFactor);
    }
}

`},"./src/WebGL/shaders/lib/sprite/sprite.vert"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`

uniform int useScreenCoordinates;
uniform vec3 screenPosition;
uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform float rotation;
uniform vec2 scale;
uniform vec2 alignment;
uniform vec2 uvOffset;
uniform vec2 uvScale;

attribute vec2 position;
attribute vec2 uv;

varying vec2 vUV;

void main() {

    vUV = uvOffset + uv * uvScale;

    vec2 alignedPosition = position + alignment;

    vec2 rotatedPosition;
    rotatedPosition.x = ( cos(rotation) * alignedPosition.x - sin(rotation) * alignedPosition.y ) * scale.x;
    rotatedPosition.y = ( sin(rotation) * alignedPosition.x + cos(rotation) * alignedPosition.y ) * scale.y;

    vec4 finalPosition;

    if(useScreenCoordinates != 0) {
        finalPosition = vec4(screenPosition.xy + rotatedPosition, screenPosition.z, 1.0);
    }

    else {
        finalPosition = projectionMatrix * modelViewMatrix * vec4(0.0, 0.0, 0.0, 1.0); finalPosition /= finalPosition.w;
        finalPosition.xy += rotatedPosition; 
    }

    gl_Position = finalPosition;

}

`},"./src/WebGL/shaders/lib/sprite/uniforms.ts"(e,i,s){s.r(i),s.d(i,{uniforms:()=>o});const o={}},"./src/WebGL/shaders/lib/ssao/index.ts"(e,i,s){s.r(i),s.d(i,{ssao:()=>_});var o=s("./src/WebGL/shaders/lib/ssao/uniforms.ts"),a=s("./src/WebGL/shaders/lib/ssao/ssao.frag"),h=s("./src/WebGL/shaders/lib/ssao/ssao.vert");const _={fragmentShader:a.default,vertexShader:h.default,uniforms:o.uniforms}},"./src/WebGL/shaders/lib/ssao/ssao.frag"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`uniform sampler2D depthmap;
varying highp vec2 vTexCoords;
uniform float vWidth;
uniform float vHeight;
uniform float total_strength;
uniform float radius;
uniform mat4 projinv;
uniform mat4 projectionMatrix;

//code for pseudorandom vector from chatgpt
float hash(vec3 p) {
    p = fract(p * vec3(0.1031, 0.1030, 0.0973));
    p += dot(p, p.yzx + 33.33);
    return fract((p.x + p.y) * p.z);
}

// Generate a pseudorandom vec3 from a seed vec3
vec3 pseudorandomVec3(vec3 seed) {
    vec3 randomVec;
    randomVec.x = hash(seed);
    randomVec.y = hash(seed + vec3(1.0, 0.0, 17.1));
    randomVec.z = hash(seed + vec3(0.0, 13.23, 0.0));
    return randomVec;
}

void main(void)
{   
   const float base = 0.2;
   const float area = 0.75;
   const int cycles = 1;

   const int samples = 64;
   vec3 sample_sphere[64] = vec3[](
      vec3(0.091258,-0.510164,0.000000),
      vec3(-0.204347,-0.872967,0.187199),
      vec3(0.009690,-0.263696,-0.110414),
      vec3(0.175208,-0.563987,0.228527),
      vec3(-0.001824,-0.003113,-0.000323),
      vec3(0.411134,-0.719869,-0.261530),
      vec3(-0.074272,-0.377368,0.276290),
      vec3(-0.147773,-0.381587,-0.284529),
      vec3(0.173317,-0.199635,0.063295),
      vec3(-0.186452,-0.199460,0.076965),
      vec3(0.143985,-0.308160,-0.307687),
      vec3(0.053194,-0.148286,0.169589),
      vec3(-0.547656,-0.486476,-0.317378),
      vec3(0.020804,-0.015092,-0.004574),
      vec3(-0.038006,-0.043165,0.054059),
      vec3(-0.094795,-0.443908,-0.731525),
      vec3(0.547552,-0.396466,0.461477),
      vec3(-0.176886,-0.089989,0.007315),
      vec3(0.074401,-0.048840,-0.074039),
      vec3(-0.008240,-0.075697,0.178197),
      vec3(-0.307880,-0.185053,-0.368943),
      vec3(0.309520,-0.108483,0.041646),
      vec3(-0.773478,-0.292946,0.538166),
      vec3(0.184487,-0.231594,-0.820065),
      vec3(0.207318,-0.100531,0.361797),
      vec3(-0.173306,-0.037737,-0.055289),
      vec3(0.548102,-0.105342,-0.253237),
      vec3(-0.119342,-0.043907,0.285162),
      vec3(-0.270247,-0.087861,-0.751357),
      vec3(0.449312,-0.039777,0.236146),
      vec3(-0.743773,-0.036095,0.196056),
      vec3(0.148819,-0.004300,-0.231448),
      vec3(0.008773,0.000809,0.051047),
      vec3(-0.461467,0.027390,-0.357386),
      vec3(0.169626,0.013338,-0.014053),
      vec3(-0.043786,0.007095,0.047331),
      vec3(0.004821,0.140371,-0.988260),
      vec3(0.092402,0.023994,0.101860),
      vec3(-0.295335,0.061530,-0.027372),
      vec3(0.024903,0.007537,-0.018901),
      vec3(-0.081463,0.125402,0.447794),
      vec3(-0.397119,0.231805,-0.631062),
      vec3(0.163853,0.059014,0.044905),
      vec3(-0.495220,0.214357,0.254139),
      vec3(0.306123,0.373687,-0.825715),
      vec3(0.021665,0.026737,0.053220),
      vec3(-0.208231,0.117129,-0.098685),
      vec3(0.139749,0.080968,-0.043086),
      vec3(-0.153599,0.182814,0.262090),
      vec3(-0.159673,0.496777,-0.743568),
      vec3(0.134797,0.117152,0.095753),
      vec3(-0.155626,0.120533,0.019395),
      vec3(0.042311,0.054462,-0.049709),
      vec3(0.001257,0.031288,0.034468),
      vec3(-0.002271,0.003199,-0.002304),
      vec3(0.662104,0.717307,0.033854),
      vec3(-0.373100,0.576021,0.308274),
      vec3(0.024233,0.231316,-0.173688),
      vec3(0.161311,0.420217,0.234273),
      vec3(-0.045248,0.078031,-0.010411),
      vec3(0.167453,0.376942,-0.094872),
      vec3(-0.056194,0.433247,0.173218),
      vec3(-0.016224,0.123149,-0.035569),
      vec3(0.067127,0.407641,0.028479)
   );

   float depth = texture2D(depthmap, vTexCoords).r;
   if(depth == 1.0) {
      discard;
   }

   vec4 screen_position = vec4(vTexCoords, depth,1.0);
   vec4 pos = projinv*screen_position;
   pos /= pos.w;
   vec3 position = pos.xyz;

   //approximate the normal from the depth map; I find this simpler
   //than trying to recompute the exact normal within every possible object shader

   //pixel offset positions in screen space
   ivec2 dim = textureSize(depthmap,0);
   vec2 offset1 = vec2(0.0,1.0/float(dim.y));
   vec2 offset2 = vec2(1.0/float(dim.x),0.0);
   float depth1 = texture2D(depthmap, vTexCoords + offset1).r;
   float depth2 = texture2D(depthmap, vTexCoords + offset2).r;
   
   vec3 p1 = vec3(screen_position.xy+offset1, depth1 - depth);
   vec3 p2 = vec3(screen_position.xy+offset2, depth2 - depth);

   //convert to model space
   vec4 pos1 = projinv*vec4(p1,1);
   pos1 /= pos1.w;
   vec4 pos2 = projinv*vec4(p2,1);
   pos2 /= pos2.w;

   vec3 normal = normalize(cross(pos1.xyz-position, pos2.xyz-position)); //model normal, important we normalize in model space

   //pseudo random number

   float occlusion = 0.0;
   for(int c = 0; c < cycles; c++) {
   vec3 random = normalize(pseudorandomVec3(position+float(c)));
   for(int i=0; i < samples; i++) {

      vec3 ray = radius * reflect(sample_sphere[i],random);
      vec3 hemi_ray = position + sign(dot(ray,normal)) * ray; //model space
      vec4 hemi_screen = projectionMatrix*vec4(hemi_ray,1.0);
      hemi_screen /= hemi_screen.w;
      
      float occ_depth = texture2D(depthmap, clamp(hemi_screen.xy,0.0,1.0)).r;
      float difference = hemi_screen.z - occ_depth;
      
      occlusion += step(0.0, difference) * (1.0-smoothstep(0.0, area, difference));
   }
   }
   float ao = 1.0 - total_strength * occlusion * (1.0 / float(cycles*samples));
   gl_FragDepthEXT = clamp(ao+base,0.0,1.0);

}`},"./src/WebGL/shaders/lib/ssao/ssao.vert"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`attribute vec2 vertexPosition;
varying highp vec2 vTexCoords;
const vec2 scale = vec2(0.5, 0.5);

void main() {
   vTexCoords  = vertexPosition * scale + scale; // scale vertex attribute to [0,1] range
   gl_Position = vec4(vertexPosition, 0.0, 1.0);
}
        `},"./src/WebGL/shaders/lib/ssao/uniforms.ts"(e,i,s){s.r(i),s.d(i,{uniforms:()=>o});const o={total_strength:{type:"f",value:1},radius:{type:"f",value:5},projinv:{type:"mat4",value:[]}}},"./src/WebGL/shaders/lib/stickimposter/index.ts"(e,i,s){s.r(i),s.d(i,{stickimposter:()=>_e});var o=s("./src/WebGL/shaders/lib/stickimposter/uniforms.ts"),a=s("./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag"),h=s("./src/WebGL/shaders/lib/stickimposter/stickimposter.partial.frag"),_=s("./src/WebGL/shaders/lib/stickimposter/stickimposter.vert");const _e={fragmentShader:[a.default,h.default].join(`
`),vertexShader:_.default,uniforms:o.uniforms}},"./src/WebGL/shaders/lib/stickimposter/stickimposter.partial.frag"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`    float dotProduct = dot( norm, vLight );
    vec3 light = vec3( max( dotProduct, 0.0 ) );
    color *= light;
#ifdef SHADED
    ivec2 dim = textureSize(shading,0);
    float shadowFactor = texture2D(shading,vec2(gl_FragCoord.x/float(dim.x),gl_FragCoord.y/float(dim.y))).r;
    color *= shadowFactor;
#endif    
    gl_FragColor = vec4(color, opacity*opacity );
    if(fogNear != fogFar) {
        float depth = -qi.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}`},"./src/WebGL/shaders/lib/stickimposter/stickimposter.vert"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];

attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLight;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

void main() {

    vColor = color; vColor.z = abs(vColor.z); //z indicates which vertex and so would vary
    r = abs(radius);
    vec4 to = modelViewMatrix*vec4(normal, 1.0); //normal is other point of cylinder
    vec4 pt = modelViewMatrix*vec4(position, 1.0);
    vec4 mvPosition = pt;
    p1 = pt.xyz; p2 = to.xyz;
    vec3 norm = to.xyz-pt.xyz;
    float mult = 1.1; //slop to account for perspective of sphere
    if(length(p1) > length(p2)) { //billboard at level of closest point
       mvPosition = to;
    }
    vec3 n = normalize(mvPosition.xyz);
    bool isperspective = (projectionMatrix[3][3] == 0.0);
//intersect with the plane defined by the camera looking at the billboard point
    if(color.z >= 0.0) { //p1
       if(isperspective) { //perspective
         vec3 pnorm = normalize(p1);
         float t = dot(mvPosition.xyz-p1,n)/dot(pnorm,n);
         mvPosition.xyz = p1+t*pnorm; 
       } else { //orthographic
         mvPosition.xyz = p1;
       }
    } else {
      if(isperspective) { //perspective
         vec3 pnorm = normalize(p2);
         float t = dot(mvPosition.xyz-p2,n)/dot(pnorm,n);
         mvPosition.xyz = p2+t*pnorm;
       } else { //orthographic
         mvPosition.xyz = p2;
       } 
       mult *= -1.0;
    }

    if(isperspective) { //perspective
      vec3 cr = normalize(cross(mvPosition.xyz,norm))*radius;
      vec3 doublecr = normalize(cross(mvPosition.xyz,cr))*radius;
      mvPosition.xyz +=  mult*(cr + doublecr).xyz;
    } else {
      vec3 cr = normalize(cross(vec3(0.0,0.0,-1.0),norm))*radius;
      vec3 doublecr = normalize(cross(vec3(0.0,0.0,-1.0),cr))*radius;
      mvPosition.xyz +=  mult*(cr + doublecr).xyz;     
    }

    cposition = mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );
    vLight = normalize( lDirection.xyz )*directionalLightColor[0]; //not really sure this is right, but color is always white so..
}

`},"./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`uniform float opacity;
uniform mat4 projectionMatrix;

uniform vec3 fogColor;
uniform float fogNear;
uniform float fogFar;

varying vec3 vLight;
varying vec3 vColor;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

#ifdef SHADED
uniform highp sampler2D shading;
#endif

//DEFINEFRAGCOLOR

//cylinder-ray intersection testing taken from http://mrl.nyu.edu/~dzorin/cg05/lecture12.pdf
//also useful: http://stackoverflow.com/questions/9595300/cylinder-impostor-in-glsl
//with a bit more care (caps) this could be a general cylinder imposter (see also outline)
void main() {
    vec3 color = abs(vColor);
    vec3 pos = cposition;
    vec3 p = pos; //ray point
    vec3 v = vec3(0.0,0.0,-1.0); //ray normal - orthographic
    if(projectionMatrix[3][3] == 0.0) v = normalize(pos); //ray normal - perspective
    vec3 pa = p1; //cyl start
    vec3 va = normalize(p2-p1); //cyl norm
    vec3 tmp1 = v-(dot(v,va)*va);
    vec3 deltap = p-pa;
    float A = dot(tmp1,tmp1);
    if(A == 0.0) discard;
    vec3 tmp2 = deltap-(dot(deltap,va)*va);
    float B = 2.0*dot(tmp1, tmp2);
    float C = dot(tmp2,tmp2)-r*r;
//quadratic equation!
    float det = (B*B) - (4.0*A*C);
    if(det < 0.0) discard;
    float sqrtDet = sqrt(det);
    float posT = (-B+sqrtDet)/(2.0*A);
    float negT = (-B-sqrtDet)/(2.0*A);
    float intersectionT = min(posT,negT);
    vec3 qi = p+v*intersectionT;
    float dotp1 = dot(va,qi-p1);
    float dotp2 = dot(va,qi-p2);
    vec3 norm;
    if( dotp1 < 0.0 || dotp2 > 0.0) { //(p-c)^2 + 2(p-c)vt +v^2+t^2 - r^2 = 0
       vec3 cp;
       if( dotp1 < 0.0) {  
//        if(vColor.x < 0.0 ) discard; //color sign bit indicates if we should cap or not
        cp = p1;
       } else {
//          if(vColor.y < 0.0 ) discard;
          cp = p2;
       }
       vec3 diff = p-cp;
       A = dot(v,v);
       B = dot(diff,v)*2.0;
       C = dot(diff,diff)-r*r;
       det = (B*B) - (4.0*C);
       if(det < 0.0) discard;
       sqrtDet = sqrt(det);
       posT = (-B+sqrtDet)/(2.0);
       negT = (-B-sqrtDet)/(2.0);
       float t = min(posT,negT);
       qi = p+v*t; 
       norm = normalize(qi-cp); 
    } else {
       norm = normalize(qi-(dotp1*va + p1));
    }
    vec4 clipPos = projectionMatrix * vec4(qi, 1.0);
    float ndcDepth = clipPos.z / clipPos.w;
    float depth = ((gl_DepthRange.diff * ndcDepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
    gl_FragDepthEXT = depth;`},"./src/WebGL/shaders/lib/stickimposter/uniforms.ts"(e,i,s){s.r(i),s.d(i,{uniforms:()=>a});var o=s("./src/colors.ts");const a={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},"./src/WebGL/shaders/lib/stickimposteroutline/index.ts"(e,i,s){s.r(i),s.d(i,{stickimposteroutline:()=>_e});var o=s("./src/WebGL/shaders/lib/stickimposteroutline/uniforms.ts"),a=s("./src/WebGL/shaders/lib/stickimposter/stickimposterFragmentShader.partial.frag"),h=s("./src/WebGL/shaders/lib/stickimposteroutline/stickimposteroutline.partial.frag"),_=s("./src/WebGL/shaders/lib/stickimposteroutline/stickimposteroutline.vert");const _e={fragmentShader:a.default+h.default,vertexShader:_.default,uniforms:o.uniforms}},"./src/WebGL/shaders/lib/stickimposteroutline/stickimposteroutline.partial.frag"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`
    gl_FragColor = vec4(color, opacity*opacity );
    if(fogNear != fogFar) {
        float depth = -qi.z;
        float fogFactor = smoothstep( fogNear, fogFar, depth );
        gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );
    }
}`},"./src/WebGL/shaders/lib/stickimposteroutline/stickimposteroutline.vert"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`

uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;
uniform mat3 normalMatrix;
uniform vec3 directionalLightColor[ 1 ];
uniform vec3 directionalLightDirection[ 1 ];
uniform vec3 outlineColor;
uniform float outlineWidth;
uniform float outlinePushback;
uniform float outlineMaxPixels;
uniform float vWidth;
uniform mat4 projinv;


attribute vec3 position;
attribute vec3 normal;
attribute vec3 color;
attribute float radius;

varying vec3 vColor;
varying vec3 vLight;
varying vec3 cposition;
varying vec3 p1;
varying vec3 p2;
varying float r;

void main() {

    vColor = outlineColor;
    float rad = radius+sign(radius)*outlineWidth;
    r = abs(rad);

    vec4 to = modelViewMatrix*vec4(normal, 1.0); //normal is other point of cylinder
    vec4 pt = modelViewMatrix*vec4(position, 1.0);
//pushback
    float scale = 1.0;
    if(projectionMatrix[3][3] != 0.0) { //orthographic
        to.z -= outlinePushback;
        pt.z -= outlinePushback;
    } else { //perspective
        vec4 midbefore = pt;
        if(length(to.xyz) < length(pt)) {
            midbefore = to;
        }
        vec4 midafter = midbefore;
        midafter.xyz += normalize(midbefore.xyz)*outlinePushback;

        to.xyz += normalize(to.xyz)*outlinePushback;
        pt.xyz += normalize(pt.xyz)*outlinePushback;

        //figure out a scaling factor for radius to account for perspective setback
        vec4 midbeforer = vec4(midbefore.x+rad,midbefore.y, midbefore.z, midbefore.w);
        vec4 midafterr = vec4(midafter.x+rad,midafter.y, midafter.z, midafter.w);

        vec4 mb = projectionMatrix*midbefore;
        vec4 mbr = projectionMatrix*midbeforer;
        vec4 ma = projectionMatrix*midafter;
        vec4 mar = projectionMatrix*midafterr;
        mb /= mb.w;
        mbr /= mbr.w;
        ma /= ma.w;
        mar /= mar.w;
        scale = abs((mbr.x-mb.x)/(mar.x-ma.x));
        rad *= scale;
        r = abs(rad);
    }
    vec4 mvPosition = pt;
    p1 = pt.xyz; p2 = to.xyz;
    vec3 norm = to.xyz-pt.xyz;
    float mult = 1.1; //slop to account for perspective of sphere
    if(length(p1) > length(p2)) { //billboard at level of closest point
       mvPosition = to;
    }

    vec3 n = normalize(mvPosition.xyz);
//intersect with the plane defined by the camera looking at the billboard point
    if(color.z >= 0.0) { //p1
       vec3 pnorm = normalize(p1);
       float t = dot(mvPosition.xyz-p1,n)/dot(pnorm,n);
       mvPosition.xyz = p1+t*pnorm;
    } else {
       vec3 pnorm = normalize(p2);
       float t = dot(mvPosition.xyz-p2,n)/dot(pnorm,n);
       mvPosition.xyz = p2+t*pnorm;
       mult *= -1.0;
    }

    if(outlineMaxPixels > 0.0) {
        vec4 cpos = mvPosition;
        vec4 unadjusted = projectionMatrix*vec4(cpos.x+abs(scale*radius), cpos.y,cpos.z,cpos.w); 
        vec4 ccoord = projectionMatrix*cpos;
        vec4 adjust = projectionMatrix*vec4(cpos.x+r,cpos.y,cpos.z,cpos.w); 
        unadjusted /= unadjusted.w;
        adjust /= adjust.w;
        unadjusted.xyz -= ccoord.xyz/ccoord.w;
        adjust.xyz -= ccoord.xyz/ccoord.w;
        float diff = abs(adjust.x-unadjusted.x);
        diff *= vWidth; //this should now be in pixels
        if(diff > outlineMaxPixels) {
            float fixlen = abs(unadjusted.x) + outlineMaxPixels/vWidth; 
            vec4 pcoord = ccoord;
            pcoord.x += fixlen*pcoord.w;
            vec4 altc = projinv*pcoord;
            r= abs(altc.x-cpos.x);
        }
    }

    vec3 cr = normalize(cross(mvPosition.xyz,norm))*rad;
    vec3 doublecr = normalize(cross(mvPosition.xyz,cr))*rad;
    mvPosition.xy +=  mult*(cr + doublecr).xy;
    cposition = mvPosition.xyz;
    gl_Position = projectionMatrix * mvPosition;
    vLight = vec3(1.0,1.0,1.0);
}

`},"./src/WebGL/shaders/lib/stickimposteroutline/uniforms.ts"(e,i,s){s.r(i),s.d(i,{uniforms:()=>a});var o=s("./src/colors.ts");const a={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},outlineColor:{type:"c",value:new o.Color(0,0,0)},outlineWidth:{type:"f",value:.1},outlinePushback:{type:"f",value:1},outlineMaxPixels:{type:"f",value:0},projinv:{type:"mat4",value:[]}}},"./src/WebGL/shaders/lib/volumetric/index.ts"(e,i,s){s.r(i),s.d(i,{volumetric:()=>_});var o=s("./src/WebGL/shaders/lib/volumetric/uniforms.ts"),a=s("./src/WebGL/shaders/lib/volumetric/volumetric.frag"),h=s("./src/WebGL/shaders/lib/volumetric/volumetric.vert");const _={fragmentShader:a.default.replace("#define GLSLIFY 1",""),vertexShader:h.default.replace("#define GLSLIFY 1",""),uniforms:o.uniforms}},"./src/WebGL/shaders/lib/volumetric/uniforms.ts"(e,i,s){s.r(i),s.d(i,{uniforms:()=>a});var o=s("./src/colors.ts");const a={opacity:{type:"f",value:1},fogColor:{type:"c",value:new o.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2e3},data:{type:"i",value:3},colormap:{type:"i",value:4},depthmap:{type:"i",value:5},step:{type:"f",value:1},maxdepth:{type:"f",value:100},subsamples:{type:"f",value:5},textmat:{type:"mat4",value:[]},projinv:{type:"mat4",value:[]},transfermin:{type:"f",value:-.2},transfermax:{type:"f",value:.2}}},"./src/WebGL/shaders/lib/volumetric/volumetric.frag"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`
uniform highp sampler3D data;
uniform highp sampler2D colormap;
uniform highp sampler2D depthmap;


uniform mat4 textmat;
uniform mat4 projinv;
uniform mat4 projectionMatrix;

uniform float step;
uniform float subsamples;
uniform float maxdepth;
uniform float transfermin;
uniform float transfermax;
in  vec4 mvPosition;
out vec4 color;
void main(void) {

   vec4 pos = mvPosition;
   bool seengood = false;
   float i = 0.0;
   color = vec4(1,1,1,0);
   float increment = 1.0/subsamples;
   float maxsteps = (maxdepth*subsamples/step);
//there's probably a better way to do this..
//calculate farthest possible point in model coordinates
   vec4 maxpos = vec4(pos.x,pos.y,pos.z-maxdepth,1.0);
// convert to projection
   maxpos = projectionMatrix*maxpos;
   vec4 startp = projectionMatrix*pos;
// homogonize
   maxpos /= maxpos.w;
   startp /= startp.w;
//take x,y from start and z from max
   maxpos = vec4(startp.x,startp.y,maxpos.z,1.0);
//convert back to model space
   maxpos = projinv*maxpos;
   maxpos /= maxpos.w;
   float incr = step/subsamples;
//get depth from depthmap
//startp is apparently [-1,1]
   vec2 tpos = startp.xy/2.0+0.5;
   float depth = texture(depthmap, tpos).r;
//compute vector between start and end
   vec4 direction = maxpos-pos;
   for( i = 0.0; i <= maxsteps; i++) {
      vec4 pt = (pos+(i/maxsteps)*direction);
      vec4 ppt = projectionMatrix*pt;
      float ptdepth = ppt.z/ppt.w;
      ptdepth = ((gl_DepthRange.diff * ptdepth) + gl_DepthRange.near + gl_DepthRange.far) / 2.0;
      if(ptdepth > depth) break;
      pt = textmat*pt;
//       pt /= pt.w;
      if(pt.x >= -0.01 && pt.y >= -0.01 && pt.z >= -0.01 && pt.x <= 1.01 && pt.y <= 1.01 && pt.z <= 1.01) {
         seengood = true;
      } else if(seengood) {
         break;
      }
      if( pt.x < -0.01 || pt.x > 1.01 || pt.y < -0.01 || pt.y > 1.01 || pt.z < -0.01 || pt.z > 1.01  ){
          color.a = 0.0;
          continue;
      }
      else {
         float val = texture(data, pt.zyx).r;
         if(isinf(val)) continue; //masked out
         float cval = (val-transfermin)/(transfermax-transfermin); //scale to texture 0-1 range
         vec4 val_color = texture(colormap, vec2(cval,0.5));
         color.rgb = color.rgb*color.a + (1.0-color.a)*val_color.a*val_color.rgb;
         color.a += (1.0 - color.a) * val_color.a; 
         if(color.a > 0.0) color.rgb /= color.a;
//          color = vec4(pt.x, pt.y, pt.z, 1.0);
      }
//       color = vec4(pt.x, pt.y, pt.z, 0.0)
    }
}

        `},"./src/WebGL/shaders/lib/volumetric/volumetric.vert"(e,i,s){s.r(i),s.d(i,{default:()=>o});const o=`uniform mat4 modelViewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewMatrix;

in vec3 position;
out vec4 mvPosition;
void main() {

    mvPosition = modelViewMatrix * vec4( position, 1.0 );
    gl_Position = projectionMatrix*mvPosition;
}
`},"./src/WebGL/shaders/utils/clone.ts"(e,i,s){s.r(i),s.d(i,{clone:()=>a});var o=s("./src/colors.ts");function a(h){let _={};for(const _e in h){_[_e]={},_[_e].type=h[_e].type;var g=h[_e].value;g instanceof o.Color?_[_e].value=g.clone():typeof g=="number"?_[_e].value=g:g instanceof Array?_[_e].value=[]:console.error("Error copying shader uniforms from ShaderLib: unknown type for uniform")}return _}},"./src/WebGL/shaders/utils/index.ts"(e,i,s){s.r(i),s.d(i,{ShaderUtils:()=>a,clone:()=>o.clone});var o=s("./src/WebGL/shaders/utils/clone.ts");const a={clone:o.clone}},"./src/WebGL/shapes/Cylinder.ts"(e,i,s){s.r(i),s.d(i,{Cylinder:()=>h});var o=s("./src/WebGL/math/index.ts");let a=new o.Vector3;class h{constructor(g=new o.Vector3,_e=new o.Vector3,st=0){this.c1=g,this.c2=_e,this.radius=st,this.direction=new o.Vector3().subVectors(this.c2,this.c1).normalize()}copy(g){return this.c1.copy(g.c1),this.c2.copy(g.c2),this.direction.copy(g.direction),this.radius=g.radius,this}lengthSq(){return a.subVectors(this.c2,this.c1).lengthSq()}applyMatrix4(g){return this.direction.add(this.c1).applyMatrix4(g),this.c1.applyMatrix4(g),this.c2.applyMatrix4(g),this.direction.sub(this.c1).normalize(),this.radius=this.radius*g.getMaxScaleOnAxis(),this}}},"./src/WebGL/shapes/Sphere.ts"(e,i,s){s.r(i),s.d(i,{Sphere:()=>a});var o=s("./src/WebGL/math/index.ts");class a{constructor(_={x:0,y:0,z:0},g=0){this.center=new o.Vector3(_.x,_.y,_.z),this.radius=g}set(_,g){return this.center.copy(_),this.radius=g,this}copy(_){return this.center.copy(_.center),this.radius=_.radius,this}applyMatrix4(_){return this.center.applyMatrix4(_),this.radius=this.radius*_.getMaxScaleOnAxis(),this}translate(_){return this.center.add(_),this}equals(_){return _.center.equals(this.center)&&_.radius===this.radius}clone(){return new a().copy(this)}}},"./src/WebGL/shapes/Triangle.ts"(e,i,s){s.r(i),s.d(i,{Triangle:()=>h});var o=s("./src/WebGL/math/index.ts");const a=new o.Vector3;class h{constructor(g=new o.Vector3,_e=new o.Vector3,st=new o.Vector3){this.a=g,this.b=_e,this.c=st}copy(g){return this.a.copy(g.a),this.b.copy(g.b),this.c.copy(g.c),this}applyMatrix4(g){return this.a.applyMatrix4(g),this.b.applyMatrix4(g),this.c.applyMatrix4(g),this}getNormal(){var g=this.a.clone();return g.sub(this.b),a.subVectors(this.c,this.b),g.cross(a),g.normalize(),g}}},"./src/WebGL/shapes/index.ts"(e,i,s){s.r(i),s.d(i,{Cylinder:()=>a.Cylinder,Sphere:()=>o.Sphere,Triangle:()=>h.Triangle});var o=s("./src/WebGL/shapes/Sphere.ts"),a=s("./src/WebGL/shapes/Cylinder.ts"),h=s("./src/WebGL/shapes/Triangle.ts")},"./src/autoload.ts"(e,i,s){s.r(i),s.d(i,{autoinit:()=>g,autoload:()=>tt,processing_autoinit:()=>_e,viewers:()=>st});var o=s("./src/GLViewer.ts"),a=s("./src/ProteinSurface4.ts"),h=s("./src/utilities.ts"),_=s("./src/colors.ts"),g=!1,_e=!1,st={};function tt(at,ot){var lt,ct,$;if(document.querySelector(".viewer_3Dmoljs")!=null&&(g=!0),g){_e=!0,at=at??null;var c=0;document.querySelectorAll(".viewer_3Dmoljs").forEach(d=>{var j=[],et=[],nt="";d.style.position=="static"&&(d.style.position="relative");var ut=null;if($=null,d.dataset.pdb)j.push("https://files.rcsb.org/view/"+d.dataset.pdb+".pdb"),et.push("pdb");else if(d.dataset.cid)et.push("sdf"),j.push("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+d.dataset.cid+"/SDF?record_type=3d");else if(d.dataset.href||d.dataset.url){if(d.dataset.href?nt=d.dataset.href:nt=d.dataset.url,j.push(nt),$=nt.substring(nt.lastIndexOf(".")+1),$=="gz"){let nr=nt.substring(0,nt.lastIndexOf(".")).lastIndexOf(".");$=nt.substring(nr+1)}et.push($);var b=nt.substring(nt.lastIndexOf("/")+1,nt.lastIndexOf("."));b=="/"&&(b=nt.substring(nt.lastIndexOf("/")+1)),d.dataset[et[et.length-1]]=b}let it=d.dataset;for(lt in it)lt.substring(0,3)==="pdb"&&lt!=="pdb"?(j.push("https://files.rcsb.org/view/"+it[lt]+".pdb"),et.push("pdb")):lt.substring(0,4)==="href"&&lt!=="href"?(nt=it[lt],j.push(nt),et.push(nt.substring(nt.lastIndexOf(".")+1))):lt.substring(0,3)==="cid"&&lt!=="cid"&&(j.push("https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+it[lt]+"/SDF?record_type=3d"),et.push("sdf"));var rt={};d.dataset.options&&(rt=(0,h.specStringToObject)(d.dataset.options));var dt=_.CC.color(d.dataset.backgroundcolor),ft=d.dataset.backgroundalpha;ft=ft==null?1:parseFloat(ft);var mt={line:{}};d.dataset.style&&(mt=(0,h.specStringToObject)(d.dataset.style));var yt={};d.dataset.select&&(yt=(0,h.specStringToObject)(d.dataset.select));var gt=[],_t=[],xt=[],Mt={},wt=null,Et=d.dataset,At=/style(.+)/,St=/surface(.*)/,bt=/labelres(.*)/,Ct=[];for(ct in Et)Object.prototype.hasOwnProperty.call(Et,ct)&&Ct.push(ct);for(Ct.sort(),lt=0;lt<Ct.length;lt++){ct=Ct[lt];var Nt=At.exec(ct),kt,Ht,jt;Nt&&(kt="select"+Nt[1],Ht=(0,h.specStringToObject)(Et[kt]),jt=(0,h.specStringToObject)(Et[ct]),gt.push([Ht,jt])),Nt=St.exec(ct),Nt&&(kt="select"+Nt[1],Ht=(0,h.specStringToObject)(Et[kt]),jt=(0,h.specStringToObject)(Et[ct]),_t.push([Ht,jt])),Nt=bt.exec(ct),Nt&&(kt="select"+Nt[1],Ht=(0,h.specStringToObject)(Et[kt]),jt=(0,h.specStringToObject)(Et[ct]),xt.push([Ht,jt])),ct=="zoomto"&&(Mt=(0,h.specStringToObject)(Et[ct])),ct=="spin"&&(wt=(0,h.specStringToObject)(Et[ct]))}var Zt=function(nr){for(nr.setStyle(yt,mt),ut&&ut.createSelectionAndStyle(yt,mt),lt=0;lt<gt.length;lt++){let Vt=gt[lt][0]||{},tr=gt[lt][1]||{line:{}};nr.setStyle(Vt,tr),ut&&ut.createSelectionAndStyle(yt,mt)}for(lt=0;lt<_t.length;lt++){let Vt=_t[lt][0]||{},tr=_t[lt][1]||{};ut?nr.addSurface(a.SurfaceType.VDW,tr,Vt,Vt).then(wr=>{ut.loadSurface("VDW",Vt,tr,wr)}):nr.addSurface(a.SurfaceType.VDW,tr,Vt,Vt)}for(lt=0;lt<xt.length;lt++){let Vt=xt[lt][0]||{},tr=xt[lt][1]||{};nr.addResLabels(Vt,tr)}nr.render(),nr.zoomTo(Mt),wt&&nr.spin(wt.axis,wt.speed)};let Xt=at;try{var Kt=(0,h.specStringToObject)(d.dataset.config)||{};Kt.backgroundColor===void 0&&(Kt.backgroundColor=dt),Kt.backgroundAlpha===void 0&&(Kt.backgroundAlpha=ft),Xt==null?Xt=st[d.id||c++]=(0,o.createViewer)(d,Kt):(Xt.setBackgroundColor(dt,ft),Xt.setConfig(Kt),ut&&ut.initiateUI()),d.dataset.ui&&$3Dmol.StateManager&&(ut=new $3Dmol.StateManager(Xt))}catch(nr){console.log(nr),d.textContent="WebGL appears to be disabled."}if(j.length!=0){let nr=0,Vt=((tr,mr)=>function(wr){nt=j[nr];var Er=tr.dataset.type||tr.dataset.datatype||et[nr];if(mr.addModel(wr,Er,rt),ut){var Sr=tr.dataset[et[nr]];ut.setModelTitle(Sr)}nr+=1,nr<j.length?(0,h.get)(j[nr]).then(Vt):(Zt(mr),tr.dataset.callback&&(0,h.makeFunction)(tr.dataset.callback)(mr),_e=!1,ot&&ot(mr))})(d,Xt);$&&$.endsWith("gz")?(0,h.getbin)(j[0]).then(Vt):(0,h.get)(j[0]).then(Vt)}else{if(d.dataset.element){var ar="#"+d.dataset.element,or=document.querySelector(ar),_r=or?or.textContent:"";$=d.dataset.type||d.dataset.datatype,Xt.addModel(_r,$,rt)}Zt(Xt),d.dataset.callback&&(0,h.makeFunction)(d.dataset.callback)(Xt),_e=!1,ot&&ot(Xt)}})}}document.onreadystatechange=()=>{document.readyState==="complete"&&tt()}},"./src/colors.ts"(e,i,s){s.r(i),s.d(i,{CC:()=>a,Color:()=>o,builtinColorSchemes:()=>at,chains:()=>tt,elementColors:()=>_e,htmlColors:()=>h,residues:()=>st,ssColors:()=>_});class o{constructor(lt,ct,$){return this.r=0,this.g=0,this.b=0,arguments.length>1&&typeof lt=="number"?(this.r=lt||0,this.g=ct||0,this.b=$||0,this):this.set(lt||0)}set(lt){return lt instanceof o?lt.clone():(typeof lt=="number"?this.setHex(lt):typeof lt=="object"&&(this.r=(lt==null?void 0:lt.r)||0,this.g=(lt==null?void 0:lt.g)||0,this.b=(lt==null?void 0:lt.b)||0),this)}setHex(lt){return lt=Math.floor(lt),this.r=(lt>>16&255)/255,this.g=(lt>>8&255)/255,this.b=(lt&255)/255,this}getHex(){var lt=Math.round(this.r*255),ct=Math.round(this.g*255),$=Math.round(this.b*255);return lt<<16|ct<<8|$}clone(){return new o(this.r,this.g,this.b)}copy(lt){return this.r=lt.r,this.g=lt.g,this.b=lt.b,this}scaled(){var lt={};return lt.r=Math.round(this.r*255),lt.g=Math.round(this.g*255),lt.b=Math.round(this.b*255),lt.a=1,lt}}class a{static color(lt){if(!lt)return a.cache[0];if(lt instanceof o)return lt;if(typeof lt=="number"&&typeof a.cache[lt]<"u")return a.cache[lt];if(lt&&Array.isArray(lt))return lt.map(a.color);let ct=a.getHex(lt),$=new o(ct);return a.cache[ct]=$,$}static getHex(lt){if(Array.isArray(lt))return lt.map(a.getHex);if(typeof lt=="string"){let ct=lt;if(!isNaN(parseInt(ct)))return parseInt(ct);if(ct=ct.trim(),ct.length==4&&ct[0]=="#"&&(ct="#"+ct[1]+ct[1]+ct[2]+ct[2]+ct[3]+ct[3]),ct.length==7&&ct[0]=="#")return parseInt(ct.substring(1),16);let $=a.rgbRegEx.exec(ct);if($){$[1]!=""&&console.log("WARNING: Opacity value in rgba ignored.  Specify separately as opacity attribute.");let d=0;for(let j=2;j<5;j++){d*=256;let et=$[j].endsWith("%")?255*parseFloat($[j])/100:parseFloat($[j]);d+=Math.round(et)}return d}let c=h[ct.toLowerCase()];return c!==void 0?c:(console.error("color not found",lt.toLowerCase(),h),0)}return lt}}a.rgbRegEx=/rgb(a?)\(\s*([^ ,\)\t]+)\s*,\s*([^ ,\)\t]+)\s*,\s*([^ ,\)\t]+)/i,a.cache={0:new o(0)};const h={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgrey:11119017,darkgreen:25600,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,grey:8421504,green:32768,greenyellow:11403055,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgrey:13882323,lightgreen:9498256,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074,b:255,g:32768,r:16711680,c:49087,m:12517567,y:12566272,k:0,w:16777215},_={pyMol:{h:16711680,s:16776960,c:65280},Jmol:{h:16711808,s:16762880,c:16777215}},g={H:16777215,He:16761035,HE:16761035,Li:11674146,LI:11674146,B:65280,C:13158600,N:9408511,O:15728640,F:14329120,Na:255,NA:255,Mg:2263842,MG:2263842,Al:8421520,AL:8421520,Si:14329120,SI:14329120,P:16753920,S:16762930,Cl:65280,CL:65280,Ca:8421520,CA:8421520,Ti:8421520,TI:8421520,Cr:8421520,CR:8421520,Mn:8421520,MN:8421520,Fe:16753920,FE:16753920,Ni:10824234,NI:10824234,Cu:10824234,CU:10824234,Zn:10824234,ZN:10824234,Br:10824234,BR:10824234,Ag:8421520,AG:8421520,I:10494192,Ba:16753920,BA:16753920,Au:14329120,AU:14329120},_e={defaultColor:16716947,Jmol:{H:16777215,He:14286847,HE:14286847,Li:13402367,LI:13402367,Be:12779264,BE:12779264,B:16758197,C:9474192,N:3166456,O:16715021,F:9494608,Ne:11789301,NE:11789301,Na:11230450,NA:11230450,Mg:9109248,MG:9109248,Al:12560038,AL:12560038,Si:1578e4,SI:1578e4,P:16744448,S:16777008,Cl:2093087,CL:2093087,Ar:8442339,AR:8442339,K:9388244,Ca:4062976,CA:4062976,Sc:15132390,SC:15132390,Ti:12567239,TI:12567239,V:10921643,Cr:9083335,CR:9083335,Mn:10255047,MN:10255047,Fe:14706227,FE:14706227,Co:15765664,CO:15765664,Ni:5296208,NI:5296208,Cu:13140019,CU:13140019,Zn:8224944,ZN:8224944,Ga:12750735,GA:12750735,Ge:6721423,GE:6721423,As:12419299,AS:12419299,Se:16752896,SE:16752896,Br:10889513,BR:10889513,Kr:6076625,KR:6076625,Rb:7351984,RB:7351984,Sr:65280,SR:65280,Y:9764863,Zr:9756896,ZR:9756896,Nb:7586505,NB:7586505,Mo:5551541,MO:5551541,Tc:3907230,TC:3907230,Ru:2396047,RU:2396047,Rh:687500,RH:687500,Pd:27013,PD:27013,Ag:12632256,AG:12632256,Cd:16767375,CD:16767375,In:10909043,IN:10909043,Sn:6717568,SN:6717568,Sb:10380213,SB:10380213,Te:13924864,TE:13924864,I:9699476,Xe:4366e3,XE:4366e3,Cs:5707663,CS:5707663,Ba:51456,BA:51456,La:7394559,LA:7394559,Ce:16777159,CE:16777159,Pr:14286791,PR:14286791,Nd:13107143,ND:13107143,Pm:10747847,PM:10747847,Sm:9437127,SM:9437127,Eu:6422471,EU:6422471,Gd:4587463,GD:4587463,Tb:3211207,TB:3211207,Dy:2097095,DY:2097095,Ho:65436,HO:65436,Er:58997,ER:58997,Tm:54354,TM:54354,Yb:48952,YB:48952,Lu:43812,LU:43812,Hf:5096191,HF:5096191,Ta:5089023,TA:5089023,W:2200790,Re:2522539,RE:2522539,Os:2516630,OS:2516630,Ir:1528967,IR:1528967,Pt:13684960,PT:13684960,Au:16765219,AU:16765219,Hg:12105936,HG:12105936,Tl:10900557,TL:10900557,Pb:5724513,PB:5724513,Bi:10375093,BI:10375093,Po:11230208,PO:11230208,At:7688005,AT:7688005,Rn:4358806,RN:4358806,Fr:4325478,FR:4325478,Ra:32e3,RA:32e3,Ac:7384058,AC:7384058,Th:47871,TH:47871,Pa:41471,PA:41471,U:36863,Np:33023,NP:33023,Pu:27647,PU:27647,Am:5528818,AM:5528818,Cm:7888099,CM:7888099,Bk:9064419,BK:9064419,Cf:10565332,CF:10565332,Es:11739092,ES:11739092,Fm:11739066,FM:11739066,Md:11734438,MD:11734438,No:12389767,NO:12389767,Lr:13041766,LR:13041766,Rf:13369433,RF:13369433,Db:13697103,DB:13697103,Sg:14221381,SG:14221381,Bh:14680120,BH:14680120,Hs:15073326,HS:15073326,Mt:15400998,MT:15400998},rasmol:g,defaultColors:Object.assign({},g),greenCarbon:Object.assign(Object.assign({},g),{C:65280}),cyanCarbon:Object.assign(Object.assign({},g),{C:65535}),magentaCarbon:Object.assign(Object.assign({},g),{C:16711935}),yellowCarbon:Object.assign(Object.assign({},g),{C:16776960}),whiteCarbon:Object.assign(Object.assign({},g),{C:16777215}),orangeCarbon:Object.assign(Object.assign({},g),{C:16753920}),purpleCarbon:Object.assign(Object.assign({},g),{C:8388736}),blueCarbon:Object.assign(Object.assign({},g),{C:255})},st={amino:{ALA:13158600,ARG:1334015,ASN:56540,ASP:15075850,CYS:15132160,GLN:56540,GLU:15075850,GLY:15461355,HIS:8553170,ILE:1016335,LEU:1016335,LYS:1334015,MET:15132160,PHE:3289770,PRO:14456450,SER:16422400,THR:16422400,TRP:11819700,TYR:3289770,VAL:1016335,ASX:16738740,GLX:16738740},shapely:{ALA:9240460,ARG:124,ASN:16743536,ASP:10485826,CYS:16777072,GLN:16731212,GLU:6684672,GLY:16777215,HIS:7368959,ILE:19456,LEU:4546117,LYS:4671416,MET:12099650,PHE:5459026,PRO:5395026,SER:16740418,THR:12078080,TRP:5195264,TYR:9203788,VAL:16747775,ASX:16711935,GLX:16711935},nucleic:{A:10526975,G:16740464,I:8454143,C:16747595,T:10551200,U:16744576}},tt={atom:{A:12636415,B:11599792,C:16761032,D:16777088,E:16761087,F:11596016,G:16765040,H:15761536,I:16113331,J:49151,K:13458524,L:6737322,M:10145074,N:15631086,O:52945,P:65407,Q:3978097,R:139,S:12433259,T:25600,U:8388608,V:8421376,W:8388736,X:32896,Y:12092939,Z:11674146},hetatm:{A:9478351,B:8441752,C:13602992,D:13619056,E:13603023,F:8437952,G:13607008,H:12603504,I:12955267,J:42959,K:11881548,L:5682578,M:9090346,N:12481214,O:46753,P:53103,Q:3447649,R:187,S:10854235,T:37888,U:11534336,V:11579392,W:11534512,X:45232,Y:15250963,Z:12726834}},at={ssPyMol:{prop:"ss",map:_.pyMol},ssJmol:{prop:"ss",map:_.Jmol},Jmol:{prop:"elem",map:_e.Jmol},amino:{prop:"resn",map:st.amino},shapely:{prop:"resn",map:st.shapely},nucleic:{prop:"resn",map:st.nucleic},chain:{prop:"chain",map:tt.atom},rasmol:{prop:"elem",map:_e.rasmol},default:{prop:"elem",map:_e.defaultColors},greenCarbon:{prop:"elem",map:_e.greenCarbon},chainHetatm:{prop:"chain",map:tt.hetatm},cyanCarbon:{prop:"elem",map:_e.cyanCarbon},magentaCarbon:{prop:"elem",map:_e.magentaCarbon},purpleCarbon:{prop:"elem",map:_e.purpleCarbon},whiteCarbon:{prop:"elem",map:_e.whiteCarbon},orangeCarbon:{prop:"elem",map:_e.orangeCarbon},yellowCarbon:{prop:"elem",map:_e.yellowCarbon},blueCarbon:{prop:"elem",map:_e.blueCarbon}}},"./src/exporter.js"(e){typeof e.exports=="object"&&(e.exports=window.$3Dmol)},"./src/glcartoon.ts"(e,i,s){s.r(i),s.d(i,{drawCartoon:()=>yt,subdivide_spline:()=>tt});var o=s("./src/WebGL/math/index.ts"),a=s("./src/WebGL/shapes/index.ts"),h=s("./src/WebGL/index.ts"),_=s("./src/Gradient.ts"),g=s("./src/colors.ts"),_e=s("./src/GLDraw.ts"),st=s("./src/utilities.ts");function tt(gt,_t){var xt=[],Mt=gt;Mt=[],Mt.push(gt[0]);var wt,Et,At,St,bt,Ct,Nt,kt,Ht;for(wt=1,Et=gt.length-1;wt<Et;wt++)if(bt=gt[wt],Ct=gt[wt+1],bt.smoothen){var jt=new o.Vector3((bt.x+Ct.x)/2,(bt.y+Ct.y)/2,(bt.z+Ct.z)/2);jt.atom=bt.atom,Mt.push(jt)}else Mt.push(bt);for(Mt.push(gt[gt.length-1]),wt=-1,At=Mt.length;wt<=At-3;wt++)if(St=Mt[wt===-1?0:wt],bt=Mt[wt+1],Ct=Mt[wt+2],Nt=Mt[wt===At-3?At-1:wt+3],kt=new o.Vector3().subVectors(Ct,St).multiplyScalar(.5),Ht=new o.Vector3().subVectors(Nt,bt).multiplyScalar(.5),!Ct.skip)for(var Zt=0;Zt<_t;Zt++){var Xt=1/_t*Zt,Kt=bt.x+Xt*kt.x+Xt*Xt*(-3*bt.x+3*Ct.x-2*kt.x-Ht.x)+Xt*Xt*Xt*(2*bt.x-2*Ct.x+kt.x+Ht.x),ar=bt.y+Xt*kt.y+Xt*Xt*(-3*bt.y+3*Ct.y-2*kt.y-Ht.y)+Xt*Xt*Xt*(2*bt.y-2*Ct.y+kt.y+Ht.y),or=bt.z+Xt*kt.z+Xt*Xt*(-3*bt.z+3*Ct.z-2*kt.z-Ht.z)+Xt*Xt*Xt*(2*bt.z-2*Ct.z+kt.z+Ht.z),_r=new o.Vector3(Kt,ar,or);Zt<_t/2?_r.atom=bt.atom:_r.atom=Ct.atom,xt.push(_r)}return xt.push(Mt[Mt.length-1]),xt}const at=.5,ot=1.3,lt=.8,ct=.4,$=.4;function c(gt,_t,xt,Mt){for(var wt,Et,At,St,bt=0,Ct=_t.length;bt<Ct;bt++){St=Math.round(bt*(Mt.length-1)/Ct),At=g.CC.color(Mt[St]);var Nt=gt.updateGeoGroup(2),kt=Nt.vertexArray,Ht=Nt.colorArray,jt=Nt.faceArray;wt=Nt.vertices,Et=wt*3,kt[Et]=_t[bt].x,kt[Et+1]=_t[bt].y,kt[Et+2]=_t[bt].z,kt[Et+3]=xt[bt].x,kt[Et+4]=xt[bt].y,kt[Et+5]=xt[bt].z;for(var Zt=0;Zt<6;++Zt)Ht[Et+3*Zt]=At.r,Ht[Et+1+3*Zt]=At.g,Ht[Et+2+3*Zt]=At.b;if(bt>0){var Xt=[wt,wt+1,wt-1,wt-2],Kt=Nt.faceidx;jt[Kt]=Xt[0],jt[Kt+1]=Xt[1],jt[Kt+2]=Xt[3],jt[Kt+3]=Xt[1],jt[Kt+4]=Xt[2],jt[Kt+5]=Xt[3],Nt.faceidx+=6}Nt.vertices+=2}}function d(gt,_t,xt,Mt,wt,Et,At){var St,bt,Ct,Nt;if(Ct=_t.length,Ct<2||_t[0].length<2)return;for(St=0;St<Ct;St++)_t[St]=tt(_t[St],Mt);if(Nt=_t[0].length,!wt)return c(gt,_t[0],_t[Ct-1],xt);var kt,Ht,jt,Zt,Xt,Kt,ar=[],or=[],_r=[];for(bt=0;bt<Ct;bt++)ar.push(.25+1.5*Math.sqrt((Ct-1)*bt-Math.pow(bt,2))/(Ct-1)),or.push(.5),_r.push(2*(Math.pow(bt/Ct,2)-bt/Ct)+.6);var nr=[];for(bt=0;bt<Ct*2-1;bt++)nr[bt]=[bt,bt+1,bt+1-2*Ct,bt-2*Ct];nr[Ct*2-1]=[bt,bt+1-2*Ct,bt+1-4*Ct,bt-2*Ct];var Vt,tr,mr,wr,Er,Sr,br,gr,xr,vr;let pr=gt.updateGeoGroup();for(St=0;St<Nt;St++){let Ot=gt.groups,zt=!1;pr=gt.updateGeoGroup(2*Ct),Ot!=gt.groups&&St>0&&(St=St-1,zt=!0),Sr=Math.round(St*(xt.length-1)/Nt),Er=g.CC.color(xt[Sr]),Xt=jt,Kt=Zt,jt=[],Zt=[],kt=[],_t[0][St].atom!==void 0&&(wr=_t[0][St].atom,At==="oval"?Ht=ar:At==="rectangle"?Ht=or:At==="parabola"&&(Ht=_r)),Ht||(Ht=or);var Tr,Cr;for(bt=0;bt<Ct;bt++)St<Nt-1?Tr=_t[bt][St+1].clone().sub(_t[bt][St]):Tr=_t[bt][St-1].clone().sub(_t[bt][St]).negate(),bt<Ct-1?Cr=_t[bt+1][St].clone().sub(_t[bt][St]):Cr=_t[bt-1][St].clone().sub(_t[bt][St]).negate(),kt[bt]=Cr.cross(Tr).normalize().multiplyScalar(wt*Ht[bt]);for(bt=0;bt<Ct;bt++)jt[bt]=_t[bt][St].clone().add(kt[bt].clone().negate());for(bt=0;bt<Ct;bt++)Zt[bt]=_t[bt][St].clone().add(kt[bt]);for(br=pr.vertexArray,gr=pr.colorArray,xr=pr.faceArray,Vt=pr.vertices,tr=Vt*3,bt=0;bt<Ct;bt++)br[tr+3*bt+0]=jt[bt].x,br[tr+3*bt+1]=jt[bt].y,br[tr+3*bt+2]=jt[bt].z;for(bt=0;bt<Ct;bt++)br[tr+3*bt+0+3*Ct]=Zt[Ct-1-bt].x,br[tr+3*bt+1+3*Ct]=Zt[Ct-1-bt].y,br[tr+3*bt+2+3*Ct]=Zt[Ct-1-bt].z;for(bt=0;bt<2*Ct;++bt)gr[tr+3*bt+0]=Er.r,gr[tr+3*bt+1]=Er.g,gr[tr+3*bt+2]=Er.b;if(St>0&&!zt){for(bt=0;bt<Ct*2;bt++)vr=[Vt+nr[bt][0],Vt+nr[bt][1],Vt+nr[bt][2],Vt+nr[bt][3]],mr=pr.faceidx,xr[mr]=vr[0],xr[mr+1]=vr[1],xr[mr+2]=vr[3],xr[mr+3]=vr[1],xr[mr+4]=vr[2],xr[mr+5]=vr[3],pr.faceidx+=6;if(wr.clickable||wr.hoverable){var Pt=[];Pt.push(new a.Triangle(Xt[0],jt[0],jt[Ct-1])),Pt.push(new a.Triangle(Xt[0],jt[Ct-1],Xt[Ct-1])),Pt.push(new a.Triangle(Xt[Ct-1],jt[Ct-1],Zt[Ct-1])),Pt.push(new a.Triangle(Xt[Ct-1],Zt[Ct-1],Kt[Ct-1])),Pt.push(new a.Triangle(Zt[0],Kt[0],Kt[Ct-1])),Pt.push(new a.Triangle(Zt[Ct-1],Zt[0],Kt[Ct-1])),Pt.push(new a.Triangle(jt[0],Xt[0],Kt[0])),Pt.push(new a.Triangle(Zt[0],jt[0],Kt[0]));for(bt in Pt)wr.intersectionShape.triangle.push(Pt[bt])}}pr.vertices+=2*Ct}for(br=pr.vertexArray,gr=pr.colorArray,xr=pr.faceArray,Vt=pr.vertices,tr=Vt*3,mr=pr.faceidx,St=0;St<Ct-1;St++)vr=[St,St+1,2*Ct-2-St,2*Ct-1-St],mr=pr.faceidx,xr[mr]=vr[0],xr[mr+1]=vr[1],xr[mr+2]=vr[3],xr[mr+3]=vr[1],xr[mr+4]=vr[2],xr[mr+5]=vr[3],pr.faceidx+=6;for(St=0;St<Ct-1;St++)vr=[Vt-1-St,Vt-2-St,Vt-2*Ct+St+1,Vt-2*Ct+St],mr=pr.faceidx,xr[mr]=vr[0],xr[mr+1]=vr[1],xr[mr+2]=vr[3],xr[mr+3]=vr[1],xr[mr+4]=vr[2],xr[mr+5]=vr[3],pr.faceidx+=6}function j(gt,_t,xt,Mt,wt,Et){if(!(_t.length<2)){var At,St;if(At=_t[0],St=_t[_t.length-1],At=tt(At,Mt),St=tt(St,Mt),!wt)return c(gt,At,St,xt);var bt=[],Ct,Nt,kt,Ht,jt,Zt=[[0,2,-6,-8],[-4,-2,6,4],[7,-1,-5,3],[-3,5,1,-7]],Xt,Kt,ar,or,_r,nr,Vt,tr,mr,wr,Er,Sr,br,gr,xr,vr,pr;for(tr=0,mr=At.length;tr<mr;tr++){if(_r=Math.round(tr*(xt.length-1)/mr),or=g.CC.color(xt[_r]),bt.push(Nt=At[tr]),bt.push(Nt),bt.push(kt=St[tr]),bt.push(kt),tr<mr-1){var Tr=At[tr+1].clone().sub(At[tr]),Cr=St[tr].clone().sub(At[tr]);Ct=Cr.cross(Tr).normalize().multiplyScalar(wt)}for(bt.push(Ht=At[tr].clone().add(Ct)),bt.push(Ht),bt.push(jt=St[tr].clone().add(Ct)),bt.push(jt),Nt.atom!==void 0&&(nr=Nt.atom),gr=gt.updateGeoGroup(8),xr=gr.vertexArray,vr=gr.colorArray,pr=gr.faceArray,Xt=gr.vertices,Kt=Xt*3,xr[Kt]=Nt.x,xr[Kt+1]=Nt.y,xr[Kt+2]=Nt.z,xr[Kt+3]=Nt.x,xr[Kt+4]=Nt.y,xr[Kt+5]=Nt.z,xr[Kt+6]=kt.x,xr[Kt+7]=kt.y,xr[Kt+8]=kt.z,xr[Kt+9]=kt.x,xr[Kt+10]=kt.y,xr[Kt+11]=kt.z,xr[Kt+12]=Ht.x,xr[Kt+13]=Ht.y,xr[Kt+14]=Ht.z,xr[Kt+15]=Ht.x,xr[Kt+16]=Ht.y,xr[Kt+17]=Ht.z,xr[Kt+18]=jt.x,xr[Kt+19]=jt.y,xr[Kt+20]=jt.z,xr[Kt+21]=jt.x,xr[Kt+22]=jt.y,xr[Kt+23]=jt.z,wr=0;wr<8;++wr)vr[Kt+3*wr]=or.r,vr[Kt+1+3*wr]=or.g,vr[Kt+2+3*wr]=or.b;if(tr>0){var Pt=Vt!==void 0&&nr!==void 0&&Vt.serial!==nr.serial;for(wr=0;wr<4;wr++){var Ot=[Xt+Zt[wr][0],Xt+Zt[wr][1],Xt+Zt[wr][2],Xt+Zt[wr][3]];if(ar=gr.faceidx,pr[ar]=Ot[0],pr[ar+1]=Ot[1],pr[ar+2]=Ot[3],pr[ar+3]=Ot[1],pr[ar+4]=Ot[2],pr[ar+5]=Ot[3],gr.faceidx+=6,nr.clickable||Vt.clickable||nr.hoverable||Vt.hoverable){var zt=bt[Ot[3]].clone(),rr=bt[Ot[0]].clone(),Jt=bt[Ot[2]].clone(),cr=bt[Ot[1]].clone();if(zt.atom=bt[Ot[3]].atom||null,Jt.atom=bt[Ot[2]].atom||null,rr.atom=bt[Ot[0]].atom||null,cr.atom=bt[Ot[1]].atom||null,Pt){var dr=zt.clone().add(rr).multiplyScalar(.5),Dt=Jt.clone().add(cr).multiplyScalar(.5),Gt=zt.clone().add(cr).multiplyScalar(.5);wr%2===0?((Vt.clickable||Vt.hoverable)&&(Er=new a.Triangle(dr,Gt,zt),Sr=new a.Triangle(Dt,Jt,Gt),br=new a.Triangle(Gt,Jt,zt),Vt.intersectionShape.triangle.push(Er),Vt.intersectionShape.triangle.push(Sr),Vt.intersectionShape.triangle.push(br)),(nr.clickable||nr.hoverable)&&(Er=new a.Triangle(rr,cr,Gt),Sr=new a.Triangle(cr,Dt,Gt),br=new a.Triangle(rr,Gt,dr),nr.intersectionShape.triangle.push(Er),nr.intersectionShape.triangle.push(Sr),nr.intersectionShape.triangle.push(br))):((nr.clickable||nr.hoverable)&&(Er=new a.Triangle(dr,Gt,zt),Sr=new a.Triangle(Dt,Jt,Gt),br=new a.Triangle(Gt,Jt,zt),nr.intersectionShape.triangle.push(Er),nr.intersectionShape.triangle.push(Sr),nr.intersectionShape.triangle.push(br)),(Vt.clickable||Vt.hoverable)&&(Er=new a.Triangle(rr,cr,Gt),Sr=new a.Triangle(cr,Dt,Gt),br=new a.Triangle(rr,Gt,dr),Vt.intersectionShape.triangle.push(Er),Vt.intersectionShape.triangle.push(Sr),Vt.intersectionShape.triangle.push(br)))}else(nr.clickable||nr.hoverable)&&(Er=new a.Triangle(rr,cr,zt),Sr=new a.Triangle(cr,Jt,zt),nr.intersectionShape.triangle.push(Er),nr.intersectionShape.triangle.push(Sr))}}}gr.vertices+=8,Vt=nr}var er=bt.length-8;for(gr=gt.updateGeoGroup(8),xr=gr.vertexArray,vr=gr.colorArray,pr=gr.faceArray,Xt=gr.vertices,Kt=Xt*3,ar=gr.faceidx,tr=0;tr<4;tr++){bt.push(bt[tr*2]),bt.push(bt[er+tr*2]);var fr=bt[tr*2],Ut=bt[er+tr*2];xr[Kt+6*tr]=fr.x,xr[Kt+1+6*tr]=fr.y,xr[Kt+2+6*tr]=fr.z,xr[Kt+3+6*tr]=Ut.x,xr[Kt+4+6*tr]=Ut.y,xr[Kt+5+6*tr]=Ut.z,vr[Kt+6*tr]=or.r,vr[Kt+1+6*tr]=or.g,vr[Kt+2+6*tr]=or.b,vr[Kt+3+6*tr]=or.r,vr[Kt+4+6*tr]=or.g,vr[Kt+5+6*tr]=or.b}er+=8,Er=[Xt,Xt+2,Xt+6,Xt+4],Sr=[Xt+1,Xt+5,Xt+7,Xt+3],pr[ar]=Er[0],pr[ar+1]=Er[1],pr[ar+2]=Er[3],pr[ar+3]=Er[1],pr[ar+4]=Er[2],pr[ar+5]=Er[3],pr[ar+6]=Sr[0],pr[ar+7]=Sr[1],pr[ar+8]=Sr[3],pr[ar+9]=Sr[1],pr[ar+10]=Sr[2],pr[ar+11]=Sr[3],gr.faceidx+=12,gr.vertices+=8}}function et(gt,_t,xt,Mt,wt,Et,At){(!At||At==="default")&&(At="rectangle"),At==="edged"?j(gt,_t,xt,Mt,wt):(At==="rectangle"||At==="oval"||At==="parabola")&&d(gt,_t,xt,Mt,wt,Et,At)}function nt(gt){return gt&&gt.elem==="C"&&gt.atom==="CA"}function ut(gt,_t){if(gt&&_t&&gt.chain===_t.chain){if(!gt.hetflag&&!_t.hetflag&&gt.reschain===_t.reschain&&(gt.resi===_t.resi||gt.resi===_t.resi-1))return!0;if(gt.resi<_t.resi){var xt=gt.x-_t.x,Mt=gt.y-_t.y,wt=gt.z-_t.z,Et=xt*xt+Mt*Mt+wt*wt;if(gt.atom=="CA"&&_t.atom=="CA"&&Et<16)return!0;if((gt.atom=="P"||_t.atom=="P")&&Et<64)return!0}}return!1}function b(gt,_t,xt,Mt,wt){if(!(_t==null||_t.vertices==0)){wt&&(_t.initTypedArrays(),_t.setUpNormals());var Et=new h.MeshDoubleLambertMaterial;Et.vertexColors=h.Coloring.FaceColors,typeof xt=="number"&&xt>=0&&xt<1&&(Et.transparent=!0,Et.opacity=xt),Et.outline=Mt;var At=new h.Mesh(_t,Et);gt.add(At)}}function it(gt,_t,xt,Mt,wt,Et,At,St,bt){var Ct,Nt,kt,Ht,jt,Zt;if(!(!Mt||!wt||!At)){var Xt=wt.sub(Mt);Xt.normalize();var Kt=St[bt];for(Nt=bt+1;Nt<St.length&&(Kt=St[Nt],Kt.atom!=At.atom);Nt++);if(Kt=Kt?new o.Vector3(Kt.x,Kt.y,Kt.z):new o.Vector3(0,0,0),Kt.sub(Mt),At.ss==="arrow start"){var ar=Kt.clone().multiplyScalar(.3).cross(wt);Mt.add(ar);var or=Kt.clone().cross(Xt).normalize();Xt.rotateAboutVector(or,.43)}for(At.style.cartoon.ribbon?Ct=At.style.cartoon.thickness||ct:At.style.cartoon.width?Ct=At.style.cartoon.width:At.ss==="c"?At.atom==="P"?Ct=lt:Ct=at:At.ss==="arrow start"?(Ct=ot,jt=!0):At.ss==="arrow end"||At.ss==="h"&&At.style.cartoon.tubes||At.ss==="tube start"?Ct=at:Ct=ot,Et!=null&&Xt.dot(Et)<0&&Xt.negate(),Xt.multiplyScalar(Ct),Nt=0;Nt<_t;Nt++)kt=-1+Nt*2/(_t-1),Ht=new o.Vector3(Mt.x+kt*Xt.x,Mt.y+kt*Xt.y,Mt.z+kt*Xt.z),Ht.atom=At,At.ss==="s"&&(Ht.smoothen=!0),gt[Nt].push(Ht);if(jt)for(Xt.multiplyScalar(2),Nt=0;Nt<_t;Nt++)kt=-1+Nt*2/(_t-1),Ht=new o.Vector3(Mt.x+kt*Xt.x,Mt.y+kt*Xt.y,Mt.z+kt*Xt.z),Ht.atom=At,Ht.smoothen=!1,Ht.skip=!0,gt[Nt].push(Ht);return Zt=At.style.cartoon.style||"default",gt.style?gt.style!=Zt&&(console.log("Warning: a cartoon chain's strand-style is ambiguous"),gt.style="default"):gt.style=Zt,(At.ss==="arrow start"||At.ss==="arrow end")&&(At.ss="s"),jt}}const rt={C:!0,CA:!0,O:!0,P:!0,OP2:!0,O2P:!0,"O5'":!0,"O3'":!0,"C5'":!0,"C2'":!0,"O5*":!0,"O3*":!0,"C5*":!0,"C2*":!0,N1:!0,N3:!0},dt={DA:!0,DG:!0,A:!0,G:!0},ft={DT:!0,DC:!0,U:!0,C:!0,T:!0},mt={DA:!0,DG:!0,A:!0,G:!0,DT:!0,DC:!0,U:!0,C:!0,T:!0};function yt(gt,_t,xt,Mt=10){let wt=Mt,Et=Mt;var At,St,bt,Ct,Nt,kt,Ht,jt,Zt,Xt,Kt,ar,or,_r,nr,Vt,tr,mr,wr=new h.Geometry(!0),Er=new h.Geometry(!0),Sr=[],br=[],gr=1,xr=!1,vr={};for(var pr in _.Gradient.builtinGradients)_.Gradient.builtinGradients.hasOwnProperty(pr)&&(vr[pr]=new _.Gradient.builtinGradients[pr](xt[1],xt[0]));var Tr=function(yr,vt){return xt&&vt.color==="spectrum"?vt.colorscheme in vr?vr[vt.colorscheme].valueToHex(yr.resi):vr.sinebow.valueToHex(yr.resi):(0,st.getColorFromStyle)(yr,vt).getHex()};for(jt=0;jt<wt;jt++)br[jt]=[];var Cr=!1,Pt=!1,Ot=[];for(jt in _t){if(Ct=_t[jt],Ct.elem==="C"&&Ct.atom==="CA"){var zt=ut(bt,Ct);zt&&Ct.ss==="s"?Cr=!0:Cr&&(bt&&St&&bt.style.cartoon.arrows&&St.style.cartoon.arrows&&(bt.ss="arrow end",St.ss="arrow start"),Cr=!1),zt&&(bt.ss==="h"||bt.ss=="tube start")&&bt.style.cartoon.tubes?!Pt&&bt.ss!="tube start"&&Ct.style.cartoon.tubes&&(Ct.ss="tube start",Pt=!0):Pt&&(bt.ss==="tube start"?bt.ss="tube end":St&&St.style.cartoon.tubes&&(St.ss="tube end"),Pt=!1),St=bt,bt=Ct}Ct&&Ct.atom in rt&&Ot.push(Ct)}Pt&&bt.style.cartoon.tubes&&(bt.ss="tube end",Pt=!1);var rr=function(yr){br[0].length>0&&et(Er,br,Sr,Et,Ht,gr,br.style);var vt=[],Qt=null;if(yr){for(jt=0;jt<wt;jt++)vt[jt]=br[jt][br[jt].length-1];Qt=Sr[Sr.length-1]}for(br=[],jt=0;jt<wt;jt++)br[jt]=[];if(Sr=[],yr){for(jt=0;jt<wt;jt++)br[jt].push(vt[jt]);Sr.push(Qt)}b(gt,Er,gr,xr,!0),b(gt,wr,gr,xr,!1),Er=new h.Geometry(!0),wr=new h.Geometry(!0)};bt=void 0;let Jt=[];for(var cr=0;cr<Ot.length;cr++){Ct=Ot[cr];var dr=Ct.resn.trim(),Dt=dr in mt;if(gr=1,At=Ct.style.cartoon,bt&&bt.style.cartoon&&(gr=bt.style.cartoon.opacity),bt&&bt.style.cartoon&&bt.style.cartoon.outline&&(xr=bt.style.cartoon.outline),bt&&bt.style.cartoon&&(!Ct.style.cartoon||bt.style.cartoon.opacity!=Ct.style.cartoon.opacity)&&rr(bt.chain==Ct.chain),bt&&Ct&&!ut(bt,Ct)&&bt.chain&&bt.chain==Ct.chain&&!bt.hetflag&&!Ct.hetflag&&bt.reschain+1==Ct.reschain&&Jt.push([bt,Ct]),At.style==="trace"){if(!Ct.hetflag){if(Ct.elem==="C"&&Ct.atom==="CA"||Dt&&Ct.atom==="P"||Ct.atom==="BB"){if(kt=Tr(Ct,At),(0,st.isNumeric)(At.thickness)?Ht=At.thickness:Ht=ct,ut(bt,Ct))if(kt==Nt){var Gt=g.CC.color(kt);_e.GLDraw.drawCylinder(wr,bt,Ct,Ht,Gt,2,2)}else{var er=new o.Vector3().addVectors(bt,Ct).multiplyScalar(.5),fr=g.CC.color(Nt),Ut=g.CC.color(kt);_e.GLDraw.drawCylinder(wr,bt,er,Ht,fr,2,0),_e.GLDraw.drawCylinder(wr,er,Ct,Ht,Ut,0,2)}if((Ct.clickable===!0||Ct.hoverable)&&Ct.intersectionShape!==void 0){var sr=new o.Vector3(Ct.x,Ct.y,Ct.z);Ct.intersectionShape.sphere.push(new a.Sphere(sr,Ht))}bt=Ct,Nt=kt}}}else{if(nt(Ct)||Dt&&(Ct.atom==="P"||Ct.atom.indexOf("O5")==0)){if(mr)if(Ct.ss==="tube end")mr=!1,tr=new o.Vector3(Ct.x,Ct.y,Ct.z),_e.GLDraw.drawCylinder(wr,Vt,tr,2,g.CC.color(Nt),1,1),Ct.ss="h";else if(bt.chain!=Ct.chain||bt.ss==="tube end")mr=!1,bt.ss="h",tr=new o.Vector3(bt.x,bt.y,bt.z),_e.GLDraw.drawCylinder(wr,Vt,tr,2,g.CC.color(Nt),1,1);else continue;if(bt&&(!ut(bt,Ct)||bt.ss==="tube start")){for(bt.ss==="tube start"&&(mr=!0,Vt=new o.Vector3(bt.x,bt.y,bt.z),bt.ss="h"),nr&&(ar?_r=new o.Vector3().addVectors(bt,ar).multiplyScalar(.5):_r=new o.Vector3(bt.x,bt.y,bt.z),_e.GLDraw.drawCylinder(wr,_r,nr,$,g.CC.color(nr.color),0,2),it(br,wt,!0,ar,or,Kt,bt,Ot,cr),Sr.push(kt),_r=null,nr=null),br[0].length>0&&et(Er,br,Sr,Et,Ht,gr,br.style),br=[],jt=0;jt<wt;jt++)br[jt]=[];Sr=[]}if(bt===void 0||bt.rescode!=Ct.rescode||bt.resi!=Ct.resi){if(nr&&bt!=null){_r=new o.Vector3().addVectors(bt,Ct).multiplyScalar(.5);var Lt=_r.clone().sub(nr).multiplyScalar(.02);_r.add(Lt),_e.GLDraw.drawCylinder(wr,_r,nr,$,g.CC.color(nr.color),0,2),_r=null,nr=null}kt=Tr(Ct,At),Sr.push(kt),(0,st.isNumeric)(At.thickness)?Ht=At.thickness:Ht=ct,bt=Ct,Zt=new o.Vector3(bt.x,bt.y,bt.z),Zt.resi=bt.resi,Nt=kt}(Ct.clickable===!0||Ct.hoverable===!0)&&(Ct.intersectionShape===void 0||Ct.intersectionShape.triangle===void 0)&&(Ct.intersectionShape={sphere:null,cylinder:[],line:[],triangle:[]})}else bt!=null&&(nt(bt)&&Ct.atom==="O"||Dt&&bt.atom==="P"&&(Ct.atom==="OP2"||Ct.atom==="O2P")||Dt&&bt.atom.indexOf("O5")==0&&Ct.atom.indexOf("C5")==0)?(Xt=new o.Vector3(Ct.x,Ct.y,Ct.z),Xt.resi=Ct.resi,(Ct.atom==="OP2"||Ct.atom==="O2P")&&(or=new o.Vector3(Ct.x,Ct.y,Ct.z))):Dt&&Ct.atom.indexOf("O3")==0?ar=new o.Vector3(Ct.x,Ct.y,Ct.z):(Ct.atom==="N1"&&dr in dt||Ct.atom==="N3"&&dr in ft)&&(nr=new o.Vector3(Ct.x,Ct.y,Ct.z),nr.color=(0,st.getColorFromStyle)(Ct,At).getHex());Xt&&Zt&&Xt.resi===Zt.resi&&(it(br,wt,!0,Zt,Xt,Kt,bt,Ot,cr),Kt=Xt,Zt=null,Xt=null,Sr.push(kt))}}nr&&(ar?_r=new o.Vector3().addVectors(bt,ar).multiplyScalar(.5):_r=new o.Vector3(bt.x,bt.y,bt.z),_e.GLDraw.drawCylinder(wr,_r,nr,$,g.CC.color(nr.color),0,2),it(br,wt,!0,ar,or,Kt,bt,Ot,cr),Sr.push(kt)),rr(!1);var hr=function(yr,vt){if(yr.style.cartoon.gapcutoff&&yr.style.cartoon.gapcutoff==vt.style.cartoon.gapcutoff){let Yt=yr.style.cartoon.gapcutoff,Rt=vt.resi-yr.resi;if(Rt>0&&Rt<Yt){let Wt=.25,ir=vt.x-yr.x,Lr=vt.y-yr.y,Dr=vt.z-yr.z,Mr=Math.sqrt(ir*ir+Lr*Lr+Dr*Dr),kr=Mr/(2*Rt),nn=new o.Vector3(yr.x,yr.y,yr.z),Vr=Mr/kr,Ir=new o.Vector3((vt.x-yr.x)/Vr,(vt.y-yr.y)/Vr,(vt.z-yr.z)/Vr);nn.add({x:Ir.x/2,y:Ir.y/2,z:Ir.z/2});let zr=nn.clone().add(Ir);Ir.multiplyScalar(2);let Kr=(0,st.extend)({},yr);for(var Qt=0;Qt<Rt;Qt++){Kr.resi+=1;let Gr=Tr(Kr,Kr.style.cartoon);_e.GLDraw.drawCylinder(wr,nn,zr,Wt,g.CC.color(Gr),_e.CAP.FLAT,_e.CAP.FLAT),nn.add(Ir),zr.add(Ir)}rr(!1)}}};for(let yr of Jt)hr(yr[0],yr[1])}},"./src/index.ts"(e,i,s){s.r(i),s.d(i,{CAP:()=>o.CAP,CC:()=>o.CC,CONTEXTS_PER_VIEWPORT:()=>o.CONTEXTS_PER_VIEWPORT,Color:()=>o.Color,CustomLinear:()=>o.CustomLinear,Cylinder:()=>o.Cylinder,GLDraw:()=>o.GLDraw,GLModel:()=>o.GLModel,GLShape:()=>o.GLShape,GLViewer:()=>o.GLViewer,GLVolumetricRender:()=>o.GLVolumetricRender,Gradient:()=>o.Gradient,GradientType:()=>o.GradientType,Label:()=>o.Label,LabelCount:()=>o.LabelCount,MarchingCube:()=>o.MarchingCube,MarchingCubeInitializer:()=>o.MarchingCubeInitializer,Matrix3:()=>o.Matrix3,Matrix4:()=>o.Matrix4,Parsers:()=>o.Parsers,PausableTimer:()=>o.PausableTimer,PointGrid:()=>o.PointGrid,ProteinSurface:()=>o.ProteinSurface,Quaternion:()=>o.Quaternion,ROYGB:()=>o.ROYGB,RWB:()=>o.RWB,Ray:()=>o.Ray,Sinebow:()=>o.Sinebow,Sphere:()=>o.Sphere,SurfaceType:()=>o.SurfaceType,Triangle:()=>o.Triangle,Vector2:()=>o.Vector2,Vector3:()=>o.Vector3,VolumeData:()=>o.VolumeData,adjustVolumeStyle:()=>o.adjustVolumeStyle,applyPartialCharges:()=>o.applyPartialCharges,autoinit:()=>o.autoinit,autoload:()=>o.autoload,base64ToArray:()=>o.base64ToArray,bondLength:()=>o.bondLength,builtinColorSchemes:()=>o.builtinColorSchemes,builtinGradients:()=>o.builtinGradients,chains:()=>o.chains,clamp:()=>o.clamp,conversionMatrix3:()=>o.conversionMatrix3,createStereoViewer:()=>o.createStereoViewer,createViewer:()=>o.createViewer,createViewerGrid:()=>o.createViewerGrid,deepCopy:()=>o.deepCopy,degToRad:()=>o.degToRad,download:()=>o.download,drawCartoon:()=>o.drawCartoon,elementColors:()=>o.elementColors,extend:()=>o.extend,get:()=>o.get,getAtomProperty:()=>o.getAtomProperty,getColorFromStyle:()=>o.getColorFromStyle,getElement:()=>o.getElement,getExtent:()=>o.getExtent,getGradient:()=>o.getGradient,getPropertyRange:()=>o.getPropertyRange,getbin:()=>o.getbin,htmlColors:()=>o.htmlColors,inflateString:()=>o.inflateString,isEmptyObject:()=>o.isEmptyObject,isNumeric:()=>o.isNumeric,makeFunction:()=>o.makeFunction,mergeGeos:()=>o.mergeGeos,normalizeValue:()=>o.normalizeValue,partialCharges:()=>o.partialCharges,processing_autoinit:()=>o.processing_autoinit,residues:()=>o.residues,setBondLength:()=>o.setBondLength,setSyncSurface:()=>o.setSyncSurface,specStringToObject:()=>o.specStringToObject,splitMesh:()=>o.splitMesh,ssColors:()=>o.ssColors,subdivide_spline:()=>o.subdivide_spline,syncSurface:()=>o.syncSurface,viewers:()=>o.viewers});var o=s("./src/3Dmol.ts");window&&(window.$3Dmol=i)},"./src/parsers/BCIF.ts"(e,i,s){s.r(i),s.d(i,{BCIF:()=>ct});var o=s("./src/utilities.ts"),a=s("./src/parsers/utils/computeSecondaryStructure.ts"),h=s("./src/parsers/utils/processSymmetries.ts"),_=s("./src/parsers/cifutils/category.ts"),g=s("./src/parsers/utils/assignPDBBonds.ts"),_e=s("./src/WebGL/index.ts"),st=s("./src/parsers/utils/isEmpty.ts"),tt=s("./src/vendor/mmtf.js");class at{constructor(c){if(this.C={},c){let d=c.getField("comp_id"),j=c.getField("atom_id_1"),et=c.getField("atom_id_2"),nt=c.getField("value_order");for(let ut=0;ut<d.length;ut++){let b=d[ut],it=j[ut],rt=et[ut],dt=nt[ut],ft=1;dt=="doub"?ft=2:dt=="trip"&&(ft=3),this.C[b]==null&&(this.C[b]={}),this.C[b][it]==null&&(this.C[b][it]={}),this.C[b][rt]==null&&(this.C[b][rt]={}),this.C[b][it][rt]=ft,this.C[b][rt][it]=ft}}}order(c,d,j){return this.C[c]!==void 0&&this.C[c][d]!==void 0&&this.C[c][d][j]!==void 0?this.C[c][d][j]:0}}class ot{constructor(c){if(this.C=[],c){let d=c.getField("conn_type_id"),j=c.getField("ptnr1_label_asym_id"),et=c.getField("ptnr1_label_seq_id"),nt=c.getField("ptnr1_label_comp_id"),ut=c.getField("ptnr1_label_atom_id"),b=c.getField("ptnr2_label_asym_id"),it=c.getField("ptnr2_label_seq_id"),rt=c.getField("ptnr2_label_comp_id"),dt=c.getField("ptnr2_label_atom_id"),ft=c.getField("pdbx_value_order");for(let mt=0;mt<d.length;mt++)if(d[mt]=="disulf"||d[mt]=="covale"){let yt=ft?ft[mt]==""?1:parseInt(ft[mt]):1;this.C.push([[j[mt],et[mt],nt[mt],ut[mt]],[b[mt],it[mt],rt[mt],dt[mt]],yt])}}}}class lt{constructor(){this.R={}}add(c){this.R[c.lchain]==null&&(this.R[c.lchain]={}),this.R[c.lchain][c.lresi]==null&&(this.R[c.lchain][c.lresi]={}),this.R[c.lchain][c.lresi][c.lresn]==null&&(this.R[c.lchain][c.lresi][c.lresn]=[]),this.R[c.lchain][c.lresi][c.lresn].push(c),this.R[c.lchain][c.lresi][c.lresn][c.atom]=c}geta([c,d,j,et]){if(this.R[c]!==void 0&&this.R[c][d]!==void 0&&this.R[c][d][j]!==void 0)return this.R[c][d][j][et]}setBonds(c,d){for(let j in this.R)for(let et in this.R[j])for(let nt in this.R[j][et]){let ut=this.R[j][et][nt];for(let b=0;b<ut.length;b++)for(let it=b+1;it<ut.length;it++){let rt=ut[b],dt=ut[it],ft=c.order(nt,rt.atom,dt.atom);rt.altLoc!=dt.altLoc&&rt.altLoc!=""&&dt.altLoc!=""&&(ft=0),ft>0&&(rt.bonds.push(dt.index),dt.bonds.push(rt.index),rt.bondOrder.push(ft),dt.bondOrder.push(ft))}}for(let j of d.C){let et=j[0],nt=j[1],ut=j[2],b=this.geta(et),it=this.geta(nt);b!=null&&it!=null&&(b.bonds.push(it.index),it.bonds.push(b.index),b.bondOrder.push(ut),it.bondOrder.push(ut))}}}function ct($,c){var d=!c.keepH,j=c.altLoc?c.altLoc:"A",et=!c.noComputeSecondaryStructure;const nt=!c.doAssembly,ut=c.assignBonds===void 0?!0:c.assignBonds;if(typeof $=="string")try{$=(0,o.base64ToArray)($)}catch{$=new TextEncoder().encode($)}else $=new Uint8Array($);var b=tt.decodeMsgpack($);b==31&&($=(0,o.inflateString)($,!1),b=tt.decodeMsgpack($));var it=[],rt=it.modelData=[],dt=b.dataBlocks.length;if(dt==0)return it;c.multimodel||(dt=1);for(let ft=0;ft<dt;ft++){let mt=it.length;const yt=[];rt.push({symmetries:[]}),it.push([]);const gt=b.dataBlocks[ft],_t=Object.create(null);for(const vr of gt.categories)_t[vr.name.substr(1)]=(0,_.Category)(vr);let xt={},Mt=_t.struct_conf;if(Mt){let vr=Mt.getField("conf_type_id"),pr=Mt.getField("beg_label_asym_id"),Tr=Mt.getField("beg_label_seq_id"),Cr=Mt.getField("end_label_seq_id");for(let Pt=0;Pt<vr.length;Pt++)if(vr[Pt].startsWith("H")){let Ot=pr[Pt],zt=Tr[Pt],rr=Cr[Pt];Ot in xt||(xt[Ot]={}),xt[Ot][zt]="h1";for(let Jt=zt+1;Jt<rr;Jt++)xt[Ot][Jt]="h";xt[Ot][rr]="h2"}}let wt=_t.struct_sheet_range;if(wt){let vr=wt.getField("id"),pr=wt.getField("beg_label_asym_id"),Tr=wt.getField("beg_label_seq_id"),Cr=wt.getField("end_label_seq_id");for(let Pt=0;Pt<vr.length;Pt++){let Ot=pr[Pt],zt=Tr[Pt],rr=Cr[Pt];Ot in xt||(xt[Ot]={}),xt[Ot][zt]="s1";for(let Jt=zt+1;Jt<rr;Jt++)xt[Ot][Jt]="s";xt[Ot][rr]="s2"}}let Et=_t.pdbx_struct_oper_list,At=Et.getField("id");if(At&&!nt){let vr=Et.getField("matrix[1][1]"),pr=Et.getField("matrix[1][2]"),Tr=Et.getField("matrix[1][3]"),Cr=Et.getField("matrix[2][1]"),Pt=Et.getField("matrix[2][2]"),Ot=Et.getField("matrix[2][3]"),zt=Et.getField("matrix[3][1]"),rr=Et.getField("matrix[3][2]"),Jt=Et.getField("matrix[3][3]"),cr=Et.getField("vector[1]"),dr=Et.getField("vector[2]"),Dt=Et.getField("vector[3]");for(let Gt=0;Gt<At.length;Gt++){const er=new _e.Matrix4(vr[Gt],pr[Gt],Tr[Gt],cr[Gt],Cr[Gt],Pt[Gt],Ot[Gt],dr[Gt],zt[Gt],rr[Gt],Jt[Gt],Dt[Gt]);rt[rt.length-1].symmetries.push(er)}}let St=new at(_t.chem_comp_bond),bt=new lt,Ct=new ot(_t.struct_conn),Nt=_t.atom_site,kt=Nt.rowCount,Ht=Nt.getField("group_PDB"),jt=Nt.getField("Cartn_x"),Zt=Nt.getField("Cartn_y"),Xt=Nt.getField("Cartn_z"),Kt=Nt.getField("auth_asym_id"),ar=Nt.getField("label_asym_id"),or=Nt.getField("auth_seq_id"),_r=Nt.getField("label_seq_id"),nr=Nt.getField("auth_comp_id"),Vt=Nt.getField("label_comp_id"),tr=Nt.getField("auth_atom_id"),mr=Nt.getField("label_atom_id"),wr=Nt.getField("type_symbol"),Er=Nt.getField("B_iso_or_equiv"),Sr=Nt.getField("id"),br=Nt.getField("label_alt_id"),gr=Nt.getField("pdbx_PDB_model_num"),xr=gr?gr[0]:0;for(let vr=0;vr<kt;vr++){if(Ht!==void 0&&Ht[vr]==="TER")continue;if(gr&&gr[vr]!=xr)if(xr=gr[vr],c.multimodel)c.onemol||(it.push([]),rt.push(rt[rt.length-1]),xr=gr[vr],bt.setBonds(St,Ct),bt=new lt);else break;const pr={};pr.x=jt[vr],pr.y=Zt[vr],pr.z=Xt[vr],pr.chain=Kt?Kt[vr]:ar?ar[vr]:void 0,pr.lchain=ar?ar[vr]:void 0,pr.resi=or?or[vr]:_r?_r[vr]:void 0,pr.lresi=_r?_r[vr]:void 0,pr.resn=nr?nr[vr].trim():Vt?Vt[vr].trim():void 0,pr.lresn=Vt?Vt[vr].trim():void 0,pr.atom=tr?tr[vr].replace(/"/gm,""):mr?mr[vr].replace(/"/gm,""):void 0,pr.icode=br?br[vr]:void 0,pr.altLoc=pr.icode,pr.hetflag=!Ht||Ht[vr]==="HETA"||Ht[vr]==="HETATM";let Tr="X";wr&&(Tr=wr[vr].replace(/\(?\+?\d+.*/,"")),pr.elem=Tr[0].toUpperCase()+Tr.substring(1,2).toLowerCase(),Er&&(pr.b=Er[vr]),!(d&&pr.elem=="H")&&(pr.altLoc!=""&&pr.altLoc!=j&&j!="*"||(pr.bonds=[],pr.ss="c",pr.serial=Sr[vr],pr.model=xr,pr.bondOrder=[],pr.properties={},pr.index=it[it.length-1].length,yt[pr.serial]=[it.length,pr.index],it[it.length-1].push(pr),bt.add(pr)))}if(bt.setBonds(St,Ct),!(0,st.isEmpty)(xt))for(let vr=mt;vr<it.length;vr++){let pr=it[vr];for(let Tr=0;Tr<pr.length;Tr++){const Cr=pr[Tr];if(Cr!==void 0&&Cr.lchain in xt&&Cr.lresi in xt[Cr.lchain]){const Pt=xt[Cr.lchain][Cr.lresi];Cr.ss=Pt[0],Pt.length>1&&(Pt[1]=="1"?Cr.ssbegin=!0:Pt[1]=="2"&&(Cr.ssend=!0))}}}c.multimodel&&ft<dt-1&&(c.onemol||(it.push([]),rt.push({symmetries:[]})))}for(let ft=0;ft<it.length;ft++)ut&&!(c.duplicateAssemblyAtoms&&!c.dontConnectDuplicatedAtoms)&&(0,g.assignPDBBonds)(it[ft],c),et&&(0,a.computeSecondaryStructure)(it[ft],c.hbondCutoff),(0,h.processSymmetries)(rt[ft].symmetries,it[ft],c,rt[ft].cryst),c.duplicateAssemblyAtoms&&!c.dontConnectDuplicatedAtoms&&ut&&(0,g.assignPDBBonds)(it[ft],c);return it}},"./src/parsers/CDJSON.ts"(e,i,s){s.r(i),s.d(i,{CDJSON:()=>o});function o(a,h){var _=[[]];typeof a=="string"&&(a=JSON.parse(a));for(var g=a.m,_e=g[0].a,st=g[0].b,tt=g[0].s,at=h!==void 0&&h.parseStyle!==void 0?h.parseStyle:tt!==void 0,ot=_[_.length-1].length,lt=0;lt<_e.length;lt++){var ct=_e[lt],$={};$.id=ct.i,$.x=ct.x,$.y=ct.y,$.z=ct.z||0,$.bonds=[],$.bondOrder=[];var c=ct.l||"C";$.elem=c[0].toUpperCase()+c.substring(1).toLowerCase(),$.serial=_[_.length-1].length,at&&($.style=tt[ct.s||0]),_[_.length-1].push($)}for(let d=0;d<st.length;d++){let j=st[d],et=j.b+ot,nt=j.e+ot,ut=j.o||1,b=_[_.length-1][et],it=_[_.length-1][nt];b.bonds.push(nt),b.bondOrder.push(ut),it.bonds.push(et),it.bondOrder.push(ut)}return _}},"./src/parsers/CIF.ts"(e,i,s){s.r(i),s.d(i,{CIF:()=>_e});var o=s("./src/parsers/utils/computeSecondaryStructure.ts"),a=s("./src/parsers/utils/processSymmetries.ts"),h=s("./src/WebGL/index.ts"),_=s("./src/parsers/utils/assignPDBBonds.ts");const g=function(st,tt,at,ot){return new h.Vector3(tt,at,ot).applyMatrix3(st)};function _e(st,tt={}){const at=[],ot=!tt.doAssembly,lt=at.modelData=[],ct=tt.assignBonds===void 0?!0:tt.assignBonds;function $(ut,b){const it=[];let rt=0,dt=0;for(;dt<ut.length;){for(;ut.substring(dt,dt+b.length)!==b&&dt<ut.length;)if(ut[dt]==="'"){for(dt++;dt<ut.length&&ut[dt]!=="'";)dt++;for(;ut.substring(dt,dt+b.length)!==b&&dt<ut.length;)dt++}else if(ut[dt]==='"'){for(dt++;dt<ut.length&&ut[dt]!=='"';)dt++;dt++}else dt++;it.push(ut.substring(rt,dt)),rt=dt=dt+b.length}return it}const c=st.split(/\r?\n|\r/),d=[];let j=!1;for(let ut=0;ut<c.length;ut++){var et=c[ut].split("#")[0];if(j?et[0]===";"&&(j=!1):et[0]===";"&&(j=!0),j||et!==""){if(!j&&(et=et.trim(),et[0]==="_")){const b=et.split(/\s/)[0].indexOf(".");if(b>-1){let it=et.split("");it[b]="_",et=it.join(""),et=et.substring(0,b)+"_"+et.substring(b+1)}}d.push(et)}}let nt=0;for(;nt<d.length;){for(;!d[nt].startsWith("data_")||d[nt]==="data_global";)nt++;nt++;const ut={};for(;nt<d.length&&!d[nt].startsWith("data_");)if(d[nt][0]===void 0)nt++;else if(d[nt][0]==="_"){const dt=d[nt].split(/\s/)[0].toLowerCase(),ft=ut[dt]=ut[dt]||[],mt=d[nt].substring(d[nt].indexOf(dt)+dt.length);if(mt==="")if(nt++,d[nt][0]===";"){let yt=d[nt].substring(1);for(nt++;d[nt]!==";";)yt=yt+`
`+d[nt],nt++;ft.push(yt)}else ft.push(d[nt]);else ft.push(mt.trim());nt++}else if(d[nt].substring(0,5)==="loop_"){nt++;const dt=[];for(;d[nt]===""||d[nt][0]==="_";){if(d[nt]!==""){let mt=d[nt].split(/\s/)[0].toLowerCase(),yt=ut[mt]=ut[mt]||[];dt.push(yt)}nt++}let ft=0;for(;nt<d.length&&d[nt][0]!=="_"&&!d[nt].startsWith("loop_")&&!d[nt].startsWith("data_");){let mt=$(d[nt]," ");for(let yt=0;yt<mt.length;yt++)mt[yt]!==""&&(dt[ft].push(mt[yt]),ft=(ft+1)%dt.length);nt++}}else nt++;lt.push({symmetries:[]}),at.push([]);const b=ut._atom_site_id!==void 0?ut._atom_site_id.length:ut._atom_site_label.length;let it;if(ut._cell_length_a!==void 0){const dt=parseFloat(ut._cell_length_a),ft=parseFloat(ut._cell_length_b),mt=parseFloat(ut._cell_length_c),yt=parseFloat(ut._cell_angle_alpha)||90,gt=parseFloat(ut._cell_angle_beta)||90,_t=parseFloat(ut._cell_angle_gamma)||90;it=(0,h.conversionMatrix3)(dt,ft,mt,yt,gt,_t),lt[lt.length-1].cryst={a:dt,b:ft,c:mt,alpha:yt,beta:gt,gamma:_t}}for(let dt=0;dt<b;dt++){if(ut._atom_site_group_pdb!==void 0&&ut._atom_site_group_pdb[dt]==="TER")continue;const ft={};if(ut._atom_site_cartn_x!==void 0)ft.x=parseFloat(ut._atom_site_cartn_x[dt]),ft.y=parseFloat(ut._atom_site_cartn_y[dt]),ft.z=parseFloat(ut._atom_site_cartn_z[dt]);else{const yt=g(it,parseFloat(ut._atom_site_fract_x[dt]),parseFloat(ut._atom_site_fract_y[dt]),parseFloat(ut._atom_site_fract_z[dt]));ft.x=yt.x,ft.y=yt.y,ft.z=yt.z}ft.chain=ut._atom_site_auth_asym_id?ut._atom_site_auth_asym_id[dt]:ut._atom_site_label_asym_id?ut._atom_site_label_asym_id[dt]:void 0,ft.lchain=ut._atom_site_label_asym_id?ut._atom_site_label_asym_id[dt]:void 0,ft.resi=ut._atom_site_auth_seq_id?parseInt(ut._atom_site_auth_seq_id[dt]):ut._atom_site_label_seq_id?ut._atom_site_label_seq_id[dt]:void 0,ft.resn=ut._atom_site_auth_comp_id?ut._atom_site_auth_comp_id[dt].trim():ut._atom_site_label_comp_id?ut._atom_site_label_comp_id[dt].trim():void 0,ft.atom=ut._atom_site_auth_atom_id?ut._atom_site_auth_atom_id[dt].replace(/"/gm,""):ut._atom_site_label_atom_id?ut._atom_site_label_atom_id[dt].replace(/"/gm,""):void 0,ft.hetflag=!ut._atom_site_group_pdb||ut._atom_site_group_pdb[dt]==="HETA"||ut._atom_site_group_pdb[dt]==="HETATM",ut._atom_site_b_iso_or_equiv&&(ft.b=parseFloat(ut._atom_site_b_iso_or_equiv[dt]));let mt="X";ut._atom_site_type_symbol?mt=ut._atom_site_type_symbol[dt].replace(/\(?\+?\d+.*/,""):ut._atom_site_label&&(mt=ut._atom_site_label[dt].split("_")[0].replace(/\(?\d+.*/,"")),ft.elem=mt[0].toUpperCase()+mt.substring(1,2).toLowerCase(),ft.bonds=[],ft.ss="c",ft.serial=dt,ft.bondOrder=[],ft.properties={},at[at.length-1].push(ft)}if(ut._pdbx_struct_oper_list_id!==void 0&&!ot)for(let dt=0;dt<ut._pdbx_struct_oper_list_id.length;dt++){const ft=parseFloat(ut["_pdbx_struct_oper_list_matrix[1][1]"][dt]),mt=parseFloat(ut["_pdbx_struct_oper_list_matrix[1][2]"][dt]),yt=parseFloat(ut["_pdbx_struct_oper_list_matrix[1][3]"][dt]),gt=parseFloat(ut["_pdbx_struct_oper_list_vector[1]"][dt]),_t=parseFloat(ut["_pdbx_struct_oper_list_matrix[2][1]"][dt]),xt=parseFloat(ut["_pdbx_struct_oper_list_matrix[2][2]"][dt]),Mt=parseFloat(ut["_pdbx_struct_oper_list_matrix[2][3]"][dt]),wt=parseFloat(ut["_pdbx_struct_oper_list_vector[2]"][dt]),Et=parseFloat(ut["_pdbx_struct_oper_list_matrix[3][1]"][dt]),At=parseFloat(ut["_pdbx_struct_oper_list_matrix[3][2]"][dt]),St=parseFloat(ut["_pdbx_struct_oper_list_matrix[3][3]"][dt]),bt=parseFloat(ut["_pdbx_struct_oper_list_vector[3]"][dt]),Ct=new h.Matrix4(ft,mt,yt,gt,_t,xt,Mt,wt,Et,At,St,bt);lt[lt.length-1].symmetries.push(Ct)}const rt=function(dt){const ft=dt.match("-");dt=dt.replace(/[-xyz]/g,"");const mt=dt.split("/");let yt,gt;return mt[1]===void 0?gt=1:gt=parseInt(mt[1]),mt[0]===""?yt=1:yt=parseInt(mt[0]),yt/gt*(ft?-1:1)};if(ut._symmetry_equiv_pos_as_xyz!==void 0&&!ot)for(let dt=0;dt<ut._symmetry_equiv_pos_as_xyz.length;dt++){const mt=ut._symmetry_equiv_pos_as_xyz[dt].replace(/["' ]/g,"").split(",").map(function(xt){return xt.replace(/-/g,"+-")});let yt=new h.Matrix4(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1);for(let xt=0;xt<3;xt++){const Mt=mt[xt].split("+");for(let wt=0;wt<Mt.length;wt++){const Et=Mt[wt];if(Et==="")continue;const At=rt(Et);Et.match("x")?yt.elements[xt+0]=At:Et.match("y")?yt.elements[xt+4]=At:Et.match("z")?yt.elements[xt+8]=At:yt.elements[xt+12]=At}}const gt=it.getMatrix4(),_t=new h.Matrix4().getInverse(gt,!0);yt=new h.Matrix4().multiplyMatrices(yt,_t),yt=new h.Matrix4().multiplyMatrices(gt,yt),lt[lt.length-1].symmetries.push(yt)}}for(let ut=0;ut<at.length;ut++)ct&&!(tt.duplicateAssemblyAtoms&&!tt.dontConnectDuplicatedAtoms)&&(0,_.assignPDBBonds)(at[ut],tt),(0,o.computeSecondaryStructure)(at[ut],tt.hbondCutoff),(0,a.processSymmetries)(lt[ut].symmetries,at[ut],tt,lt[ut].cryst),tt.duplicateAssemblyAtoms&&!tt.dontConnectDuplicatedAtoms&&ct&&(0,_.assignPDBBonds)(at[ut],tt);return at}},"./src/parsers/CUBE.ts"(e,i,s){s.r(i),s.d(i,{CUBE:()=>_});var o=s("./src/WebGL/index.ts"),a=s("./src/parsers/utils/assignBonds.ts"),h=s("./src/parsers/utils/anumToSymbol.ts");function _(g,_e){_e=_e||{};const st=[[]];let tt=g.split(/\r?\n/);const at=_e.assignBonds===void 0?!0:_e.assignBonds;if(tt.length<6)return st;let ot=tt[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const lt=Math.abs(parseFloat(ot[0]));let ct={origin:void 0,size:void 0,unit:void 0,matrix4:void 0,matrix:void 0};const $=ct.origin=new o.Vector3(parseFloat(ot[1]),parseFloat(ot[2]),parseFloat(ot[3]));ot=tt[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),ot=tt[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const c=ot[0]>0?.529177:1;$.multiplyScalar(c);const d=Math.abs(ot[0]),j=new o.Vector3(parseFloat(ot[1]),parseFloat(ot[2]),parseFloat(ot[3])).multiplyScalar(c);ot=tt[4].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const et=Math.abs(ot[0]),nt=new o.Vector3(parseFloat(ot[1]),parseFloat(ot[2]),parseFloat(ot[3])).multiplyScalar(c);ot=tt[5].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");const ut=Math.abs(ot[0]),b=new o.Vector3(parseFloat(ot[1]),parseFloat(ot[2]),parseFloat(ot[3])).multiplyScalar(c);if(ct.size={x:d,y:et,z:ut},ct.unit=new o.Vector3(j.x,nt.y,b.z),j.y!=0||j.z!=0||nt.x!=0||nt.z!=0||b.x!=0||b.y!=0){ct.matrix4=new o.Matrix4(j.x,nt.x,b.x,0,j.y,nt.y,b.y,0,j.z,nt.z,b.z,0,0,0,0,1);let gt=new o.Matrix4().makeTranslation($.x,$.y,$.z);ct.matrix4=ct.matrix4.multiplyMatrices(gt,ct.matrix4),ct.matrix=ct.matrix4.matrix3FromTopLeft(),ct.origin=new o.Vector3(0,0,0),ct.unit=new o.Vector3(1,1,1)}st.modelData=[{cryst:ct}],tt=tt.splice(6,lt);for(var it=st[st.length-1].length,rt=it+tt.length,dt=it;dt<rt;++dt){var ft={};ft.serial=dt;var mt=tt[dt-it],yt=mt.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");ft.elem=h.anumToSymbol[yt[0]],ft.x=parseFloat(yt[2])*c,ft.y=parseFloat(yt[3])*c,ft.z=parseFloat(yt[4])*c,ft.hetflag=!0,ft.bonds=[],ft.bondOrder=[],ft.properties={},st[st.length-1].push(ft)}if(at)for(let gt=0;gt<st.length;gt++)(0,a.assignBonds)(st[gt],_e);return st}},"./src/parsers/GRO.ts"(e,i,s){s.r(i),s.d(i,{GRO:()=>h});var o=s("./src/parsers/utils/assignPDBBonds.ts"),a=s("./src/parsers/utils/atomNameToElem.ts");function h(_,g){const _e=[],st=_.split(/\r?\n|\r/);for(;st.length>0;){const tt=parseInt(st[1]);if(st.length<3||isNaN(tt)||tt<=0||st.length<tt+3)break;const ot=[];_e.push(ot);let lt=2;const ct=ot.length,$=ct+tt;for(let c=ct;c<$;c++){const d=st[lt++],j={};j.serial=c,j.atom=d.slice(10,15).trim(),j.elem=(0,a.atomNameToElem)(j.atom,!0),j.x=10*parseFloat(d.slice(20,28)),j.y=10*parseFloat(d.slice(28,36)),j.z=10*parseFloat(d.slice(36,44)),j.resi=parseInt(d.slice(0,5)),j.resn=d.slice(5,10).trim(),j.bonds=[],j.bondOrder=[],j.properties={},d.length>44&&(j.dx=10*parseFloat(d.slice(44,52)),j.dy=10*parseFloat(d.slice(52,60)),j.dz=10*parseFloat(d.slice(60,68))),ot[c]=j}if(st.length<=lt+3){const d=st[lt++].trim().split(/\s+/);if(d.length===3){for(let j=0;j<3;j++)d[j]=(parseFloat(d[j])*10).toString();_e.box=d}}st.splice(0,++lt)}for(let tt=0;tt<_e.length;tt++)(0,o.assignPDBBonds)(_e[tt],g);return _e}},"./src/parsers/LAMMPSTRJ.ts"(e,i,s){s.r(i),s.d(i,{LAMMPSTRJ:()=>h});var o=s("./src/parsers/utils/assignBonds.ts");const a={id:"serial",type:"atom",element:"elem",q:"charge",radius:"radius",x:"x",xu:"x",xs:"x",xsu:"x",y:"y",yu:"y",ys:"y",ysu:"y",z:"z",zu:"z",zs:"z",zsu:"z"};function h(_,g){const _e=[],st=_.split(/\r?\n|\r/);let tt=0,at=0,ot=0;for(;ot<st.length-9;){for(var lt=ot;lt<st.length;lt++)if(st[lt].match(/ITEM: NUMBER OF ATOMS/)&&(at=parseInt(st[lt+1])),st[lt].match(/ITEM: ATOMS/)){tt=lt+1;break}const ct=st[tt-1].replace("ITEM: ATOMS ","").split(" ");_e.push([]);for(let $=tt;$<tt+at;$++){const c={},d={},j=st[$].split(" ");for(let et=0;et<j.length;et++){const nt=a[ct[et]];nt!==void 0&&(nt==="serial"?c[nt]=parseInt(j[et]):nt==="x"||nt==="y"||nt==="z"?c[nt]=parseFloat(j[et]):nt==="charge"||nt==="radius"?d[nt]=parseFloat(j[et]):c[nt]=j[et]),c.properties=d,c.bonds=[],c.bondOrder=[]}_e[_e.length-1][$-tt]=c}ot=tt+at-1}if(g.assignBonds)for(let ct=0;ct<_e.length;ct++)(0,o.assignBonds)(_e[ct],g);return _e}},"./src/parsers/MMTF.ts"(e,i,s){s.r(i),s.d(i,{MMTFparser:()=>at});var o=s("./src/utilities.ts"),a=s("./src/WebGL/index.ts"),h=s("./src/parsers/utils/computeSecondaryStructure.ts"),_=s("./src/parsers/utils/processSymmetries.ts"),g=s("./src/vendor/mmtf.js"),_e=function(ot){return String.fromCharCode.apply(null,ot).replace(/\0/g,"")},st=function(ot){return ot==0||ot==2||ot==4?"h":ot==3?"s":"c"};let tt=new Set(["D-SACCHARIDE","D-SACCHARIDE 1,4 AND 1,4 LINKING","D-SACCHARIDE 1,4 AND 1,6 LINKING","L-SACCHARIDE","L-SACCHARIDE 1,4 AND 1,4 LINKING","L-SACCHARIDE 1,4 AND 1,6 LINKING","NON-POLYMER","OTHER","PEPTIDE-LIKE","SACCHARIDE"]);function at(ot,lt){var ct=!lt.keepH,$=lt.altLoc?lt.altLoc:"A",c=!!lt.noSecondaryStructure,d=!lt.noComputeSecondaryStructure,j=!lt.doAssembly,et=lt.assemblyIndex?lt.assemblyIndex:0;typeof ot=="string"?ot=(0,o.base64ToArray)(ot):ot=new Uint8Array(ot);var nt=g.decode(ot),ut=[[]],b=ut.modelData=[],it=0,rt=0,dt=0,ft=nt.secStructList,mt=nt.bFactorList,yt=nt.altLocList,gt=nt.occupancyList,_t=nt.bondAtomList,xt=nt.bondOrderList,Mt=nt.numModels;if(Mt==0)return ut;lt.multimodel||(Mt=1);var wt,Et,At,St,bt,Ct,Nt=[];if(!j&&nt.bioAssemblyList&&nt.bioAssemblyList.length>0){var kt=nt.bioAssemblyList[et].transformList;for(wt=0,Ct=kt.length;wt<Ct;wt++){var Ht=new a.Matrix4(kt[wt].matrix);Ht.transpose(),Nt.push(Ht)}}var jt=null;if(nt.unitCell){var Zt=nt.unitCell;jt={a:Zt[0],b:Zt[1],c:Zt[2],alpha:Zt[3],beta:Zt[4],gamma:Zt[5]}}let Xt=[];nt.entityList.forEach(Yt=>{Yt.chainIndexList.forEach(Rt=>{Xt[Rt]=Yt.type=="polymer"})});var Kt=0;for(bt=0;bt<Mt;bt++){var ar=nt.chainsPerModel[bt],or=ut[ut.length-1],_r=[];for(b.push({symmetries:Nt,cryst:jt}),wt=0;wt<ar;++wt){var nr=nt.groupsPerChain[it],Vt=_e(nt.chainIdList.subarray(it*4,it*4+4));nt.chainNameList&&(Vt=_e(nt.chainNameList.subarray(it*4,it*4+4)));var tr=rt,mr="";for(Et=0;Et<nr;++Et){var wr=nt.groupList[nt.groupTypeList[rt]],Er=wr.atomNameList.length,Sr=0,br=!1,gr=!1;if(ft){Sr=ft[rt];var xr=st(Sr);(rt==0||xr!=mr)&&(br=!0),mr=xr;var vr=rt+1;(vr>=ft.length||st(ft[vr]!=xr))&&(gr=!0)}var pr=nt.groupIdList[rt],Tr=wr.groupName;let Yt=wr.chemCompType;var Cr=dt;let Rt=tt.has(Yt)||!Xt[it];for(At=0;At<Er;++At){var Pt=wr.elementList[At];if(ct&&Pt=="H"){dt+=1;continue}var Ot="";mt&&(Ot=mt[dt]);var zt="";yt&&yt[dt]&&(zt=String.fromCharCode(yt[dt]));var rr="";if(gt&&(rr=gt[dt]),zt!=""&&zt!=$&&$!="*"){dt+=1;continue}var Jt=nt.atomIdList[dt],cr=wr.atomNameList[At],dr=0;wr.atomChargeList&&(dr=wr.atomChargeList[At]);var Dt=nt.xCoordList[dt],Gt=nt.yCoordList[dt],er=nt.zCoordList[dt];_r[dt]=or.length,or.push({resn:Tr,x:Dt,y:Gt,z:er,elem:Pt,hetflag:Rt,chain:Vt,resi:pr,icode:zt,rescode:pr+(zt!=" "?"^"+zt:""),serial:Jt,altLoc:zt,index:dt,atom:cr,bonds:[],ss:st(Sr),ssbegin:br,ssend:gr,bondOrder:[],properties:{charge:dr,occupancy:rr},b:Ot}),dt+=1}var fr=wr.bondAtomList;for(At=0,St=wr.bondOrderList.length;At<St;++At){var Ut=Cr+fr[At*2],sr=Cr+fr[At*2+1],Lt=wr.bondOrderList[At],hr=_r[Ut],yr=_r[sr],vt=or[hr],Qt=or[yr];vt&&Qt&&(vt.bonds.push(yr),vt.bondOrder.push(Lt),Qt.bonds.push(hr),Qt.bondOrder.push(Lt))}rt+=1}for(rt=tr,Et=0;Et<nr;++Et)rt+=1;it+=1}if(_t)for(let Yt=Kt,Rt=_t.length;Yt<Rt;Yt+=2){let Wt=_t[Yt],ir=_t[Yt+1],Lr=xt?xt[Yt/2]:1;if(Wt>=dt){Kt=Yt;break}let Dr=_r[Wt],Mr=_r[ir],kr=or[Dr],nn=or[Mr];kr&&nn&&(kr.bonds.push(Mr),kr.bondOrder.push(Lr),nn.bonds.push(Dr),nn.bondOrder.push(Lr))}lt.multimodel&&(lt.onemol||ut.push([]))}if(!j)for(let Yt=0;Yt<ut.length;Yt++)(0,_.processSymmetries)(b[Yt].symmetries,ut[Yt],lt,b[Yt].cryst);return d&&!c&&(0,h.computeSecondaryStructure)(ut,lt.hbondCutoff),ut}},"./src/parsers/MOL2.ts"(e,i,s){s.r(i),s.d(i,{MOL2:()=>a});let o={"C.1":"C",C1:"C","C.2":"C",C2:"C","C.3":"C",C3:"C","C.ar":"C",Car:"C","C.cat":"C",Ccat:"C","H.spc":"H",Hspc:"H","H.t3p":"H",Ht3p:"H","N.1":"N",N1:"N","N.2":"N",N2:"N","N.3":"N",N3:"N","N.4":"N",N4:"N","N.am":"N",Nam:"N","N.ar":"N",Nar:"N","N.p13":"N",Np13:"N","O.2":"O",O2:"O","O.3":"O",O3:"O","O.co2":"O",Oco2:"O","O.spc":"O",Ospc:"O","O.t3p":"O",Ot3p:"O","P.3":"P",P3:"P","S.2":"S",S2:"S","S.3":"S",S3:"S","S.o":"S",So:"S","S.o2":"S",So2:"S"};function a(h,_){var g=[[]],_e=!1;typeof _.keepH<"u"&&(_e=!_.keepH);var st=h.search(/@<TRIPOS>MOLECULE/),tt=h.search(/@<TRIPOS>ATOM/);if(st==-1||tt==-1)return g;for(var at=h.substring(st).split(/\r?\n|\r/);at.length>0;){var ot=[],lt=at[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),ct=parseInt(lt[0]),$=0;lt.length>1&&($=parseInt(lt[1]));var c=4,d;for(d=3;d<at.length;d++)if(at[d]=="@<TRIPOS>ATOM"){c=d+1;break}var j=g[g.length-1].length,et=j+ct,nt;for(d=j;d<et;d++){nt=at[c++],lt=nt.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");var ut={},b=lt[5];if(o[b]!==void 0?b=o[b]:(b=b.split(".")[0],b=b[0].toUpperCase()+b.substring(1).toLowerCase()),ut.atom=lt[1],ut.elem=b,!(ut.elem=="H"&&_e)){var it=g[g.length-1].length,rt=parseInt(lt[0]);ut.serial=rt,ut.x=parseFloat(lt[2]),ut.y=parseFloat(lt[3]),ut.z=parseFloat(lt[4]),ut.atom=lt[5];var dt=parseFloat(lt[8]);ut.index=it,ut.bonds=[],ut.bondOrder=[],ut.properties={charge:dt,partialCharge:dt},ot[rt]=it,g[g.length-1].push(ut)}}for(var ft=!1;c<at.length;)if(at[c++]=="@<TRIPOS>BOND"){ft=!0;break}if(ft&&$)for(d=0;d<$;d++){nt=at[c++],lt=nt.replace(/^\s+/,"").replace(/\s+/g," ").split(" ");var mt=parseInt(lt[1]),yt=g[g.length-1][ot[mt]],gt=parseInt(lt[2]),_t=g[g.length-1][ot[gt]],xt=parseInt(lt[3]);isNaN(xt)&&(xt=1),yt!==void 0&&_t!==void 0&&(yt.bonds.push(ot[gt]),yt.bondOrder.push(xt),_t.bonds.push(ot[mt]),_t.bondOrder.push(xt))}if(_.multimodel){_.onemol||g.push([]),at.splice(0,c),h=at.join(`
`);continue}else break}return g}},"./src/parsers/PDB.ts"(e,i,s){s.r(i),s.d(i,{PDB:()=>a});var o=s("./src/parsers/utils/getSinglePDB.ts");function a(h,_){_=_||{};var g=[],_e={};g.modelData=[];for(var st=h.split(/\r?\n|\r/);st.length>0;){var tt=(0,o.getSinglePDB)(st,_,_e),at=tt[0],ot=tt[1];if(st=tt[2],at.length!=0){if(_.multimodel&&_.onemol&&g.length>0)for(var lt=g[0].length,ct=0;ct<at.length;ct++){var $=at[ct];$.index=ct;for(var c=0;c<$.bonds.length;c++)$.bonds[c]+=lt;g[0].push($)}else g.modelData.push(ot),g.push(at);if(!_.multimodel)break}}return g}},"./src/parsers/PQR.ts"(e,i,s){s.r(i),s.d(i,{PQR:()=>h});var o=s("./src/parsers/utils/assignPDBBonds.ts"),a=s("./src/parsers/utils/computeSecondaryStructure.ts");function h(_,g){var _e=[[]],st=!g.noSecondaryStructure;_e.modelData=[{symmetries:[]}];var tt=[],at=_.split(/\r?\n|\r/),ot;for(let ft=0;ft<at.length;ft++){ot=at[ft].replace(/^\s*/,"");var lt=ot.substring(0,6);if(lt.indexOf("END")==0)if(g.multimodel){g.onemol||_e.push([]);continue}else break;else if(lt=="ATOM  "||lt=="HETATM"){var ct;let mt=parseInt(ot.substring(6,11)),yt=ot.substring(12,16).replace(/ /g,""),gt=ot.substring(17,20).trim(),_t=ot.substring(21,22),xt=parseInt(ot.substring(22,26));var $=ot.substring(30).trim().split(/\s+/),c=parseFloat($[0]),d=parseFloat($[1]),j=parseFloat($[2]),et=parseFloat($[3]),nt=parseFloat($[4]),ut=yt[0];yt.length>1&&yt[1].toUpperCase()!=yt[1]&&(ut=yt.substring(0,2)),ot[0]=="H"?ct=!0:ct=!1,tt[mt]=_e[_e.length-1].length,_e[_e.length-1].push({resn:gt,x:c,y:d,z:j,elem:ut,hetflag:ct,chain:_t,resi:xt,serial:mt,atom:yt,bonds:[],ss:"c",bondOrder:[],properties:{charge:et,partialCharge:et,radius:nt},pdbline:ot})}else if(lt=="CONECT"){var b=parseInt(ot.substring(6,11)),it=_e[_e.length-1][tt[b]];for(let mt=0;mt<4;mt++){var rt=parseInt(ot.substring([11,16,21,26][mt],[11,16,21,26][mt]+5)),dt=_e[_e.length-1][tt[rt]];it!==void 0&&dt!==void 0&&(it.bonds.push(tt[rt]),it.bondOrder.push(1))}}}for(let ft=0;ft<_e.length;ft++)(0,o.assignPDBBonds)(_e[ft],g),st&&(0,a.computeSecondaryStructure)(_e[ft],g.hbondCutoff);return _e}},"./src/parsers/PRMTOP.ts"(e,i,s){s.r(i),s.d(i,{PRMTOP:()=>o});function o(a){var h=[],_,g=0,_e=a.split(/\r?\n|\r/);if(_e.length>0&&_e[0].includes("VERSION")){var st=_e.filter(function(j){return j.includes("POINTERS")||j.includes("ATOM_NAME")||j.includes("CHARGE")||j.includes("RADII")||j.includes("BONDS_INC_HYDROGEN")||j.includes("BONDS_WITHOUT_HYDROGEN")||j.includes("RESIDUE_LABEL")||j.includes("RESIDUE_POINTER")}),tt=$("POINTERS");if(tt==-1)return[];var at=c(tt),ot=parseInt(_e[tt+1].slice(0,at[1]));let d=parseInt(_e[tt+2].slice(at[1],at[0]+at[1]));if(isNaN(ot)||ot<=0)return[];if(tt=$("ATOM_NAME"),tt==-1)return[];at=c(tt);var lt=at[0];for(let j=0;j<ot/at[0];j++){j==parseInt(ot/at[0])&&(lt=ot%at[0]);for(let et=0;et<lt;et++){let nt={},ut={charge:"",radii:""};nt.serial=g,nt.x=0,nt.y=0,nt.z=0,nt.atom=_e[tt+1].slice(at[1]*et,at[1]*(et+1)).trim(),nt.elem=_e[tt+1].slice(at[1]*et,at[1]*et+1).trim(),nt.properties=ut,nt.bonds=[],nt.bondOrder=[],nt.index=h.length,h.push(nt),g++}tt++}if(tt=$("CHARGE"),tt!=-1){at=c(tt),g=0,lt=at[0];for(let j=0;j<ot/at[0];j++){j==parseInt(ot/at[0])&&(lt=ot%at[0]);for(let et=0;et<lt;et++)h[g].properties.charge=parseFloat(_e[tt+1].slice(at[1]*et,at[1]*(et+1))),g++;tt++}}tt=$("RESIDUE_POINTER");var ct=[];if(tt!=-1){at=c(tt),lt=at[0],tt+=1;for(let j=0;j<d/at[0];j++){j==parseInt(d/at[0])&&(lt=d%at[0]);for(let et=0;et<lt;et++)ct.push(parseInt(_e[tt].slice(at[1]*et,at[1]*(et+1))));tt++}if(tt=$("RESIDUE_LABEL"),tt!=-1){let j=[];at=c(tt),lt=at[0],tt+=1;for(let b=0;b<d/at[0];b++){b==parseInt(d/at[0])&&(lt=d%at[0]);for(let it=0;it<lt;it++)j.push(_e[tt].slice(at[1]*it,at[1]*(it+1)).trim());tt++}let et=0,nt=0,ut="";ct.push(h.length+1);for(let b=0;b<h.length;b++)b+1>=ct[et]&&(ut=j[et],et+=1,nt+=1),h[b].resi=nt,h[b].resn=ut}}if(tt=$("RADII"),tt!=-1){at=c(tt),g=0,lt=at[0];for(let j=0;j<ot/at[0];j++){j==parseInt(ot/at[0])&&(lt=ot%at[0]);for(let et=0;et<lt;et++)h[g].properties.radii=parseFloat(_e[tt+1].slice(at[1]*et,at[1]*(et+1))),g++;tt++}}if(tt=$("BONDS_WITHOUT_HYDROGEN"),tt!=-1)for(at=c(tt),g=0,lt=at[0],tt=tt+1;!_e[tt].match(/^%FLAG/);){_e[tt+1].match(/^%FLAG/)&&(lt=ot%at[0]);for(let j=0;j<lt;j++)g%3==0?_=parseInt(_e[tt].slice(at[1]*j,at[1]*(j+1))/3):g%3==1&&(h[_].bonds.push(parseInt(_e[tt].slice(at[1]*j,at[1]*(j+1))/3)),h[_].bondOrder.push(1)),g++;tt++}if(tt=$("BONDS_INC_HYDROGEN"),tt!=-1)for(at=c(tt),g=0,lt=at[0],tt=tt+1;!_e[tt].match(/^%FLAG/);){_e[tt+1].match(/^%FLAG/)&&(lt=ot%at[0]);for(let j=0;j<lt;j++)g%3==0?_=parseInt(_e[tt].slice(at[1]*j,at[1]*(j+1))/3):g%3==1&&(h[_].bonds.push(parseInt(_e[tt].slice(at[1]*j,at[1]*(j+1))/3)),h[_].bonds.push(1)),g++;tt++}}else return[];function $(d){var j=_e.indexOf(st.filter(function(et){return et.includes(d)})[0]);if(Number.isInteger(j)&&j>0){for(;!_e[j].includes("FORMAT");)j++;return j}else return-1}function c(d){var j=_e[d].match(/\((\d*)\S*/),et=_e[d].match(/[a-zA-Z](\d*)\)\s*/);return et==null&&(et=_e[d].match(/[a-zA-Z](\d*)\.\d*\)\s*/)),[parseInt(j[1]),parseInt(et[1])]}return[h]}},"./src/parsers/SDF.ts"(e,i,s){s.r(i),s.d(i,{SDF:()=>h});var o=function(_,g){var _e=[[]],st=!1;for(typeof g.keepH<"u"&&(st=!g.keepH);_.length>0&&!(_.length<4);){var tt=parseInt(_[3].substring(0,3));if(isNaN(tt)||tt<=0)break;var at=parseInt(_[3].substring(3,6)),ot=4;if(_.length<4+tt+at)break;var lt=[],ct=_e[_e.length-1].length,$=ct+tt,c,d;for(c=ct;c<$;c++,ot++){d=_[ot];var j={},et=d.substring(31,34).replace(/ /g,"");j.atom=j.elem=et[0].toUpperCase()+et.substring(1).toLowerCase(),(j.elem!=="H"||!st)&&(j.serial=c,lt[c]=_e[_e.length-1].length,j.x=parseFloat(d.substring(0,10)),j.y=parseFloat(d.substring(10,20)),j.z=parseFloat(d.substring(20,30)),j.hetflag=!0,j.bonds=[],j.bondOrder=[],j.properties={},j.index=_e[_e.length-1].length,_e[_e.length-1].push(j))}for(c=0;c<at;c++,ot++){d=_[ot];var nt=lt[parseInt(d.substring(0,3))-1+ct],ut=lt[parseInt(d.substring(3,6))-1+ct],b=parseFloat(d.substring(6));typeof nt<"u"&&typeof ut<"u"&&(_e[_e.length-1][nt].bonds.push(ut),_e[_e.length-1][nt].bondOrder.push(b),_e[_e.length-1][ut].bonds.push(nt),_e[_e.length-1][ut].bondOrder.push(b))}if(g.multimodel){for(g.onemol||_e.push([]);_[ot]!=="$$$$"&&ot<_.length;)ot++;_.splice(0,++ot)}else break}return _e},a=function(_,g){var _e=[[]],st=!1;for(typeof g.keepH<"u"&&(st=!g.keepH);_.length>0&&!(_.length<8||!_[4].startsWith("M  V30 BEGIN CTAB")||!_[5].startsWith("M  V30 COUNTS")||_[5].length<14);){var tt=_[5].substring(13).match(/\S+/g);if(tt.length<2)break;var at=parseInt(tt[0]);if(isNaN(at)||at<=0)break;var ot=parseInt(tt[1]),lt=7;if(_.length<8+at+ot)break;var ct=[],$=_e[_e.length-1].length,c=$+at,d,j;for(d=$;d<c;d++,lt++){j=_[lt];var et=j.substring(6).match(/\S+/g);if(et.length>4){var nt={},ut=et[1].replace(/ /g,"");nt.atom=nt.elem=ut[0].toUpperCase()+ut.substring(1).toLowerCase(),(nt.elem!=="H"||!st)&&(nt.serial=d,ct[d]=_e[_e.length-1].length,nt.x=parseFloat(et[2]),nt.y=parseFloat(et[3]),nt.z=parseFloat(et[4]),nt.hetflag=!0,nt.bonds=[],nt.bondOrder=[],nt.properties={},nt.index=_e[_e.length-1].length,_e[_e.length-1].push(nt))}}if(_[lt]==="M  V30 END ATOM")lt++;else break;if(ot!==0&&_[lt]==="M  V30 BEGIN BOND")lt++;else break;for(d=0;d<ot;d++,lt++){j=_[lt];var b=j.substring(6).match(/\S+/g);if(b.length>3){var it=ct[parseInt(b[2])-1+$],rt=ct[parseInt(b[3])-1+$],dt=parseFloat(b[1]);typeof it<"u"&&typeof rt<"u"&&(_e[_e.length-1][it].bonds.push(rt),_e[_e.length-1][it].bondOrder.push(dt),_e[_e.length-1][rt].bonds.push(it),_e[_e.length-1][rt].bondOrder.push(dt))}}if(g.multimodel){for(g.onemol||_e.push([]);_[lt]!=="$$$$"&&lt<_.length;)lt++;_.splice(0,++lt)}else break}return _e};function h(_,g){var _e="V2000",st=_.split(/\r?\n|\r/);return st.length>3&&st[3].length>38&&(_e=st[3].substring(34,39)),_e==="V2000"?o(st,g):_e==="V3000"?a(st,g):[[""]]}},"./src/parsers/VASP.ts"(e,i,s){s.r(i),s.d(i,{VASP:()=>h});var o=s("./src/WebGL/index.ts"),a=s("./src/parsers/utils/assignBonds.ts");function h(_,g={}){var _e=[[]],st={};const tt=g.assignBonds===void 0?!0:g.assignBonds;var at=_.replace(/^\s+/,"").split(/\r?\n/);if(at.length<3)return _e;if(at[1].match(/\d+/))st.length=parseFloat(at[1]);else return console.log("Warning: second line of the vasp structure file must be a number"),_e;if(st.length<0)return console.log("Warning: Vasp implementation for negative lattice lengths is not yet available"),_e;st.xVec=new Float32Array(at[2].replace(/^\s+/,"").split(/\s+/)),st.yVec=new Float32Array(at[3].replace(/^\s+/,"").split(/\s+/)),st.zVec=new Float32Array(at[4].replace(/^\s+/,"").split(/\s+/));var ot=new o.Matrix3(st.xVec[0],st.xVec[1],st.xVec[2],st.yVec[0],st.yVec[1],st.yVec[2],st.zVec[0],st.zVec[1],st.zVec[2]);ot.multiplyScalar(st.length),_e.modelData=[{symmetries:[],cryst:{matrix:ot}}];var lt=at[5].trim().split(/\s+/),ct=new Int16Array(at[6].trim().split(/\s+/)),$=at[7].trim(),c=!1;if($.match(/S/)&&(c=!0,$=at[8].trim()),$.toLowerCase()[0]=="c")$="cartesian";else if($.toLowerCase()[0]=="d")$="direct";else return console.log("Warning: Unknown vasp mode in POSCAR file: mode must be either C(artesian) or D(irect)"),_e;if(lt.length!=ct.length)return console.log("Warning: declaration of atomary species wrong:"),console.log(lt),console.log(ct),_e;c?at.splice(0,9):at.splice(0,8);for(var d=0,j=0,et=lt.length;j<et;j++){for(var nt=lt[j],ut=0,b=ct[j];ut<b;ut++){var it=new Float32Array(at[d+ut].trim().split(/\s+/)),rt={};rt.elem=nt,$=="cartesian"?(rt.x=st.length*it[0],rt.y=st.length*it[1],rt.z=st.length*it[2]):(rt.x=st.length*(it[0]*st.xVec[0]+it[1]*st.yVec[0]+it[2]*st.zVec[0]),rt.y=st.length*(it[0]*st.xVec[1]+it[1]*st.yVec[1]+it[2]*st.zVec[1]),rt.z=st.length*(it[0]*st.xVec[2]+it[1]*st.yVec[2]+it[2]*st.zVec[2])),rt.bonds=[],rt.bondOrder=[],_e[0].push(rt)}d+=ct[j]}if(tt)for(let dt=0;dt<_e.length;dt++)(0,a.assignBonds)(_e[dt],g);return _e}},"./src/parsers/XYZ.ts"(e,i,s){s.r(i),s.d(i,{XYZ:()=>h});var o=s("./src/WebGL/index.ts"),a=s("./src/parsers/utils/assignBonds.ts");function h(_,g){g=g||{};for(var _e=[[]],st=g.assignBonds===void 0?!0:g.assignBonds,tt=_.trimStart().split(/\r?\n|\r/);tt.length>0&&!(tt.length<3);){var at=parseInt(tt[0]);if(isNaN(at)||at<=0||tt.length<at+2)break;var ot=/Lattice\s*=\s*["\{\}]([^"\{\}]+)["\{\}]\s*/gi,lt=ot.exec(tt[1]);if(lt!=null&&lt.length>1){var ct=new Float32Array(lt[1].split(/\s+/)),$=new o.Matrix3(ct[0],ct[3],ct[6],ct[1],ct[4],ct[7],ct[2],ct[5],ct[8]);_e.modelData=[{cryst:{matrix:$}}]}for(var c=2,d=_e[_e.length-1].length,j=d+at,et=d;et<j;et++){var nt=tt[c++],ut=nt.trim().split(/\s+/),b={};b.serial=et;var it=ut[0];b.atom=b.elem=it[0].toUpperCase()+it.substring(1,2).toLowerCase(),b.x=parseFloat(ut[1]),b.y=parseFloat(ut[2]),b.z=parseFloat(ut[3]),b.hetflag=!0,b.bonds=[],b.bondOrder=[],b.properties={},_e[_e.length-1][et]=b,ut.length>=7&&(b.dx=parseFloat(ut[4]),b.dy=parseFloat(ut[5]),b.dz=parseFloat(ut[6]))}if(g.multimodel)_e.push([]),tt.splice(0,c);else break}if(st)for(let dt=0;dt<_e.length;dt++)(0,a.assignBonds)(_e[dt],g);if(g.onemol){var rt=_e;_e=[],_e.push(rt[0]);for(let dt=1;dt<rt.length;dt++){let ft=_e[0].length;for(let mt=0;mt<rt[dt].length;mt++){let yt=rt[dt][mt];for(let gt=0;gt<yt.bonds.length;gt++)yt.bonds[gt]=yt.bonds[gt]+ft;yt.index=_e[0].length,yt.serial=_e[0].length,_e[0].push(yt)}}}return _e}},"./src/parsers/cifutils/category.ts"(e,i,s){s.r(i),s.d(i,{Category:()=>a});var o=s("./src/parsers/cifutils/decoder.ts");function a(h){const _=Object.create(null),g=Object.create(null);for(const _e of h.columns)_[_e.name]=_e;return{rowCount:h.rowCount,name:h.name.substring(1),fieldNames:h.columns.map(_e=>_e.name),getField(_e){const st=_[_e];if(st)return g[_e]||(g[_e]=(0,o.decode)(st.data)),g[_e]}}}},"./src/parsers/cifutils/decoder.ts"(e,i,s){s.r(i),s.d(i,{decode:()=>_});var o=s("./src/parsers/cifutils/encoding.ts");const a=new Uint16Array(new Uint8Array([18,52]).buffer)[0]===13330;function h(ft,mt){const yt=new ArrayBuffer(ft.length),gt=new Uint8Array(yt);for(let _t=0,xt=ft.length;_t<xt;_t+=mt)for(let Mt=0;Mt<mt;Mt++)gt[_t+mt-Mt-1]=ft[_t+Mt];return yt}function _(ft){let mt=ft.data;for(let yt=ft.encoding.length-1;yt>=0;yt--)mt=g(mt,ft.encoding[yt]);return mt}function g(ft,mt){switch(mt.kind){case"ByteArray":switch(mt.type){case o.Encoding.IntDataType.Uint8:return ft;case o.Encoding.IntDataType.Int8:return tt(ft);case o.Encoding.IntDataType.Int16:return ot(ft);case o.Encoding.IntDataType.Uint16:return lt(ft);case o.Encoding.IntDataType.Int32:return ct(ft);case o.Encoding.IntDataType.Uint32:return $(ft);case o.Encoding.FloatDataType.Float32:return c(ft);case o.Encoding.FloatDataType.Float64:return d(ft);default:throw new Error("unreachable")}case"FixedPoint":return j(ft,mt);case"IntervalQuantization":return et(ft,mt);case"RunLength":return nt(ft,mt);case"Delta":return ut(ft,mt);case"IntegerPacking":return rt(ft,mt);case"StringArray":return dt(ft,mt)}}function _e(ft,mt){switch(ft){case o.Encoding.IntDataType.Int8:return new Int8Array(mt);case o.Encoding.IntDataType.Int16:return new Int16Array(mt);case o.Encoding.IntDataType.Int32:return new Int32Array(mt);case o.Encoding.IntDataType.Uint8:return new Uint8Array(mt);case o.Encoding.IntDataType.Uint16:return new Uint16Array(mt);case o.Encoding.IntDataType.Uint32:return new Uint32Array(mt);default:return new Int32Array(mt)}}function st(ft,mt){switch(ft){case o.Encoding.FloatDataType.Float32:return new Float32Array(mt);case o.Encoding.FloatDataType.Float64:return new Float64Array(mt);default:return new Float64Array(mt)}}function tt(ft){return new Int8Array(ft.buffer,ft.byteOffset)}function at(ft,mt,yt){return(ft.byteOffset!=0||ft.byteLength!=ft.buffer.byteLength)&&(ft=new Uint8Array(ft)),a?new yt(ft.buffer):new yt(h(ft,mt))}function ot(ft){return at(ft,2,Int16Array)}function lt(ft){return at(ft,2,Uint16Array)}function ct(ft){return at(ft,4,Int32Array)}function $(ft){return at(ft,4,Uint32Array)}function c(ft){return at(ft,4,Float32Array)}function d(ft){return at(ft,8,Float64Array)}function j(ft,mt){const yt=ft.length,gt=st(mt.srcType,yt),_t=1/mt.factor;for(let xt=0;xt<yt;xt++)gt[xt]=_t*ft[xt];return gt}function et(ft,mt){const yt=ft.length,gt=st(mt.srcType,yt),_t=(mt.max-mt.min)/(mt.numSteps-1),xt=mt.min;for(let Mt=0;Mt<yt;Mt++)gt[Mt]=xt+_t*ft[Mt];return gt}function nt(ft,mt){const yt=_e(mt.srcType,mt.srcSize);let gt=0;for(let _t=0,xt=ft.length;_t<xt;_t+=2){const Mt=ft[_t],wt=ft[_t+1];for(let Et=0;Et<wt;++Et)yt[gt++]=Mt}return yt}function ut(ft,mt){const yt=ft.length,gt=_e(mt.srcType,yt);if(!yt)return ft;gt[0]=ft[0]+(mt.origin|0);for(let _t=1;_t<yt;++_t)gt[_t]=ft[_t]+gt[_t-1];return gt}function b(ft,mt){const yt=mt.byteCount===1?127:32767,gt=-yt-1,_t=ft.length,xt=new Int32Array(mt.srcSize);let Mt=0,wt=0;for(;Mt<_t;){let Et=0,At=ft[Mt];for(;At===yt||At===gt;)Et+=At,Mt++,At=ft[Mt];Et+=At,xt[wt]=Et,Mt++,wt++}return xt}function it(ft,mt){const yt=mt.byteCount===1?255:65535,gt=ft.length,_t=new Int32Array(mt.srcSize);let xt=0,Mt=0;for(;xt<gt;){let wt=0,Et=ft[xt];for(;Et===yt;)wt+=Et,xt++,Et=ft[xt];wt+=Et,_t[Mt]=wt,xt++,Mt++}return _t}function rt(ft,mt){return ft.length===mt.srcSize?ft:mt.isUnsigned?it(ft,mt):b(ft,mt)}function dt(ft,mt){const yt=_({encoding:mt.offsetEncoding,data:mt.offsets}),gt=_({encoding:mt.dataEncoding,data:ft}),_t=mt.stringData,xt=new Array(yt.length);xt[0]="";for(let Et=1,At=yt.length;Et<At;Et++)xt[Et]=_t.substring(yt[Et-1],yt[Et]);let Mt=0;const wt=new Array(gt.length);for(let Et=0,At=gt.length;Et<At;Et++)wt[Mt++]=xt[gt[Et]+1];return wt}},"./src/parsers/cifutils/encoding.ts"(e,i,s){s.r(i),s.d(i,{Encoding:()=>a,VERSION:()=>o});const o="0.3.0";var a;(function(h){(function(_e){_e[_e.Int8=1]="Int8",_e[_e.Int16=2]="Int16",_e[_e.Int32=3]="Int32",_e[_e.Uint8=4]="Uint8",_e[_e.Uint16=5]="Uint16",_e[_e.Uint32=6]="Uint32"})(h.IntDataType||(h.IntDataType={})),function(_e){_e[_e.Float32=32]="Float32",_e[_e.Float64=33]="Float64"}(h.FloatDataType||(h.FloatDataType={}));function _(_e){let st;return _e instanceof Int8Array?st=h.IntDataType.Int8:_e instanceof Int16Array?st=h.IntDataType.Int16:_e instanceof Int32Array?st=h.IntDataType.Int32:_e instanceof Uint8Array?st=h.IntDataType.Uint8:_e instanceof Uint16Array?st=h.IntDataType.Uint16:_e instanceof Uint32Array?st=h.IntDataType.Uint32:_e instanceof Float32Array?st=h.FloatDataType.Float32:_e instanceof Float64Array?st=h.FloatDataType.Float64:st=h.IntDataType.Int32,st}h.getDataType=_;function g(_e){if(_e instanceof Int8Array||_e instanceof Int16Array||_e instanceof Int32Array)return!0;for(let st=0,tt=_e.length;st<tt;st++)if(st<0)return!1;return!0}h.isSignedIntegerDataType=g})(a||(a={}))},"./src/parsers/index.ts"(e,i,s){s.r(i),s.d(i,{Parsers:()=>j,bondLength:()=>d.bondLength,setBondLength:()=>d.setBondLength});var o=s("./src/parsers/VASP.ts"),a=s("./src/parsers/CUBE.ts"),h=s("./src/parsers/XYZ.ts"),_=s("./src/parsers/SDF.ts"),g=s("./src/parsers/CDJSON.ts"),_e=s("./src/parsers/CIF.ts"),st=s("./src/parsers/MOL2.ts"),tt=s("./src/parsers/PDB.ts"),at=s("./src/parsers/PQR.ts"),ot=s("./src/parsers/MMTF.ts"),lt=s("./src/parsers/PRMTOP.ts"),ct=s("./src/parsers/GRO.ts"),$=s("./src/parsers/LAMMPSTRJ.ts"),c=s("./src/parsers/BCIF.ts"),d=s("./src/parsers/utils/bondLength.ts");const j={vasp:o.VASP,VASP:o.VASP,cube:a.CUBE,CUBE:a.CUBE,xyz:h.XYZ,XYZ:h.XYZ,sdf:_.SDF,SDF:_.SDF,json:g.CDJSON,cdjson:g.CDJSON,CDJSON:g.CDJSON,mcif:_e.CIF,cif:_e.CIF,CIF:_e.CIF,mol2:st.MOL2,MOL2:st.MOL2,pdb:tt.PDB,PDB:tt.PDB,pdbqt:tt.PDB,PDBQT:tt.PDB,pqr:at.PQR,PQR:at.PQR,mmtf:ot.MMTFparser,MMTF:ot.MMTFparser,prmtop:lt.PRMTOP,PRMTOP:lt.PRMTOP,gro:ct.GRO,GRO:ct.GRO,lammpstrj:$.LAMMPSTRJ,LAMMPSTRJ:$.LAMMPSTRJ,bcif:c.BCIF,BCIF:c.BCIF}},"./src/parsers/utils/anumToSymbol.ts"(e,i,s){s.r(i),s.d(i,{anumToSymbol:()=>o});const o={1:"H",2:"He",3:"Li",4:"Be",5:"B",6:"C",7:"N",8:"O",9:"F",10:"Ne",11:"Na",12:"Mg",13:"Al",14:"Si",15:"P",16:"S",17:"Cl",18:"Ar",19:"K",20:"Ca",21:"Sc",22:"Ti",23:"V",24:"Cr",25:"Mn",26:"Fe",27:"Co",28:"Ni",29:"Cu",30:"Zn",31:"Ga",32:"Ge",33:"As",34:"Se",35:"Br",36:"Kr",37:"Rb",38:"Sr",39:"Y",40:"Zr",41:"Nb",42:"Mo",43:"Tc",44:"Ru",45:"Rh",46:"Pd",47:"Ag",48:"Cd",49:"In",50:"Sn",51:"Sb",52:"Te",53:"I",54:"Xe",55:"Cs",56:"Ba",71:"Lu",72:"Hf",73:"Ta",74:"W",75:"Re",76:"Os",77:"Ir",78:"Pt",79:"Au",80:"Hg",81:"Tl",82:"Pb",83:"Bi",84:"Po",85:"At",86:"Rn",87:"Fr",88:"Ra",104:"Rf",105:"Db",106:"Sg",107:"Bh",108:"Hs",109:"Mt",110:"Ds",111:"Rg",112:"Cn",113:"Nh",114:"Fl",115:"Mc",116:"Lv",117:"Ts",118:"Og",57:"La",58:"Ce",59:"Pr",60:"Nd",61:"Pm",62:"Sm",63:"Eu",64:"Gd",65:"Tb",66:"Dy",67:"Ho",68:"Er",69:"Tm",70:"Yb",89:"Ac",90:"Th",91:"Pa",92:"U",93:"Np",94:"Pu",95:"Am",96:"Cm",97:"Bk",98:"Cf",99:"Es",100:"Fm",101:"Md",102:"No"}},"./src/parsers/utils/areConnected.ts"(e,i,s){s.r(i),s.d(i,{areConnected:()=>h});var o=s("./src/parsers/utils/bondLength.ts");const a=new Set(["Na","K","Ca","Mg","Mn","Sr"]);function h(_,g,_e){if(_e&&_e.unboundCations&&(a.has(_.elem)||a.has(g.elem)))return!1;let st=(0,o.bondLength)(_.elem)+(0,o.bondLength)(g.elem);st+=.25,st*=st;let tt=_.x-g.x;if(tt*=tt,tt>st)return!1;let at=_.y-g.y;if(at*=at,at>st)return!1;let ot=_.z-g.z;if(ot*=ot,ot>st)return!1;const lt=tt+at+ot;return!(isNaN(lt)||lt<.5||lt>st||_.altLoc!==g.altLoc&&_.altLoc.trim()!==""&&g.altLoc.trim()!=="")}},"./src/parsers/utils/assignBackboneHBonds.ts"(e,i,s){s.r(i),s.d(i,{assignBackboneHBonds:()=>o});function o(a,h){const _=h||3.2,g=_*_,_e=[];for(let st=0,tt=a.length;st<tt;st++){a[st].index=st;const at=a[st];!at.hetflag&&(at.atom==="N"||at.atom==="O")&&(_e.push(at),at.hbondOther=null,at.hbondDistanceSq=Number.POSITIVE_INFINITY)}_e.sort(function(st,tt){return st.z-tt.z});for(let st=0,tt=_e.length;st<tt;st++){const at=_e[st];for(let ot=st+1;ot<tt;ot++){const lt=_e[ot],ct=lt.z-at.z;if(ct>_)break;if(lt.atom==at.atom)continue;const $=Math.abs(lt.y-at.y);if($>_)continue;const c=Math.abs(lt.x-at.x);if(c>_)continue;const d=c*c+$*$+ct*ct;d>g||lt.chain==at.chain&&Math.abs(lt.resi-at.resi)<4||(d<at.hbondDistanceSq&&(at.hbondOther=lt,at.hbondDistanceSq=d),d<lt.hbondDistanceSq&&(lt.hbondOther=at,lt.hbondDistanceSq=d))}}}},"./src/parsers/utils/assignBonds.ts"(e,i,s){s.r(i),s.d(i,{assignBonds:()=>_});var o=s("./src/parsers/utils/areConnected.ts");const a=[{x:0,y:0,z:1},{x:0,y:1,z:-1},{x:0,y:1,z:0},{x:0,y:1,z:1},{x:1,y:-1,z:-1},{x:1,y:-1,z:0},{x:1,y:-1,z:1},{x:1,y:0,z:-1},{x:1,y:0,z:0},{x:1,y:0,z:1},{x:1,y:1,z:-1},{x:1,y:1,z:0},{x:1,y:1,z:1}],h=4.95;function _(g,_e){for(let at=0,ot=g.length;at<ot;at++)g[at].index||(g[at].index=at);const st={x:{y:{z:[]}}};for(let at=0;at<g.length;at++){const ot=g[at],lt=Math.floor(ot.x/h),ct=Math.floor(ot.y/h),$=Math.floor(ot.z/h);st[lt]||(st[lt]={}),st[lt][ct]||(st[lt][ct]={}),st[lt][ct][$]||(st[lt][ct][$]=[]),st[lt][ct][$].push(ot)}function tt(at,ot){for(let lt=0;lt<at.length;lt++){const ct=at[lt];for(let $=0;$<ot.length;$++){const c=ot[$];if((0,o.areConnected)(ct,c,_e)){const d=ct.bonds.indexOf(c.index),j=c.bonds.indexOf(ct.index);d===-1&&j===-1?(ct.bonds.push(c.index),ct.bondOrder.push(1),c.bonds.push(ct.index),c.bondOrder.push(1)):d===-1?(ct.bonds.push(c.index),ct.bondOrder.push(c.bondOrder[j])):j===-1&&(c.bonds.push(ct.index),c.bondOrder.push(ct.bondOrder[d]))}}}}for(let at in st){const ot=parseInt(at);for(let lt in st[ot]){const ct=parseInt(lt);for(let $ in st[ot][ct]){const c=parseInt($),d=st[ot][ct][c];for(let j=0;j<d.length;j++){const et=d[j];for(let nt=j+1;nt<d.length;nt++){const ut=d[nt];(0,o.areConnected)(et,ut,_e)&&et.bonds.indexOf(ut.index)==-1&&(et.bonds.push(ut.index),et.bondOrder.push(1),ut.bonds.push(et.index),ut.bondOrder.push(1))}}for(let j=0;j<a.length;j++){const et=a[j];if(!st[ot+et.x]||!st[ot+et.x][ct+et.y]||!st[ot+et.x][ct+et.y][c+et.z])continue;const nt=st[ot+et.x][ct+et.y][c+et.z];tt(d,nt)}}}}}},"./src/parsers/utils/assignPDBBonds.ts"(e,i,s){s.r(i),s.d(i,{assignPDBBonds:()=>_});var o=s("./src/parsers/utils/areConnected.ts"),a=s("./src/parsers/utils/assignBonds.ts"),h=s("./src/parsers/utils/standardResidues.ts");function _(g,_e){const st=[],tt=[];for(let ct=0,$=g.length;ct<$;ct++){const c=g[ct];c.index=ct,c.hetflag||!h.standardResidues.has(c.resn)?tt.push(c):st.push(c)}(0,a.assignBonds)(tt,_e),st.sort(function(ct,$){return ct.chain!==$.chain?ct.chain<$.chain?-1:1:ct.resi-$.resi});let at=-1,ot=-1,lt;for(let ct=0,$=st.length;ct<$;ct++){const c=st[ct];c.resi!==at&&(at=c.resi,lt||ot++,lt=!1),c.reschain=ot;for(let d=ct+1;d<st.length;d++){const j=st[d];if(j.chain!==c.chain||j.resi-c.resi>1)break;(0,o.areConnected)(c,j,_e)&&(c.bonds.indexOf(j.index)===-1&&(c.bonds.push(j.index),c.bondOrder.push(1),j.bonds.push(c.index),j.bondOrder.push(1)),c.resi!==j.resi&&(lt=!0))}}}},"./src/parsers/utils/atomNameToElem.ts"(e,i,s){s.r(i),s.d(i,{atomNameToElem:()=>a});var o=s("./src/parsers/utils/bondLength.ts");function a(h,_){let g=h.replace(/ /g,"");return g.length>0&&g[0]==="H"&&g!=="Hg"&&g!=="He"&&g!=="Hf"&&g!=="Hs"&&g!=="Ho"&&(g="H"),g.length>1&&(g=g[0].toUpperCase()+g.substring(1).toLowerCase(),o.bondTable[g]===void 0?g=g[0]:_&&(g==="Ca"||g==="Cd")&&(g="C")),g}},"./src/parsers/utils/bondLength.ts"(e,i,s){s.r(i),s.d(i,{bondLength:()=>a,bondTable:()=>o,setBondLength:()=>h});let o={H:.37,He:.32,Li:1.34,Be:.9,B:.82,C:.77,N:.75,O:.73,F:.71,Ne:.69,Na:1.54,Mg:1.3,Al:1.18,Si:1.11,P:1.06,S:1.02,Cl:.99,Ar:.97,K:1.96,Ca:1.74,Sc:1.44,Ti:1.56,V:1.25,Mn:1.39,Fe:1.25,Co:1.26,Ni:1.21,Cu:1.38,Zn:1.31,Ga:1.26,Ge:1.22,Se:1.16,Br:1.14,Kr:1.1,Rb:2.11,Sr:1.92,Y:1.62,Zr:1.48,Nb:1.37,Mo:1.45,Tc:1.56,Ru:1.26,Rh:1.35,Pd:1.31,Ag:1.53,Cd:1.48,In:1.44,Sn:1.41,Sb:1.38,Te:1.35,I:1.33,Xe:1.3,Cs:2.25,Ba:1.98,Lu:1.6,Hf:1.5,Ta:1.38,W:1.46,Re:1.59,Os:1.44,Ir:1.37,Pt:1.28,Au:1.44,Hg:1.49,Tl:1.48,Pb:1.47,Bi:1.46,Rn:1.45};function a(_){return o[_]||1.6}function h(_,g){g<0&&(g=0),o[_]=g}},"./src/parsers/utils/computeSecondaryStructure.ts"(e,i,s){s.r(i),s.d(i,{computeSecondaryStructure:()=>a});var o=s("./src/parsers/utils/assignBackboneHBonds.ts");function a(h,_){(0,o.assignBackboneHBonds)(h,_);const g={};let _e,st,tt,at,ot,lt;for(_e=0,st=h.length;_e<st;_e++)if(ot=h[_e],g[ot.chain]===void 0&&(g[ot.chain]=[]),isFinite(ot.hbondDistanceSq)){const ct=ot.hbondOther;g[ct.chain]===void 0&&(g[ct.chain]=[]),Math.abs(ct.resi-ot.resi)===4&&(g[ot.chain][ot.resi]="h")}for(tt in g)for(at=1;at<g[tt].length-1;at++){const ct=g[tt][at-1],$=g[tt][at+1];lt=g[tt][at],ct=="h"&&ct==$&&lt!=ct&&(g[tt][at]=ct)}for(_e=0,st=h.length;_e<st;_e++)ot=h[_e],isFinite(ot.hbondDistanceSq)&&g[ot.chain][ot.resi]!="h"&&ot.ss!=="h"&&(g[ot.chain][ot.resi]="maybesheet");for(let ct=0,$=h.length;ct<$;ct++)if(ot=h[ct],isFinite(ot.hbondDistanceSq)&&g[ot.chain][ot.resi]=="maybesheet"){let c=ot.hbondOther,d=g[c.chain][c.resi];(d=="maybesheet"||d=="s")&&(g[ot.chain][ot.resi]="s",g[c.chain][c.resi]="s")}for(let ct in g){for(let $=1;$<g[ct].length-1;$++){const c=g[ct][$-1],d=g[ct][$+1];lt=g[ct][$],c=="s"&&c==d&&lt!=c&&(g[ct][$]=c)}for(let $=0;$<g[ct].length;$++){const c=g[ct][$];(c=="h"||c=="s")&&g[ct][$-1]!=c&&g[ct][$+1]!=c&&delete g[ct][$]}}for(_e=0,st=h.length;_e<st;_e++)ot=h[_e],lt=g[ot.chain][ot.resi],delete ot.hbondOther,delete ot.hbondDistanceSq,!(lt===void 0||lt==="maybesheet")&&(ot.ss=lt,g[ot.chain][ot.resi-1]!=lt&&(ot.ssbegin=!0),g[ot.chain][ot.resi+1]!=lt&&(ot.ssend=!0))}},"./src/parsers/utils/getSinglePDB.ts"(e,i,s){s.r(i),s.d(i,{getSinglePDB:()=>at});var o=s("./src/WebGL/index.ts"),a=s("./src/parsers/utils/atomNameToElem.ts"),h=s("./src/parsers/utils/bondLength.ts"),_=s("./src/parsers/utils/computeSecondaryStructure.ts"),g=s("./src/parsers/utils/isEmpty.ts"),_e=s("./src/parsers/utils/processSymmetries.ts"),st=s("./src/parsers/utils/assignPDBBonds.ts"),tt=s("./src/parsers/utils/validateBonds.ts");function at(ot,lt,ct){const $=[],c=lt.assignBonds===void 0?!0:lt.assignBonds,d=!lt.keepH,j=!!lt.noSecondaryStructure,et=!lt.noComputeSecondaryStructure,nt=!lt.doAssembly,ut=lt.altLoc?lt.altLoc:"A",b={symmetries:[],cryst:void 0};let it,rt=[];const dt=[];let ft;const mt={};for(let yt=0;yt<ot.length;yt++){ft=ot[yt].replace(/^\s*/,"");const gt=ft.substring(0,6);let _t,xt,Mt;if(gt.indexOf("END")===0){if(rt=ot.slice(yt+1),gt==="END")for(const wt in ct)ct.hasOwnProperty(wt)&&delete ct[wt];break}else if(gt==="ATOM  "||gt==="HETATM"){let wt,Et,At,St,bt,Ct,Nt,kt,Ht,jt,Zt,Xt;if(Zt=ft.substring(16,17),Zt!==" "&&Zt!==ut&&ut!=="*"||(jt=parseInt(ft.substring(6,11)),it=ft.substring(12,16).replace(/ /g,""),wt=ft.substring(17,20).replace(/ /g,""),Et=ft.substring(21,22),At=parseInt(ft.substring(22,26)),St=ft.substring(26,27),bt=parseFloat(ft.substring(30,38)),Ct=parseFloat(ft.substring(38,46)),Nt=parseFloat(ft.substring(46,54)),Xt=parseFloat(ft.substring(60,68)),Ht=ft.substring(76,78).replace(/ /g,""),Ht===""||h.bondTable[Ht]===void 0?Ht=(0,a.atomNameToElem)(ft.substring(12,14),ft[0]=="A"):Ht=Ht[0].toUpperCase()+Ht.substring(1).toLowerCase(),Ht==="H"&&d))continue;gt[0]=="H"?kt=!0:kt=!1,dt[jt]=$.length,$.push({resn:wt,x:bt,y:Ct,z:Nt,elem:Ht,hetflag:kt,altLoc:Zt,chain:Et,resi:At,icode:St,rescode:At+(St!==" "?"^"+St:""),serial:jt,atom:it,bonds:[],ss:"c",bondOrder:[],properties:{},b:Xt,pdbline:ft})}else if(gt==="SHEET "){_t=ft.substring(21,22),xt=parseInt(ft.substring(22,26)),Mt=parseInt(ft.substring(33,37)),_t in ct||(ct[_t]={}),ct[_t][xt]="s1";for(let wt=xt+1;wt<Mt;wt++)ct[_t][wt]="s";ct[_t][Mt]="s2"}else if(gt==="CONECT"){const wt=parseInt(ft.substring(6,11)),Et=dt[wt],At=$[Et],St=[11,16,21,26];for(let bt=0;bt<4;bt++){const Ct=parseInt(ft.substring(St[bt],St[bt]+5)),Nt=dt[Ct];let kt=Et+":"+Nt;const Ht=$[Nt];if(At!==void 0&&Ht!==void 0)if(!mt[kt])mt[kt]=1,(At.bonds.length==0||At.bonds[At.bonds.length-1]!==Nt)&&(At.bonds.push(Nt),At.bondOrder.push(1));else{mt[kt]+=1;for(let jt=0;jt<At.bonds.length;jt++)if(At.bonds[jt]==Nt){const Zt=mt[kt];Zt>=4?At.bondOrder[jt]=1:At.bondOrder[jt]=Zt}}}}else if(gt==="HELIX "){_t=ft.substring(19,20),xt=parseInt(ft.substring(21,25)),Mt=parseInt(ft.substring(33,37)),_t in ct||(ct[_t]={}),ct[_t][xt]="h1";for(let wt=xt+1;wt<Mt;wt++)ct[_t][wt]="h";ct[_t][Mt]="h2"}else if(!nt&&gt==="REMARK"&&ft.substring(13,18)==="BIOMT"){let wt,Et=new o.Matrix4;for(wt=1;wt<=3;wt++)if(ft=ot[yt].replace(/^\s*/,""),parseInt(ft.substring(18,19))==wt)Et.elements[wt-1]=parseFloat(ft.substring(23,33)),Et.elements[wt-1+4]=parseFloat(ft.substring(33,43)),Et.elements[wt-1+8]=parseFloat(ft.substring(43,53)),Et.elements[wt-1+12]=parseFloat(ft.substring(53)),yt++;else for(;ft.substring(13,18)==="BIOMT";)yt++,ft=ot[yt].replace(/^\s*/,"");Et.elements[3]=0,Et.elements[7]=0,Et.elements[11]=0,Et.elements[15]=1,b.symmetries.push(Et),yt--}else if(gt==="CRYST1"){let wt,Et,At,St,bt,Ct;wt=parseFloat(ft.substring(7,15)),Et=parseFloat(ft.substring(16,24)),At=parseFloat(ft.substring(25,33)),St=parseFloat(ft.substring(34,40)),bt=parseFloat(ft.substring(41,47)),Ct=parseFloat(ft.substring(48,54)),b.cryst={a:wt,b:Et,c:At,alpha:St,beta:bt,gamma:Ct}}else if(gt==="ANISOU"){const wt=parseInt(ft.substring(6,11)),Et=dt[wt],At=$[Et];if(At){const St=ft.substring(30).trim().split(/\s+/),bt={u11:parseInt(St[0]),u22:parseInt(St[1]),u33:parseInt(St[2]),u12:parseInt(St[3]),u13:parseInt(St[4]),u23:parseInt(St[5])};At.uMat=bt}}}if((0,tt.validateBonds)($,dt),c&&(0,st.assignPDBBonds)($,lt),nt||(0,_e.processSymmetries)(b.symmetries,$,lt,b.cryst),et&&!j&&(0,_.computeSecondaryStructure)($,lt.hbondCutoff),!(0,g.isEmpty)(ct))for(let yt=0;yt<$.length;yt++){const gt=$[yt];if(gt!==void 0&&gt.chain in ct&&gt.resi in ct[gt.chain]){const _t=ct[gt.chain][gt.resi];gt.ss=_t[0],_t.length>1&&(_t[1]=="1"?gt.ssbegin=!0:_t[1]=="2"&&(gt.ssend=!0))}}return[$,b,rt]}},"./src/parsers/utils/isEmpty.ts"(e,i,s){s.r(i),s.d(i,{isEmpty:()=>o});function o(a){for(const h in a)return!1;return!0}},"./src/parsers/utils/processSymmetries.ts"(e,i,s){s.r(i),s.d(i,{processSymmetries:()=>a});var o=s("./src/WebGL/index.ts");function a(h,_,g,_e){const st=!g.duplicateAssemblyAtoms,tt=_.length;let at=tt,ot=-1,lt=null,ct=null;(g.normalizeAssembly||g.wrapAtoms)&&_e&&(lt=(0,o.conversionMatrix3)(_e.a,_e.b,_e.c,_e.alpha,_e.beta,_e.gamma),ct=new o.Matrix3,ct.getInverse3(lt));let $=function(j){let et=j.clone().applyMatrix3(ct);const nt=[et.x,et.y,et.z],ut=[0,0,0];for(let it=0;it<3;it++){for(;nt[it]<-.001;)nt[it]+=1,ut[it]+=1;for(;nt[it]>1.001;)nt[it]-=1,ut[it]-=1}const b=new o.Vector3(ut[0],ut[1],ut[2]);return b.applyMatrix3(lt),b};if(g.normalizeAssembly&&_e)for(let j=0;j<h.length;j++){const et=new o.Vector3(0,0,0);for(let ut=0;ut<tt;ut++){const b=new o.Vector3(_[ut].x,_[ut].y,_[ut].z);b.applyMatrix4(h[j]),et.add(b)}et.divideScalar(tt);const nt=$(et);h[j].isNearlyIdentity()&&nt.lengthSq()>.001&&(ot=j),h[j].translate(nt)}if(st){if(h.length>1)for(let j=0;j<_.length;j++){var c=[];for(let et=0;et<h.length;et++)if(!h[et].isNearlyIdentity()){var d=new o.Vector3;d.set(_[j].x,_[j].y,_[j].z),d.applyMatrix4(h[et]),c.push(d)}_[j].symmetries=c}}else{for(let j=0;j<tt;j++)_[j].sym=-1;for(let j=0;j<h.length;j++)if(!h[j].isNearlyIdentity()&&ot!=j){let et=new o.Vector3;for(let nt=0;nt<tt;nt++){const ut=[];for(let it=0;it<_[nt].bonds.length;it++)ut.push(_[nt].bonds[it]+at);if(et.set(_[nt].x,_[nt].y,_[nt].z),et.applyMatrix4(h[j]),g.wrapAtoms&&_e){let it=$(et);et.add(it)}const b={};for(const it in _[nt])b[it]=_[nt][it];b.x=et.x,b.y=et.y,b.z=et.z,b.bonds=ut,b.sym=j,b.index=_.length,_.push(b)}at=_.length}else for(let et=0;et<tt;et++)_[et].sym=j;if(g.wrapAtoms&&_e){let j=new o.Vector3;for(let et=0;et<tt;et++){j.set(_[et].x,_[et].y,_[et].z);let nt=$(j);j.add(nt),_[et].x=j.x,_[et].y=j.y,_[et].z=j.z}}if(ot>=0){const j=new o.Vector3;for(let et=0;et<tt;et++)j.set(_[et].x,_[et].y,_[et].z),j.applyMatrix4(h[ot]),_[et].x=j.x,_[et].y=j.y,_[et].z=j.z}h.length=0}}},"./src/parsers/utils/standardResidues.ts"(e,i,s){s.r(i),s.d(i,{standardResidues:()=>o});const o=new Set(["ABU","ACD","ALA","ALB","ALI","ARG","AR0","ASN","ASP","ASX","BAS","CYS","CYH","CYX","CSS","CSH","GLN","GLU","GLX","GLY","HIS","HIE","HID","HIP","HYP","ILE","ILU","LEU","LYS","MET","PCA","PGA","PHE","PR0","PRO","PRZ","SER","THR","TRP","TYR","VAL","A","1MA","C","5MC","OMC","G","1MG","2MG","M2G","7MG","OMG","YG","I","T","U","+U","H2U","5MU","PSU","ACE","F0R","H2O","HOH","WAT"])},"./src/parsers/utils/validateBonds.ts"(e,i,s){s.r(i),s.d(i,{validateBonds:()=>o});function o(a,h){for(let _=0,g=a.length;_<g;_++){const _e=a[_];for(let st=0;st<_e.bonds.length;st++){const tt=_e.bonds[st],at=a[tt],ot=h[_e.serial];at&&ot&&at.bonds.indexOf(ot)<0&&(at.bonds.push(ot),at.bondOrder.push(_e.bondOrder[st]))}}}},"./src/partialCharges.ts"(e,i,s){s.r(i),s.d(i,{applyPartialCharges:()=>a,partialCharges:()=>o});const o={"ALA:N":-.15,"ALA:CA":.1,"ALA:CB":0,"ALA:C":.6,"ALA:O":-.55,"ARG:N":-.15,"ARG:CA":.1,"ARG:CB":0,"ARG:CG":0,"ARG:CD":.1,"ARG:NE":-.1,"ARG:CZ":.5,"ARG:NH1":.25,"ARG:NH2":.25,"ARG:C":.6,"ARG:O":-.55,"ASN:N":-.15,"ASN:CA":.1,"ASN:CB":0,"ASN:CG":.55,"ASN:OD1":-.55,"ASN:ND2":0,"ASN:C":.6,"ASN:O":-.55,"ASP:N":-.15,"ASP:CA":.1,"ASP:CB":0,"ASP:CG":.14,"ASP:OD1":-.57,"ASP:OD2":-.57,"ASP:C":.6,"ASP:O":-.55,"CYS:N":-.15,"CYS:CA":.1,"CYS:CB":.19,"CYS:SG":-.19,"CYS:C":.6,"CYS:O":-.55,"GLN:N":-.15,"GLN:CA":.1,"GLN:CB":0,"GLN:CG":0,"GLN:CD":.55,"GLN:OE1":-.55,"GLN:NE2":0,"GLN:C":.6,"GLN:O":-.55,"GLU:N":-.15,"GLU:CA":.1,"GLU:CB":0,"GLU:CG":0,"GLU:CD":.14,"GLU:OE1":-.57,"GLU:OE2":-.57,"GLU:C":.6,"GLU:O":-.55,"GLY:N":-.15,"GLY:CA":.1,"GLY:C":.6,"GLY:O":-.55,"HIS:N":-.15,"HIS:CA":.1,"HIS:CB":0,"HIS:CG":.1,"HIS:ND1":-.1,"HIS:CD2":.1,"HIS:NE2":-.4,"HIS:CE1":.3,"HIS:C":.6,"HIS:O":-.55,"ILE:N":-.15,"ILE:CA":.1,"ILE:CB":0,"ILE:CG2":0,"ILE:CG1":0,"ILE:CD":0,"ILE:C":.6,"ILE:O":-.55,"LEU:N":-.15,"LEU:CA":.1,"LEU:CB":0,"LEU:CG":0,"LEU:CD1":0,"LEU:CD2":0,"LEU:C":.6,"LEU:O":-.55,"LYS:N":-.15,"LYS:CA":.1,"LYS:CB":0,"LYS:CG":0,"LYS:CD":0,"LYS:CE":.25,"LYS:NZ":.75,"LYS:C":.6,"LYS:O":-.55,"MET:N":-.15,"MET:CA":.1,"MET:CB":0,"MET:CG":.06,"MET:SD":-.12,"MET:CE":.06,"MET:C":.6,"MET:O":-.55,"PHE:N":-.15,"PHE:CA":.1,"PHE:CB":0,"PHE:CG":0,"PHE:CD1":0,"PHE:CD2":0,"PHE:CE1":0,"PHE:CE2":0,"PHE:CZ":0,"PHE:C":.6,"PHE:O":-.55,"PRO:N":-.25,"PRO:CD":.1,"PRO:CA":.1,"PRO:CB":0,"PRO:CG":0,"PRO:C":.6,"PRO:O":-.55,"SER:N":-.15,"SER:CA":.1,"SER:CB":.25,"SER:OG":-.25,"SER:C":.6,"SER:O":-.55,"THR:N":-.15,"THR:CA":.1,"THR:CB":.25,"THR:OG1":-.25,"THR:CG2":0,"THR:C":.6,"THR:O":-.55,"TRP:N":-.15,"TRP:CA":.1,"TRP:CB":0,"TRP:CG":-.03,"TRP:CD2":.1,"TRP:CE2":-.04,"TRP:CE3":-.03,"TRP:CD1":.06,"TRP:NE1":-.06,"TRP:CZ2":0,"TRP:CZ3":0,"TRP:CH2":0,"TRP:C":.6,"TRP:O":-.55,"TYR:N":-.15,"TYR:CA":.1,"TYR:CB":0,"TYR:CG":0,"TYR:CD1":0,"TYR:CE1":0,"TYR:CD2":0,"TYR:CE2":0,"TYR:CZ":.25,"TYR:OH":-.25,"TYR:C":.6,"TYR:O":-.55,"VAL:N":-.15,"VAL:CA":.1,"VAL:CB":0,"VAL:CG1":0,"VAL:CG2":0,"VAL:C":.6,"VAL:O":-.55};function a(h,_){if((!_||typeof h.partialCharge>"u")&&h.resn&&h.atom){var g=h.resn+":"+h.atom;h.properties.partialCharge=o[g]}}},"./src/specs.ts"(e,i,s){s.r(i)},"./src/utilities.ts"(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{PausableTimer:()=>PausableTimer,adjustVolumeStyle:()=>adjustVolumeStyle,base64ToArray:()=>base64ToArray,deepCopy:()=>deepCopy,download:()=>download,extend:()=>extend,get:()=>get,getAtomProperty:()=>getAtomProperty,getColorFromStyle:()=>getColorFromStyle,getElement:()=>getElement,getExtent:()=>getExtent,getPropertyRange:()=>getPropertyRange,getbin:()=>getbin,inflateString:()=>inflateString,isEmptyObject:()=>isEmptyObject,isNumeric:()=>isNumeric,makeFunction:()=>makeFunction,mergeGeos:()=>mergeGeos,specStringToObject:()=>specStringToObject});var _Gradient__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/Gradient.ts"),_VolumeData__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/VolumeData.ts"),_colors__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/colors.ts"),pako__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/pako/dist/pako.esm.mjs");function extend(e,i){for(var s in i)i.hasOwnProperty(s)&&i[s]!==void 0&&(e[s]=i[s]);return e}function deepCopy(e){let i,s,o;if(e==null)return{};if(typeof e!="object"||e===null)return e;i=Array.isArray(e)?[]:{};for(o in e)s=e[o],i[o]=deepCopy(s);return i}function isNumeric(e){var i=typeof e;return(i==="number"||i==="string")&&!isNaN(e-parseFloat(e))}function isEmptyObject(e){return Object.keys(e).length===0}function makeFunction(callback){return callback&&typeof callback=="string"&&(callback=eval("("+callback+")")),callback&&typeof callback!="function"?(console.warn("Invalid callback provided."),()=>{}):callback}function adjustVolumeStyle(e){e&&(e.volformat&&!(e.voldata instanceof _VolumeData__WEBPACK_IMPORTED_MODULE_1__.VolumeData)&&(e.voldata=new _VolumeData__WEBPACK_IMPORTED_MODULE_1__.VolumeData(e.voldata,e.volformat)),e.volscheme&&(e.volscheme=_Gradient__WEBPACK_IMPORTED_MODULE_0__.Gradient.getGradient(e.volscheme)))}function getExtent(e,i){var s,o,a,h,_,g,_e,st,tt,at,ot=!i;if(s=o=a=9999,h=_=g=-9999,_e=st=tt=at=0,e.length===0)return[[0,0,0],[0,0,0],[0,0,0]];for(var lt=0;lt<e.length;lt++){var ct=e[lt];if(!(typeof ct>"u"||!isFinite(ct.x)||!isFinite(ct.y)||!isFinite(ct.z))&&(at++,_e+=ct.x,st+=ct.y,tt+=ct.z,s=s<ct.x?s:ct.x,o=o<ct.y?o:ct.y,a=a<ct.z?a:ct.z,h=h>ct.x?h:ct.x,_=_>ct.y?_:ct.y,g=g>ct.z?g:ct.z,ct.symmetries&&ot))for(var $=0;$<ct.symmetries.length;$++)at++,_e+=ct.symmetries[$].x,st+=ct.symmetries[$].y,tt+=ct.symmetries[$].z,s=s<ct.symmetries[$].x?s:ct.symmetries[$].x,o=o<ct.symmetries[$].y?o:ct.symmetries[$].y,a=a<ct.symmetries[$].z?a:ct.symmetries[$].z,h=h>ct.symmetries[$].x?h:ct.symmetries[$].x,_=_>ct.symmetries[$].y?_:ct.symmetries[$].y,g=g>ct.symmetries[$].z?g:ct.symmetries[$].z}return[[s,o,a],[h,_,g],[_e/at,st/at,tt/at]]}function getPropertyRange(e,i){for(var s=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,a=0,h=e.length;a<h;a++){var _=e[a],g=getAtomProperty(_,i);g!=null&&(g<s&&(s=g),g>o&&(o=g))}return!isFinite(s)&&!isFinite(o)?s=o=0:isFinite(s)?isFinite(o)||(o=s):s=o,[s,o]}class PausableTimer{constructor(i,s,o){this.total_time_run=0,this.fn=i,this.arg=o,this.countdown=s,this.start_time=new Date().getTime(),this.ident=setTimeout(i,s,o)}cancel(){clearTimeout(this.ident)}pause(){clearTimeout(this.ident),this.total_time_run=new Date().getTime()-this.start_time}resume(){this.ident=setTimeout(this.fn,Math.max(0,this.countdown-this.total_time_run),this.arg)}}function base64ToArray(e){for(var i=window.atob(e),s=i.length,o=new Uint8Array(s),a=0;a<s;a++)o[a]=i.charCodeAt(a);return o}function getAtomProperty(e,i){var s=null;return e.properties&&typeof e.properties[i]<"u"?s=e.properties[i]:typeof e[i]<"u"&&(s=e[i]),s}function mergeGeos(e,i){var s=i.geometry;s!==void 0&&e.geometryGroups.push(s.geometryGroups[0])}function specStringToObject(e){if(typeof e=="object")return e;if(typeof e>"u"||e==null)return e;try{return JSON.parse(e)}catch{}e=e.replace(/%7E/g,"~");var i=function(ot){return isNumeric(ot)?Math.floor(parseFloat(ot))==parseInt(ot)||ot.indexOf(".")>=0?parseFloat(ot):parseInt(ot):ot==="true"?!0:ot==="false"?!1:ot},s={};if(e==="all")return s;for(var o=e.split(";"),a=0;a<o.length;a++){var h=o[a].split(":"),_=h[0],g={},_e=h[1];if(_e)if(_e=_e.replace(/~/g,"="),_e.indexOf("=")!==-1)for(var st=_e.split(","),tt=0;tt<st.length;tt++){var at=st[tt].split("=",2);g[at[0]]=i(at[1])}else _e.indexOf(",")!==-1?g=_e.split(","):g=i(_e);s[_]=g}return s}function checkStatus(e){if(!e.ok)throw new Error(`HTTP ${e.status} - ${e.statusText}`);return e}function get(e,i){var s=fetch(e).then(checkStatus).then(o=>o.text());return i?s.then(i):s}function getbin(e,i,s,o){var a;return s=="POST"?a=fetch(e,{method:"POST",body:o}).then(h=>checkStatus(h)).then(h=>h.arrayBuffer()):a=fetch(e).then(h=>checkStatus(h)).then(h=>h.arrayBuffer()),i?a.then(i):a}function download(e,i,s,o){var a="",h="",_="",g=null,_e=i.addModel();if(e.indexOf(":")<0&&(e.length==4?e="pdb:"+e:isNaN(e)?e="url:"+e:e="cid:"+e),e.substring(0,5)=="mmtf:"&&(console.warn("WARNING: MMTF now deprecated.  Reverting to bcif."),e="bcif:"+e.slice(5)),e.substring(0,5)==="bcif:")e=e.substring(5).toUpperCase(),_="https://models.rcsb.org/"+e+".bcif.gz",s&&typeof s.noComputeSecondaryStructure>"u"&&(s.noComputeSecondaryStructure=!0),g=new Promise(function(tt){getbin(_).then(function(at){_e.addMolData(at,"bcif.gz",s),i.zoomTo(),i.render(),tt(_e)},function(){console.error("fetch of "+_+" failed.")})});else{if(e.substring(0,4)==="pdb:"){if(a="bcif",s&&s.format&&(a=s.format),s&&typeof s.noComputeSecondaryStructure>"u"&&(s.noComputeSecondaryStructure=!0),e=e.substring(4).toUpperCase(),!e.match(/^[1-9][A-Za-z0-9]{3}$/)){alert("Wrong PDB ID");return}a=="bcif"?_="https://models.rcsb.org/"+e.toUpperCase()+".bcif.gz":(h=s&&s.pdbUri?s.pdbUri:"https://files.rcsb.org/view/",_=h+e+"."+a)}else if(e.substring(0,4)=="cid:"){if(a="sdf",e=e.substring(4),!e.match(/^[0-9]+$/)){alert("Wrong Compound ID");return}_="https://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+e+"/SDF?record_type=3d"}else e.substring(0,4)=="url:"&&(_=e.substring(4),a=_);var st=function(tt){_e.addMolData(tt,a,s),i.zoomTo(),i.render()};g=new Promise(function(tt){a=="bcif"?getbin(_).then(function(at){st(at),tt(_e)}).catch(function(){h=s&&s.pdbUri?s.pdbUri:"https://files.rcsb.org/view/",_=h+e+".pdb",a="pdb",console.warn("falling back to pdb format"),get(_).then(function(at){st(at),tt(_e)}).catch(function(at){st(""),tt(_e),console.error("fetch of "+_+" failed: "+at.statusText)})}):get(_).then(function(at){st(at),tt(_e)}).catch(function(at){st(""),tt(_e),console.error("fetch of "+_+" failed: "+at.statusText)})})}return o?(g.then(function(tt){o(tt)}),_e):g}function getColorFromStyle(e,i){let s=i.colorscheme;if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[s]<"u")s=_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[s];else if(typeof s=="string"&&s.endsWith("Carbon")){let _=s.substring(0,s.lastIndexOf("Carbon")).toLowerCase();if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.htmlColors[_]<"u"){let g=Object.assign({},_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors.defaultColors);g.C=_colors__WEBPACK_IMPORTED_MODULE_2__.htmlColors[_],_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[s]={prop:"elem",map:g},s=_colors__WEBPACK_IMPORTED_MODULE_2__.builtinColorSchemes[s]}}let o=e.color;if(typeof i.color<"u"&&i.color!="spectrum"&&(o=i.color),typeof s<"u"){let _,g;if(typeof _colors__WEBPACK_IMPORTED_MODULE_2__.elementColors[s]<"u")s=_colors__WEBPACK_IMPORTED_MODULE_2__.elementColors[s],typeof s[e[s.prop]]<"u"&&(o=s.map[e[s.prop]]);else if(typeof s[e[s.prop]]<"u")o=s.map[e[s.prop]];else if(typeof s.prop<"u"&&typeof s.gradient<"u"){_=s.prop;var a=s.gradient;a instanceof _Gradient__WEBPACK_IMPORTED_MODULE_0__.GradientType||(a=(0,_Gradient__WEBPACK_IMPORTED_MODULE_0__.getGradient)(s));let _e=a.range()||[-1,1];g=getAtomProperty(e,_),g!=null&&(o=a.valueToHex(g,_e))}else typeof s.prop<"u"&&typeof s.map<"u"?(_=s.prop,g=getAtomProperty(e,_),typeof s.map[g]<"u"&&(o=s.map[g])):typeof i.colorscheme[e.elem]<"u"?o=i.colorscheme[e.elem]:console.warn("Could not interpret colorscheme "+s)}else typeof i.colorfunc<"u"&&(o=i.colorfunc(e));return _colors__WEBPACK_IMPORTED_MODULE_2__.CC.color(o)}function getElement(e){let i=e;return typeof e=="string"?i=document.querySelector("#"+e):typeof e=="object"&&e.get&&(i=e.get(0)),i}function inflateString(e,i=!0){let s;return typeof e=="string"?s=new TextEncoder().encode(e):s=new Uint8Array(e),(0,pako__WEBPACK_IMPORTED_MODULE_3__.inflate)(s,{to:i?"string":null})}},"./src/vendor/mmtf.js"(e,i){(function(s,o){o(i)})(this,function(s){function o(Pt,Ot,zt){for(var rr=(Pt.byteLength,0),Jt=zt.length;Jt>rr;rr++){var cr=zt.charCodeAt(rr);if(128>cr)Pt.setUint8(Ot++,cr>>>0&127|0);else if(2048>cr)Pt.setUint8(Ot++,cr>>>6&31|192),Pt.setUint8(Ot++,cr>>>0&63|128);else if(65536>cr)Pt.setUint8(Ot++,cr>>>12&15|224),Pt.setUint8(Ot++,cr>>>6&63|128),Pt.setUint8(Ot++,cr>>>0&63|128);else{if(!(1114112>cr))throw new Error("bad codepoint "+cr);Pt.setUint8(Ot++,cr>>>18&7|240),Pt.setUint8(Ot++,cr>>>12&63|128),Pt.setUint8(Ot++,cr>>>6&63|128),Pt.setUint8(Ot++,cr>>>0&63|128)}}}function a(Pt){for(var Ot=0,zt=0,rr=Pt.length;rr>zt;zt++){var Jt=Pt.charCodeAt(zt);if(128>Jt)Ot+=1;else if(2048>Jt)Ot+=2;else if(65536>Jt)Ot+=3;else{if(!(1114112>Jt))throw new Error("bad codepoint "+Jt);Ot+=4}}return Ot}function h(Pt,Ot,zt){var rr=typeof Pt;if(rr==="string"){var Jt=a(Pt);if(32>Jt)return Ot.setUint8(zt,160|Jt),o(Ot,zt+1,Pt),1+Jt;if(256>Jt)return Ot.setUint8(zt,217),Ot.setUint8(zt+1,Jt),o(Ot,zt+2,Pt),2+Jt;if(65536>Jt)return Ot.setUint8(zt,218),Ot.setUint16(zt+1,Jt),o(Ot,zt+3,Pt),3+Jt;if(4294967296>Jt)return Ot.setUint8(zt,219),Ot.setUint32(zt+1,Jt),o(Ot,zt+5,Pt),5+Jt}if(Pt instanceof Uint8Array){var Jt=Pt.byteLength,cr=new Uint8Array(Ot.buffer);if(256>Jt)return Ot.setUint8(zt,196),Ot.setUint8(zt+1,Jt),cr.set(Pt,zt+2),2+Jt;if(65536>Jt)return Ot.setUint8(zt,197),Ot.setUint16(zt+1,Jt),cr.set(Pt,zt+3),3+Jt;if(4294967296>Jt)return Ot.setUint8(zt,198),Ot.setUint32(zt+1,Jt),cr.set(Pt,zt+5),5+Jt}if(rr==="number"){if(!isFinite(Pt))throw new Error("Number not finite: "+Pt);if(Math.floor(Pt)!==Pt)return Ot.setUint8(zt,203),Ot.setFloat64(zt+1,Pt),9;if(Pt>=0){if(128>Pt)return Ot.setUint8(zt,Pt),1;if(256>Pt)return Ot.setUint8(zt,204),Ot.setUint8(zt+1,Pt),2;if(65536>Pt)return Ot.setUint8(zt,205),Ot.setUint16(zt+1,Pt),3;if(4294967296>Pt)return Ot.setUint8(zt,206),Ot.setUint32(zt+1,Pt),5;throw new Error("Number too big 0x"+Pt.toString(16))}if(Pt>=-32)return Ot.setInt8(zt,Pt),1;if(Pt>=-128)return Ot.setUint8(zt,208),Ot.setInt8(zt+1,Pt),2;if(Pt>=-32768)return Ot.setUint8(zt,209),Ot.setInt16(zt+1,Pt),3;if(Pt>=-2147483648)return Ot.setUint8(zt,210),Ot.setInt32(zt+1,Pt),5;throw new Error("Number too small -0x"+(-Pt).toString(16).substr(1))}if(Pt===null)return Ot.setUint8(zt,192),1;if(rr==="boolean")return Ot.setUint8(zt,Pt?195:194),1;if(rr==="object"){var Jt,Gt=0,dr=Array.isArray(Pt);if(dr)Jt=Pt.length;else{var Dt=Object.keys(Pt);Jt=Dt.length}var Gt;if(16>Jt?(Ot.setUint8(zt,Jt|(dr?144:128)),Gt=1):65536>Jt?(Ot.setUint8(zt,dr?220:222),Ot.setUint16(zt+1,Jt),Gt=3):4294967296>Jt&&(Ot.setUint8(zt,dr?221:223),Ot.setUint32(zt+1,Jt),Gt=5),dr)for(var er=0;Jt>er;er++)Gt+=h(Pt[er],Ot,zt+Gt);else for(var er=0;Jt>er;er++){var fr=Dt[er];Gt+=h(fr,Ot,zt+Gt),Gt+=h(Pt[fr],Ot,zt+Gt)}return Gt}throw new Error("Unknown type "+rr)}function _(Pt){var Ot=typeof Pt;if(Ot==="string"){var zt=a(Pt);if(32>zt)return 1+zt;if(256>zt)return 2+zt;if(65536>zt)return 3+zt;if(4294967296>zt)return 5+zt}if(Pt instanceof Uint8Array){var zt=Pt.byteLength;if(256>zt)return 2+zt;if(65536>zt)return 3+zt;if(4294967296>zt)return 5+zt}if(Ot==="number"){if(Math.floor(Pt)!==Pt)return 9;if(Pt>=0){if(128>Pt)return 1;if(256>Pt)return 2;if(65536>Pt)return 3;if(4294967296>Pt)return 5;throw new Error("Number too big 0x"+Pt.toString(16))}if(Pt>=-32)return 1;if(Pt>=-128)return 2;if(Pt>=-32768)return 3;if(Pt>=-2147483648)return 5;throw new Error("Number too small -0x"+Pt.toString(16).substr(1))}if(Ot==="boolean"||Pt===null)return 1;if(Ot==="object"){var zt,rr=0;if(Array.isArray(Pt)){zt=Pt.length;for(var Jt=0;zt>Jt;Jt++)rr+=_(Pt[Jt])}else{var cr=Object.keys(Pt);zt=cr.length;for(var Jt=0;zt>Jt;Jt++){var dr=cr[Jt];rr+=_(dr)+_(Pt[dr])}}if(16>zt)return 1+rr;if(65536>zt)return 3+rr;if(4294967296>zt)return 5+rr;throw new Error("Array or object too long 0x"+zt.toString(16))}throw new Error("Unknown type "+Ot)}function g(Pt){var Ot=new ArrayBuffer(_(Pt)),zt=new DataView(Ot);return h(Pt,zt,0),new Uint8Array(Ot)}function _e(Pt,Ot,zt){return Ot?new Pt(Ot.buffer,Ot.byteOffset,Ot.byteLength/(zt||1)):void 0}function st(Pt){return _e(DataView,Pt)}function tt(Pt){return _e(Uint8Array,Pt)}function at(Pt){return _e(Int8Array,Pt)}function ot(Pt){return _e(Int32Array,Pt,4)}function lt(Pt){return _e(Float32Array,Pt,4)}function ct(Pt,Ot){var zt=Pt.length/2;Ot||(Ot=new Int16Array(zt));for(var rr=0,Jt=0;zt>rr;++rr,Jt+=2)Ot[rr]=Pt[Jt]<<8^Pt[Jt+1]<<0;return Ot}function $(Pt,Ot){var zt=Pt.length;Ot||(Ot=new Uint8Array(2*zt));for(var rr=st(Ot),Jt=0;zt>Jt;++Jt)rr.setInt16(2*Jt,Pt[Jt]);return tt(Ot)}function c(Pt,Ot){var zt=Pt.length/4;Ot||(Ot=new Int32Array(zt));for(var rr=0,Jt=0;zt>rr;++rr,Jt+=4)Ot[rr]=Pt[Jt]<<24^Pt[Jt+1]<<16^Pt[Jt+2]<<8^Pt[Jt+3]<<0;return Ot}function d(Pt,Ot){var zt=Pt.length;Ot||(Ot=new Uint8Array(4*zt));for(var rr=st(Ot),Jt=0;zt>Jt;++Jt)rr.setInt32(4*Jt,Pt[Jt]);return tt(Ot)}function j(Pt,Ot){var zt=Pt.length;Ot||(Ot=new Float32Array(zt/4));for(var rr=st(Ot),Jt=st(Pt),cr=0,dr=0,Dt=zt/4;Dt>cr;++cr,dr+=4)rr.setFloat32(dr,Jt.getFloat32(dr),!0);return Ot}function et(Pt,Ot,zt){var rr=Pt.length,Jt=1/Ot;zt||(zt=new Float32Array(rr));for(var cr=0;rr>cr;++cr)zt[cr]=Pt[cr]*Jt;return zt}function nt(Pt,Ot,zt){var rr=Pt.length;zt||(zt=new Int32Array(rr));for(var Jt=0;rr>Jt;++Jt)zt[Jt]=Math.round(Pt[Jt]*Ot);return zt}function ut(Pt,Ot){var zt,rr;if(!Ot){var Jt=0;for(zt=0,rr=Pt.length;rr>zt;zt+=2)Jt+=Pt[zt+1];Ot=new Pt.constructor(Jt)}var cr=0;for(zt=0,rr=Pt.length;rr>zt;zt+=2)for(var dr=Pt[zt],Dt=Pt[zt+1],Gt=0;Dt>Gt;++Gt)Ot[cr]=dr,++cr;return Ot}function b(Pt){if(Pt.length===0)return new Int32Array;var Ot,zt,rr=2;for(Ot=1,zt=Pt.length;zt>Ot;++Ot)Pt[Ot-1]!==Pt[Ot]&&(rr+=2);var Jt=new Int32Array(rr),cr=0,dr=1;for(Ot=1,zt=Pt.length;zt>Ot;++Ot)Pt[Ot-1]!==Pt[Ot]?(Jt[cr]=Pt[Ot-1],Jt[cr+1]=dr,dr=1,cr+=2):++dr;return Jt[cr]=Pt[Pt.length-1],Jt[cr+1]=dr,Jt}function it(Pt,Ot){var zt=Pt.length;Ot||(Ot=new Pt.constructor(zt)),zt&&(Ot[0]=Pt[0]);for(var rr=1;zt>rr;++rr)Ot[rr]=Pt[rr]+Ot[rr-1];return Ot}function rt(Pt,Ot){var zt=Pt.length;Ot||(Ot=new Pt.constructor(zt)),Ot[0]=Pt[0];for(var rr=1;zt>rr;++rr)Ot[rr]=Pt[rr]-Pt[rr-1];return Ot}function dt(Pt,Ot){var zt,rr,Jt=Pt instanceof Int8Array?127:32767,cr=-Jt-1,dr=Pt.length;if(!Ot){var Dt=0;for(zt=0;dr>zt;++zt)Pt[zt]<Jt&&Pt[zt]>cr&&++Dt;Ot=new Int32Array(Dt)}for(zt=0,rr=0;dr>zt;){for(var Gt=0;Pt[zt]===Jt||Pt[zt]===cr;)Gt+=Pt[zt],++zt;Gt+=Pt[zt],++zt,Ot[rr]=Gt,++rr}return Ot}function ft(Pt,Ot){var zt,rr=32767,Jt=-rr-1,cr=Pt.length,dr=0;for(zt=0;cr>zt;++zt){var Dt=Pt[zt];Dt===0?++dr:Dt>0?(dr+=Math.ceil(Dt/rr),Dt%rr===0&&(dr+=1)):(dr+=Math.ceil(Dt/Jt),Dt%Jt===0&&(dr+=1))}var Gt=new Int16Array(dr),er=0;for(zt=0;cr>zt;++zt){var Dt=Pt[zt];if(Dt>=0)for(;Dt>=rr;)Gt[er]=rr,++er,Dt-=rr;else for(;Jt>=Dt;)Gt[er]=Jt,++er,Dt-=Jt;Gt[er]=Dt,++er}return Gt}function mt(Pt,Ot){return it(ut(Pt),Ot)}function yt(Pt){return b(rt(Pt))}function gt(Pt,Ot,zt){return et(ut(Pt,ot(zt)),Ot,zt)}function _t(Pt,Ot){return b(nt(Pt,Ot))}function xt(Pt,Ot,zt){return et(it(Pt,ot(zt)),Ot,zt)}function Mt(Pt,Ot,zt){return rt(nt(Pt,Ot),zt)}function wt(Pt,Ot,zt){return et(dt(Pt,ot(zt)),Ot,zt)}function Et(Pt,Ot,zt){var rr=dt(Pt,ot(zt));return xt(rr,Ot,lt(rr))}function At(Pt,Ot,zt){return ft(Mt(Pt,Ot))}function St(cr){var Ot=st(cr),zt=Ot.getInt32(0),rr=Ot.getInt32(4),Jt=cr.subarray(8,12),cr=cr.subarray(12);return[zt,cr,rr,Jt]}function bt(Pt,Ot,zt,rr){var Jt=new ArrayBuffer(12+rr.byteLength),cr=new Uint8Array(Jt),dr=new DataView(Jt);return dr.setInt32(0,Pt),dr.setInt32(4,Ot),zt&&cr.set(zt,8),cr.set(rr,12),cr}function Ct(Pt){var Ot=Pt.length,zt=tt(Pt);return bt(2,Ot,void 0,zt)}function Nt(Pt){var Ot=Pt.length,zt=d(Pt);return bt(4,Ot,void 0,zt)}function kt(Pt,Ot){var zt=Pt.length/Ot,rr=d([Ot]),Jt=tt(Pt);return bt(5,zt,rr,Jt)}function Ht(Pt){var Ot=Pt.length,zt=d(b(Pt));return bt(6,Ot,void 0,zt)}function jt(Pt){var Ot=Pt.length,zt=d(yt(Pt));return bt(8,Ot,void 0,zt)}function Zt(Pt,Ot){var zt=Pt.length,rr=d([Ot]),Jt=d(_t(Pt,Ot));return bt(9,zt,rr,Jt)}function Xt(Pt,Ot){var zt=Pt.length,rr=d([Ot]),Jt=$(At(Pt,Ot));return bt(10,zt,rr,Jt)}function Kt(Pt){var Ot={};return br.forEach(function(zt){Pt[zt]!==void 0&&(Ot[zt]=Pt[zt])}),Pt.bondAtomList&&(Ot.bondAtomList=Nt(Pt.bondAtomList)),Pt.bondOrderList&&(Ot.bondOrderList=Ct(Pt.bondOrderList)),Ot.xCoordList=Xt(Pt.xCoordList,1e3),Ot.yCoordList=Xt(Pt.yCoordList,1e3),Ot.zCoordList=Xt(Pt.zCoordList,1e3),Pt.bFactorList&&(Ot.bFactorList=Xt(Pt.bFactorList,100)),Pt.atomIdList&&(Ot.atomIdList=jt(Pt.atomIdList)),Pt.altLocList&&(Ot.altLocList=Ht(Pt.altLocList)),Pt.occupancyList&&(Ot.occupancyList=Zt(Pt.occupancyList,100)),Ot.groupIdList=jt(Pt.groupIdList),Ot.groupTypeList=Nt(Pt.groupTypeList),Pt.secStructList&&(Ot.secStructList=Ct(Pt.secStructList)),Pt.insCodeList&&(Ot.insCodeList=Ht(Pt.insCodeList)),Pt.sequenceIndexList&&(Ot.sequenceIndexList=jt(Pt.sequenceIndexList)),Ot.chainIdList=kt(Pt.chainIdList,4),Pt.chainNameList&&(Ot.chainNameList=kt(Pt.chainNameList,4)),Ot}function ar(Pt){function Ot(Gt){for(var er={},fr=0;Gt>fr;fr++){var Ut=cr();er[Ut]=cr()}return er}function zt(Gt){var er=Pt.subarray(dr,dr+Gt);return dr+=Gt,er}function rr(Gt){var er=Pt.subarray(dr,dr+Gt);dr+=Gt;var fr=65535;if(Gt>fr){for(var Ut=[],sr=0;sr<er.length;sr+=fr)Ut.push(String.fromCharCode.apply(null,er.subarray(sr,sr+fr)));return Ut.join("")}return String.fromCharCode.apply(null,er)}function Jt(Gt){for(var er=new Array(Gt),fr=0;Gt>fr;fr++)er[fr]=cr();return er}function cr(){var Gt,er,fr=Pt[dr];if(!(128&fr))return dr++,fr;if((240&fr)===128)return er=15&fr,dr++,Ot(er);if((240&fr)===144)return er=15&fr,dr++,Jt(er);if((224&fr)===160)return er=31&fr,dr++,rr(er);if((224&fr)===224)return Gt=Dt.getInt8(dr),dr++,Gt;switch(fr){case 192:return dr++,null;case 194:return dr++,!1;case 195:return dr++,!0;case 196:return er=Dt.getUint8(dr+1),dr+=2,zt(er);case 197:return er=Dt.getUint16(dr+1),dr+=3,zt(er);case 198:return er=Dt.getUint32(dr+1),dr+=5,zt(er);case 202:return Gt=Dt.getFloat32(dr+1),dr+=5,Gt;case 203:return Gt=Dt.getFloat64(dr+1),dr+=9,Gt;case 204:return Gt=Pt[dr+1],dr+=2,Gt;case 205:return Gt=Dt.getUint16(dr+1),dr+=3,Gt;case 206:return Gt=Dt.getUint32(dr+1),dr+=5,Gt;case 208:return Gt=Dt.getInt8(dr+1),dr+=2,Gt;case 209:return Gt=Dt.getInt16(dr+1),dr+=3,Gt;case 210:return Gt=Dt.getInt32(dr+1),dr+=5,Gt;case 217:return er=Dt.getUint8(dr+1),dr+=2,rr(er);case 218:return er=Dt.getUint16(dr+1),dr+=3,rr(er);case 219:return er=Dt.getUint32(dr+1),dr+=5,rr(er);case 220:return er=Dt.getUint16(dr+1),dr+=3,Jt(er);case 221:return er=Dt.getUint32(dr+1),dr+=5,Jt(er);case 222:return er=Dt.getUint16(dr+1),dr+=3,Ot(er);case 223:return er=Dt.getUint32(dr+1),dr+=5,Ot(er)}throw new Error("Unknown type 0x"+fr.toString(16))}var dr=0,Dt=new DataView(Pt.buffer);return cr()}function or(Pt,Ot,zt,rr){switch(Pt){case 1:return j(Ot);case 2:return at(Ot);case 3:return ct(Ot);case 4:return c(Ot);case 5:return tt(Ot);case 6:return ut(c(Ot),new Uint8Array(zt));case 7:return ut(c(Ot));case 8:return mt(c(Ot));case 9:return gt(c(Ot),c(rr)[0]);case 10:return Et(ct(Ot),c(rr)[0]);case 11:return et(ct(Ot),c(rr)[0]);case 12:return wt(ct(Ot),c(rr)[0]);case 13:return wt(at(Ot),c(rr)[0]);case 14:return dt(ct(Ot));case 15:return dt(at(Ot))}}function _r(Pt,Ot){Ot=Ot||{};var zt=Ot.ignoreFields,rr={};return xr.forEach(function(Jt){var cr=zt?zt.indexOf(Jt)!==-1:!1,dr=Pt[Jt];cr||dr===void 0||(dr instanceof Uint8Array?rr[Jt]=or.apply(null,St(dr)):rr[Jt]=dr)}),rr}function nr(Pt){return String.fromCharCode.apply(null,Pt).replace(/\0/g,"")}function Vt(Pt,Ot,zt){zt=zt||{};var rr,Jt,cr,dr,Dt,Gt,er=zt.firstModelOnly,fr=Ot.onModel,Ut=Ot.onChain,sr=Ot.onGroup,Lt=Ot.onAtom,hr=Ot.onBond,yr=0,vt=0,Qt=0,Yt=0,Rt=0,Wt=-1,ir=Pt.chainNameList,Lr=Pt.secStructList,Dr=Pt.insCodeList,Mr=Pt.sequenceIndexList,kr=Pt.atomIdList,nn=Pt.bFactorList,Vr=Pt.altLocList,Ir=Pt.occupancyList,zr=Pt.bondAtomList,Kr=Pt.bondOrderList;for(rr=0,Jt=Pt.chainsPerModel.length;Jt>rr&&!(er&&yr>0);++rr){var Gr=Pt.chainsPerModel[yr];for(fr&&fr({chainCount:Gr,modelIndex:yr}),cr=0;Gr>cr;++cr){var cn=Pt.groupsPerChain[vt];if(Ut){var en=nr(Pt.chainIdList.subarray(4*vt,4*vt+4)),jr=null;ir&&(jr=nr(ir.subarray(4*vt,4*vt+4))),Ut({groupCount:cn,chainIndex:vt,modelIndex:yr,chainId:en,chainName:jr})}for(dr=0;cn>dr;++dr){var Ur=Pt.groupList[Pt.groupTypeList[Qt]],Nr=Ur.atomNameList.length;if(sr){var tn=null;Lr&&(tn=Lr[Qt]);var sn=null;Pt.insCodeList&&(sn=String.fromCharCode(Dr[Qt]));var un=null;Mr&&(un=Mr[Qt]),sr({atomCount:Nr,groupIndex:Qt,chainIndex:vt,modelIndex:yr,groupId:Pt.groupIdList[Qt],groupType:Pt.groupTypeList[Qt],groupName:Ur.groupName,singleLetterCode:Ur.singleLetterCode,chemCompType:Ur.chemCompType,secStruct:tn,insCode:sn,sequenceIndex:un})}for(Dt=0;Nr>Dt;++Dt){if(Lt){var dn=null;kr&&(dn=kr[Yt]);var fn=null;nn&&(fn=nn[Yt]);var _n=null;Vr&&(_n=String.fromCharCode(Vr[Yt]));var On=null;Ir&&(On=Ir[Yt]),Lt({atomIndex:Yt,groupIndex:Qt,chainIndex:vt,modelIndex:yr,atomId:dn,element:Ur.elementList[Dt],atomName:Ur.atomNameList[Dt],formalCharge:Ur.formalChargeList[Dt],xCoord:Pt.xCoordList[Yt],yCoord:Pt.yCoordList[Yt],zCoord:Pt.zCoordList[Yt],bFactor:fn,altLoc:_n,occupancy:On})}Yt+=1}if(hr){var Qn=Ur.bondAtomList;for(Dt=0,Gt=Ur.bondOrderList.length;Gt>Dt;++Dt)hr({atomIndex1:Yt-Nr+Qn[2*Dt],atomIndex2:Yt-Nr+Qn[2*Dt+1],bondOrder:Ur.bondOrderList[Dt]})}Qt+=1}vt+=1}if(Rt=Wt+1,Wt=Yt-1,hr&&zr)for(Dt=0,Gt=zr.length;Gt>Dt;Dt+=2){var Jn=zr[Dt],qn=zr[Dt+1];(Jn>=Rt&&Wt>=Jn||qn>=Rt&&Wt>=qn)&&hr({atomIndex1:Jn,atomIndex2:qn,bondOrder:Kr?Kr[Dt/2]:null})}yr+=1}}function tr(Pt){return g(Kt(Pt))}function mr(Pt,Ot){Pt instanceof ArrayBuffer&&(Pt=new Uint8Array(Pt));var zt;return zt=Pt instanceof Uint8Array?ar(Pt):Pt,_r(zt,Ot)}function wr(Pt,Ot,zt,rr){function Jt(){try{var dr=mr(cr.response);zt(dr)}catch(Dt){rr(Dt)}}var cr=new XMLHttpRequest;cr.addEventListener("load",Jt,!0),cr.addEventListener("error",rr,!0),cr.responseType="arraybuffer",cr.open("GET",Ot+Pt.toUpperCase()),cr.send()}function Er(Pt,Ot,zt){wr(Pt,Tr,Ot,zt)}function Sr(Pt,Ot,zt){wr(Pt,Cr,Ot,zt)}var br=["mmtfVersion","mmtfProducer","unitCell","spaceGroup","structureId","title","depositionDate","releaseDate","experimentalMethods","resolution","rFree","rWork","bioAssemblyList","ncsOperatorList","entityList","groupList","numBonds","numAtoms","numGroups","numChains","numModels","groupsPerChain","chainsPerModel"],gr=["xCoordList","yCoordList","zCoordList","groupIdList","groupTypeList","chainIdList","bFactorList","atomIdList","altLocList","occupancyList","secStructList","insCodeList","sequenceIndexList","chainNameList","bondAtomList","bondOrderList"],xr=br.concat(gr),vr="v1.0.1",pr="//mmtf.rcsb.org/v1.0/",Tr=pr+"full/",Cr=pr+"reduced/";s.encode=tr,s.decode=mr,s.traverse=Vt,s.fetch=Er,s.fetchReduced=Sr,s.version=vr,s.fetchUrl=Tr,s.fetchReducedUrl=Cr,s.encodeMsgpack=g,s.encodeMmtf=Kt,s.decodeMsgpack=ar,s.decodeMmtf=_r})}},__webpack_module_cache__={};function __webpack_require__(e){var i=__webpack_module_cache__[e];if(i!==void 0)return i.exports;if(__webpack_modules__[e]===void 0){var s=new Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}var o=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e].call(o.exports,o,o.exports,__webpack_require__),o.exports}__webpack_require__.n=e=>{var i=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(i,{a:i}),i},__webpack_require__.d=(e,i)=>{for(var s in i)__webpack_require__.o(i,s)&&!__webpack_require__.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:i[s]})},__webpack_require__.o=(e,i)=>Object.prototype.hasOwnProperty.call(e,i),__webpack_require__.r=e=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__("./src/index.ts"),__webpack_require__("./src/SurfaceWorker.js");var __webpack_exports__=__webpack_require__("./src/exporter.js");return __webpack_exports__})())})(_3Dmol);var _3DmolExports=_3Dmol.exports;const _3Dmol_default=getDefaultExportFromCjs(_3DmolExports),$3Dmol$1=_mergeNamespaces({__proto__:null,default:_3Dmol_default},[_3DmolExports]),create3DmolViewer=async(e,i={})=>{console.log("Creating 3Dmol viewer with container:",e);try{if(!$3Dmol$1||!_3DmolExports.createViewer)throw new Error("3Dmol.js module did not load correctly  createViewer not found");console.log(" 3Dmol.js loaded from npm package");const s={backgroundColor:"black",antialias:!0,quality:"high",...i},o=_3DmolExports.createViewer(e,{backgroundColor:s.backgroundColor,antialias:s.antialias,quality:s.quality});if(!o)throw new Error("Failed to create 3Dmol viewer");return console.log(" 3Dmol.js viewer instance created"),{viewer:o,$3Dmol:$3Dmol$1,models:new Map,representations:new Map,shapeIds:new Map,async loadProtein(h,_={}){try{console.log(`Loading protein from: ${h}`);const g=await fetch(h);if(!g.ok)throw new Error(`Failed to fetch PDB file: ${g.status}`);const _e=await g.text(),st=o.addModel(_e,"pdb");return this.models.set(st,{type:"protein",url:h,loadedAt:new Date().toISOString()}),console.log(" Protein loaded, model:",st),st}catch(g){throw console.error("Error loading protein:",g),g}},async loadLigand(h,_={}){try{console.log(`Loading ligand from: ${h}`);const g=await fetch(h);if(!g.ok)throw new Error(`Failed to fetch SDF file: ${g.status}`);const _e=await g.text(),st=o.addModel(_e,"sdf");return this.models.set(st,{type:"ligand",url:h,loadedAt:new Date().toISOString()}),console.log(" Ligand loaded, model:",st),st}catch(g){throw console.error("Error loading ligand:",g),g}},async addCartoonRepresentation(h,_={}){try{const g={opacity:_.opacity??1},_e=_.colorscheme||_.scheme||_.color||"spectrum",st=typeof _e=="string"?_e.toLowerCase():"";if(st==="spectrum")g.color="spectrum";else{const ot={chainid:"chain",chain:"chain",chainhetatm:"chainHetatm",ssjmol:"ssJmol",jmol:"Jmol",amino:"amino",shapely:"shapely",nucleic:"nucleic",taylor:"taylor",turn:"turn",strand:"strand"}[st];ot?g.colorscheme=ot:g.color=_e}o.setStyle({model:h},{cartoon:g});const tt=`cartoon_${Date.now()}`;return this.representations.set(tt,{type:"cartoon",model:h,options:_}),console.log(" Cartoon representation added"),tt}catch(g){throw console.error("Error adding cartoon representation:",g),g}},async addBallAndStickRepresentation(h,_={}){try{o.setStyle({model:h},{stick:{radius:_.bondRadius??.15,colorscheme:_.colorscheme||"default"},sphere:{scale:_.scale??.3,colorscheme:_.colorscheme||"default"}});const g=`ballandstick_${Date.now()}`;return this.representations.set(g,{type:"ballandstick",model:h,options:_}),console.log(" Ball-and-stick representation added"),g}catch(g){throw console.error("Error adding ball-and-stick representation:",g),g}},clearRepresentations(h){try{o.removeModel(h);for(const[_,g]of this.representations)g.model===h&&this.representations.delete(_);this.models.delete(h),console.log("Cleared representations for model")}catch(_){console.error("Error clearing representations:",_)}},clearRepresentationsOfType(h){try{const _=[];for(const[g,_e]of this.representations)_e.type===h&&_.push({repId:g,model:_e.model});for(const{repId:g,model:_e}of _)o.removeModel(_e),this.representations.delete(g),this.models.delete(_e);console.log(`Cleared ${_.length} representations of type: ${h}`)}catch(_){console.error("Error clearing representations by type:",_)}},async resetView(){try{o.zoomTo(),o.render(),console.log("Camera view reset")}catch(h){console.error("Error resetting view:",h)}},async zoomTo(h=null){try{h&&h.length>0?o.zoomTo({model:h}):o.zoomTo(),o.render()}catch(_){console.error("Error zooming:",_)}},setSpin(h){try{h?o.spin("y"):o.spin(!1),console.log(`Spin ${h?"enabled":"disabled"}`)}catch(_){console.error("Error setting spin:",_)}},render(){try{o.render()}catch(h){console.error("Error rendering:",h)}},getState(){return{models:Array.from(this.models.entries()),representations:Array.from(this.representations.entries()),viewerInitialized:!!o}},dispose(){try{o.clear(),this.models.clear(),this.representations.clear(),this.shapeIds.clear(),console.log("Viewer disposed")}catch(h){console.error("Error disposing viewer:",h)}}}}catch(s){throw console.error("Error creating 3Dmol viewer:",s),s}},createMockViewer=()=>({viewer:null,models:new Map,representations:new Map,async loadProtein(e){return console.log(`Mock loading protein from: ${e}`),"mock_protein_id"},async loadLigand(e){return console.log(`Mock loading ligand from: ${e}`),"mock_ligand_id"},async addCartoonRepresentation(e,i={}){return console.log(`Mock adding cartoon representation for model: ${e}`),`mock_cartoon_${e}`},async addBallAndStickRepresentation(e,i={}){return console.log(`Mock adding ball-and-stick representation for model: ${e}`),`mock_ballandstick_${e}`},async addVolumeData(e,i={}){return console.log("Mock adding volume data:",e,i),"mock_volume_id"},clearRepresentations(e){console.log(`Mock clearing representations for model: ${e}`)},clearRepresentationsOfType(e){console.log(`Mock clearing representations of type: ${e}`)},async resetView(){console.log("Mock resetting view")},async zoomTo(e=null){console.log("Mock zooming to:",e||"all content")},setSpin(e,i=1){console.log(`Mock spin ${e?"enabled":"disabled"}`)},render(){console.log("Mock rendering")},getState(){return{models:[],representations:[],viewerInitialized:!1}},dispose(){console.log("Mock viewer disposed")}}),InteractiveViewer=()=>{var j;const{state:e,actions:i}=useViewer(),s=e.viewer,o=i.setViewer,a=i.setProteinPart,h=i.setProteinSelectionBounds;i.setNarrative;const _=reactExports.useRef(null),g=reactExports.useRef(null),_e=reactExports.useRef(!1),st=reactExports.useRef(0),tt=5,[at,ot]=reactExports.useState(e.isLoading),[lt,ct]=reactExports.useState(e.selectedLigand||((j=ligandOptions[0])==null?void 0:j.id)||""),[$,c]=reactExports.useState(e.currentNarrative||"");reactExports.useEffect(()=>!_.current||s||_e.current?void 0:(_e.current=!0,(async()=>{try{console.log("Initializing 3Dmol.js viewer..."),console.log(`Viewer ref: ${!!_.current}`);const nt=await create3DmolViewer(_.current,{backgroundColor:"black",antialias:!0,quality:"high"});console.log("3Dmol.js viewer created successfully"),console.log("Viewer wrapper methods:",Object.keys(nt)),console.log("Loading PDB structure...");const ut=await nt.loadProtein("/assets/pdb/3FLY.pdb");console.log("Protein model loaded:",ut),console.log("Creating cartoon representation...");const b=await nt.addCartoonRepresentation(ut,{colorscheme:"spectrum",opacity:1});console.log("Cartoon representation created:",b),nt.render(),g.current=nt,o(nt),ot(!1),c("P38 MAP Kinase structure loaded successfully. Click on any part of the protein to select it, then enable FragMaps to see interaction sites for that specific region."),setTimeout(()=>{var it;if(nt&&_.current){console.log("Setting up interactions..."),console.log("Viewer wrapper state:",nt.getState());const rt=(it=_.current)==null?void 0:it.querySelector("canvas");if(!rt){console.log(" No canvas found in viewerRef");return}console.log(" Canvas found:",rt),console.log("Canvas dimensions:",rt.width,"x",rt.height),rt?(console.log("Canvas found for interaction setup"),rt.tabIndex=0,rt.style.outline="none",rt.focus(),rt.addEventListener("click",async dt=>{var gt;console.log(" [INTERACTIVE-VIEWER] Canvas clicked, detecting protein region...");const ft=rt.getBoundingClientRect(),mt=dt.clientX-ft.left,yt=dt.clientY-ft.top;console.log(` [INTERACTIVE-VIEWER] Click position: x=${mt}, y=${yt}`);try{const _t=await detectProteinRegion(nt,mt,yt);if(_t&&_t.residues.length>0){console.log(" [INTERACTIVE-VIEWER] Protein region detected!"),console.log(` [INTERACTIVE-VIEWER] Found ${_t.residues.length} residues`),console.log(" [INTERACTIVE-VIEWER] Bounds:",_t.bounds),a({residues:_t.residues,description:`Selected ${getRegionDescription(_t.residues)}${_t.isDummy?" (demo mode)":""}`,loci:_t.loci,isDummy:_t.isDummy||!1}),h(_t.bounds);const xt=((gt=e.activeFragMaps)==null?void 0:gt.size)||0,Mt=e.selectedLigand==="crystal"?"Crystal Ligand":e.selectedLigand==="sil1"?"SILCS-MC Pose 1":e.selectedLigand==="sil2"?"SILCS-MC Pose 2":"Crystal Ligand";c(`P38 MAP Kinase (3FLY)
${xt} Active FragMaps
${Mt}`),i.clearFragMaps()}else console.log(" [INTERACTIVE-VIEWER] No protein region detected at click position"),c("No protein region detected at this position. Try clicking directly on the protein structure. The protein is shown as a cartoon representation - click on any part of the colored ribbons. If the issue persists, the molecular viewer may still be loading - please wait a moment and try again.")}catch(_t){console.error(" [INTERACTIVE-VIEWER] Error handling protein selection:",_t),c("Error detecting protein region. The molecular viewer may still be loading. Please wait a moment and try clicking on the protein structure again.")}}),console.log("Canvas interaction setup complete")):console.log("Canvas not found for interaction setup")}},2e3)}catch(nt){console.error(`ERROR: ${nt.message}`),console.log("Falling back to mock viewer due to error"),ot(!1),c("3Dmol.js viewer initialization failed. Falling back to demo mode.");const ut=createMockViewer();g.current=ut,o(ut)}})(),()=>{console.log("Cleaning up viewer..."),setTimeout(()=>{if(g.current){try{g.current.dispose(),console.log("3Dmol.js viewer disposed")}catch(nt){console.log(`Viewer dispose failed: ${nt.message}`)}g.current=null}_e.current=!1,console.log("Cleanup complete")},0)}),[]);const d=reactExports.useCallback(async et=>{if(!s){console.log("No viewer available, skipping ligand load");return}try{const nt=ligandOptions.find(ut=>ut.id===et);if(!nt){console.log(" Ligand not found:",et);return}if(console.log(" Found ligand:",nt),console.log("Loading ligand:",nt.name,"from file:",nt.file),s.viewer){console.log(" Real 3Dmol viewer detected"),console.log("Loading ligand with 3Dmol visualization");try{console.log(" Clearing existing ligand representations...");const it=[];for(const[rt,dt]of s.models)dt.type==="ligand"&&it.push(rt);for(const rt of it)console.log(" Removing existing ligand model:",rt),s.clearRepresentations(rt);console.log(` Removed ${it.length} existing ligand models`)}catch(it){console.log(" No existing ligand to remove or error removing:",it.message)}console.log(" Loading ligand file from:",`/assets/ligands/${nt.file}`);const ut=await s.loadLigand(`/assets/ligands/${nt.file}`);console.log(" Ligand model loaded successfully:",ut),console.log(" Creating ligand representation...");const b=await s.addBallAndStickRepresentation(ut,{scale:.8,bondRadius:.3,colorscheme:"default",opacity:1});console.log(" Ligand representation created:",b),await s.zoomTo(),s.render(),console.log(" Auto-enabling FragMaps with ligand..."),setTimeout(async()=>{try{const it=new CustomEvent("ligandLoaded",{detail:{ligandId:et,ligandName:nt.name}});window.dispatchEvent(it),console.log(` Dispatched ligand loaded event for ${nt.name}`)}catch(it){console.log(" Could not auto-enable FragMaps:",it.message)}},1e3),console.log(" Ligand loading completed successfully!"),c(`Loaded ${nt.name}: ${nt.description}. The ligand is shown in ball-and-stick representation with element-based coloring.`)}else console.log(" Mock viewer detected - using simple ligand loading"),console.log(`Mock loading ligand: ${nt.name} from ${nt.file}`)}catch(nt){console.error(" Error loading ligand:",nt),console.log("Falling back to mock viewer for ligand loading"),ot(!1),c("Ligand loading failed. Please try again.")}},[s,ligandOptions,ot,c]);return reactExports.useEffect(()=>{if(console.log("Ligand selection changed to:",lt),s&&s.viewer)console.log("Viewer is ready, loading ligand:",lt),d(lt);else{console.log("Viewer not ready for ligand loading, will retry...");const et=()=>{st.current<tt&&s&&s.viewer?(console.log(`Retrying ligand load (${st.current+1}/${tt})`),d(lt),st.current++):st.current>=tt&&console.log("Max retries reached for ligand loading")},nt=setInterval(()=>{et()},500);setTimeout(()=>{clearInterval(nt)},2500),et()}},[lt,s,d]),reactExports.useEffect(()=>{const et=nt=>{console.log(" [INTERACTIVE-VIEWER] Ligand loaded event received:",nt.detail),e.selectedProteinPart?console.log(" [INTERACTIVE-VIEWER] Protein part already selected, FragMaps will auto-enable"):console.log(" [INTERACTIVE-VIEWER] No protein part selected, FragMaps will enable when protein is selected")};return window.addEventListener("ligandLoaded",et),()=>{window.removeEventListener("ligandLoaded",et)}},[e.selectedProteinPart]),jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-molstar-bg flex flex-col",children:[jsxRuntimeExports.jsx("div",{className:"glass-morphism border-b border-white/10 px-6 py-4",children:jsxRuntimeExports.jsxs("div",{className:"max-w-7xl mx-auto",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Interactive Molecular Viewer"}),jsxRuntimeExports.jsx("p",{className:"text-gray-400 text-sm",children:"Explore P38 MAP Kinase with SILCS FragMaps. Use controls to toggle visualizations and select different ligands."})]})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col lg:flex-row",children:[jsxRuntimeExports.jsxs("div",{className:"lg:w-80 p-6 space-y-6 overflow-y-auto max-h-screen",children:[jsxRuntimeExports.jsx(LigandSelector,{ligandOptions,selectedLigand:lt,onLigandSelect:ct,isLoading:at}),jsxRuntimeExports.jsx(FragMapManager,{}),jsxRuntimeExports.jsx(FragMapToggles,{fragMapTypes,activeFragMaps:e.activeFragMaps,isoValues:e.isoValues,onToggleFragMap:i.toggleFragMap,onIsoValueChange:i.setIsoValue,selectedProteinPart:e.selectedProteinPart})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 p-6",children:jsxRuntimeExports.jsxs("div",{className:"viewer-container h-full min-h-[600px] relative",children:[at&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-molstar-bg rounded-lg z-10",children:jsxRuntimeExports.jsx("div",{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full",style:{animation:"spin 2s linear infinite"}})}),jsxRuntimeExports.jsx("div",{ref:_,className:"molstar-container w-full h-full relative z-50",style:{minHeight:"600px",backgroundColor:"black",position:"absolute",top:0,left:0,right:0,bottom:0}}),!(s!=null&&s.viewer)&&!at&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gradient-to-br from-molstar-bg to-molstar-surface rounded-lg border border-white/10 z-20",children:jsxRuntimeExports.jsxs("div",{className:"text-center space-y-4 p-8",children:[jsxRuntimeExports.jsx("div",{className:"w-20 h-20 mx-auto bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center",children:jsxRuntimeExports.jsx("svg",{className:"w-10 h-10 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),jsxRuntimeExports.jsx("h3",{className:"text-xl font-semibold text-white",children:"Molecular Visualization Demo"}),jsxRuntimeExports.jsx("p",{className:"text-gray-400 max-w-md",children:"This is a demonstration of the SILCS FragMaps interface. The actual 3D molecular viewer requires integration with 3Dmol.js or similar libraries."}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-300",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white/5 rounded-lg p-3",children:[jsxRuntimeExports.jsx("div",{className:"font-medium text-blue-400 mb-1",children:"Protein Structure"}),jsxRuntimeExports.jsx("div",{className:"text-xs",children:"P38 MAP Kinase (3FLY)"})]}),jsxRuntimeExports.jsxs("div",{className:"bg-white/5 rounded-lg p-3",children:[jsxRuntimeExports.jsx("div",{className:"font-medium text-purple-400 mb-1",children:"Active FragMaps"}),jsxRuntimeExports.jsxs("div",{className:"text-xs",children:[e.activeFragMaps.size," of 6"]})]})]}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500",children:"Check browser console for molecular loading events"})]})})]})}),jsxRuntimeExports.jsx("div",{className:"lg:w-80 p-6",children:jsxRuntimeExports.jsx(CaptionPanel,{caption:$})})]})]})},App=()=>{const[e,i]=reactExports.useState("overview"),s=o=>{i(o)};return reactExports.useEffect(()=>{const o=()=>{const a=window.location.hash.slice(1);s(a==="interactive"?"interactive":"overview")};return o(),window.addEventListener("hashchange",o),()=>window.removeEventListener("hashchange",o)},[]),jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-molstar-bg",children:[jsxRuntimeExports.jsx(Navbar,{currentSection:e,onNavigate:s}),e==="overview"?jsxRuntimeExports.jsx("div",{className:"min-h-screen pt-16",children:jsxRuntimeExports.jsx(Overview,{})}):jsxRuntimeExports.jsx("div",{className:"min-h-screen pt-16",children:jsxRuntimeExports.jsx(ViewerProvider,{children:jsxRuntimeExports.jsx(InteractiveViewer,{})})}),jsxRuntimeExports.jsxs("div",{className:"fixed inset-0 pointer-events-none",children:[jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-900/10 via-transparent to-purple-900/10"}),jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent"})]})]})};client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));
//# sourceMappingURL=index-Cvx4wi05.js.map
